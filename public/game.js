(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function(){"use strict";var n={"@@functional/placeholder":!0},t=function(n,t){switch(n){case 0:return function(){return t.apply(this,arguments)};case 1:return function(n){return t.apply(this,arguments)};case 2:return function(n,r){return t.apply(this,arguments)};case 3:return function(n,r,e){return t.apply(this,arguments)};case 4:return function(n,r,e,u){return t.apply(this,arguments)};case 5:return function(n,r,e,u,i){return t.apply(this,arguments)};case 6:return function(n,r,e,u,i,o){return t.apply(this,arguments)};case 7:return function(n,r,e,u,i,o,c){return t.apply(this,arguments)};case 8:return function(n,r,e,u,i,o,c,a){return t.apply(this,arguments)};case 9:return function(n,r,e,u,i,o,c,a,f){return t.apply(this,arguments)};case 10:return function(n,r,e,u,i,o,c,a,f,s){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},r=function(n){return new RegExp(n.source,(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.sticky?"y":"")+(n.unicode?"u":""))},e=function(n){return function(){return!n.apply(this,arguments)}},u=function(n,t){n=n||[],t=t||[];var r,e=n.length,u=t.length,i=[];for(r=0;e>r;)i[i.length]=n[r],r+=1;for(r=0;u>r;)i[i.length]=t[r],r+=1;return i},i=function(n,t,r){for(var e=0,u=r.length;u>e;){if(n(t,r[e]))return!0;e+=1}return!1},o=function(n){return function t(r){return 0===arguments.length?t:null!=r&&r["@@functional/placeholder"]===!0?t:n.apply(this,arguments)}},c=function(n){return function t(r,e){var u=arguments.length;return 0===u?t:1===u&&null!=r&&r["@@functional/placeholder"]===!0?t:1===u?o(function(t){return n(r,t)}):2===u&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0?t:2===u&&null!=r&&r["@@functional/placeholder"]===!0?o(function(t){return n(t,e)}):2===u&&null!=e&&e["@@functional/placeholder"]===!0?o(function(t){return n(r,t)}):n(r,e)}},a=function(n){return function t(r,e,u){var i=arguments.length;return 0===i?t:1===i&&null!=r&&r["@@functional/placeholder"]===!0?t:1===i?c(function(t,e){return n(r,t,e)}):2===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0?t:2===i&&null!=r&&r["@@functional/placeholder"]===!0?c(function(t,r){return n(t,e,r)}):2===i&&null!=e&&e["@@functional/placeholder"]===!0?c(function(t,e){return n(r,t,e)}):2===i?o(function(t){return n(r,e,t)}):3===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0&&null!=u&&u["@@functional/placeholder"]===!0?t:3===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0?c(function(t,r){return n(t,r,u)}):3===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=u&&u["@@functional/placeholder"]===!0?c(function(t,r){return n(t,e,r)}):3===i&&null!=e&&e["@@functional/placeholder"]===!0&&null!=u&&u["@@functional/placeholder"]===!0?c(function(t,e){return n(r,t,e)}):3===i&&null!=r&&r["@@functional/placeholder"]===!0?o(function(t){return n(t,e,u)}):3===i&&null!=e&&e["@@functional/placeholder"]===!0?o(function(t){return n(r,t,u)}):3===i&&null!=u&&u["@@functional/placeholder"]===!0?o(function(t){return n(r,e,t)}):n(r,e,u)}},f=function cu(n,r,e){return function(){for(var u=[],i=0,o=n,c=0;c<r.length||i<arguments.length;){var a;c<r.length&&(null==r[c]||r[c]["@@functional/placeholder"]!==!0||i>=arguments.length)?a=r[c]:(a=arguments[i],i+=1),u[c]=a,(null==a||a["@@functional/placeholder"]!==!0)&&(o-=1),c+=1}return 0>=o?e.apply(this,u):t(o,cu(n,u,e))}},s=function(n,t){for(var r=0,e=t.length,u=[];e>r;)n(t[r])&&(u[u.length]=t[r]),r+=1;return u},l=function(n){return{"@@transducer/value":n,"@@transducer/reduced":!0}},p=function(n){return function(t){return s(function(n){return"function"==typeof t[n]},n(t))}},h=function(n,t){return Object.prototype.hasOwnProperty.call(t,n)},g=function(n){return n},d=Array.isArray||function(n){return null!=n&&n.length>=0&&"[object Array]"===Object.prototype.toString.call(n)},y=Number.isInteger||function(n){return n<<0===n},m=function(n){return"[object Number]"===Object.prototype.toString.call(n)},v=function(n){return"[object String]"===Object.prototype.toString.call(n)},w=function(n){return"function"==typeof n["@@transducer/step"]},x=function(n,t){for(var r=0,e=t.length,u=Array(e);e>r;)u[r]=n(t[r]),r+=1;return u},b=function(n,t){return function(){return t.call(this,n.apply(this,arguments))}},j=function(n,t){return function(){var r=this;return n.apply(r,arguments).then(function(n){return t.call(r,n)})}},O=function(n){return'"'+n.replace(/"/g,'\\"')+'"'},S=function(n){return n&&n["@@transducer/reduced"]?n:{"@@transducer/value":n,"@@transducer/reduced":!0}},E=function au(n,t,r){switch(arguments.length){case 1:return au(n,0,n.length);case 2:return au(n,t,n.length);default:for(var e=[],u=0,i=Math.max(0,Math.min(n.length,r)-t);i>u;)e[u]=n[t+u],u+=1;return e}},A=function(){var n=function(n){return(10>n?"0":"")+n};return"function"==typeof Date.prototype.toISOString?function(n){return n.toISOString()}:function(t){return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),I=function(){function n(n,t){this.xf=t,this.pred=n,this.lastValue=void 0,this.seenFirstValue=!1}return n.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},n.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){var r=!1;return this.seenFirstValue?this.pred(this.lastValue,t)&&(r=!0):this.seenFirstValue=!0,this.lastValue=t,r?n:this.xf["@@transducer/step"](n,t)},c(function(t,r){return new n(t,r)})}(),k={init:function(){return this.xf["@@transducer/init"]()},result:function(n){return this.xf["@@transducer/result"](n)}},N=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.f(t)?this.xf["@@transducer/step"](n,t):n},c(function(t,r){return new n(t,r)})}(),C=function(){function n(n,t){this.xf=t,this.f=n,this.found=!1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.found||(n=this.xf["@@transducer/step"](n,void 0)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.found=!0,n=S(this.xf["@@transducer/step"](n,t))),n},c(function(t,r){return new n(t,r)})}(),M=function(){function n(n,t){this.xf=t,this.f=n,this.idx=-1,this.found=!1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.found||(n=this.xf["@@transducer/step"](n,-1)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.idx+=1,this.f(t)&&(this.found=!0,n=S(this.xf["@@transducer/step"](n,this.idx))),n},c(function(t,r){return new n(t,r)})}(),P=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](n,this.last))},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.last=t),n},c(function(t,r){return new n(t,r)})}(),T=function(){function n(n,t){this.xf=t,this.f=n,this.idx=-1,this.lastIdx=-1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](n,this.lastIdx))},n.prototype["@@transducer/step"]=function(n,t){return this.idx+=1,this.f(t)&&(this.lastIdx=this.idx),n},c(function(t,r){return new n(t,r)})}(),q=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.xf["@@transducer/step"](n,this.f(t))},c(function(t,r){return new n(t,r)})}(),W=function(){function n(n,t){this.xf=t,this.n=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return 0===this.n?S(n):(this.n-=1,this.xf["@@transducer/step"](n,t))},c(function(t,r){return new n(t,r)})}(),R=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.f(t)?this.xf["@@transducer/step"](n,t):S(n)},c(function(t,r){return new n(t,r)})}(),B=function(){function n(n){this.f=n}return n.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},n.prototype["@@transducer/result"]=function(n){return n},n.prototype["@@transducer/step"]=function(n,t){return this.f(n,t)},function(t){return new n(t)}}(),L=c(function(n,t){return n+t}),U=a(function(n,t,r){if(t>=r.length||t<-r.length)return r;var e=0>t?r.length:0,i=e+t,o=u(r);return o[i]=n(r[i]),o}),F=o(function(n){return function(){return n}}),D=c(function(n,t){for(var r=0,e=t.length-(n-1),u=new Array(e>=0?e:0);e>r;)u[r]=E(t,r,r+n),r+=1;return u}),V=c(function(n,t){return u(t,[n])}),z=c(function(n,t){return n.apply(this,t)}),_=a(function(n,t,r){var e={};for(var u in r)e[u]=r[u];return e[n]=t,e}),K=a(function fu(n,t,r){switch(n.length){case 0:return r;case 1:return _(n[0],t,r);default:return _(n[0],fu(E(n,1),t,Object(r[n[0]])),r)}}),$=c(function(n,r){return t(n.length,function(){return n.apply(r,arguments)})}),H=c(function(n,t){return function(){return n.apply(this,arguments)&&t.apply(this,arguments)}}),X=o(function(n){return function(t,r){return n(t,r)?-1:n(r,t)?1:0}}),Y=o(e),Z=o(function(n){return function(){for(var t=0;t<n.length;){if(n[t][0].apply(this,arguments))return n[t][1].apply(this,arguments);t+=1}}}),G=a(i),J=c(function(n,t){for(var r={},e=t.length,u=0;e>u;){var i=n(t[u]);r[i]=(h(i,r)?r[i]:0)+1,u+=1}return r}),Q=c(function(n,t){var r={};return r[n]=t,r}),nn=c(function(n,r){return 1===n?o(r):t(n,f(n,[],r))}),tn=L(-1),rn=c(function(n,t){return null==t?n:t}),en=a(function(n,t,r){for(var e=[],u=0,i=t.length,o=G(n);i>u;)o(t[u],r)||o(t[u],e)||(e[e.length]=t[u]),u+=1;return e}),un=c(function(n,t){var r={};for(var e in t)e!==n&&(r[e]=t[e]);return r}),on=c(function su(n,t){switch(n.length){case 0:return t;case 1:return un(n[0],t);default:var r=n[0],e=E(n,1);return null==t[r]?t:_(r,su(e,t[r]),t)}}),cn=c(function(n,t){return n/t}),an=c(function(n,t){for(var r=t.length-1;r>=0&&n(t[r]);)r-=1;return E(t,0,r+1)}),fn=c(function(n,t){return function(){return n.apply(this,arguments)||t.apply(this,arguments)}}),sn=o(function(n){if(null!=n&&"function"==typeof n.empty)return n.empty();if(null!=n&&null!=typeof n.constructor&&"function"==typeof n.constructor.empty)return n.constructor.empty();switch(Object.prototype.toString.call(n)){case"[object Array]":return[];case"[object Object]":return{};case"[object String]":return""}}),ln=c(function lu(n,t){var r,e,u,i={};for(e in t)r=n[e],u=typeof r,i[e]="function"===u?r(t[e]):"object"===u?lu(n[e],t[e]):t[e];return i}),pn=o(function(n){for(var t=0,r=n.length,e={};r>t;)d(n[t])&&n[t].length&&(e[n[t][0]]=n[t][1]),t+=1;return e}),hn=c(function(n,t){return n>t}),gn=c(function(n,t){return n>=t}),dn=c(h),yn=c(function(n,t){return n in t}),mn=c(function(n,t){return n===t?0!==n||1/n===1/t:n!==n&&t!==t}),vn=o(g),wn=a(function(n,t,r){return nn(Math.max(n.length,t.length,r.length),function(){return n.apply(this,arguments)?t.apply(this,arguments):r.apply(this,arguments)})}),xn=L(1),bn=a(function(n,t,r){n=n<r.length&&n>=0?n:r.length;var e=E(r);return e.splice(n,0,t),e}),jn=a(function(n,t,r){return n=n<r.length&&n>=0?n:r.length,u(u(E(r,0,n),t),E(r,n))}),On=c(function(n,t){return null!=t&&t.constructor===n||t instanceof n}),Sn=o(function(n){return d(n)?!0:n?"object"!=typeof n?!1:n instanceof String?!1:1===n.nodeType?!!n.length:0===n.length?!0:n.length>0?n.hasOwnProperty(0)&&n.hasOwnProperty(n.length-1):!1:!1}),En=o(function(n){return 0===Object(n).length}),An=o(function(n){return null==n}),In=function(){var n=!{toString:null}.propertyIsEnumerable("toString"),t=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],r=function(n,t){for(var r=0;r<n.length;){if(n[r]===t)return!0;r+=1}return!1};return o("function"==typeof Object.keys?function(n){return Object(n)!==n?[]:Object.keys(n)}:function(e){if(Object(e)!==e)return[];var u,i,o=[];for(u in e)h(u,e)&&(o[o.length]=u);if(n)for(i=t.length-1;i>=0;)u=t[i],h(u,e)&&!r(o,u)&&(o[o.length]=u),i-=1;return o})}(),kn=o(function(n){var t,r=[];for(t in n)r[r.length]=t;return r}),Nn=o(function(n){return null!=n&&On(Number,n.length)?n.length:NaN}),Cn=c(function(n,t){return t>n}),Mn=c(function(n,t){return t>=n}),Pn=a(function(n,t,r){for(var e=0,u=r.length,i=[],o=[t];u>e;)o=n(o[0],r[e]),i[e]=o[1],e+=1;return[o[0],i]}),Tn=a(function(n,t,r){for(var e=r.length-1,u=[],i=[t];e>=0;)i=n(i[0],r[e]),u[e]=i[1],e-=1;return[i[0],u]}),qn=c(function(n,t){return t.match(n)||[]}),Wn=c(function(n,t){return y(n)?!y(t)||1>t?NaN:(n%t+t)%t:NaN}),Rn=c(function(n,t){return t>n?t:n}),Bn=a(function(n,t,r){return n(r)>n(t)?r:t}),Ln=c(function(n,t){for(var r={},e=In(n),u=0;u<e.length;)r[e[u]]=n[e[u]],u+=1;for(e=In(t),u=0;u<e.length;)r[e[u]]=t[e[u]],u+=1;return r}),Un=c(function(n,t){return n>t?t:n}),Fn=a(function(n,t,r){return n(r)<n(t)?r:t}),Dn=c(function(n,t){return n%t}),Vn=c(function(n,t){return n*t}),zn=c(function(n,t){switch(n){case 0:return function(){return t.call(this)};case 1:return function(n){return t.call(this,n)};case 2:return function(n,r){return t.call(this,n,r)};case 3:return function(n,r,e){return t.call(this,n,r,e)};case 4:return function(n,r,e,u){return t.call(this,n,r,e,u)};case 5:return function(n,r,e,u,i){return t.call(this,n,r,e,u,i)};case 6:return function(n,r,e,u,i,o){return t.call(this,n,r,e,u,i,o)};case 7:return function(n,r,e,u,i,o,c){return t.call(this,n,r,e,u,i,o,c)};case 8:return function(n,r,e,u,i,o,c,a){return t.call(this,n,r,e,u,i,o,c,a)};case 9:return function(n,r,e,u,i,o,c,a,f){return t.call(this,n,r,e,u,i,o,c,a,f)};case 10:return function(n,r,e,u,i,o,c,a,f,s){return t.call(this,n,r,e,u,i,o,c,a,f,s)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),_n=o(function(n){return-n}),Kn=o(function(n){return!n}),$n=c(function(n,t){var r=0>n?t.length+n:n;return v(t)?t.charAt(r):t[r]}),Hn=o(function(n){return function(){return $n(n,arguments)}}),Xn=c(function(n,t){return t.charAt(0>n?t.length+n:n)}),Yn=c(function(n,t){return t.charCodeAt(0>n?t.length+n:n)}),Zn=o(function(n){return[n]}),Gn=o(function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments))}}),Jn=function(){var n=function(t){return{value:t,map:function(r){return n(r(t))}}};return a(function(t,r,e){return t(function(t){return n(r(t))})(e).value})}(),Qn=c(function(n,t){if(null!=t){for(var r=t,e=0,u=n.length;u>e&&null!=r;e+=1)r=r[n[e]];return r}}),nt=c(function(n,t){for(var r={},e=0;e<n.length;)n[e]in t&&(r[n[e]]=t[n[e]]),e+=1;return r}),tt=c(function(n,t){for(var r={},e=0,u=n.length;u>e;){var i=n[e];r[i]=t[i],e+=1}return r}),rt=c(function(n,t){var r={};for(var e in t)n(t[e],e,t)&&(r[e]=t[e]);return r}),et=c(function(n,t){return u([n],t)}),ut=c(function(n,t){return t[n]}),it=a(function(n,t,r){return null!=r&&h(t,r)?r[t]:n}),ot=a(function(n,t,r){return n(r[t])}),ct=c(function(n,t){for(var r=n.length,e=[],u=0;r>u;)e[u]=t[n[u]],u+=1;return e}),at=c(function(n,t){if(!m(n)||!m(t))throw new TypeError("Both arguments to range must be numbers");for(var r=[],e=n;t>e;)r.push(e),e+=1;return r}),ft=a(function(n,t,r){for(var e=r.length-1;e>=0;)t=n(t,r[e]),e-=1;return t}),st=o(S),lt=a(function(n,t,r){return u(E(r,0,Math.min(n,r.length)),E(r,Math.min(r.length,n+t)))}),pt=a(function(n,t,r){return r.replace(n,t)}),ht=o(function(n){return E(n).reverse()}),gt=a(function(n,t,r){for(var e=0,u=r.length,i=[t];u>e;)t=n(t,r[e]),i[e+1]=t,e+=1;return i}),dt=a(function(n,t,r){return Jn(n,F(t),r)}),yt=c(function(n,t){return E(t).sort(n)}),mt=c(function(n,t){return E(t).sort(function(t,r){var e=n(t),u=n(r);return u>e?-1:e>u?1:0})}),vt=c(function(n,t){return n-t}),wt=c(function(n,t){for(var r=t.length-1;r>=0&&n(t[r]);)r-=1;return E(t,r+1,1/0)}),xt=c(function(n,t){return n(t),t}),bt=c(function(n,t){return r(n).test(t)}),jt=c(function(n,t){for(var r=Number(t),e=new Array(r),u=0;r>u;)e[u]=n(u),u+=1;return e}),Ot=o(function(n){var t=[];for(var r in n)h(r,n)&&(t[t.length]=[r,n[r]]);return t}),St=o(function(n){var t=[];for(var r in n)t[t.length]=[r,n[r]];return t}),Et=function(){var n="	\n\f\r   ᠎             　\u2028\u2029\ufeff",t="​",r="function"==typeof String.prototype.trim;return o(r&&!n.trim()&&t.trim()?function(n){return n.trim()}:function(t){var r=new RegExp("^["+n+"]["+n+"]*"),e=new RegExp("["+n+"]["+n+"]*$");return t.replace(r,"").replace(e,"")})}(),At=o(function(n){return null===n?"Null":void 0===n?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),It=o(function(n){return function(){return n(E(arguments))}}),kt=o(function(n){return zn(1,n)}),Nt=c(function(n,t){return nn(n,function(){for(var r,e=1,u=t,i=0;n>=e&&"function"==typeof u;)r=e===n?arguments.length:i+u.length,u=u.apply(this,E(arguments,i,r)),e+=1,i=r;return u})}),Ct=c(function(n,t){for(var r=n(t),e=[];r&&r.length;)e[e.length]=r[0],r=n(r[1]);return e}),Mt=c(function(n,t){for(var r,e=0,u=t.length,o=[];u>e;)r=t[e],i(n,r,o)||(o[o.length]=r),e+=1;return o}),Pt=a(function(n,t,r){return U(F(t),n,r)}),Tt=o(function(n){for(var t=In(n),r=t.length,e=[],u=0;r>u;)e[u]=n[t[u]],u+=1;return e}),qt=o(function(n){var t,r=[];for(t in n)r[r.length]=n[t];return r}),Wt=function(){var n=function(n){return{value:n,map:function(){return this}}};return c(function(t,r){return t(n)(r).value})}(),Rt=c(function(n,t){for(var r in n)if(h(r,n)&&!n[r](t[r]))return!1;return!0}),Bt=c(function(n,t){return nn(n.length,function(){return t.apply(this,u([n],arguments))})}),Lt=c(function(n,t){for(var r,e=0,u=n.length,i=t.length,o=[];u>e;){for(r=0;i>r;)o[o.length]=[n[e],t[r]],r+=1;e+=1}return o}),Ut=c(function(n,t){for(var r=[],e=0,u=Math.min(n.length,t.length);u>e;)r[e]=[n[e],t[e]],e+=1;return r}),Ft=c(function(n,t){for(var r=0,e=n.length,u={};e>r;)u[n[r]]=t[r],r+=1;return u}),Dt=a(function(n,t,r){for(var e=[],u=0,i=Math.min(t.length,r.length);i>u;)e[u]=n(t[u],r[u]),u+=1;return e}),Vt=F(!1),zt=F(!0),_t=function(n,t){return function(){var r=arguments.length;if(0===r)return t();var e=arguments[r-1];return d(e)||"function"!=typeof e[n]?t.apply(this,arguments):e[n].apply(e,E(arguments,0,r-1))}},Kt=function pu(n,t,e){var u=function(r){for(var u=t.length,i=0;u>i;){if(n===t[i])return e[i];i+=1}t[i+1]=n,e[i+1]=r;for(var o in n)r[o]=pu(n[o],t,e);return r};switch(At(n)){case"Object":return u({});case"Array":return u([]);case"Date":return new Date(n);case"RegExp":return r(n);default:return n}},$t=function(n){return function(r){var e=E(arguments,1);return t(Math.max(0,r.length-e.length),function(){return r.apply(this,n(e,arguments))})}},Ht=function(n,t,r){return function(){var e=arguments.length;if(0===e)return r();var u=arguments[e-1];if(!d(u)){var i=E(arguments,0,e-1);if("function"==typeof u[n])return u[n].apply(u,i);if(w(u)){var o=t.apply(null,i);return o(u)}}return r.apply(this,arguments)}},Xt=function hu(n,t,r,e){var u=At(n);if(u!==At(t))return!1;if("Boolean"===u||"Number"===u||"String"===u)return"object"==typeof n?"object"==typeof t&&mn(n.valueOf(),t.valueOf()):mn(n,t);if(mn(n,t))return!0;if("RegExp"===u)return n.source===t.source&&n.global===t.global&&n.ignoreCase===t.ignoreCase&&n.multiline===t.multiline&&n.sticky===t.sticky&&n.unicode===t.unicode;if(Object(n)===n){if("Date"===u&&n.getTime()!==t.getTime())return!1;var i=In(n);if(i.length!==In(t).length)return!1;for(var o=r.length-1;o>=0;){if(r[o]===n)return e[o]===t;o-=1}for(r[r.length]=n,e[e.length]=t,o=i.length-1;o>=0;){var c=i[o];if(!h(c,t)||!hu(t[c],n[c],r,e))return!1;o-=1}return r.pop(),e.pop(),!0}return!1},Yt=function(n,t){return null!=t&&!d(t)&&"function"==typeof t[n]},Zt=function(n){return function t(r){for(var e,u,i,o=[],c=0,a=r.length;a>c;){if(Sn(r[c]))for(e=n?t(r[c]):r[c],u=0,i=e.length;i>u;)o[o.length]=e[u],u+=1;else o[o.length]=r[c];c+=1}return o}},Gt=function(){function n(n,t,r){for(var e=0,u=r.length;u>e;){if(t=n["@@transducer/step"](t,r[e]),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}e+=1}return n["@@transducer/result"](t)}function t(n,t,r){for(var e=r.next();!e.done;){if(t=n["@@transducer/step"](t,e.value),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}e=r.next()}return n["@@transducer/result"](t)}function r(n,t,r){return n["@@transducer/result"](r.reduce($(n["@@transducer/step"],n),t))}var e="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(u,i,o){if("function"==typeof u&&(u=B(u)),Sn(o))return n(u,i,o);if("function"==typeof o.reduce)return r(u,i,o);if(null!=o[e])return t(u,i,o[e]());if("function"==typeof o.next)return t(u,i,o);throw new TypeError("reduce: list must be array or iterable")}}(),Jt=function(){var n={"@@transducer/init":Array,"@@transducer/step":function(n,t){return u(n,[t])},"@@transducer/result":g},t={"@@transducer/init":String,"@@transducer/step":function(n,t){return n+t},"@@transducer/result":g},r={"@@transducer/init":Object,"@@transducer/step":function(n,t){return Ln(n,Sn(t)?Q(t[0],t[1]):t)},"@@transducer/result":g};return function(e){if(w(e))return e;if(Sn(e))return n;if("string"==typeof e)return t;if("object"==typeof e)return r;throw new Error("Cannot create transformer for "+e)}}(),Qt=function(){function n(n,t){this.xf=t,this.f=n,this.all=!0}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.all&&(n=this.xf["@@transducer/step"](n,!0)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)||(this.all=!1,n=S(this.xf["@@transducer/step"](n,!1))),n},c(function(t,r){return new n(t,r)})}(),nr=function(){function n(n,t){this.xf=t,this.f=n,this.any=!1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.any||(n=this.xf["@@transducer/step"](n,!1)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.any=!0,n=S(this.xf["@@transducer/step"](n,!0))),n},c(function(t,r){return new n(t,r)})}(),tr=function(){function n(n,t){this.xf=t,this.n=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.n>0?(this.n-=1,n):this.xf["@@transducer/step"](n,t)},c(function(t,r){return new n(t,r)})}(),rr=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){if(this.f){if(this.f(t))return n;this.f=null}return this.xf["@@transducer/step"](n,t)},c(function(t,r){return new n(t,r)})}(),er=function(){function n(n,t){this.xf=t,this.f=n,this.inputs={}}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){var t;for(t in this.inputs)if(h(t,this.inputs)&&(n=this.xf["@@transducer/step"](n,this.inputs[t]),n["@@transducer/reduced"])){n=n["@@transducer/value"];break}return this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){var r=this.f(t);return this.inputs[r]=this.inputs[r]||[r,[]],this.inputs[r][1]=V(t,this.inputs[r][1]),n},c(function(t,r){return new n(t,r)})}(),ur=o(function(n){return nn(n.length,function(){var t=0,r=arguments[0],e=arguments[arguments.length-1],i=E(arguments);return i[0]=function(){var n=r.apply(this,u(arguments,[t,e]));return t+=1,n},n.apply(this,i)})}),ir=c(Ht("all",Qt,function(n,t){for(var r=0;r<t.length;){if(!n(t[r]))return!1;r+=1}return!0})),or=c(function(n,t){return Yt("and",n)?n.and(t):n&&t}),cr=c(Ht("any",nr,function(n,t){for(var r=0;r<t.length;){if(n(t[r]))return!0;r+=1}return!1})),ar=o(function(n){return zn(2,n)}),fr=o(function(n){return Kt(n,[],[])}),sr=c(function(n,t){if(d(t))return u(n,t);if(Yt("concat",n))return n.concat(t);throw new TypeError("can't concat "+typeof n)}),lr=o(function(n){return nn(n.length,n)}),pr=c(Ht("dropWhile",rr,function(n,t){for(var r=0,e=t.length;e>r&&n(t[r]);)r+=1;return E(t,r)})),hr=c(function(n,t){return Yt("equals",n)?n.equals(t):Yt("equals",t)?t.equals(n):Xt(n,t,[],[])}),gr=c(Ht("filter",N,s)),dr=c(Ht("find",C,function(n,t){for(var r=0,e=t.length;e>r;){if(n(t[r]))return t[r];r+=1}})),yr=c(Ht("findIndex",M,function(n,t){for(var r=0,e=t.length;e>r;){if(n(t[r]))return r;r+=1}return-1})),mr=c(Ht("findLast",P,function(n,t){for(var r=t.length-1;r>=0;){if(n(t[r]))return t[r];r-=1}})),vr=c(Ht("findLastIndex",T,function(n,t){for(var r=t.length-1;r>=0;){if(n(t[r]))return r;r-=1}return-1})),wr=o(Zt(!0)),xr=o(function(n){return lr(function(t,r){var e=E(arguments);return e[0]=r,e[1]=t,n.apply(this,e)})}),br=c(_t("forEach",function(n,t){for(var r=t.length,e=0;r>e;)n(t[e]),e+=1;return t})),jr=o(p(In)),Or=o(p(kn)),Sr=c(Ht("groupBy",er,function(n,t){return Gt(function(t,r){var e=n(r);return t[e]=V(r,t[e]||(t[e]=[])),t},{},t)})),Er=$n(0),Ar=a(function(n,t,r){for(var e=[],u=0;u<t.length;)i(n,t[u],r)&&(e[e.length]=t[u]),u+=1;return Mt(n,e)}),Ir=c(_t("intersperse",function(n,t){for(var r=[],e=0,u=t.length;u>e;)e===u-1?r.push(t[e]):r.push(t[e],n),e+=1;return r})),kr=a(function(n,t,r){return w(n)?Gt(t(n),n["@@transducer/init"](),r):Gt(t(Jt(n)),n,r)}),Nr=o(function(n){for(var t=In(n),r=t.length,e=0,u={};r>e;){var i=t[e],o=n[i],c=h(o,u)?u[o]:u[o]=[];c[c.length]=i,e+=1}return u}),Cr=o(function(n){for(var t=In(n),r=t.length,e=0,u={};r>e;){var i=t[e];u[n[i]]=i,e+=1}return u}),Mr=$n(-1),Pr=c(function(n,t){if(Yt("lastIndexOf",t))return t.lastIndexOf(n);for(var r=t.length-1;r>=0;){if(hr(t[r],n))return r;r-=1}return-1}),Tr=c(Ht("map",q,x)),qr=c(function(n,t){return Gt(function(r,e){return r[e]=n(t[e]),r},{},In(t))}),Wr=c(function(n,t){return Gt(function(r,e){return r[e]=n(t[e],e,t),r},{},In(t))}),Rr=c(e(Ht("any",nr,cr))),Br=c(function(n,t){return Yt("or",n)?n.or(t):n||t}),Lr=lr($t(u)),Ur=lr($t(xr(u))),Fr=c(function(n,t){return Gt(function(t,r){var e=t[n(r)?0:1];return e[e.length]=r,t},[[],[]],t)}),Dr=a(function(n,t,r){return hr(Qn(n,r),t)}),Vr=c(function(n,t){return Tr(ut(n),t)}),zr=a(function(n,t,r){return ot(hr(t),n,r)}),_r=a(function(n,t,r){return ot(On(n),t,r)}),Kr=a(Gt),$r=c(function(n,t){return gr(e(n),t)}),Hr=c(function(n,t){return jt(F(n),t)}),Xr=a(_t("slice",function(n,t,r){return Array.prototype.slice.call(r,n,t)})),Yr=c(function(n,t){if(0>=n)throw new Error("First argument to splitEvery must be a positive integer");for(var r=[],e=0;e<t.length;)r.push(Xr(e,e+=n,t));return r}),Zr=Kr(L,0),Gr=_t("tail",Xr(1,1/0)),Jr=c(Ht("take",W,function(n,t){return Xr(0,0>n?1/0:n,t)})),Qr=c(Ht("takeWhile",R,function(n,t){for(var r=0,e=t.length;e>r&&n(t[r]);)r+=1;return E(t,0,r)})),ne=nn(4,function(n,t,r,e){return Gt(n("function"==typeof t?B(t):t),r,e)}),te=a(function(n,t,r){return Mt(n,u(t,r))}),re=Mt(hr),ee=o(Zt(!1)),ue=lr(function(n){var r=E(arguments,1),e=r.length;return lr(t(e,function(){for(var t=[],u=0;e>u;)t[u]=r[u](arguments[u]),u+=1;return n.apply(this,t.concat(E(arguments,e)))}))}),ie=c(function(n,t){return Rt(qr(hr,n),t)}),oe=function(){var n=function(n){return{"@@transducer/init":k.init,"@@transducer/result":function(t){return n["@@transducer/result"](t)},"@@transducer/step":function(t,r){var e=n["@@transducer/step"](t,r);return e["@@transducer/reduced"]?l(e):e}}};return function(t){var r=n(t);return{"@@transducer/init":k.init,"@@transducer/result":function(n){return r["@@transducer/result"](n)},"@@transducer/step":function(n,t){return Sn(t)?Gt(r,n,t):Gt(r,n,[t])}}}}(),ce=function(n,t,r){for(var e=r;e<n.length;){if(hr(n[e],t))return e;e+=1}return-1},ae=function(n){return function(r){var e=function(){var t=arguments;return n(function(n){return n.apply(null,t)},r)};return arguments.length>1?e.apply(null,E(arguments,1)):t(Math.max.apply(Math,Vr("length",r)),e)}},fe=c(function(n,t){return Tr(n,oe(t))}),se=o(ae(ir)),le=o(ae(cr)),pe=c(function(n,t){return Yt("ap",n)?n.ap(t):Gt(function(n,r){return u(n,Tr(r,t))},[],n)}),he=lr(function(n){return n.apply(this,E(arguments,1))}),ge=c(Ht("chain",fe,function(n,t){return ee(Tr(n,t))})),de=a(function(n,t,r){function e(t,r){return pe(Tr(V,n(r)),t)}return Gt(e,t([]),r)}),ye=c(function(n,t){if(n>10)throw new Error("Constructor with greater than ten arguments");return 0===n?function(){return new t}:lr(zn(n,function(n,r,e,u,i,o,c,a,f,s){switch(arguments.length){case 1:return new t(n);case 2:return new t(n,r);case 3:return new t(n,r,e);case 4:return new t(n,r,e,u);case 5:return new t(n,r,e,u,i);case 6:return new t(n,r,e,u,i,o);case 7:return new t(n,r,e,u,i,o,c);case 8:return new t(n,r,e,u,i,o,c,a);case 9:return new t(n,r,e,u,i,o,c,a,f);case 10:return new t(n,r,e,u,i,o,c,a,f,s)}}))}),me=nn(3,function(n){var t=E(arguments,1);return nn(Math.max.apply(Math,Vr("length",t)),function(){var r=arguments,e=this;return n.apply(e,x(function(n){return n.apply(e,r)},t))})}),ve=c(Ht("drop",tr,function(n,t){return Xr(Math.max(0,n),1/0,t)})),we=c(function(n,t){return Jr(n<t.length?t.length-n:0,t)}),xe=c(Ht("dropRepeatsWith",I,function(n,t){var r=[],e=1,u=t.length;if(0!==u)for(r[0]=t[0];u>e;)n(Mr(r),t[e])||(r[r.length]=t[e]),e+=1;return r})),be=a(function(n,t,r){return hr(t[n],r[n])}),je=c(function(n,t){return Yt("indexOf",t)?t.indexOf(n):ce(t,n,0)}),Oe=Xr(0,-1),Se=o(function(n){for(var t=n.length,r=0;t>r;){if(ce(n,n[r],r+1)>=0)return!1;r+=1}return!0}),Ee=c(function(n,t){return function(r){return function(e){return Tr(function(n){return t(n,e)},r(n(e)))}}}),Ae=o(function(n){return Ee($n(n),Pt(n))}),Ie=o(function(n){return Ee(ut(n),_(n))}),ke=c(function(n,t){var r=nn(n,t);return nn(n,function(){return Gt(pe,Tr(r,arguments[0]),E(arguments,1))})}),Ne=o(function(n){return Zr(n)/n.length}),Ce=o(function(n){var t=n.length;if(0===t)return NaN;var r=2-t%2,e=(t-r)/2;return Ne(E(n).sort(function(n,t){return t>n?-1:n>t?1:0}).slice(e,e+r))}),Me=o(function(n){return Kr(Ln,{},n)}),Pe=function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return nn(arguments[0].length,Kr(b,arguments[0],Gr(arguments)))},Te=function(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return nn(arguments[0].length,Kr(j,arguments[0],Gr(arguments)))},qe=Kr(Vn,1),We=ue(x,tt,vn),Re=c(function(n,t){return ve(n>=0?t.length-n:0,t)}),Be=function(n,t){return ce(t,n,0)>=0},Le=function gu(n,t){var r=function(r){var e=t.concat([n]);return Be(r,e)?"<Circular>":gu(r,e)},e=function(n,t){return x(function(t){return O(t)+": "+r(n[t])},t.slice().sort())};switch(Object.prototype.toString.call(n)){case"[object Arguments]":return"(function() { return arguments; }("+x(r,n).join(", ")+"))";case"[object Array]":return"["+x(r,n).concat(e(n,$r(bt(/^\d+$/),In(n)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof n?"new Boolean("+r(n.valueOf())+")":n.toString();case"[object Date]":return"new Date("+O(A(n))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof n?"new Number("+r(n.valueOf())+")":1/n===-(1/0)?"-0":n.toString(10);case"[object String]":return"object"==typeof n?"new String("+r(n.valueOf())+")":O(n);case"[object Undefined]":return"undefined";default:return"function"==typeof n.constructor&&"Object"!==n.constructor.name&&"function"==typeof n.toString&&"[object Object]"!==n.toString()?n.toString():"{"+e(n,In(n)).join(", ")+"}"}},Ue=de(vn),Fe=function(){if(0===arguments.length)throw new Error("compose requires at least one argument");return Pe.apply(this,ht(arguments))},De=function(){return 0===arguments.length?vn:Fe.apply(this,Tr(ge,arguments))},Ve=function(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return Te.apply(this,ht(arguments))},ze=o(function(n){return ye(n.length,n);
}),_e=c(Be),Ke=c(function(n,t){for(var r=[],e=0,u=n.length;u>e;)Be(n[e],t)||Be(n[e],r)||(r[r.length]=n[e]),e+=1;return r}),$e=o(Ht("dropRepeats",I(hr),xe(hr))),He=c(function(n,t){return re(s(xr(Be)(n),t))}),Xe=o(function(n){return ke(n.length,n)}),Ye=c(function(n,t){var r={};for(var e in t)Be(e,n)||(r[e]=t[e]);return r}),Ze=function(){return De.apply(this,ht(arguments))},Ge=o(function(n){return Le(n,[])}),Je=c(Fe(re,u)),Qe=c(function(n,t){for(var r,e,u=0,i=[],o=[];u<t.length;)e=t[u],r=n(e),Be(r,i)||(o.push(e),i.push(r)),u+=1;return o}),nu=c(function(n,t){return nn(n+1,function(){var r=arguments[n];if(null!=r&&On(Function,r[t]))return r[t].apply(r,E(arguments,0,n));throw new TypeError(Ge(r)+' does not have a method named "'+t+'"')})}),tu=nu(1,"join"),ru=o(function(n){var t={};return function(){var r=Ge(arguments);return h(r,t)||(t[r]=n.apply(this,arguments)),t[r]}}),eu=nu(1,"split"),uu=nu(0,"toLowerCase"),iu=nu(0,"toUpperCase"),ou={F:Vt,T:zt,__:n,add:L,addIndex:ur,adjust:U,all:ir,allPass:se,always:F,and:or,any:cr,anyPass:le,ap:pe,aperture:D,append:V,apply:z,assoc:_,assocPath:K,binary:ar,bind:$,both:H,call:he,chain:ge,clone:fr,commute:Ue,commuteMap:de,comparator:X,complement:Y,compose:Fe,composeK:De,composeP:Ve,concat:sr,cond:Z,construct:ze,constructN:ye,contains:_e,containsWith:G,converge:me,countBy:J,createMapEntry:Q,curry:lr,curryN:nn,dec:tn,defaultTo:rn,difference:Ke,differenceWith:en,dissoc:un,dissocPath:on,divide:cn,drop:ve,dropLast:we,dropLastWhile:an,dropRepeats:$e,dropRepeatsWith:xe,dropWhile:pr,either:fn,empty:sn,eqProps:be,equals:hr,evolve:ln,filter:gr,find:dr,findIndex:yr,findLast:mr,findLastIndex:vr,flatten:wr,flip:xr,forEach:br,fromPairs:pn,functions:jr,functionsIn:Or,groupBy:Sr,gt:hn,gte:gn,has:dn,hasIn:yn,head:Er,identical:mn,identity:vn,ifElse:wn,inc:xn,indexOf:je,init:Oe,insert:bn,insertAll:jn,intersection:He,intersectionWith:Ar,intersperse:Ir,into:kr,invert:Nr,invertObj:Cr,invoker:nu,is:On,isArrayLike:Sn,isEmpty:En,isNil:An,isSet:Se,join:tu,keys:In,keysIn:kn,last:Mr,lastIndexOf:Pr,length:Nn,lens:Ee,lensIndex:Ae,lensProp:Ie,lift:Xe,liftN:ke,lt:Cn,lte:Mn,map:Tr,mapAccum:Pn,mapAccumRight:Tn,mapObj:qr,mapObjIndexed:Wr,match:qn,mathMod:Wn,max:Rn,maxBy:Bn,mean:Ne,median:Ce,memoize:ru,merge:Ln,mergeAll:Me,min:Un,minBy:Fn,modulo:Dn,multiply:Vn,nAry:zn,negate:_n,none:Rr,not:Kn,nth:$n,nthArg:Hn,nthChar:Xn,nthCharCode:Yn,of:Zn,omit:Ye,once:Gn,or:Br,over:Jn,partial:Lr,partialRight:Ur,partition:Fr,path:Qn,pathEq:Dr,pick:nt,pickAll:tt,pickBy:rt,pipe:Pe,pipeK:Ze,pipeP:Te,pluck:Vr,prepend:et,product:qe,project:We,prop:ut,propEq:zr,propIs:_r,propOr:it,propSatisfies:ot,props:ct,range:at,reduce:Kr,reduceRight:ft,reduced:st,reject:$r,remove:lt,repeat:Hr,replace:pt,reverse:ht,scan:gt,set:dt,slice:Xr,sort:yt,sortBy:mt,split:eu,splitEvery:Yr,subtract:vt,sum:Zr,tail:Gr,take:Jr,takeLast:Re,takeLastWhile:wt,takeWhile:Qr,tap:xt,test:bt,times:jt,toLower:uu,toPairs:Ot,toPairsIn:St,toString:Ge,toUpper:iu,transduce:ne,trim:Et,type:At,unapply:It,unary:kt,uncurryN:Nt,unfold:Ct,union:Je,unionWith:te,uniq:re,uniqBy:Qe,uniqWith:Mt,unnest:ee,update:Pt,useWith:ue,values:Tt,valuesIn:qt,view:Wt,where:Rt,whereEq:ie,wrap:Bt,xprod:Lt,zip:Ut,zipObj:Ft,zipWith:Dt};"object"==typeof exports?module.exports=ou:"function"==typeof define&&define.amd?define(function(){return ou}):this.R=ou}).call(this);

},{}],2:[function(require,module,exports){
var Tetris;!function(t){var i=function(){function t(){}return t.borderWidth=4,t.borderHeight=4,t.tileSize=30,t.offsetX=40,t.offsetY=-2*(t.tileSize-1),t.boardWidth=10,t.boardWidthInPixels=t.offsetX+2*t.borderWidth+t.boardWidth*t.tileSize,t.boardHeight=22,t.boardHeightInPixels=t.offsetY+2*t.borderWidth+t.boardHeight*t.tileSize,t.moveTimerRate=.1,t.animationTime=300,t}();t.Config=i}(Tetris||(Tetris={}));var Tetris;!function(t){!function(t){t[t.Empty=0]="Empty",t[t.Taken=1]="Taken"}(t.BlockStatus||(t.BlockStatus={}));t.BlockStatus;!function(t){t[t.Left=-1]="Left",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Down=4]="Down"}(t.Direction||(t.Direction={}));t.Direction}(Tetris||(Tetris={}));var __extends=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o]);e.prototype=i.prototype,t.prototype=new e},Tetris;!function(t){var i=function(i){function e(){i.apply(this,arguments)}return __extends(e,i),e.prototype.update=function(){this.game.input.mouse.isDown&&this.game.states.switchState("main")},e.prototype.create=function(){i.prototype.create.call(this),this.addChild(new Kiwi.GameObjects.TextField(this,"Tetris clone",t.Config.boardWidthInPixels/2,200,"#000",30)),this.addChild(new Kiwi.GameObjects.TextField(this,"Default controls for the game are:",t.Config.boardWidthInPixels/2,250,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"Move - arrow keys",t.Config.boardWidthInPixels/2,280,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Rotate counterclockwise - z",t.Config.boardWidthInPixels/2,300,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Rotate clockwise - x",t.Config.boardWidthInPixels/2,320,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Rotate both ways - up arrow",t.Config.boardWidthInPixels/2,340,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Soft drop - down key",t.Config.boardWidthInPixels/2,360,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Hard drop - space",t.Config.boardWidthInPixels/2,380,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Hold - shift",t.Config.boardWidthInPixels/2,400,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"On mobile you can play",t.Config.boardWidthInPixels/2,440,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"with on screen buttons",t.Config.boardWidthInPixels/2,460,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"or by dragging on screen",t.Config.boardWidthInPixels/2,480,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"Click on screen to play",t.Config.boardWidthInPixels/2,510,"#000",25)),this.getAllChildren().forEach(function(t){return t.textAlign="center"})},e}(Kiwi.State);t.MenuState=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.isLower=function(t){return this.y>t.y},t}();t.Position=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function i(i,e,o,s){this.size=t.Config.tileSize,this.x=i,this.y=e,s&&(this.sprite=new Kiwi.GameObjects.Sprite(o,s,t.Config.offsetX+t.Config.borderWidth+i*(this.size-1),t.Config.offsetY+t.Config.borderWidth+e*(this.size-1)))}return i.prototype.fall=function(t){void 0===t&&(t=1),this.y+=t,this.sprite&&(this.sprite.transform.y+=t*(this.size-1))},i.prototype.move=function(t){this.x+=t,this.sprite&&(this.sprite.transform.x+=t*(this.size-1))},i.prototype.setPosition=function(t){var i=t.x-this.x,e=t.y-this.y;this.x=t.x,this.y=t.y,this.sprite&&(this.sprite.transform.x+=i*(this.size-1),this.sprite.transform.y+=e*(this.size-1))},i.prototype.getPosition=function(){return new t.Position(this.x,this.y)},i.prototype.destroy=function(i){var e=this;if(void 0===i&&(i=!1),this.sprite)if(i){var o=this.sprite.state.game.tweens.create(this.sprite);o.to({alpha:0},t.Config.animationTime,Kiwi.Animations.Tweens.Easing.Bounce.In,!0).onComplete(function(){return e.sprite.destroy()},this)}else this.sprite.destroy()},i}();t.Block=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(i){var e=function(){function i(t){this.currentRotation=0,this.currentTest=0,this.nextPositions=[],this.blocks=[],this.state=t,this.gameObject=new Kiwi.Group(t)}return i.prototype.addBlock=function(i,e,o,s){void 0===s&&(s=!1);var n=new t.Block(e,o,this.state,this.state.textures["block-"+i]);this.blocks.push(n),this.gameObject.addChild(n.sprite),s&&(this.center=n)},i.prototype.getGameObject=function(){return this.gameObject},i.prototype.getBlocks=function(){return this.blocks},i.prototype.destroy=function(){this.getBlocks().forEach(function(t){return t.destroy()})},i.prototype.getPositions=function(t){return void 0===t&&(t=this.blocks),t.map(function(t){return t.getPosition()})},i.prototype.fall=function(t){var i=this;return void 0===t&&(t=1),this.blocks.forEach(function(e){return e==i.center?!0:void e.fall(t)}),this.center.fall(t),this},i.prototype.setByPointerPosition=function(i){var e=this;return this.blocks.forEach(function(o){return o==e.center?!0:void o.setPosition(new t.Position(o.x+i,o.y))}),this.center.setPosition(new t.Position(this.center.x+i,this.center.y)),this},i.prototype.move=function(t){var i=this;return this.blocks.forEach(function(e){return e==i.center?!0:void e.move(t)}),this.center.move(t),this},i.prototype.getRotations=function(){return i.rotations},i.prototype.getNextRotation=function(i){var e=[];if(5==this.currentTest)return this.currentTest=0,e;var o=this.getRotations(),s=this.center.x,n=this.center.y,r=i*o[this.currentRotation][this.currentTest][0],h=i*o[this.currentRotation][this.currentTest][1],a=new t.Position(s+r,n+h);return this.blocks.forEach(function(o){var r=i*(o.x-s),h=i*(o.y-n);e.push(new t.Position(a.x-h,a.y+r))}),this.nextCenter=a,this.nextPositions=e,this.direction=i,this.currentTest++,e},i.prototype.rotate=function(){var i=this;return this.nextCenter||this.getNextRotation(1),this.center.setPosition(new t.Position(this.nextCenter.x,this.nextCenter.y)),this.blocks.forEach(function(e,o){return e==i.center?!0:void e.setPosition(new t.Position(i.nextPositions[o].x,i.nextPositions[o].y))}),this.currentTest=0,this.currentRotation+=this.direction,4==this.currentRotation&&(this.currentRotation=0),-1==this.currentRotation&&(this.currentRotation=3),this},i.rotations=[[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]]],i}();i.Shape=e}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(){function i(t){this.shapes=["I","J","L","O","S","T","Z"],this.shapeStack=[],this.state=t}return i.shuffle=function(t){for(var i,e,o=t.length;o>0;)e=Math.floor(Math.random()*o),o--,i=t[o],t[o]=t[e],t[e]=i;return t},i.prototype.getNextShape=function(t){if(void 0===t&&(t=!1),this.shapeStack.length<2){var e=this.shapes.slice(0);e.forEach(function(t,i){return e[i]="Shape"+t}),this.shapeStack=this.shapeStack.concat(i.shuffle(e))}return t?this.shapeStack.shift():this.shapeStack[0]},i.prototype.createNewShape=function(i,e,o,s){void 0===i&&(i=!1),void 0===e&&(e=""),void 0===o&&(o=4),void 0===s&&(s=1),0==e.length&&(e=this.getNextShape(!0));var n=new t[e](this.state,o,s);return i&&this.state.addChild(n.getGameObject()),n},i}();t.ShapeStack=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function i(i,e,o){var s=this;this.blocks=[],this.state=i,this.gameObject=new Kiwi.Group(i),e.forEach(function(i){var e=new t.Block(i.x,i.y+o,s.state,s.state.textures["block-ghost"]);s.blocks.push(e),s.gameObject.addChild(e.sprite)})}return i.prototype.getGameObject=function(){return this.gameObject},i.prototype.setPosition=function(i,e){this.blocks.forEach(function(o,s){o.setPosition(new t.Position(i[s].x,i[s].y+e))})},i}();t.Ghost=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=require("ramda"),e=function(){function e(i){this.height=t.Config.boardHeight,this.width=t.Config.boardWidth,this.blocks=[],this.highestPositions=[],this.state=i;for(var e=0;e<this.height;e++)this.blocks[e]=[];for(var e=0;e<this.width;e++)this.highestPositions[e]=new t.Position(e,this.height)}return e.prototype.emptyPositions=function(t){var i=this;return 0===t.filter(function(t){return t.x<0||t.x>i.width-1||t.y>i.height-1||t.y<0||void 0!==i.blocks[t.y][t.x]}).length},e.prototype.emptyDirection=function(i,e){var o=this;return 0===i.filter(function(i){return e===t.Direction.Down&&(i.y===o.height-1||void 0!==o.blocks[i.y+1][i.x])||e===t.Direction.Left&&(0===i.x||void 0!==o.blocks[i.y][i.x-1])||e===t.Direction.Right&&(i.x===o.width-1||void 0!==o.blocks[i.y][i.x+1])}).length},e.prototype.refreshHighestPosition=function(t){this.highestPositions[t.x]=this.highestPositions[t.x].isLower(t)?t:this.highestPositions[t.x]},e.prototype.refreshHighestPositions=function(t){var i=this;void 0===t&&(t=[]),this.highestPositions.forEach(function(e,o){i.highestPositions[o].y=i.height;var s=t.filter(function(t){return t.x==o}).map(function(t){return t.y})[0];s=s?s:0;for(var n=s;n<i.height;n++)if(i.blocks[n][o]){i.highestPositions[o].y=n;break}})},e.prototype.setBlocks=function(i,e){var o=this;return void 0===e&&(e=t.BlockStatus.Taken),i.forEach(function(i){o.blocks[i.y][i.x]=e===t.BlockStatus.Taken?i:void 0,e===t.BlockStatus.Taken&&o.refreshHighestPosition(i.getPosition())}),this},e.prototype.checkRows=function(i){var e=this,o=this.getRowsToClear(i);return o.length>0&&(this.clearRows(o),this.state.game.time.clock.setTimeout(function(){e.fallBlocks(o),e.refreshHighestPositions()},t.Config.animationTime,this)),o.length},e.prototype.getRowsToClear=function(t){var e=this,o=i.uniq(t.filter(function(t){return e.blocks[t.y].length===e.width&&!i.contains(void 0,e.blocks[t.y])}).map(function(t){return t.y}));return i.sort(function(t,i){return i-t},o)},e.prototype.clearRows=function(i){var e=this;i.forEach(function(i){e.blocks[i].forEach(function(t){return t.destroy(!0)}),e.setBlocks(e.blocks[i],t.BlockStatus.Empty)})},e.prototype.fallBlocks=function(e){var o=this;e.forEach(function(s,n){var r=n+1,h=e[r]?e[r]:0,a=i.flatten(i.reverse(o.blocks.filter(function(t,i){return s>=i&&i>=h}))).filter(function(t){return void 0!==t});a.forEach(function(i){o.setBlocks([i],t.BlockStatus.Empty),i.setPosition(new t.Position(i.x,i.y+r)),o.setBlocks([i],t.BlockStatus.Taken)})})},e.prototype.findDistanceToFall=function(t){var i=this;return this.refreshHighestPositions(t),t.reduce(function(t,e){var o=Math.sqrt(Math.pow(i.highestPositions[e.x].y-e.y,2))-1;return t>o?o:t},this.height)},e.prototype.findValidPosition=function(t,i){var e=this;return 0===t?0:i.reduce(function(i,o){var s=o.x+t,n=t;return 0>s&&(n=t-s),s>8&&console.log(s),s>e.width-1&&(n=t-(s-(e.width-1))),Math.abs(n)<Math.abs(i)?n:i},t)},e}();t.Board=e}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function t(t){void 0===t&&(t=1),this.score=0,this.level=1,this.rowsCleared=0,this.level=t}return t.prototype.checkLevel=function(t){this.rowsCleared+=t,this.rowsCleared>10*this.level&&this.level++},t.prototype.getInfo=function(){return{score:this.score,level:this.level,lines:this.rowsCleared}},t.prototype.getFallingDelay=function(){var t=this.level<10?this.level:10;return.05*(11-t)},t.prototype.addRowsCleared=function(t){switch(t){case 1:this.score+=40*this.level;break;case 2:this.score+=100*this.level;break;case 3:this.score+=300*this.level;break;case 4:this.score+=1200*this.level;break;default:return}this.checkLevel(t)},t.prototype.addSoftDrop=function(){this.score++},t.prototype.addHardDrop=function(t){this.score+=2*t},t}();t.ScoringManager=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function i(t,i,e,o,s){this.state=t,this.levelObject=e,this.scoreObject=o,this.linesObject=s,this.scoringManager=i}return i.prototype.updateScore=function(){var t=this.scoringManager.getInfo();this.scoreObject.text=t.score.toString(),this.levelObject.text=t.level.toString(),this.linesObject.text=t.lines.toString()},i.setUpSprite=function(i,e,o,s){var n=i.getGameObject();return"ShapeI"==e&&(i.rotate().rotate(),o-=20,s-=15),"ShapeO"==e&&(o-=10,s+=4),n.y=s,n.x=o,n.scale=.7,n.getAllChildren().forEach(function(i){i.alpha=0;var e=i.state.game.tweens.create(i);e.to({alpha:1},t.Config.animationTime,Kiwi.Animations.Tweens.Easing.Sinusoidal.In,!0)}),n},i.prototype.setNextShape=function(e){this.nextShape&&this.nextShape.getGameObject().destroy(),this.nextShape=new t.Shapes[e](this.state,0,0),"ShapeI"==e&&(this.nextShape.rotate(),this.nextShape.rotate()),this.state.addChild(i.setUpSprite(this.nextShape,e,t.Config.boardWidthInPixels-6,285))},i.prototype.setHeldShape=function(e){this.heldShape&&this.heldShape.getGameObject().destroy(),this.heldShape=new t.Shapes[e](this.state,0,0),"ShapeI"==e&&(this.heldShape.rotate(),this.heldShape.rotate()),this.state.addChild(i.setUpSprite(this.heldShape,e,t.Config.boardWidthInPixels-6,435))},i}();t.Hud=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(i){function e(){i.apply(this,arguments),this.holdKeyIsDown=!1,this.canHold=!0,this.moveKeyIsDown=!1,this.rotateKeyIsDown=!1,this.rotationDirection=0,this.dropping=!1,this.lastMousePosition=-1,this.usesScreenControls=!1,this.animationsStarted=!1,this.blocks=["blue","cyan","green","orange","purple","red","yellow"]}return __extends(e,i),e.prototype.preload=function(){var t=this;i.prototype.preload.call(this),this.addImage("board","assets/img/board.png"),this.addImage("borders","assets/img/borders.png"),this.addImage("hudBorders","assets/img/hud-borders.png"),this.blocks.forEach(function(i){return t.addImage("block-"+i,"assets/img/block-"+i+".png")}),this.addImage("block-ghost","assets/img/block-ghost.png"),this.addSpriteSheet("controlArrow","assets/img/control-arrow.png",51,73),this.addSpriteSheet("controlButton","assets/img/control-button.png",100,100)},e.prototype.moveControls=function(){if(this.boardSprite.input.withinBounds){this.usesScreenControls=!0;var i=Math.trunc((this.game.input.x-t.Config.offsetX-t.Config.borderWidth)/(t.Config.tileSize-1));if(this.lastMousePosition!==i){var e=Math.round(i-this.currentShape.center.x)-1;console.log("pp: "+i),3==this.currentShape.currentRotation&&e++,console.log("dfc: "+e);var o=this.board.findValidPosition(e,this.currentShape.getPositions());return console.log("ccP: "+o),this.lastMousePosition=i,this.currentShape.setByPointerPosition(o),void this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions()))}}this.usesScreenControls=!1;var s=this.leftKey.isDown||this.leftKeyScreen.isDown,n=this.rightKey.isDown||this.rightKeyScreen.isDown,r=n?t.Direction.Right:t.Direction.Left;(s||n)&&!this.moveKeyIsDown&&this.board.emptyDirection(this.currentShape.getBlocks(),r)&&(this.moveKeyIsDown=!0,this.currentShape.move(r),this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions())),this.moveTimer.start())},e.prototype.rotate=function(t){for(var i=this.currentShape.getNextRotation(t),e=!1;i.length>0;){if(this.board.emptyPositions(i)){e=!0,this.currentShape.rotate(),this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions()));break}if(e)break;i=this.currentShape.getNextRotation(t)}return e},e.prototype.afterShapeLanded=function(){return this.animationsStarted=!1,this.createNewShape(),this.board.emptyPositions(this.currentShape.getPositions())?(this.canHold=!0,this.addChild(this.currentShape.getGameObject()),this.hud.setNextShape(this.shapeStack.getNextShape()),void this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions()))):void this.game.states.switchState("gameOver",null,null,this.scoringManager.getInfo())},e.prototype.fallDown=function(i,e){var o=this;if(void 0===i&&(i=1),void 0===e&&(e=!1),!this.animationsStarted&&(!this.board.emptyDirection(this.currentShape.getBlocks(),t.Direction.Down)||(.01===this.fallTimer.delay&&this.scoringManager.addSoftDrop(),this.currentShape.fall(i),e))){this.board.setBlocks(this.currentShape.getBlocks(),t.BlockStatus.Taken);var s=this.board.checkRows(this.currentShape.getBlocks());this.scoringManager.addRowsCleared(s),s?(this.animationsStarted=!0,this.game.time.clock.setTimeout(function(){o.afterShapeLanded()},t.Config.animationTime,this)):this.afterShapeLanded()}},e.prototype.rotationControls=function(){this.rotateCounterClockwiseKey.isDown||this.rotateCounterClockwiseScreen.isDown?this.rotationDirection=t.Direction.Left:this.rotateClockwiseKey.isDown||this.rotateClockwiseScreen.isDown?this.rotationDirection=t.Direction.Right:(this.rotateBothKey.isDown||this.rotateBothScreen.isDown||this.boardSprite.input.isDown)&&(this.rotationDirection=t.Direction.Up),0===this.rotationDirection||this.rotateKeyIsDown||(this.rotateKeyIsDown=!0,this.rotationDirection==t.Direction.Up?this.rotate(t.Direction.Right)||this.rotate(t.Direction.Left):this.rotate(this.rotationDirection)),(this.rotationDirection==t.Direction.Right&&this.rotateClockwiseKey.isUp&&this.rotateClockwiseScreen.isUp||this.rotationDirection==t.Direction.Left&&this.rotateCounterClockwiseKey.isUp&&this.rotateCounterClockwiseScreen.isUp||this.rotationDirection==t.Direction.Up&&this.rotateBothKey.isUp&&this.rotateBothScreen.isUp&&this.boardSprite.input.isUp)&&(this.rotateKeyIsDown=!1,this.rotationDirection=0)},e.prototype.dropDownControls=function(){if((this.hardDropKey.isDown||this.hardDropScreen.isDown)&&!this.dropping){this.dropping=!0;var t=this.board.findDistanceToFall(this.currentShape.getPositions());this.fallDown(t,!0),this.scoringManager.addHardDrop(t)}this.hardDropKey.isUp&&this.hardDropScreen.isUp&&this.dropping&&(this.dropping=!1)},e.prototype.fallTimerControls=function(){this.fallTimer.delay=this.scoringManager.getFallingDelay(),(this.softDropKey.isDown||this.softDropScreen.isDown)&&(this.fallTimer.delay=.01)},e.prototype.holdControls=function(){if((this.holdKey.isDown||this.holdSprite.input.isDown)&&!this.holdKeyIsDown&&this.canHold){this.holdKeyIsDown=!0;var t=this.heldShape?this.heldShape:"";this.heldShape=this.currentShape.name,this.currentShape.destroy(),this.createNewShape(!0,t),t||this.hud.setNextShape(this.shapeStack.getNextShape()),this.hud.setHeldShape(this.heldShape),this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions())),this.canHold=!1}this.holdKey.isUp&&this.holdSprite.input.isUp&&this.holdKeyIsDown&&(this.holdKeyIsDown=!1)},e.prototype.update=function(){i.prototype.update.call(this),this.animationsStarted||(this.moveControls(),this.rotationControls(),this.dropDownControls(),this.fallTimerControls(),this.holdControls(),this.fallTimer.start(),this.hud.updateScore())},e.prototype.createNewShape=function(t,i,e,o,s){void 0===t&&(t=!1),void 0===i&&(i=""),void 0===e&&(e=4),void 0===o&&(o=1),void 0===s&&(s=!1),this.currentShape=this.shapeStack.createNewShape(t,i,e,o),this.board.refreshHighestPositions(),s&&this.board.setBlocks(this.currentShape.getBlocks())},e.prototype.create=function(){var e=this;i.prototype.create.call(this),this.rotateBothScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,95,t.Config.boardHeightInPixels-30),this.rotateBothScreen.rotPointX=.5*this.rotateBothScreen.width,this.rotateBothScreen.rotPointY=.5*this.rotateBothScreen.height,this.rotateBothScreen.rotation=Math.PI/2,this.addChild(this.rotateBothScreen),this.leftKeyScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,30,t.Config.boardHeightInPixels+35),this.addChild(this.leftKeyScreen),this.rightKeyScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,160,t.Config.boardHeightInPixels+35),this.rightKeyScreen.rotPointX=.5*this.rightKeyScreen.width,this.rightKeyScreen.rotPointY=.5*this.rightKeyScreen.height,this.rightKeyScreen.rotation=Math.PI,this.addChild(this.rightKeyScreen),this.softDropScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,95,t.Config.boardHeightInPixels+100),this.softDropScreen.rotPointX=.5*this.softDropScreen.width,this.softDropScreen.rotPointY=.5*this.softDropScreen.height,this.softDropScreen.rotation=-Math.PI/2,this.addChild(this.softDropScreen),this.rotateClockwiseScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlButton,210,t.Config.boardHeightInPixels-30),this.rotateClockwiseScreen.scaleX=.6,this.rotateClockwiseScreen.scaleY=.6,this.addChild(this.rotateClockwiseScreen),this.rotateCounterClockwiseScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlButton,280,t.Config.boardHeightInPixels-30),this.rotateCounterClockwiseScreen.scaleX=.6,this.rotateCounterClockwiseScreen.scaleY=.6,this.addChild(this.rotateCounterClockwiseScreen),this.hardDropScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlButton,330,460),this.hardDropScreen.scaleX=.6,this.hardDropScreen.scaleY=.6,this.addChild(this.hardDropScreen),this.leftKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.LEFT),this.rightKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.RIGHT),this.rotateBothKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.UP),this.rotateClockwiseKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.Z),this.rotateCounterClockwiseKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.X),this.softDropKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.DOWN),this.hardDropKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.SPACEBAR),this.holdKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.SHIFT);var o=new Kiwi.GameObjects.TextField(this,"Score",t.Config.boardWidthInPixels,0,"#000",24);this.addChild(o);var s=new Kiwi.GameObjects.TextField(this,"0",t.Config.boardWidthInPixels,25,"#000",24);this.addChild(s);var n=new Kiwi.GameObjects.TextField(this,"Level",t.Config.boardWidthInPixels,60,"#000",24);this.addChild(n);var r=new Kiwi.GameObjects.TextField(this,"0",t.Config.boardWidthInPixels,85,"#000",24);this.addChild(r);var h=new Kiwi.GameObjects.TextField(this,"Lines",t.Config.boardWidthInPixels,110,"#000",24);this.addChild(h);var a=new Kiwi.GameObjects.TextField(this,"0",t.Config.boardWidthInPixels,135,"#000",24);this.addChild(a),this.boardSprite=new Kiwi.GameObjects.Sprite(this,this.textures.board,t.Config.offsetX+t.Config.borderWidth,t.Config.borderHeight),this.boardSprite.input.enabled=!0,this.addChild(this.boardSprite);var c=new Kiwi.GameObjects.StaticImage(this,this.textures.borders,t.Config.offsetX,0);this.addChild(c);var d=new Kiwi.GameObjects.TextField(this,"Next",t.Config.boardWidthInPixels,170,"#000",24);this.addChild(d);var l=new Kiwi.GameObjects.StaticImage(this,this.textures.hudBorders,t.Config.boardWidthInPixels+20,235);l.scaleX=2.5,l.scaleY=3.5,this.addChild(l);var u=new Kiwi.GameObjects.TextField(this,"Hold",t.Config.boardWidthInPixels,320,"#000",24);this.addChild(u),this.holdSprite=new Kiwi.GameObjects.Sprite(this,this.textures.hudBorders,t.Config.boardWidthInPixels+20,385),this.holdSprite.scaleX=2.5,this.holdSprite.scaleY=3.5,this.holdSprite.input.enabled=!0,this.addChild(this.holdSprite),this.moveTimer=this.game.time.clock.createTimer("move",t.Config.moveTimerRate,0),this.moveTimer.createTimerEvent(Kiwi.Time.TimerEvent.TIMER_STOP,function(){e.moveKeyIsDown=!1},this),this.fallTimer=this.game.time.clock.createTimer("fall",.5,0),this.fallTimer.createTimerEvent(Kiwi.Time.TimerEvent.TIMER_STOP,this.fallDown,this),this.board=new t.Board(this),this.shapeStack=new t.Shapes.ShapeStack(this),this.scoringManager=new t.ScoringManager(1),this.hud=new t.Hud(this,this.scoringManager,r,s,a),this.createNewShape(!0,"ShapeI"),this.hud.setNextShape(this.shapeStack.getNextShape()),this.ghost=new t.Ghost(this,this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions())),this.addChildBefore(this.ghost.getGameObject(),c),this.fallTimer.start()},e}(Kiwi.State);t.MainState=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(i){function e(){i.apply(this,arguments)}return __extends(e,i),e.prototype.update=function(){this.game.input.mouse.isDown&&this.game.states.switchState("main")},e.prototype.create=function(e,o,s){i.prototype.create.call(this),this.addChild(new Kiwi.GameObjects.TextField(this,"Game Over!",t.Config.boardWidthInPixels/2,100,"#000",30)),this.addChild(new Kiwi.GameObjects.TextField(this,"Score",t.Config.boardWidthInPixels/2,150,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,e.toString(),t.Config.boardWidthInPixels/2,175,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,"Lines",t.Config.boardWidthInPixels/2,200,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,s.toString(),t.Config.boardWidthInPixels/2,225,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,"Level",t.Config.boardWidthInPixels/2,250,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,o.toString(),t.Config.boardWidthInPixels/2,275,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,"Play again",t.Config.boardWidthInPixels/2,350,"#000",24)),this.getAllChildren().forEach(function(t){return t.textAlign="center"})},e}(Kiwi.State);t.GameOverState=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i={renderer:Kiwi.RENDERER_CANVAS,width:430,height:800,plugins:["TouchButton"]},e=new Kiwi.Game("content","Tetris",null,i),o=new t.MenuState("menu"),s=new t.MainState("main"),n=new t.GameOverState("gameOver");e.states.addState(o),e.states.addState(s),e.states.addState(n),e.states.switchState("menu")}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="red",this.name="ShapeDot",this.addBlock(this.blockColor,e,o,!0)}return __extends(i,t),i}(t.Shape);t.ShapeDot=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(i){var e=function(i){function e(t,e,o){i.call(this,t),this.blockColor="cyan",this.name="ShapeI",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o),this.addBlock(this.blockColor,e+1,o),this.addBlock(this.blockColor,e+2,o),this.addCenter(e+.5,o+.5)}return __extends(e,i),e.prototype.getRotations=function(){return e.rotations},e.prototype.addCenter=function(i,e){this.center=new t.Block(i,e,this.state,null)},e.rotations=[[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]]],e}(i.Shape);i.ShapeI=e}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="blue",this.name="ShapeJ",this.addBlock(this.blockColor,e-1,o-1),this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e+1,o)}return __extends(i,t),i}(t.Shape);t.ShapeJ=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="orange",this.name="ShapeL",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e+1,o),this.addBlock(this.blockColor,e+1,o-1)}return __extends(i,t),i}(t.Shape);t.ShapeL=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(i){var e=function(i){function e(t,e,o){i.call(this,t),this.blockColor="yellow",this.name="ShapeO",this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e,o),this.addBlock(this.blockColor,e+1,o-1),this.addBlock(this.blockColor,e+1,o),this.addCenter(e-.5,o-.5)}return __extends(e,i),e.prototype.rotate=function(){return this},e.prototype.getNextRotation=function(t){return void 0===t&&(t=0),[]},e.prototype.addCenter=function(i,e){this.center=new t.Block(i,e,this.state,null)},e}(i.Shape);i.ShapeO=e}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="green",this.name="ShapeS",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e+1,o-1)}return __extends(i,t),i}(t.Shape);t.ShapeS=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="purple",this.name="ShapeT",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e+1,o)}return __extends(i,t),i}(t.Shape);t.ShapeT=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="red",this.name="ShapeZ",this.addBlock(this.blockColor,e-1,o-1),this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e+1,o)}return __extends(i,t),i}(t.Shape);t.ShapeZ=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));

},{"ramda":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjOlxcVXNlcnNcXEd5dGlzXFxEZXNrdG9wXFxUZXRyaXNcXG5vZGVfbW9kdWxlc1xccmFtZGFcXGRpc3RcXHJhbWRhLmpzIiwiYzpcXFVzZXJzXFxHeXRpc1xcRGVza3RvcFxcVGV0cmlzXFxzcmNcXHR5cGVzY3JpcHQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Q0NLRSxXQUVBLFlBMEJFLElBQUksSUFBTyw0QkFBNEIsR0FHbkMsRUFBUyxTQUFnQixFQUFHLEdBRTVCLE9BQVEsR0FDUixJQUFLLEdBQ0QsTUFBTyxZQUNILE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxHQUNiLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEdBQ2pCLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksR0FDckIsTUFBTyxHQUFHLE1BQU0sS0FBTSxXQUU5QixLQUFLLEdBQ0QsTUFBTyxVQUFVLEVBQUksRUFBSSxFQUFJLEdBQ3pCLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksRUFBSSxFQUFJLEdBQzdCLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksRUFBSSxFQUFJLEVBQUksR0FDakMsTUFBTyxHQUFHLE1BQU0sS0FBTSxXQUU5QixLQUFLLEdBQ0QsTUFBTyxVQUFVLEVBQUksRUFBSSxFQUFJLEVBQUksRUFBSSxFQUFJLEdBQ3JDLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksRUFBSSxFQUFJLEVBQUksRUFBSSxFQUFJLEdBQ3pDLE1BQU8sR0FB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LEdBQ2pCLEVBQVMsRUFBTyxTQUFXLEVBQU8sYUFDdEMsU0FBVyxXQUtkLElBQUksU0FDSixTQUFXLEdBQ1AsR0FBSSxJQUNKLFNBQVcsR0FDUCxHQUFJLEdBQVMsU0FBVyxHQUVwQixRQUFTLEdBQU8sRUFBTyxFQUFHLEdBQ3RCLEVBQU8sS0FBSyxLQUFNLEdBQ2xCLEtBQUssV0FBYSxTQUNsQixLQUFLLEtBQU8sU0FDWixLQUFLLFNBQVMsS0FBSyxXQUFZLEVBQUksRUFBRyxHQUN0QyxLQUFLLFNBQVMsS0FBSyxXQUFZLEVBQUcsR0FBRyxHQUNyQyxLQUFLLFNBQVMsS0FBSyxXQUFZLEVBQUcsRUFBSSxHQUN0QyxLQUFLLFNBQVMsS0FBSyxXQUFZLEVBQUksRUFBRyxHQUUxQyxNQVZBLFdBQVUsRUFBUSxHQVVYLEdBQ1IsRUFBTyxNQUNWLEdBQU8sT0FBUyxHQUNqQixFQUFTLEVBQU8sU0FBVyxFQUFPLGFBQ3RDLFNBQVcsV0FLZCxJQUFJLFNBQ0osU0FBVyxHQUNQLEdBQUksSUFDSixTQUFXLEdBQ1AsR0FBSSxHQUFTLFNBQVcsR0FFcEIsUUFBUyxHQUFPLEVBQU8sRUFBRyxHQUN0QixFQUFPLEtBQUssS0FBTSxHQUNsQixLQUFLLFdBQWEsTUFDbEIsS0FBSyxLQUFPLFNBQ1osS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFJLEVBQUcsRUFBSSxHQUMxQyxLQUFLLFNBQVMsS0FBSyxXQUFZLEVBQUcsRUFBSSxHQUN0QyxLQUFLLFNBQVMsS0FBSyxXQUFZLEVBQUcsR0FBRyxHQUNyQyxLQUFLLFNBQVMsS0FBSyxXQUFZLEVBQUksRUFBRyxHQUUxQyxNQVZBLFdBQVUsRUFBUSxHQVVYLEdBQ1IsRUFBTyxNQUNWLEdBQU8sT0FBUyxHQUNqQixFQUFTLEVBQU8sU0FBVyxFQUFPLGFBQ3RDLFNBQVciLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8gIFJhbWRhIHYwLjE3LjFcbi8vICBodHRwczovL2dpdGh1Yi5jb20vcmFtZGEvcmFtZGFcbi8vICAoYykgMjAxMy0yMDE1IFNjb3R0IFNhdXlldCwgTWljaGFlbCBIdXJsZXksIGFuZCBEYXZpZCBDaGFtYmVyc1xuLy8gIFJhbWRhIG1heSBiZSBmcmVlbHkgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxuXG47KGZ1bmN0aW9uKCkge1xuXG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICAgKiBBIHNwZWNpYWwgcGxhY2Vob2xkZXIgdmFsdWUgdXNlZCB0byBzcGVjaWZ5IFwiZ2Fwc1wiIHdpdGhpbiBjdXJyaWVkIGZ1bmN0aW9ucyxcbiAgICAgKiBhbGxvd2luZyBwYXJ0aWFsIGFwcGxpY2F0aW9uIG9mIGFueSBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMsXG4gICAgICogcmVnYXJkbGVzcyBvZiB0aGVpciBwb3NpdGlvbnMuXG4gICAgICpcbiAgICAgKiBJZiBgZ2AgaXMgYSBjdXJyaWVkIHRlcm5hcnkgZnVuY3Rpb24gYW5kIGBfYCBpcyBgUi5fX2AsIHRoZSBmb2xsb3dpbmcgYXJlIGVxdWl2YWxlbnQ6XG4gICAgICpcbiAgICAgKiAgIC0gYGcoMSwgMiwgMylgXG4gICAgICogICAtIGBnKF8sIDIsIDMpKDEpYFxuICAgICAqICAgLSBgZyhfLCBfLCAzKSgxKSgyKWBcbiAgICAgKiAgIC0gYGcoXywgXywgMykoMSwgMilgXG4gICAgICogICAtIGBnKF8sIDIsIF8pKDEsIDMpYFxuICAgICAqICAgLSBgZyhfLCAyKSgxKSgzKWBcbiAgICAgKiAgIC0gYGcoXywgMikoMSwgMylgXG4gICAgICogICAtIGBnKF8sIDIpKF8sIDMpKDEpYFxuICAgICAqXG4gICAgICogQGNvbnN0YW50XG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZ3JlZXQgPSBSLnJlcGxhY2UoJ3tuYW1lfScsIFIuX18sICdIZWxsbywge25hbWV9IScpO1xuICAgICAqICAgICAgZ3JlZXQoJ0FsaWNlJyk7IC8vPT4gJ0hlbGxvLCBBbGljZSEnXG4gICAgICovXG4gICAgdmFyIF9fID0geyAnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJzogdHJ1ZSB9O1xuXG4gICAgLy8ganNoaW50IHVudXNlZDp2YXJzXG4gICAgdmFyIF9hcml0eSA9IGZ1bmN0aW9uIF9hcml0eShuLCBmbikge1xuICAgICAgICAvLyBqc2hpbnQgdW51c2VkOnZhcnNcbiAgICAgICAgc3dpdGNoIChuKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2LCBhNykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcsIGE4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcsIGE4LCBhOSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlyc3QgYXJndW1lbnQgdG8gX2FyaXR5IG11c3QgYmUgYSBub24tbmVnYXRpdmUgaW50ZWdlciBubyBncmVhdGVyIHRoYW4gdGVuJyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIF9jbG9uZVJlZ0V4cCA9IGZ1bmN0aW9uIF9jbG9uZVJlZ0V4cChwYXR0ZXJuKSB7XG4gICAgICAgIHJldHVybiBuZXcgUmVnRXhwKHBhdHRlcm4uc291cmNlLCAocGF0dGVybi5nbG9iYWwgPyAnZycgOiAnJykgKyAocGF0dGVybi5pZ25vcmVDYXNlID8gJ2knIDogJycpICsgKHBhdHRlcm4ubXVsdGlsaW5lID8gJ20nIDogJycpICsgKHBhdHRlcm4uc3RpY2t5ID8gJ3knIDogJycpICsgKHBhdHRlcm4udW5pY29kZSA/ICd1JyA6ICcnKSk7XG4gICAgfTtcblxuICAgIHZhciBfY29tcGxlbWVudCA9IGZ1bmN0aW9uIF9jb21wbGVtZW50KGYpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAhZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQcml2YXRlIGBjb25jYXRgIGZ1bmN0aW9uIHRvIG1lcmdlIHR3byBhcnJheS1saWtlIG9iamVjdHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl8QXJndW1lbnRzfSBbc2V0MT1bXV0gQW4gYXJyYXktbGlrZSBvYmplY3QuXG4gICAgICogQHBhcmFtIHtBcnJheXxBcmd1bWVudHN9IFtzZXQyPVtdXSBBbiBhcnJheS1saWtlIG9iamVjdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcsIG1lcmdlZCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBfY29uY2F0KFs0LCA1LCA2XSwgWzEsIDIsIDNdKTsgLy89PiBbNCwgNSwgNiwgMSwgMiwgM11cbiAgICAgKi9cbiAgICB2YXIgX2NvbmNhdCA9IGZ1bmN0aW9uIF9jb25jYXQoc2V0MSwgc2V0Mikge1xuICAgICAgICBzZXQxID0gc2V0MSB8fCBbXTtcbiAgICAgICAgc2V0MiA9IHNldDIgfHwgW107XG4gICAgICAgIHZhciBpZHg7XG4gICAgICAgIHZhciBsZW4xID0gc2V0MS5sZW5ndGg7XG4gICAgICAgIHZhciBsZW4yID0gc2V0Mi5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbjEpIHtcbiAgICAgICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoXSA9IHNldDFbaWR4XTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4yKSB7XG4gICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBzZXQyW2lkeF07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICB2YXIgX2NvbnRhaW5zV2l0aCA9IGZ1bmN0aW9uIF9jb250YWluc1dpdGgocHJlZCwgeCwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChwcmVkKHgsIGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogT3B0aW1pemVkIGludGVybmFsIHR3by1hcml0eSBjdXJyeSBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGN1cnJ5LlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBUaGUgY3VycmllZCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICB2YXIgX2N1cnJ5MSA9IGZ1bmN0aW9uIF9jdXJyeTEoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGYxKGEpIHtcbiAgICAgICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYxO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChhICE9IG51bGwgJiYgYVsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZjE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBPcHRpbWl6ZWQgaW50ZXJuYWwgdHdvLWFyaXR5IGN1cnJ5IGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY3VycnkuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IFRoZSBjdXJyaWVkIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIHZhciBfY3VycnkyID0gZnVuY3Rpb24gX2N1cnJ5Mihmbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZjIoYSwgYikge1xuICAgICAgICAgICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKG4gPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZjI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDEgJiYgYSAhPSBudWxsICYmIGFbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYyO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAyICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSAmJiBiICE9IG51bGwgJiYgYlsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZjI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDIgJiYgYSAhPSBudWxsICYmIGFbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAyICYmIGIgIT0gbnVsbCAmJiBiWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIChiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBPcHRpbWl6ZWQgaW50ZXJuYWwgdGhyZWUtYXJpdHkgY3VycnkgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBjdXJyeS5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gVGhlIGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgdmFyIF9jdXJyeTMgPSBmdW5jdGlvbiBfY3VycnkzKGZuKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmMyhhLCBiLCBjKSB7XG4gICAgICAgICAgICB2YXIgbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgICAgICBpZiAobiA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmMztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMSAmJiBhICE9IG51bGwgJiYgYVsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZjM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiAoYiwgYykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYiwgYyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDIgJiYgYSAhPSBudWxsICYmIGFbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlICYmIGIgIT0gbnVsbCAmJiBiWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmMztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMiAmJiBhICE9IG51bGwgJiYgYVsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiAoYSwgYykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYiwgYyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDIgJiYgYiAhPSBudWxsICYmIGJbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gKGIsIGMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAzICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSAmJiBiICE9IG51bGwgJiYgYlsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUgJiYgYyAhPSBudWxsICYmIGNbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYzO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAzICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSAmJiBiICE9IG51bGwgJiYgYlsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYiwgYyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDMgJiYgYSAhPSBudWxsICYmIGFbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlICYmIGMgIT0gbnVsbCAmJiBjWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIChhLCBjKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiLCBjKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMyAmJiBiICE9IG51bGwgJiYgYlsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUgJiYgYyAhPSBudWxsICYmIGNbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gKGIsIGMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAzICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiLCBjKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMyAmJiBiICE9IG51bGwgJiYgYlsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2N1cnJ5MShmdW5jdGlvbiAoYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYiwgYyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDMgJiYgYyAhPSBudWxsICYmIGNbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYiwgYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEludGVybmFsIGN1cnJ5TiBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGxlbmd0aCBUaGUgYXJpdHkgb2YgdGhlIGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICogQHJldHVybiB7YXJyYXl9IEFuIGFycmF5IG9mIGFyZ3VtZW50cyByZWNlaXZlZCB0aHVzIGZhci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY3VycnkuXG4gICAgICovXG4gICAgdmFyIF9jdXJyeU4gPSBmdW5jdGlvbiBfY3VycnlOKGxlbmd0aCwgcmVjZWl2ZWQsIGZuKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY29tYmluZWQgPSBbXTtcbiAgICAgICAgICAgIHZhciBhcmdzSWR4ID0gMDtcbiAgICAgICAgICAgIHZhciBsZWZ0ID0gbGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGNvbWJpbmVkSWR4ID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChjb21iaW5lZElkeCA8IHJlY2VpdmVkLmxlbmd0aCB8fCBhcmdzSWR4IDwgYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKGNvbWJpbmVkSWR4IDwgcmVjZWl2ZWQubGVuZ3RoICYmIChyZWNlaXZlZFtjb21iaW5lZElkeF0gPT0gbnVsbCB8fCByZWNlaXZlZFtjb21iaW5lZElkeF1bJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddICE9PSB0cnVlIHx8IGFyZ3NJZHggPj0gYXJndW1lbnRzLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVjZWl2ZWRbY29tYmluZWRJZHhdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFyZ3VtZW50c1thcmdzSWR4XTtcbiAgICAgICAgICAgICAgICAgICAgYXJnc0lkeCArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb21iaW5lZFtjb21iaW5lZElkeF0gPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBudWxsIHx8IHJlc3VsdFsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gIT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdCAtPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb21iaW5lZElkeCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGxlZnQgPD0gMCA/IGZuLmFwcGx5KHRoaXMsIGNvbWJpbmVkKSA6IF9hcml0eShsZWZ0LCBfY3VycnlOKGxlbmd0aCwgY29tYmluZWQsIGZuKSk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBfZmlsdGVyID0gZnVuY3Rpb24gX2ZpbHRlcihmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGgsIHJlc3VsdCA9IFtdO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoXSA9IGxpc3RbaWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHZhciBfZm9yY2VSZWR1Y2VkID0gZnVuY3Rpb24gX2ZvcmNlUmVkdWNlZCh4KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL3ZhbHVlJzogeCxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvcmVkdWNlZCc6IHRydWVcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgc3RyYXRlZ3kgZm9yIGV4dHJhY3RpbmcgZnVuY3Rpb24gbmFtZXMgZnJvbSBhbiBvYmplY3RcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBmdW5jdGlvbiB0aGF0IHRha2VzIGFuIG9iamVjdCBhbmQgcmV0dXJucyBhbiBhcnJheSBvZiBmdW5jdGlvbiBuYW1lcy5cbiAgICAgKi9cbiAgICB2YXIgX2Z1bmN0aW9uc1dpdGggPSBmdW5jdGlvbiBfZnVuY3Rpb25zV2l0aChmbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIF9maWx0ZXIoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2Ygb2JqW2tleV0gPT09ICdmdW5jdGlvbic7XG4gICAgICAgICAgICB9LCBmbihvYmopKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIF9oYXMgPSBmdW5jdGlvbiBfaGFzKHByb3AsIG9iaikge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG4gICAgfTtcblxuICAgIHZhciBfaWRlbnRpdHkgPSBmdW5jdGlvbiBfaWRlbnRpdHkoeCkge1xuICAgICAgICByZXR1cm4geDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVGVzdHMgd2hldGhlciBvciBub3QgYW4gb2JqZWN0IGlzIGFuIGFycmF5LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbCBUaGUgb2JqZWN0IHRvIHRlc3QuXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIGB2YWxgIGlzIGFuIGFycmF5LCBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBfaXNBcnJheShbXSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgX2lzQXJyYXkobnVsbCk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIF9pc0FycmF5KHt9KTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXkgfHwgZnVuY3Rpb24gX2lzQXJyYXkodmFsKSB7XG4gICAgICAgIHJldHVybiB2YWwgIT0gbnVsbCAmJiB2YWwubGVuZ3RoID49IDAgJiYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIERldGVybWluZSBpZiB0aGUgcGFzc2VkIGFyZ3VtZW50IGlzIGFuIGludGVnZXIuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gblxuICAgICAqIEBjYXRlZ29yeSBUeXBlXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKi9cbiAgICB2YXIgX2lzSW50ZWdlciA9IE51bWJlci5pc0ludGVnZXIgfHwgZnVuY3Rpb24gX2lzSW50ZWdlcihuKSB7XG4gICAgICAgIHJldHVybiBuIDw8IDAgPT09IG47XG4gICAgfTtcblxuICAgIHZhciBfaXNOdW1iZXIgPSBmdW5jdGlvbiBfaXNOdW1iZXIoeCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpID09PSAnW29iamVjdCBOdW1iZXJdJztcbiAgICB9O1xuXG4gICAgdmFyIF9pc1N0cmluZyA9IGZ1bmN0aW9uIF9pc1N0cmluZyh4KSB7XG4gICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeCkgPT09ICdbb2JqZWN0IFN0cmluZ10nO1xuICAgIH07XG5cbiAgICB2YXIgX2lzVHJhbnNmb3JtZXIgPSBmdW5jdGlvbiBfaXNUcmFuc2Zvcm1lcihvYmopIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBvYmpbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPT09ICdmdW5jdGlvbic7XG4gICAgfTtcblxuICAgIHZhciBfbWFwID0gZnVuY3Rpb24gX21hcChmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGgsIHJlc3VsdCA9IEFycmF5KGxlbik7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIHJlc3VsdFtpZHhdID0gZm4obGlzdFtpZHhdKTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHZhciBfcGlwZSA9IGZ1bmN0aW9uIF9waXBlKGYsIGcpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBnLmNhbGwodGhpcywgZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIF9waXBlUCA9IGZ1bmN0aW9uIF9waXBlUChmLCBnKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3R4ID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiBmLmFwcGx5KGN0eCwgYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGcuY2FsbChjdHgsIHgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBfcXVvdGUgPSBmdW5jdGlvbiBfcXVvdGUocykge1xuICAgICAgICByZXR1cm4gJ1wiJyArIHMucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpICsgJ1wiJztcbiAgICB9O1xuXG4gICAgdmFyIF9yZWR1Y2VkID0gZnVuY3Rpb24gX3JlZHVjZWQoeCkge1xuICAgICAgICByZXR1cm4geCAmJiB4WydAQHRyYW5zZHVjZXIvcmVkdWNlZCddID8geCA6IHtcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvdmFsdWUnOiB4LFxuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9yZWR1Y2VkJzogdHJ1ZVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBBbiBvcHRpbWl6ZWQsIHByaXZhdGUgYXJyYXkgYHNsaWNlYCBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcmd1bWVudHN8QXJyYXl9IGFyZ3MgVGhlIGFycmF5IG9yIGFyZ3VtZW50cyBvYmplY3QgdG8gY29uc2lkZXIuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtmcm9tPTBdIFRoZSBhcnJheSBpbmRleCB0byBzbGljZSBmcm9tLCBpbmNsdXNpdmUuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFt0bz1hcmdzLmxlbmd0aF0gVGhlIGFycmF5IGluZGV4IHRvIHNsaWNlIHRvLCBleGNsdXNpdmUuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3LCBzbGljZWQgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgX3NsaWNlKFsxLCAyLCAzLCA0LCA1XSwgMSwgMyk7IC8vPT4gWzIsIDNdXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBmaXJzdFRocmVlQXJncyA9IGZ1bmN0aW9uKGEsIGIsIGMsIGQpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIF9zbGljZShhcmd1bWVudHMsIDAsIDMpO1xuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIGZpcnN0VGhyZWVBcmdzKDEsIDIsIDMsIDQpOyAvLz0+IFsxLCAyLCAzXVxuICAgICAqL1xuICAgIHZhciBfc2xpY2UgPSBmdW5jdGlvbiBfc2xpY2UoYXJncywgZnJvbSwgdG8pIHtcbiAgICAgICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBfc2xpY2UoYXJncywgMCwgYXJncy5sZW5ndGgpO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gX3NsaWNlKGFyZ3MsIGZyb20sIGFyZ3MubGVuZ3RoKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHZhciBsaXN0ID0gW107XG4gICAgICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgICAgIHZhciBsZW4gPSBNYXRoLm1heCgwLCBNYXRoLm1pbihhcmdzLmxlbmd0aCwgdG8pIC0gZnJvbSk7XG4gICAgICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICAgICAgbGlzdFtpZHhdID0gYXJnc1tmcm9tICsgaWR4XTtcbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBsaXN0O1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBvbHlmaWxsIGZyb20gPGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0RhdGUvdG9JU09TdHJpbmc+LlxuICAgICAqL1xuICAgIHZhciBfdG9JU09TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwYWQgPSBmdW5jdGlvbiBwYWQobikge1xuICAgICAgICAgICAgcmV0dXJuIChuIDwgMTAgPyAnMCcgOiAnJykgKyBuO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdHlwZW9mIERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nID09PSAnZnVuY3Rpb24nID8gZnVuY3Rpb24gX3RvSVNPU3RyaW5nKGQpIHtcbiAgICAgICAgICAgIHJldHVybiBkLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgIH0gOiBmdW5jdGlvbiBfdG9JU09TdHJpbmcoZCkge1xuICAgICAgICAgICAgcmV0dXJuIGQuZ2V0VVRDRnVsbFllYXIoKSArICctJyArIHBhZChkLmdldFVUQ01vbnRoKCkgKyAxKSArICctJyArIHBhZChkLmdldFVUQ0RhdGUoKSkgKyAnVCcgKyBwYWQoZC5nZXRVVENIb3VycygpKSArICc6JyArIHBhZChkLmdldFVUQ01pbnV0ZXMoKSkgKyAnOicgKyBwYWQoZC5nZXRVVENTZWNvbmRzKCkpICsgJy4nICsgKGQuZ2V0VVRDTWlsbGlzZWNvbmRzKCkgLyAxMDAwKS50b0ZpeGVkKDMpLnNsaWNlKDIsIDUpICsgJ1onO1xuICAgICAgICB9O1xuICAgIH0oKTtcblxuICAgIHZhciBfeGRyb3BSZXBlYXRzV2l0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWERyb3BSZXBlYXRzV2l0aChwcmVkLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5wcmVkID0gcHJlZDtcbiAgICAgICAgICAgIHRoaXMubGFzdFZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5zZWVuRmlyc3RWYWx1ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIFhEcm9wUmVwZWF0c1dpdGgucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9pbml0J10oKTtcbiAgICAgICAgfTtcbiAgICAgICAgWERyb3BSZXBlYXRzV2l0aC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ocmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgWERyb3BSZXBlYXRzV2l0aC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgdmFyIHNhbWVBc0xhc3QgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWVuRmlyc3RWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VlbkZpcnN0VmFsdWUgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByZWQodGhpcy5sYXN0VmFsdWUsIGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHNhbWVBc0xhc3QgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5sYXN0VmFsdWUgPSBpbnB1dDtcbiAgICAgICAgICAgIHJldHVybiBzYW1lQXNMYXN0ID8gcmVzdWx0IDogdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIGlucHV0KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3hkcm9wUmVwZWF0c1dpdGgocHJlZCwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWERyb3BSZXBlYXRzV2l0aChwcmVkLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeGZCYXNlID0ge1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL2luaXQnXSgpO1xuICAgICAgICB9LFxuICAgICAgICByZXN1bHQ6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ocmVzdWx0KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgX3hmaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhGaWx0ZXIoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgIH1cbiAgICAgICAgWEZpbHRlci5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhGaWx0ZXIucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBfeGZCYXNlLnJlc3VsdDtcbiAgICAgICAgWEZpbHRlci5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZihpbnB1dCkgPyB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgaW5wdXQpIDogcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGZpbHRlcihmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRmlsdGVyKGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94ZmluZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWEZpbmQoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgICAgICB0aGlzLmZvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgWEZpbmQucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYRmluZC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5mb3VuZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCB2b2lkIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXShyZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgICBYRmluZC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZihpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBfcmVkdWNlZCh0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgaW5wdXQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94ZmluZChmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRmluZChmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeGZpbmRJbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWEZpbmRJbmRleChmLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5mID0gZjtcbiAgICAgICAgICAgIHRoaXMuaWR4ID0gLTE7XG4gICAgICAgICAgICB0aGlzLmZvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgWEZpbmRJbmRleC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhGaW5kSW5kZXgucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZm91bmQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgLTEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXShyZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgICBYRmluZEluZGV4LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICB0aGlzLmlkeCArPSAxO1xuICAgICAgICAgICAgaWYgKHRoaXMuZihpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBfcmVkdWNlZCh0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdGhpcy5pZHgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94ZmluZEluZGV4KGYsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhGaW5kSW5kZXgoZiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hmaW5kTGFzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWEZpbmRMYXN0KGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICB9XG4gICAgICAgIFhGaW5kTGFzdC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhGaW5kTGFzdC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10odGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIHRoaXMubGFzdCkpO1xuICAgICAgICB9O1xuICAgICAgICBYRmluZExhc3QucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmYoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0ID0gaW5wdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGZpbmRMYXN0KGYsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhGaW5kTGFzdChmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeGZpbmRMYXN0SW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhGaW5kTGFzdEluZGV4KGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICAgICAgdGhpcy5pZHggPSAtMTtcbiAgICAgICAgICAgIHRoaXMubGFzdElkeCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIFhGaW5kTGFzdEluZGV4LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWEZpbmRMYXN0SW5kZXgucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCB0aGlzLmxhc3RJZHgpKTtcbiAgICAgICAgfTtcbiAgICAgICAgWEZpbmRMYXN0SW5kZXgucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIHRoaXMuaWR4ICs9IDE7XG4gICAgICAgICAgICBpZiAodGhpcy5mKGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdElkeCA9IHRoaXMuaWR4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3hmaW5kTGFzdEluZGV4KGYsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhGaW5kTGFzdEluZGV4KGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94bWFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYTWFwKGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICB9XG4gICAgICAgIFhNYXAucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYTWFwLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gX3hmQmFzZS5yZXN1bHQ7XG4gICAgICAgIFhNYXAucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdGhpcy5mKGlucHV0KSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94bWFwKGYsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhNYXAoZiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3h0YWtlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYVGFrZShuLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5uID0gbjtcbiAgICAgICAgfVxuICAgICAgICBYVGFrZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhUYWtlLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gX3hmQmFzZS5yZXN1bHQ7XG4gICAgICAgIFhUYWtlLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5uID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9yZWR1Y2VkKHJlc3VsdCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubiAtPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgaW5wdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeHRha2UobiwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWFRha2UobiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3h0YWtlV2hpbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhUYWtlV2hpbGUoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgIH1cbiAgICAgICAgWFRha2VXaGlsZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhUYWtlV2hpbGUucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBfeGZCYXNlLnJlc3VsdDtcbiAgICAgICAgWFRha2VXaGlsZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZihpbnB1dCkgPyB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgaW5wdXQpIDogX3JlZHVjZWQocmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3h0YWtlV2hpbGUoZiwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWFRha2VXaGlsZShmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeHdyYXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhXcmFwKGZuKSB7XG4gICAgICAgICAgICB0aGlzLmYgPSBmbjtcbiAgICAgICAgfVxuICAgICAgICBYV3JhcC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2luaXQgbm90IGltcGxlbWVudGVkIG9uIFhXcmFwJyk7XG4gICAgICAgIH07XG4gICAgICAgIFhXcmFwLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gZnVuY3Rpb24gKGFjYykge1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfTtcbiAgICAgICAgWFdyYXAucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKGFjYywgeCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZihhY2MsIHgpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX3h3cmFwKGZuKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhXcmFwKGZuKTtcbiAgICAgICAgfTtcbiAgICB9KCk7XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIHR3byBudW1iZXJzLiBFcXVpdmFsZW50IHRvIGBhICsgYmAgYnV0IGN1cnJpZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXIgLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYlxuICAgICAqIEByZXR1cm4ge051bWJlcn1cbiAgICAgKiBAc2VlIFIuc3VidHJhY3RcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmFkZCgyLCAzKTsgICAgICAgLy89PiAgNVxuICAgICAqICAgICAgUi5hZGQoNykoMTApOyAgICAgIC8vPT4gMTdcbiAgICAgKi9cbiAgICB2YXIgYWRkID0gX2N1cnJ5MihmdW5jdGlvbiBhZGQoYSwgYikge1xuICAgICAgICByZXR1cm4gYSArIGI7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBcHBsaWVzIGEgZnVuY3Rpb24gdG8gdGhlIHZhbHVlIGF0IHRoZSBnaXZlbiBpbmRleCBvZiBhbiBhcnJheSxcbiAgICAgKiByZXR1cm5pbmcgYSBuZXcgY29weSBvZiB0aGUgYXJyYXkgd2l0aCB0aGUgZWxlbWVudCBhdCB0aGUgZ2l2ZW5cbiAgICAgKiBpbmRleCByZXBsYWNlZCB3aXRoIHRoZSByZXN1bHQgb2YgdGhlIGZ1bmN0aW9uIGFwcGxpY2F0aW9uLlxuICAgICAqIEBzZWUgUi51cGRhdGVcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gYSkgLT4gTnVtYmVyIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gYXBwbHkuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlkeCBUaGUgaW5kZXguXG4gICAgICogQHBhcmFtIHtBcnJheXxBcmd1bWVudHN9IGxpc3QgQW4gYXJyYXktbGlrZSBvYmplY3Qgd2hvc2UgdmFsdWVcbiAgICAgKiAgICAgICAgYXQgdGhlIHN1cHBsaWVkIGluZGV4IHdpbGwgYmUgcmVwbGFjZWQuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgY29weSBvZiB0aGUgc3VwcGxpZWQgYXJyYXktbGlrZSBvYmplY3Qgd2l0aFxuICAgICAqICAgICAgICAgdGhlIGVsZW1lbnQgYXQgaW5kZXggYGlkeGAgcmVwbGFjZWQgd2l0aCB0aGUgdmFsdWVcbiAgICAgKiAgICAgICAgIHJldHVybmVkIGJ5IGFwcGx5aW5nIGBmbmAgdG8gdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5hZGp1c3QoUi5hZGQoMTApLCAxLCBbMCwgMSwgMl0pOyAgICAgLy89PiBbMCwgMTEsIDJdXG4gICAgICogICAgICBSLmFkanVzdChSLmFkZCgxMCkpKDEpKFswLCAxLCAyXSk7ICAgICAvLz0+IFswLCAxMSwgMl1cbiAgICAgKi9cbiAgICB2YXIgYWRqdXN0ID0gX2N1cnJ5MyhmdW5jdGlvbiBhZGp1c3QoZm4sIGlkeCwgbGlzdCkge1xuICAgICAgICBpZiAoaWR4ID49IGxpc3QubGVuZ3RoIHx8IGlkeCA8IC1saXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YXJ0ID0gaWR4IDwgMCA/IGxpc3QubGVuZ3RoIDogMDtcbiAgICAgICAgdmFyIF9pZHggPSBzdGFydCArIGlkeDtcbiAgICAgICAgdmFyIF9saXN0ID0gX2NvbmNhdChsaXN0KTtcbiAgICAgICAgX2xpc3RbX2lkeF0gPSBmbihsaXN0W19pZHhdKTtcbiAgICAgICAgcmV0dXJuIF9saXN0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgYWx3YXlzIHJldHVybnMgdGhlIGdpdmVuIHZhbHVlLiBOb3RlIHRoYXQgZm9yXG4gICAgICogbm9uLXByaW1pdGl2ZXMgdGhlIHZhbHVlIHJldHVybmVkIGlzIGEgcmVmZXJlbmNlIHRvIHRoZSBvcmlnaW5hbCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gaXMga25vd24gYXMgYGNvbnN0YCwgYGNvbnN0YW50YCwgb3IgYEtgIChmb3IgSyBjb21iaW5hdG9yKVxuICAgICAqIGluIG90aGVyIGxhbmd1YWdlcyBhbmQgbGlicmFyaWVzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgYSAtPiAoKiAtPiBhKVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsIFRoZSB2YWx1ZSB0byB3cmFwIGluIGEgZnVuY3Rpb25cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBGdW5jdGlvbiA6OiAqIC0+IHZhbC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgdCA9IFIuYWx3YXlzKCdUZWUnKTtcbiAgICAgKiAgICAgIHQoKTsgLy89PiAnVGVlJ1xuICAgICAqL1xuICAgIHZhciBhbHdheXMgPSBfY3VycnkxKGZ1bmN0aW9uIGFsd2F5cyh2YWwpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QsIGNvbXBvc2VkIG9mIG4tdHVwbGVzIG9mIGNvbnNlY3V0aXZlIGVsZW1lbnRzXG4gICAgICogSWYgYG5gIGlzIGdyZWF0ZXIgdGhhbiB0aGUgbGVuZ3RoIG9mIHRoZSBsaXN0LCBhbiBlbXB0eSBsaXN0IGlzIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBOdW1iZXIgLT4gW2FdIC0+IFtbYV1dXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG4gVGhlIHNpemUgb2YgdGhlIHR1cGxlcyB0byBjcmVhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIHNwbGl0IGludG8gYG5gLXR1cGxlc1xuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbmV3IGxpc3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5hcGVydHVyZSgyLCBbMSwgMiwgMywgNCwgNV0pOyAvLz0+IFtbMSwgMl0sIFsyLCAzXSwgWzMsIDRdLCBbNCwgNV1dXG4gICAgICogICAgICBSLmFwZXJ0dXJlKDMsIFsxLCAyLCAzLCA0LCA1XSk7IC8vPT4gW1sxLCAyLCAzXSwgWzIsIDMsIDRdLCBbMywgNCwgNV1dXG4gICAgICogICAgICBSLmFwZXJ0dXJlKDcsIFsxLCAyLCAzLCA0LCA1XSk7IC8vPT4gW11cbiAgICAgKi9cbiAgICB2YXIgYXBlcnR1cmUgPSBfY3VycnkyKGZ1bmN0aW9uIGFwZXJ0dXJlKG4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBsaW1pdCA9IGxpc3QubGVuZ3RoIC0gKG4gLSAxKTtcbiAgICAgICAgdmFyIGFjYyA9IG5ldyBBcnJheShsaW1pdCA+PSAwID8gbGltaXQgOiAwKTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxpbWl0KSB7XG4gICAgICAgICAgICBhY2NbaWR4XSA9IF9zbGljZShsaXN0LCBpZHgsIGlkeCArIG4pO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBjb250ZW50cyBvZiB0aGUgZ2l2ZW4gbGlzdCwgZm9sbG93ZWQgYnkgdGhlIGdpdmVuXG4gICAgICogZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgYSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHsqfSBlbCBUaGUgZWxlbWVudCB0byBhZGQgdG8gdGhlIGVuZCBvZiB0aGUgbmV3IGxpc3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB3aG9zZSBjb250ZW50cyB3aWxsIGJlIGFkZGVkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIG91dHB1dFxuICAgICAqICAgICAgICBsaXN0LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBsaXN0IGNvbnRhaW5pbmcgdGhlIGNvbnRlbnRzIG9mIHRoZSBvbGQgbGlzdCBmb2xsb3dlZCBieSBgZWxgLlxuICAgICAqIEBzZWUgUi5wcmVwZW5kXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5hcHBlbmQoJ3Rlc3RzJywgWyd3cml0ZScsICdtb3JlJ10pOyAvLz0+IFsnd3JpdGUnLCAnbW9yZScsICd0ZXN0cyddXG4gICAgICogICAgICBSLmFwcGVuZCgndGVzdHMnLCBbXSk7IC8vPT4gWyd0ZXN0cyddXG4gICAgICogICAgICBSLmFwcGVuZChbJ3Rlc3RzJ10sIFsnd3JpdGUnLCAnbW9yZSddKTsgLy89PiBbJ3dyaXRlJywgJ21vcmUnLCBbJ3Rlc3RzJ11dXG4gICAgICovXG4gICAgdmFyIGFwcGVuZCA9IF9jdXJyeTIoZnVuY3Rpb24gYXBwZW5kKGVsLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBfY29uY2F0KGxpc3QsIFtlbF0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyBmdW5jdGlvbiBgZm5gIHRvIHRoZSBhcmd1bWVudCBsaXN0IGBhcmdzYC4gVGhpcyBpcyB1c2VmdWwgZm9yXG4gICAgICogY3JlYXRpbmcgYSBmaXhlZC1hcml0eSBmdW5jdGlvbiBmcm9tIGEgdmFyaWFkaWMgZnVuY3Rpb24uIGBmbmAgc2hvdWxkXG4gICAgICogYmUgYSBib3VuZCBmdW5jdGlvbiBpZiBjb250ZXh0IGlzIHNpZ25pZmljYW50LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKCouLi4gLT4gYSkgLT4gWypdIC0+IGFcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFyZ3NcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBzZWUgUi5jYWxsLCBSLnVuYXBwbHlcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbnVtcyA9IFsxLCAyLCAzLCAtOTksIDQyLCA2LCA3XTtcbiAgICAgKiAgICAgIFIuYXBwbHkoTWF0aC5tYXgsIG51bXMpOyAvLz0+IDQyXG4gICAgICovXG4gICAgdmFyIGFwcGx5ID0gX2N1cnJ5MihmdW5jdGlvbiBhcHBseShmbiwgYXJncykge1xuICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJncyk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBNYWtlcyBhIHNoYWxsb3cgY2xvbmUgb2YgYW4gb2JqZWN0LCBzZXR0aW5nIG9yIG92ZXJyaWRpbmcgdGhlIHNwZWNpZmllZFxuICAgICAqIHByb3BlcnR5IHdpdGggdGhlIGdpdmVuIHZhbHVlLiAgTm90ZSB0aGF0IHRoaXMgY29waWVzIGFuZCBmbGF0dGVuc1xuICAgICAqIHByb3RvdHlwZSBwcm9wZXJ0aWVzIG9udG8gdGhlIG5ldyBvYmplY3QgYXMgd2VsbC4gIEFsbCBub24tcHJpbWl0aXZlXG4gICAgICogcHJvcGVydGllcyBhcmUgY29waWVkIGJ5IHJlZmVyZW5jZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBTdHJpbmcgLT4gYSAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHByb3AgdGhlIHByb3BlcnR5IG5hbWUgdG8gc2V0XG4gICAgICogQHBhcmFtIHsqfSB2YWwgdGhlIG5ldyB2YWx1ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogdGhlIG9iamVjdCB0byBjbG9uZVxuICAgICAqIEByZXR1cm4ge09iamVjdH0gYSBuZXcgb2JqZWN0IHNpbWlsYXIgdG8gdGhlIG9yaWdpbmFsIGV4Y2VwdCBmb3IgdGhlIHNwZWNpZmllZCBwcm9wZXJ0eS5cbiAgICAgKiBAc2VlIFIuZGlzc29jXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5hc3NvYygnYycsIDMsIHthOiAxLCBiOiAyfSk7IC8vPT4ge2E6IDEsIGI6IDIsIGM6IDN9XG4gICAgICovXG4gICAgdmFyIGFzc29jID0gX2N1cnJ5MyhmdW5jdGlvbiBhc3NvYyhwcm9wLCB2YWwsIG9iaikge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIGZvciAodmFyIHAgaW4gb2JqKSB7XG4gICAgICAgICAgICByZXN1bHRbcF0gPSBvYmpbcF07XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0W3Byb3BdID0gdmFsO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogTWFrZXMgYSBzaGFsbG93IGNsb25lIG9mIGFuIG9iamVjdCwgc2V0dGluZyBvciBvdmVycmlkaW5nIHRoZSBub2Rlc1xuICAgICAqIHJlcXVpcmVkIHRvIGNyZWF0ZSB0aGUgZ2l2ZW4gcGF0aCwgYW5kIHBsYWNpbmcgdGhlIHNwZWNpZmljIHZhbHVlIGF0IHRoZVxuICAgICAqIHRhaWwgZW5kIG9mIHRoYXQgcGF0aC4gIE5vdGUgdGhhdCB0aGlzIGNvcGllcyBhbmQgZmxhdHRlbnMgcHJvdG90eXBlXG4gICAgICogcHJvcGVydGllcyBvbnRvIHRoZSBuZXcgb2JqZWN0IGFzIHdlbGwuICBBbGwgbm9uLXByaW1pdGl2ZSBwcm9wZXJ0aWVzXG4gICAgICogYXJlIGNvcGllZCBieSByZWZlcmVuY2UuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgW1N0cmluZ10gLT4gYSAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtBcnJheX0gcGF0aCB0aGUgcGF0aCB0byBzZXRcbiAgICAgKiBAcGFyYW0geyp9IHZhbCB0aGUgbmV3IHZhbHVlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiB0aGUgb2JqZWN0IHRvIGNsb25lXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBhIG5ldyBvYmplY3Qgc2ltaWxhciB0byB0aGUgb3JpZ2luYWwgZXhjZXB0IGFsb25nIHRoZSBzcGVjaWZpZWQgcGF0aC5cbiAgICAgKiBAc2VlIFIuZGlzc29jUGF0aFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuYXNzb2NQYXRoKFsnYScsICdiJywgJ2MnXSwgNDIsIHthOiB7Yjoge2M6IDB9fX0pOyAvLz0+IHthOiB7Yjoge2M6IDQyfX19XG4gICAgICovXG4gICAgdmFyIGFzc29jUGF0aCA9IF9jdXJyeTMoZnVuY3Rpb24gYXNzb2NQYXRoKHBhdGgsIHZhbCwgb2JqKSB7XG4gICAgICAgIHN3aXRjaCAocGF0aC5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGFzc29jKHBhdGhbMF0sIHZhbCwgb2JqKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBhc3NvYyhwYXRoWzBdLCBhc3NvY1BhdGgoX3NsaWNlKHBhdGgsIDEpLCB2YWwsIE9iamVjdChvYmpbcGF0aFswXV0pKSwgb2JqKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaXMgYm91bmQgdG8gYSBjb250ZXh0LlxuICAgICAqIE5vdGU6IGBSLmJpbmRgIGRvZXMgbm90IHByb3ZpZGUgdGhlIGFkZGl0aW9uYWwgYXJndW1lbnQtYmluZGluZyBjYXBhYmlsaXRpZXMgb2ZcbiAgICAgKiBbRnVuY3Rpb24ucHJvdG90eXBlLmJpbmRdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Z1bmN0aW9uL2JpbmQpLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2VlIFIucGFydGlhbFxuICAgICAqIEBzaWcgKCogLT4gKikgLT4geyp9IC0+ICgqIC0+ICopXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGJpbmQgdG8gY29udGV4dFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0aGlzT2JqIFRoZSBjb250ZXh0IHRvIGJpbmQgYGZuYCB0b1xuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIGZ1bmN0aW9uIHRoYXQgd2lsbCBleGVjdXRlIGluIHRoZSBjb250ZXh0IG9mIGB0aGlzT2JqYC5cbiAgICAgKi9cbiAgICB2YXIgYmluZCA9IF9jdXJyeTIoZnVuY3Rpb24gYmluZChmbiwgdGhpc09iaikge1xuICAgICAgICByZXR1cm4gX2FyaXR5KGZuLmxlbmd0aCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXNPYmosIGFyZ3VtZW50cyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB3cmFwcGluZyBjYWxscyB0byB0aGUgdHdvIGZ1bmN0aW9ucyBpbiBhbiBgJiZgIG9wZXJhdGlvbiwgcmV0dXJuaW5nIHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0XG4gICAgICogZnVuY3Rpb24gaWYgaXQgaXMgZmFsc2UteSBhbmQgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kIGZ1bmN0aW9uIG90aGVyd2lzZS4gIE5vdGUgdGhhdCB0aGlzIGlzXG4gICAgICogc2hvcnQtY2lyY3VpdGVkLCBtZWFuaW5nIHRoYXQgdGhlIHNlY29uZCBmdW5jdGlvbiB3aWxsIG5vdCBiZSBpbnZva2VkIGlmIHRoZSBmaXJzdCByZXR1cm5zIGEgZmFsc2UteVxuICAgICAqIHZhbHVlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgKCouLi4gLT4gQm9vbGVhbikgLT4gKCouLi4gLT4gQm9vbGVhbikgLT4gKCouLi4gLT4gQm9vbGVhbilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmIGEgcHJlZGljYXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZyBhbm90aGVyIHByZWRpY2F0ZVxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBhIGZ1bmN0aW9uIHRoYXQgYXBwbGllcyBpdHMgYXJndW1lbnRzIHRvIGBmYCBhbmQgYGdgIGFuZCBgJiZgcyB0aGVpciBvdXRwdXRzIHRvZ2V0aGVyLlxuICAgICAqIEBzZWUgUi5hbmRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZ3QxMCA9IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHggPiAxMDsgfTtcbiAgICAgKiAgICAgIHZhciBldmVuID0gZnVuY3Rpb24oeCkgeyByZXR1cm4geCAlIDIgPT09IDAgfTtcbiAgICAgKiAgICAgIHZhciBmID0gUi5ib3RoKGd0MTAsIGV2ZW4pO1xuICAgICAqICAgICAgZigxMDApOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIGYoMTAxKTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBib3RoID0gX2N1cnJ5MihmdW5jdGlvbiBib3RoKGYsIGcpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9ib3RoKCkge1xuICAgICAgICAgICAgcmV0dXJuIGYuYXBwbHkodGhpcywgYXJndW1lbnRzKSAmJiBnLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBNYWtlcyBhIGNvbXBhcmF0b3IgZnVuY3Rpb24gb3V0IG9mIGEgZnVuY3Rpb24gdGhhdCByZXBvcnRzIHdoZXRoZXIgdGhlIGZpcnN0IGVsZW1lbnQgaXMgbGVzcyB0aGFuIHRoZSBzZWNvbmQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoYSwgYiAtPiBCb29sZWFuKSAtPiAoYSwgYiAtPiBOdW1iZXIpXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSBmdW5jdGlvbiBvZiBhcml0eSB0d28uXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgRnVuY3Rpb24gOjogYSAtPiBiIC0+IEludCB0aGF0IHJldHVybnMgYC0xYCBpZiBhIDwgYiwgYDFgIGlmIGIgPCBhLCBvdGhlcndpc2UgYDBgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBjbXAgPSBSLmNvbXBhcmF0b3IoZnVuY3Rpb24oYSwgYikge1xuICAgICAqICAgICAgICByZXR1cm4gYS5hZ2UgPCBiLmFnZTtcbiAgICAgKiAgICAgIH0pO1xuICAgICAqICAgICAgdmFyIHBlb3BsZSA9IFtcbiAgICAgKiAgICAgICAgLy8gLi4uXG4gICAgICogICAgICBdO1xuICAgICAqICAgICAgUi5zb3J0KGNtcCwgcGVvcGxlKTtcbiAgICAgKi9cbiAgICB2YXIgY29tcGFyYXRvciA9IF9jdXJyeTEoZnVuY3Rpb24gY29tcGFyYXRvcihwcmVkKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIHByZWQoYSwgYikgPyAtMSA6IHByZWQoYiwgYSkgPyAxIDogMDtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRha2VzIGEgZnVuY3Rpb24gYGZgIGFuZCByZXR1cm5zIGEgZnVuY3Rpb24gYGdgIHN1Y2ggdGhhdDpcbiAgICAgKlxuICAgICAqICAgLSBhcHBseWluZyBgZ2AgdG8gemVybyBvciBtb3JlIGFyZ3VtZW50cyB3aWxsIGdpdmUgX190cnVlX18gaWYgYXBwbHlpbmdcbiAgICAgKiAgICAgdGhlIHNhbWUgYXJndW1lbnRzIHRvIGBmYCBnaXZlcyBhIGxvZ2ljYWwgX19mYWxzZV9fIHZhbHVlOyBhbmRcbiAgICAgKlxuICAgICAqICAgLSBhcHBseWluZyBgZ2AgdG8gemVybyBvciBtb3JlIGFyZ3VtZW50cyB3aWxsIGdpdmUgX19mYWxzZV9fIGlmIGFwcGx5aW5nXG4gICAgICogICAgIHRoZSBzYW1lIGFyZ3VtZW50cyB0byBgZmAgZ2l2ZXMgYSBsb2dpY2FsIF9fdHJ1ZV9fIHZhbHVlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgKCouLi4gLT4gKikgLT4gKCouLi4gLT4gQm9vbGVhbilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQHNlZSBSLm5vdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpc0V2ZW4gPSBmdW5jdGlvbihuKSB7IHJldHVybiBuICUgMiA9PT0gMDsgfTtcbiAgICAgKiAgICAgIHZhciBpc09kZCA9IFIuY29tcGxlbWVudChpc0V2ZW4pO1xuICAgICAqICAgICAgaXNPZGQoMjEpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIGlzT2RkKDQyKTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBjb21wbGVtZW50ID0gX2N1cnJ5MShfY29tcGxlbWVudCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24sIGBmbmAsIHdoaWNoIGVuY2Fwc3VsYXRlcyBpZi9lbHNlLWlmL2Vsc2UgbG9naWMuXG4gICAgICogYFIuY29uZGAgdGFrZXMgYSBsaXN0IG9mIFtwcmVkaWNhdGUsIHRyYW5zZm9ybV0gcGFpcnMuIEFsbCBvZiB0aGVcbiAgICAgKiBhcmd1bWVudHMgdG8gYGZuYCBhcmUgYXBwbGllZCB0byBlYWNoIG9mIHRoZSBwcmVkaWNhdGVzIGluIHR1cm5cbiAgICAgKiB1bnRpbCBvbmUgcmV0dXJucyBhIFwidHJ1dGh5XCIgdmFsdWUsIGF0IHdoaWNoIHBvaW50IGBmbmAgcmV0dXJucyB0aGVcbiAgICAgKiByZXN1bHQgb2YgYXBwbHlpbmcgaXRzIGFyZ3VtZW50cyB0byB0aGUgY29ycmVzcG9uZGluZyB0cmFuc2Zvcm1lci5cbiAgICAgKiBJZiBub25lIG9mIHRoZSBwcmVkaWNhdGVzIG1hdGNoZXMsIGBmbmAgcmV0dXJucyB1bmRlZmluZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExvZ2ljXG4gICAgICogQHNpZyBbWygqLi4uIC0+IEJvb2xlYW4pLCgqLi4uIC0+ICopXV0gLT4gKCouLi4gLT4gKilcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYWlyc1xuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBmbiA9IFIuY29uZChbXG4gICAgICogICAgICAgIFtSLmVxdWFscygwKSwgICBSLmFsd2F5cygnd2F0ZXIgZnJlZXplcyBhdCAwwrBDJyldLFxuICAgICAqICAgICAgICBbUi5lcXVhbHMoMTAwKSwgUi5hbHdheXMoJ3dhdGVyIGJvaWxzIGF0IDEwMMKwQycpXSxcbiAgICAgKiAgICAgICAgW1IuVCwgICAgICAgICAgIGZ1bmN0aW9uKHRlbXApIHsgcmV0dXJuICdub3RoaW5nIHNwZWNpYWwgaGFwcGVucyBhdCAnICsgdGVtcCArICfCsEMnOyB9XVxuICAgICAqICAgICAgXSk7XG4gICAgICogICAgICBmbigwKTsgLy89PiAnd2F0ZXIgZnJlZXplcyBhdCAwwrBDJ1xuICAgICAqICAgICAgZm4oNTApOyAvLz0+ICdub3RoaW5nIHNwZWNpYWwgaGFwcGVucyBhdCA1MMKwQydcbiAgICAgKiAgICAgIGZuKDEwMCk7IC8vPT4gJ3dhdGVyIGJvaWxzIGF0IDEwMMKwQydcbiAgICAgKi9cbiAgICB2YXIgY29uZCA9IF9jdXJyeTEoZnVuY3Rpb24gY29uZChwYWlycykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoaWR4IDwgcGFpcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhaXJzW2lkeF1bMF0uYXBwbHkodGhpcywgYXJndW1lbnRzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFpcnNbaWR4XVsxXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBgeGAgaXMgZm91bmQgaW4gdGhlIGBsaXN0YCwgdXNpbmcgYHByZWRgIGFzIGFuXG4gICAgICogZXF1YWxpdHkgcHJlZGljYXRlIGZvciBgeGAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhLCBhIC0+IEJvb2xlYW4pIC0+IGEgLT4gW2FdIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkIEEgcHJlZGljYXRlIHVzZWQgdG8gdGVzdCB3aGV0aGVyIHR3byBpdGVtcyBhcmUgZXF1YWwuXG4gICAgICogQHBhcmFtIHsqfSB4IFRoZSBpdGVtIHRvIGZpbmRcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIGl0ZXJhdGUgb3ZlclxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBgeGAgaXMgaW4gYGxpc3RgLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhzID0gW3t4OiAxMn0sIHt4OiAxMX0sIHt4OiAxMH1dO1xuICAgICAqICAgICAgUi5jb250YWluc1dpdGgoZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYS54ID09PSBiLng7IH0sIHt4OiAxMH0sIHhzKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmNvbnRhaW5zV2l0aChmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhLnggPT09IGIueDsgfSwge3g6IDF9LCB4cyk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgY29udGFpbnNXaXRoID0gX2N1cnJ5MyhfY29udGFpbnNXaXRoKTtcblxuICAgIC8qKlxuICAgICAqIENvdW50cyB0aGUgZWxlbWVudHMgb2YgYSBsaXN0IGFjY29yZGluZyB0byBob3cgbWFueSBtYXRjaCBlYWNoIHZhbHVlXG4gICAgICogb2YgYSBrZXkgZ2VuZXJhdGVkIGJ5IHRoZSBzdXBwbGllZCBmdW5jdGlvbi4gUmV0dXJucyBhbiBvYmplY3RcbiAgICAgKiBtYXBwaW5nIHRoZSBrZXlzIHByb2R1Y2VkIGJ5IGBmbmAgdG8gdGhlIG51bWJlciBvZiBvY2N1cnJlbmNlcyBpblxuICAgICAqIHRoZSBsaXN0LiBOb3RlIHRoYXQgYWxsIGtleXMgYXJlIGNvZXJjZWQgdG8gc3RyaW5ncyBiZWNhdXNlIG9mIGhvd1xuICAgICAqIEphdmFTY3JpcHQgb2JqZWN0cyB3b3JrLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgKGEgLT4gU3RyaW5nKSAtPiBbYV0gLT4geyp9XG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHVzZWQgdG8gbWFwIHZhbHVlcyB0byBrZXlzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gY291bnQgZWxlbWVudHMgZnJvbS5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEFuIG9iamVjdCBtYXBwaW5nIGtleXMgdG8gbnVtYmVyIG9mIG9jY3VycmVuY2VzIGluIHRoZSBsaXN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBudW1iZXJzID0gWzEuMCwgMS4xLCAxLjIsIDIuMCwgMy4wLCAyLjJdO1xuICAgICAqICAgICAgdmFyIGxldHRlcnMgPSBSLnNwbGl0KCcnLCAnYWJjQUJDYWFhQkJjJyk7XG4gICAgICogICAgICBSLmNvdW50QnkoTWF0aC5mbG9vcikobnVtYmVycyk7ICAgIC8vPT4geycxJzogMywgJzInOiAyLCAnMyc6IDF9XG4gICAgICogICAgICBSLmNvdW50QnkoUi50b0xvd2VyKShsZXR0ZXJzKTsgICAvLz0+IHsnYSc6IDUsICdiJzogNCwgJ2MnOiAzfVxuICAgICAqL1xuICAgIHZhciBjb3VudEJ5ID0gX2N1cnJ5MihmdW5jdGlvbiBjb3VudEJ5KGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBjb3VudHMgPSB7fTtcbiAgICAgICAgdmFyIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgdmFyIGtleSA9IGZuKGxpc3RbaWR4XSk7XG4gICAgICAgICAgICBjb3VudHNba2V5XSA9IChfaGFzKGtleSwgY291bnRzKSA/IGNvdW50c1trZXldIDogMCkgKyAxO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50cztcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgYSBzaW5nbGUga2V5OnZhbHVlIHBhaXIuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgU3RyaW5nIC0+IGEgLT4ge1N0cmluZzphfVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBrZXlcbiAgICAgKiBAcGFyYW0geyp9IHZhbFxuICAgICAqIEByZXR1cm4ge09iamVjdH1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbWF0Y2hQaHJhc2VzID0gUi5jb21wb3NlKFxuICAgICAqICAgICAgICBSLmNyZWF0ZU1hcEVudHJ5KCdtdXN0JyksXG4gICAgICogICAgICAgIFIubWFwKFIuY3JlYXRlTWFwRW50cnkoJ21hdGNoX3BocmFzZScpKVxuICAgICAqICAgICAgKTtcbiAgICAgKiAgICAgIG1hdGNoUGhyYXNlcyhbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IHttdXN0OiBbe21hdGNoX3BocmFzZTogJ2Zvbyd9LCB7bWF0Y2hfcGhyYXNlOiAnYmFyJ30sIHttYXRjaF9waHJhc2U6ICdiYXonfV19XG4gICAgICovXG4gICAgdmFyIGNyZWF0ZU1hcEVudHJ5ID0gX2N1cnJ5MihmdW5jdGlvbiBjcmVhdGVNYXBFbnRyeShrZXksIHZhbCkge1xuICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgIG9ialtrZXldID0gdmFsO1xuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGN1cnJpZWQgZXF1aXZhbGVudCBvZiB0aGUgcHJvdmlkZWQgZnVuY3Rpb24sIHdpdGggdGhlXG4gICAgICogc3BlY2lmaWVkIGFyaXR5LiBUaGUgY3VycmllZCBmdW5jdGlvbiBoYXMgdHdvIHVudXN1YWwgY2FwYWJpbGl0aWVzLlxuICAgICAqIEZpcnN0LCBpdHMgYXJndW1lbnRzIG5lZWRuJ3QgYmUgcHJvdmlkZWQgb25lIGF0IGEgdGltZS4gSWYgYGdgIGlzXG4gICAgICogYFIuY3VycnlOKDMsIGYpYCwgdGhlIGZvbGxvd2luZyBhcmUgZXF1aXZhbGVudDpcbiAgICAgKlxuICAgICAqICAgLSBgZygxKSgyKSgzKWBcbiAgICAgKiAgIC0gYGcoMSkoMiwgMylgXG4gICAgICogICAtIGBnKDEsIDIpKDMpYFxuICAgICAqICAgLSBgZygxLCAyLCAzKWBcbiAgICAgKlxuICAgICAqIFNlY29uZGx5LCB0aGUgc3BlY2lhbCBwbGFjZWhvbGRlciB2YWx1ZSBgUi5fX2AgbWF5IGJlIHVzZWQgdG8gc3BlY2lmeVxuICAgICAqIFwiZ2Fwc1wiLCBhbGxvd2luZyBwYXJ0aWFsIGFwcGxpY2F0aW9uIG9mIGFueSBjb21iaW5hdGlvbiBvZiBhcmd1bWVudHMsXG4gICAgICogcmVnYXJkbGVzcyBvZiB0aGVpciBwb3NpdGlvbnMuIElmIGBnYCBpcyBhcyBhYm92ZSBhbmQgYF9gIGlzIGBSLl9fYCxcbiAgICAgKiB0aGUgZm9sbG93aW5nIGFyZSBlcXVpdmFsZW50OlxuICAgICAqXG4gICAgICogICAtIGBnKDEsIDIsIDMpYFxuICAgICAqICAgLSBgZyhfLCAyLCAzKSgxKWBcbiAgICAgKiAgIC0gYGcoXywgXywgMykoMSkoMilgXG4gICAgICogICAtIGBnKF8sIF8sIDMpKDEsIDIpYFxuICAgICAqICAgLSBgZyhfLCAyKSgxKSgzKWBcbiAgICAgKiAgIC0gYGcoXywgMikoMSwgMylgXG4gICAgICogICAtIGBnKF8sIDIpKF8sIDMpKDEpYFxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgTnVtYmVyIC0+ICgqIC0+IGEpIC0+ICgqIC0+IGEpXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGxlbmd0aCBUaGUgYXJpdHkgZm9yIHRoZSByZXR1cm5lZCBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY3VycnkuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgbmV3LCBjdXJyaWVkIGZ1bmN0aW9uLlxuICAgICAqIEBzZWUgUi5jdXJyeVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBhZGRGb3VyTnVtYmVycyA9IGZ1bmN0aW9uKCkge1xuICAgICAqICAgICAgICByZXR1cm4gUi5zdW0oW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDAsIDQpKTtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIHZhciBjdXJyaWVkQWRkRm91ck51bWJlcnMgPSBSLmN1cnJ5Tig0LCBhZGRGb3VyTnVtYmVycyk7XG4gICAgICogICAgICB2YXIgZiA9IGN1cnJpZWRBZGRGb3VyTnVtYmVycygxLCAyKTtcbiAgICAgKiAgICAgIHZhciBnID0gZigzKTtcbiAgICAgKiAgICAgIGcoNCk7IC8vPT4gMTBcbiAgICAgKi9cbiAgICB2YXIgY3VycnlOID0gX2N1cnJ5MihmdW5jdGlvbiBjdXJyeU4obGVuZ3RoLCBmbikge1xuICAgICAgICBpZiAobGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gX2N1cnJ5MShmbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9hcml0eShsZW5ndGgsIF9jdXJyeU4obGVuZ3RoLCBbXSwgZm4pKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIERlY3JlbWVudHMgaXRzIGFyZ3VtZW50LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG5cbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICogQHNlZSBSLmluY1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZGVjKDQyKTsgLy89PiA0MVxuICAgICAqL1xuICAgIHZhciBkZWMgPSBhZGQoLTEpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgc2Vjb25kIGFyZ3VtZW50IGlmIGl0IGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZC4gSWYgaXQgaXMgbnVsbFxuICAgICAqIG9yIHVuZGVmaW5lZCwgdGhlIGZpcnN0IChkZWZhdWx0KSBhcmd1bWVudCBpcyByZXR1cm5lZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnIGEgLT4gYiAtPiBhIHwgYlxuICAgICAqIEBwYXJhbSB7YX0gdmFsIFRoZSBkZWZhdWx0IHZhbHVlLlxuICAgICAqIEBwYXJhbSB7Yn0gdmFsIFRoZSB2YWx1ZSB0byByZXR1cm4gaWYgaXQgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgICogQHJldHVybiB7Kn0gVGhlIHRoZSBzZWNvbmQgdmFsdWUgb3IgdGhlIGRlZmF1bHQgdmFsdWVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZGVmYXVsdFRvNDIgPSBkZWZhdWx0VG8oNDIpO1xuICAgICAqXG4gICAgICogICAgICBkZWZhdWx0VG80MihudWxsKTsgIC8vPT4gNDJcbiAgICAgKiAgICAgIGRlZmF1bHRUbzQyKHVuZGVmaW5lZCk7ICAvLz0+IDQyXG4gICAgICogICAgICBkZWZhdWx0VG80MignUmFtZGEnKTsgIC8vPT4gJ1JhbWRhJ1xuICAgICAqL1xuICAgIHZhciBkZWZhdWx0VG8gPSBfY3VycnkyKGZ1bmN0aW9uIGRlZmF1bHRUbyhkLCB2KSB7XG4gICAgICAgIHJldHVybiB2ID09IG51bGwgPyBkIDogdjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEZpbmRzIHRoZSBzZXQgKGkuZS4gbm8gZHVwbGljYXRlcykgb2YgYWxsIGVsZW1lbnRzIGluIHRoZSBmaXJzdCBsaXN0IG5vdCBjb250YWluZWQgaW4gdGhlIHNlY29uZCBsaXN0LlxuICAgICAqIER1cGxpY2F0aW9uIGlzIGRldGVybWluZWQgYWNjb3JkaW5nIHRvIHRoZSB2YWx1ZSByZXR1cm5lZCBieSBhcHBseWluZyB0aGUgc3VwcGxpZWQgcHJlZGljYXRlIHRvIHR3byBsaXN0XG4gICAgICogZWxlbWVudHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyAoYSxhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSB1c2VkIHRvIHRlc3Qgd2hldGhlciB0d28gaXRlbXMgYXJlIGVxdWFsLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QxIFRoZSBmaXJzdCBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QyIFRoZSBzZWNvbmQgbGlzdC5cbiAgICAgKiBAc2VlIFIuZGlmZmVyZW5jZVxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgZWxlbWVudHMgaW4gYGxpc3QxYCB0aGF0IGFyZSBub3QgaW4gYGxpc3QyYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBmdW5jdGlvbiBjbXAoeCwgeSkgeyByZXR1cm4geC5hID09PSB5LmE7IH1cbiAgICAgKiAgICAgIHZhciBsMSA9IFt7YTogMX0sIHthOiAyfSwge2E6IDN9XTtcbiAgICAgKiAgICAgIHZhciBsMiA9IFt7YTogM30sIHthOiA0fV07XG4gICAgICogICAgICBSLmRpZmZlcmVuY2VXaXRoKGNtcCwgbDEsIGwyKTsgLy89PiBbe2E6IDF9LCB7YTogMn1dXG4gICAgICovXG4gICAgdmFyIGRpZmZlcmVuY2VXaXRoID0gX2N1cnJ5MyhmdW5jdGlvbiBkaWZmZXJlbmNlV2l0aChwcmVkLCBmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBmaXJzdExlbiA9IGZpcnN0Lmxlbmd0aDtcbiAgICAgICAgdmFyIGNvbnRhaW5zUHJlZCA9IGNvbnRhaW5zV2l0aChwcmVkKTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGZpcnN0TGVuKSB7XG4gICAgICAgICAgICBpZiAoIWNvbnRhaW5zUHJlZChmaXJzdFtpZHhdLCBzZWNvbmQpICYmICFjb250YWluc1ByZWQoZmlyc3RbaWR4XSwgb3V0KSkge1xuICAgICAgICAgICAgICAgIG91dFtvdXQubGVuZ3RoXSA9IGZpcnN0W2lkeF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBvYmplY3QgdGhhdCBkb2VzIG5vdCBjb250YWluIGEgYHByb3BgIHByb3BlcnR5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIFN0cmluZyAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHByb3AgdGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHRvIGRpc3NvY2lhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIHRoZSBvYmplY3QgdG8gY2xvbmVcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGEgbmV3IG9iamVjdCBzaW1pbGFyIHRvIHRoZSBvcmlnaW5hbCBidXQgd2l0aG91dCB0aGUgc3BlY2lmaWVkIHByb3BlcnR5XG4gICAgICogQHNlZSBSLmFzc29jXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5kaXNzb2MoJ2InLCB7YTogMSwgYjogMiwgYzogM30pOyAvLz0+IHthOiAxLCBjOiAzfVxuICAgICAqL1xuICAgIHZhciBkaXNzb2MgPSBfY3VycnkyKGZ1bmN0aW9uIGRpc3NvYyhwcm9wLCBvYmopIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBwIGluIG9iaikge1xuICAgICAgICAgICAgaWYgKHAgIT09IHByb3ApIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbcF0gPSBvYmpbcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIE1ha2VzIGEgc2hhbGxvdyBjbG9uZSBvZiBhbiBvYmplY3QsIG9taXR0aW5nIHRoZSBwcm9wZXJ0eSBhdCB0aGVcbiAgICAgKiBnaXZlbiBwYXRoLiBOb3RlIHRoYXQgdGhpcyBjb3BpZXMgYW5kIGZsYXR0ZW5zIHByb3RvdHlwZSBwcm9wZXJ0aWVzXG4gICAgICogb250byB0aGUgbmV3IG9iamVjdCBhcyB3ZWxsLiAgQWxsIG5vbi1wcmltaXRpdmUgcHJvcGVydGllcyBhcmUgY29waWVkXG4gICAgICogYnkgcmVmZXJlbmNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIFtTdHJpbmddIC0+IHtrOiB2fSAtPiB7azogdn1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYXRoIHRoZSBwYXRoIHRvIHNldFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogdGhlIG9iamVjdCB0byBjbG9uZVxuICAgICAqIEByZXR1cm4ge09iamVjdH0gYSBuZXcgb2JqZWN0IHdpdGhvdXQgdGhlIHByb3BlcnR5IGF0IHBhdGhcbiAgICAgKiBAc2VlIFIuYXNzb2NQYXRoXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5kaXNzb2NQYXRoKFsnYScsICdiJywgJ2MnXSwge2E6IHtiOiB7YzogNDJ9fX0pOyAvLz0+IHthOiB7Yjoge319fVxuICAgICAqL1xuICAgIHZhciBkaXNzb2NQYXRoID0gX2N1cnJ5MihmdW5jdGlvbiBkaXNzb2NQYXRoKHBhdGgsIG9iaikge1xuICAgICAgICBzd2l0Y2ggKHBhdGgubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBkaXNzb2MocGF0aFswXSwgb2JqKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHZhciBoZWFkID0gcGF0aFswXTtcbiAgICAgICAgICAgIHZhciB0YWlsID0gX3NsaWNlKHBhdGgsIDEpO1xuICAgICAgICAgICAgcmV0dXJuIG9ialtoZWFkXSA9PSBudWxsID8gb2JqIDogYXNzb2MoaGVhZCwgZGlzc29jUGF0aCh0YWlsLCBvYmpbaGVhZF0pLCBvYmopO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBEaXZpZGVzIHR3byBudW1iZXJzLiBFcXVpdmFsZW50IHRvIGBhIC8gYmAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXIgLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGEgVGhlIGZpcnN0IHZhbHVlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBiIFRoZSBzZWNvbmQgdmFsdWUuXG4gICAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgcmVzdWx0IG9mIGBhIC8gYmAuXG4gICAgICogQHNlZSBSLm11bHRpcGx5XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5kaXZpZGUoNzEsIDEwMCk7IC8vPT4gMC43MVxuICAgICAqXG4gICAgICogICAgICB2YXIgaGFsZiA9IFIuZGl2aWRlKFIuX18sIDIpO1xuICAgICAqICAgICAgaGFsZig0Mik7IC8vPT4gMjFcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHJlY2lwcm9jYWwgPSBSLmRpdmlkZSgxKTtcbiAgICAgKiAgICAgIHJlY2lwcm9jYWwoNCk7ICAgLy89PiAwLjI1XG4gICAgICovXG4gICAgdmFyIGRpdmlkZSA9IF9jdXJyeTIoZnVuY3Rpb24gZGl2aWRlKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgLyBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IGNvbnRhaW5pbmcgYWxsIGJ1dCBsYXN0IHRoZWBuYCBlbGVtZW50cyBvZiBhIGdpdmVuIGxpc3QsXG4gICAgICogcGFzc2luZyBlYWNoIHZhbHVlIGZyb20gdGhlIHJpZ2h0IHRvIHRoZSBzdXBwbGllZCBwcmVkaWNhdGUgZnVuY3Rpb24sIHNraXBwaW5nXG4gICAgICogZWxlbWVudHMgd2hpbGUgdGhlIHByZWRpY2F0ZSBmdW5jdGlvbiByZXR1cm5zIGB0cnVlYC4gVGhlIHByZWRpY2F0ZSBmdW5jdGlvblxuICAgICAqIGlzIHBhc3NlZCBvbmUgYXJndW1lbnQ6ICh2YWx1ZSkqLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBhcnJheS5cbiAgICAgKiBAc2VlIFIudGFrZUxhc3RXaGlsZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBsdGVUaHJlZSA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIHggPD0gMztcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIFIuZHJvcExhc3RXaGlsZShsdGVUaHJlZSwgWzEsIDIsIDMsIDQsIDMsIDIsIDFdKTsgLy89PiBbMSwgMl1cbiAgICAgKi9cbiAgICB2YXIgZHJvcExhc3RXaGlsZSA9IF9jdXJyeTIoZnVuY3Rpb24gZHJvcExhc3RXaGlsZShwcmVkLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgIHdoaWxlIChpZHggPj0gMCAmJiBwcmVkKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgIGlkeCAtPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc2xpY2UobGlzdCwgMCwgaWR4ICsgMSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHdyYXBwaW5nIGNhbGxzIHRvIHRoZSB0d28gZnVuY3Rpb25zIGluIGFuIGB8fGAgb3BlcmF0aW9uLCByZXR1cm5pbmcgdGhlIHJlc3VsdCBvZiB0aGUgZmlyc3RcbiAgICAgKiBmdW5jdGlvbiBpZiBpdCBpcyB0cnV0aC15IGFuZCB0aGUgcmVzdWx0IG9mIHRoZSBzZWNvbmQgZnVuY3Rpb24gb3RoZXJ3aXNlLiAgTm90ZSB0aGF0IHRoaXMgaXNcbiAgICAgKiBzaG9ydC1jaXJjdWl0ZWQsIG1lYW5pbmcgdGhhdCB0aGUgc2Vjb25kIGZ1bmN0aW9uIHdpbGwgbm90IGJlIGludm9rZWQgaWYgdGhlIGZpcnN0IHJldHVybnMgYSB0cnV0aC15XG4gICAgICogdmFsdWUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExvZ2ljXG4gICAgICogQHNpZyAoKi4uLiAtPiBCb29sZWFuKSAtPiAoKi4uLiAtPiBCb29sZWFuKSAtPiAoKi4uLiAtPiBCb29sZWFuKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGYgYSBwcmVkaWNhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBnIGFub3RoZXIgcHJlZGljYXRlXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IGEgZnVuY3Rpb24gdGhhdCBhcHBsaWVzIGl0cyBhcmd1bWVudHMgdG8gYGZgIGFuZCBgZ2AgYW5kIGB8fGBzIHRoZWlyIG91dHB1dHMgdG9nZXRoZXIuXG4gICAgICogQHNlZSBSLm9yXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGd0MTAgPSBmdW5jdGlvbih4KSB7IHJldHVybiB4ID4gMTA7IH07XG4gICAgICogICAgICB2YXIgZXZlbiA9IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHggJSAyID09PSAwIH07XG4gICAgICogICAgICB2YXIgZiA9IFIuZWl0aGVyKGd0MTAsIGV2ZW4pO1xuICAgICAqICAgICAgZigxMDEpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIGYoOCk7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBlaXRoZXIgPSBfY3VycnkyKGZ1bmN0aW9uIGVpdGhlcihmLCBnKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfZWl0aGVyKCkge1xuICAgICAgICAgICAgcmV0dXJuIGYuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCBnLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBlbXB0eSB2YWx1ZSBvZiBpdHMgYXJndW1lbnQncyB0eXBlLiBSYW1kYSBkZWZpbmVzIHRoZSBlbXB0eVxuICAgICAqIHZhbHVlIG9mIEFycmF5IChgW11gKSwgT2JqZWN0IChge31gKSwgYW5kIFN0cmluZyAoYCcnYCkuIE90aGVyIHR5cGVzIGFyZVxuICAgICAqIHN1cHBvcnRlZCBpZiB0aGV5IGRlZmluZSBgPFR5cGU+LmVtcHR5YCBhbmQvb3IgYDxUeXBlPi5wcm90b3R5cGUuZW1wdHlgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgYSAtPiBhXG4gICAgICogQHBhcmFtIHsqfSB4XG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmVtcHR5KEp1c3QoNDIpKTsgICAgICAvLz0+IE5vdGhpbmcoKVxuICAgICAqICAgICAgUi5lbXB0eShbMSwgMiwgM10pOyAgICAgLy89PiBbXVxuICAgICAqICAgICAgUi5lbXB0eSgndW5pY29ybnMnKTsgICAgLy89PiAnJ1xuICAgICAqICAgICAgUi5lbXB0eSh7eDogMSwgeTogMn0pOyAgLy89PiB7fVxuICAgICAqL1xuICAgIHZhciBlbXB0eSA9IF9jdXJyeTEoZnVuY3Rpb24gZW1wdHkoeCkge1xuICAgICAgICBpZiAoeCAhPSBudWxsICYmIHR5cGVvZiB4LmVtcHR5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4geC5lbXB0eSgpO1xuICAgICAgICB9IGVsc2UgaWYgKHggIT0gbnVsbCAmJiB0eXBlb2YgeC5jb25zdHJ1Y3RvciAhPSBudWxsICYmIHR5cGVvZiB4LmNvbnN0cnVjdG9yLmVtcHR5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICByZXR1cm4geC5jb25zdHJ1Y3Rvci5lbXB0eSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3dpdGNoIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeCkpIHtcbiAgICAgICAgICAgIGNhc2UgJ1tvYmplY3QgQXJyYXldJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICBjYXNlICdbb2JqZWN0IE9iamVjdF0nOlxuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIGNhc2UgJ1tvYmplY3QgU3RyaW5nXSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IG9iamVjdCBieSByZWN1cnNpdmVseSBldm9sdmluZyBhIHNoYWxsb3cgY29weSBvZiBgb2JqZWN0YCwgYWNjb3JkaW5nIHRvIHRoZVxuICAgICAqIGB0cmFuc2Zvcm1hdGlvbmAgZnVuY3Rpb25zLiBBbGwgbm9uLXByaW1pdGl2ZSBwcm9wZXJ0aWVzIGFyZSBjb3BpZWQgYnkgcmVmZXJlbmNlLlxuICAgICAqXG4gICAgICogQSBgdHJhbmZvcm1hdGlvbmAgZnVuY3Rpb24gd2lsbCBub3QgYmUgaW52b2tlZCBpZiBpdHMgY29ycmVzcG9uZGluZyBrZXkgZG9lcyBub3QgZXhpc3QgaW5cbiAgICAgKiB0aGUgZXZvbHZlZCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge2s6ICh2IC0+IHYpfSAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtPYmplY3R9IHRyYW5zZm9ybWF0aW9ucyBUaGUgb2JqZWN0IHNwZWNpZnlpbmcgdHJhbnNmb3JtYXRpb24gZnVuY3Rpb25zIHRvIGFwcGx5XG4gICAgICogICAgICAgIHRvIHRoZSBvYmplY3QuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGJlIHRyYW5zZm9ybWVkLlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gVGhlIHRyYW5zZm9ybWVkIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgdG9tYXRvICA9IHtmaXJzdE5hbWU6ICcgIFRvbWF0byAnLCBkYXRhOiB7ZWxhcHNlZDogMTAwLCByZW1haW5pbmc6IDE0MDB9LCBpZDoxMjN9O1xuICAgICAqICAgICAgdmFyIHRyYW5zZm9ybWF0aW9ucyA9IHtcbiAgICAgKiAgICAgICAgZmlyc3ROYW1lOiBSLnRyaW0sXG4gICAgICogICAgICAgIGxhc3ROYW1lOiBSLnRyaW0sIC8vIFdpbGwgbm90IGdldCBpbnZva2VkLlxuICAgICAqICAgICAgICBkYXRhOiB7ZWxhcHNlZDogUi5hZGQoMSksIHJlbWFpbmluZzogUi5hZGQoLTEpfVxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIFIuZXZvbHZlKHRyYW5zZm9ybWF0aW9ucywgdG9tYXRvKTsgLy89PiB7Zmlyc3ROYW1lOiAnVG9tYXRvJywgZGF0YToge2VsYXBzZWQ6IDEwMSwgcmVtYWluaW5nOiAxMzk5fSwgaWQ6MTIzfVxuICAgICAqL1xuICAgIHZhciBldm9sdmUgPSBfY3VycnkyKGZ1bmN0aW9uIGV2b2x2ZSh0cmFuc2Zvcm1hdGlvbnMsIG9iamVjdCkge1xuICAgICAgICB2YXIgdHJhbnNmb3JtYXRpb24sIGtleSwgdHlwZSwgcmVzdWx0ID0ge307XG4gICAgICAgIGZvciAoa2V5IGluIG9iamVjdCkge1xuICAgICAgICAgICAgdHJhbnNmb3JtYXRpb24gPSB0cmFuc2Zvcm1hdGlvbnNba2V5XTtcbiAgICAgICAgICAgIHR5cGUgPSB0eXBlb2YgdHJhbnNmb3JtYXRpb247XG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IHR5cGUgPT09ICdmdW5jdGlvbicgPyB0cmFuc2Zvcm1hdGlvbihvYmplY3Rba2V5XSkgOiB0eXBlID09PSAnb2JqZWN0JyA/IGV2b2x2ZSh0cmFuc2Zvcm1hdGlvbnNba2V5XSwgb2JqZWN0W2tleV0pIDogb2JqZWN0W2tleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgb2JqZWN0IG91dCBvZiBhIGxpc3Qga2V5LXZhbHVlIHBhaXJzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbW2ssdl1dIC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhaXJzIEFuIGFycmF5IG9mIHR3by1lbGVtZW50IGFycmF5cyB0aGF0IHdpbGwgYmUgdGhlIGtleXMgYW5kIHZhbHVlcyBvZiB0aGUgb3V0cHV0IG9iamVjdC5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBvYmplY3QgbWFkZSBieSBwYWlyaW5nIHVwIGBrZXlzYCBhbmQgYHZhbHVlc2AuXG4gICAgICogQHNlZSBSLnRvUGFpcnNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmZyb21QYWlycyhbWydhJywgMV0sIFsnYicsIDJdLCAgWydjJywgM11dKTsgLy89PiB7YTogMSwgYjogMiwgYzogM31cbiAgICAgKi9cbiAgICB2YXIgZnJvbVBhaXJzID0gX2N1cnJ5MShmdW5jdGlvbiBmcm9tUGFpcnMocGFpcnMpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGxlbiA9IHBhaXJzLmxlbmd0aCwgb3V0ID0ge307XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChfaXNBcnJheShwYWlyc1tpZHhdKSAmJiBwYWlyc1tpZHhdLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIG91dFtwYWlyc1tpZHhdWzBdXSA9IHBhaXJzW2lkeF1bMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzIGdyZWF0ZXIgdGhhbiB0aGUgc2Vjb25kO1xuICAgICAqIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgT3JkIGEgPT4gYSAtPiBhIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0geyp9IGFcbiAgICAgKiBAcGFyYW0geyp9IGJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBzZWUgUi5sdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZ3QoMiwgMSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5ndCgyLCAyKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5ndCgyLCAzKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5ndCgnYScsICd6Jyk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuZ3QoJ3onLCAnYScpOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgZ3QgPSBfY3VycnkyKGZ1bmN0aW9uIGd0KGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgPiBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGUgc2Vjb25kO1xuICAgICAqIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgT3JkIGEgPT4gYSAtPiBhIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBiXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiBAc2VlIFIubHRlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5ndGUoMiwgMSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5ndGUoMiwgMik7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5ndGUoMiwgMyk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuZ3RlKCdhJywgJ3onKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5ndGUoJ3onLCAnYScpOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgZ3RlID0gX2N1cnJ5MihmdW5jdGlvbiBndGUoYSwgYikge1xuICAgICAgICByZXR1cm4gYSA+PSBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCBhbiBvYmplY3QgaGFzIGFuIG93biBwcm9wZXJ0eSB3aXRoXG4gICAgICogdGhlIHNwZWNpZmllZCBuYW1lXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgcyAtPiB7czogeH0gLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byBjaGVjayBmb3IuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IFdoZXRoZXIgdGhlIHByb3BlcnR5IGV4aXN0cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaGFzTmFtZSA9IFIuaGFzKCduYW1lJyk7XG4gICAgICogICAgICBoYXNOYW1lKHtuYW1lOiAnYWxpY2UnfSk7ICAgLy89PiB0cnVlXG4gICAgICogICAgICBoYXNOYW1lKHtuYW1lOiAnYm9iJ30pOyAgICAgLy89PiB0cnVlXG4gICAgICogICAgICBoYXNOYW1lKHt9KTsgICAgICAgICAgICAgICAgLy89PiBmYWxzZVxuICAgICAqXG4gICAgICogICAgICB2YXIgcG9pbnQgPSB7eDogMCwgeTogMH07XG4gICAgICogICAgICB2YXIgcG9pbnRIYXMgPSBSLmhhcyhSLl9fLCBwb2ludCk7XG4gICAgICogICAgICBwb2ludEhhcygneCcpOyAgLy89PiB0cnVlXG4gICAgICogICAgICBwb2ludEhhcygneScpOyAgLy89PiB0cnVlXG4gICAgICogICAgICBwb2ludEhhcygneicpOyAgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBoYXMgPSBfY3VycnkyKF9oYXMpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIG9yIG5vdCBhbiBvYmplY3Qgb3IgaXRzIHByb3RvdHlwZSBjaGFpbiBoYXNcbiAgICAgKiBhIHByb3BlcnR5IHdpdGggdGhlIHNwZWNpZmllZCBuYW1lXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgcyAtPiB7czogeH0gLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byBjaGVjayBmb3IuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IFdoZXRoZXIgdGhlIHByb3BlcnR5IGV4aXN0cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBmdW5jdGlvbiBSZWN0YW5nbGUod2lkdGgsIGhlaWdodCkge1xuICAgICAqICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICogICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAqICAgICAgfVxuICAgICAqICAgICAgUmVjdGFuZ2xlLnByb3RvdHlwZS5hcmVhID0gZnVuY3Rpb24oKSB7XG4gICAgICogICAgICAgIHJldHVybiB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQ7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICB2YXIgc3F1YXJlID0gbmV3IFJlY3RhbmdsZSgyLCAyKTtcbiAgICAgKiAgICAgIFIuaGFzSW4oJ3dpZHRoJywgc3F1YXJlKTsgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5oYXNJbignYXJlYScsIHNxdWFyZSk7ICAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgaGFzSW4gPSBfY3VycnkyKGZ1bmN0aW9uIGhhc0luKHByb3AsIG9iaikge1xuICAgICAgICByZXR1cm4gcHJvcCBpbiBvYmo7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgaXRzIGFyZ3VtZW50cyBhcmUgaWRlbnRpY2FsLCBmYWxzZSBvdGhlcndpc2UuIFZhbHVlcyBhcmVcbiAgICAgKiBpZGVudGljYWwgaWYgdGhleSByZWZlcmVuY2UgdGhlIHNhbWUgbWVtb3J5LiBgTmFOYCBpcyBpZGVudGljYWwgdG8gYE5hTmA7XG4gICAgICogYDBgIGFuZCBgLTBgIGFyZSBub3QgaWRlbnRpY2FsLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgYSAtPiBhIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0geyp9IGFcbiAgICAgKiBAcGFyYW0geyp9IGJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBvID0ge307XG4gICAgICogICAgICBSLmlkZW50aWNhbChvLCBvKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlkZW50aWNhbCgxLCAxKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlkZW50aWNhbCgxLCAnMScpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlkZW50aWNhbChbXSwgW10pOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlkZW50aWNhbCgwLCAtMCk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuaWRlbnRpY2FsKE5hTiwgTmFOKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgLy8gU2FtZVZhbHVlIGFsZ29yaXRobVxuICAgIC8vIFN0ZXBzIDEtNSwgNy0xMFxuICAgIC8vIFN0ZXBzIDYuYi02LmU6ICswICE9IC0wXG4gICAgLy8gU3RlcCA2LmE6IE5hTiA9PSBOYU5cbiAgICB2YXIgaWRlbnRpY2FsID0gX2N1cnJ5MihmdW5jdGlvbiBpZGVudGljYWwoYSwgYikge1xuICAgICAgICAvLyBTYW1lVmFsdWUgYWxnb3JpdGhtXG4gICAgICAgIGlmIChhID09PSBiKSB7XG4gICAgICAgICAgICAvLyBTdGVwcyAxLTUsIDctMTBcbiAgICAgICAgICAgIC8vIFN0ZXBzIDYuYi02LmU6ICswICE9IC0wXG4gICAgICAgICAgICByZXR1cm4gYSAhPT0gMCB8fCAxIC8gYSA9PT0gMSAvIGI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBTdGVwIDYuYTogTmFOID09IE5hTlxuICAgICAgICAgICAgcmV0dXJuIGEgIT09IGEgJiYgYiAhPT0gYjtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0aGF0IGRvZXMgbm90aGluZyBidXQgcmV0dXJuIHRoZSBwYXJhbWV0ZXIgc3VwcGxpZWQgdG8gaXQuIEdvb2QgYXMgYSBkZWZhdWx0XG4gICAgICogb3IgcGxhY2Vob2xkZXIgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyBhIC0+IGFcbiAgICAgKiBAcGFyYW0geyp9IHggVGhlIHZhbHVlIHRvIHJldHVybi5cbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgaW5wdXQgdmFsdWUsIGB4YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmlkZW50aXR5KDEpOyAvLz0+IDFcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAqICAgICAgUi5pZGVudGl0eShvYmopID09PSBvYmo7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBpZGVudGl0eSA9IF9jdXJyeTEoX2lkZW50aXR5KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgcHJvY2VzcyBlaXRoZXIgdGhlIGBvblRydWVgIG9yIHRoZSBgb25GYWxzZWAgZnVuY3Rpb24gZGVwZW5kaW5nXG4gICAgICogdXBvbiB0aGUgcmVzdWx0IG9mIHRoZSBgY29uZGl0aW9uYCBwcmVkaWNhdGUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExvZ2ljXG4gICAgICogQHNpZyAoKi4uLiAtPiBCb29sZWFuKSAtPiAoKi4uLiAtPiAqKSAtPiAoKi4uLiAtPiAqKSAtPiAoKi4uLiAtPiAqKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbmRpdGlvbiBBIHByZWRpY2F0ZSBmdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uVHJ1ZSBBIGZ1bmN0aW9uIHRvIGludm9rZSB3aGVuIHRoZSBgY29uZGl0aW9uYCBldmFsdWF0ZXMgdG8gYSB0cnV0aHkgdmFsdWUuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25GYWxzZSBBIGZ1bmN0aW9uIHRvIGludm9rZSB3aGVuIHRoZSBgY29uZGl0aW9uYCBldmFsdWF0ZXMgdG8gYSBmYWxzeSB2YWx1ZS5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcgdW5hcnkgZnVuY3Rpb24gdGhhdCB3aWxsIHByb2Nlc3MgZWl0aGVyIHRoZSBgb25UcnVlYCBvciB0aGUgYG9uRmFsc2VgXG4gICAgICogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlcGVuZGluZyB1cG9uIHRoZSByZXN1bHQgb2YgdGhlIGBjb25kaXRpb25gIHByZWRpY2F0ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICAvLyBGbGF0dGVuIGFsbCBhcnJheXMgaW4gdGhlIGxpc3QgYnV0IGxlYXZlIG90aGVyIHZhbHVlcyBhbG9uZS5cbiAgICAgKiAgICAgIHZhciBmbGF0dGVuQXJyYXlzID0gUi5tYXAoUi5pZkVsc2UoQXJyYXkuaXNBcnJheSwgUi5mbGF0dGVuLCBSLmlkZW50aXR5KSk7XG4gICAgICpcbiAgICAgKiAgICAgIGZsYXR0ZW5BcnJheXMoW1swXSwgW1sxMF0sIFs4XV0sIDEyMzQsIHt9XSk7IC8vPT4gW1swXSwgWzEwLCA4XSwgMTIzNCwge31dXG4gICAgICogICAgICBmbGF0dGVuQXJyYXlzKFtbWzEwXSwgMTIzXSwgWzgsIFsxMF1dLCBcImhlbGxvXCJdKTsgLy89PiBbWzEwLCAxMjNdLCBbOCwgMTBdLCBcImhlbGxvXCJdXG4gICAgICovXG4gICAgdmFyIGlmRWxzZSA9IF9jdXJyeTMoZnVuY3Rpb24gaWZFbHNlKGNvbmRpdGlvbiwgb25UcnVlLCBvbkZhbHNlKSB7XG4gICAgICAgIHJldHVybiBjdXJyeU4oTWF0aC5tYXgoY29uZGl0aW9uLmxlbmd0aCwgb25UcnVlLmxlbmd0aCwgb25GYWxzZS5sZW5ndGgpLCBmdW5jdGlvbiBfaWZFbHNlKCkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbmRpdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpID8gb25UcnVlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiBvbkZhbHNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogSW5jcmVtZW50cyBpdHMgYXJndW1lbnQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEByZXR1cm4ge051bWJlcn1cbiAgICAgKiBAc2VlIFIuZGVjXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pbmMoNDIpOyAvLz0+IDQzXG4gICAgICovXG4gICAgdmFyIGluYyA9IGFkZCgxKTtcblxuICAgIC8qKlxuICAgICAqIEluc2VydHMgdGhlIHN1cHBsaWVkIGVsZW1lbnQgaW50byB0aGUgbGlzdCwgYXQgaW5kZXggYGluZGV4YC4gIF9Ob3RlXG4gICAgICogdGhhdCB0aGlzIGlzIG5vdCBkZXN0cnVjdGl2ZV86IGl0IHJldHVybnMgYSBjb3B5IG9mIHRoZSBsaXN0IHdpdGggdGhlIGNoYW5nZXMuXG4gICAgICogPHNtYWxsPk5vIGxpc3RzIGhhdmUgYmVlbiBoYXJtZWQgaW4gdGhlIGFwcGxpY2F0aW9uIG9mIHRoaXMgZnVuY3Rpb24uPC9zbWFsbD5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IGEgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCBUaGUgcG9zaXRpb24gdG8gaW5zZXJ0IHRoZSBlbGVtZW50XG4gICAgICogQHBhcmFtIHsqfSBlbHQgVGhlIGVsZW1lbnQgdG8gaW5zZXJ0IGludG8gdGhlIEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpbnNlcnQgaW50b1xuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBBcnJheSB3aXRoIGBlbHRgIGluc2VydGVkIGF0IGBpbmRleGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pbnNlcnQoMiwgJ3gnLCBbMSwyLDMsNF0pOyAvLz0+IFsxLDIsJ3gnLDMsNF1cbiAgICAgKi9cbiAgICB2YXIgaW5zZXJ0ID0gX2N1cnJ5MyhmdW5jdGlvbiBpbnNlcnQoaWR4LCBlbHQsIGxpc3QpIHtcbiAgICAgICAgaWR4ID0gaWR4IDwgbGlzdC5sZW5ndGggJiYgaWR4ID49IDAgPyBpZHggOiBsaXN0Lmxlbmd0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IF9zbGljZShsaXN0KTtcbiAgICAgICAgcmVzdWx0LnNwbGljZShpZHgsIDAsIGVsdCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnRzIHRoZSBzdWItbGlzdCBpbnRvIHRoZSBsaXN0LCBhdCBpbmRleCBgaW5kZXhgLiAgX05vdGUgIHRoYXQgdGhpc1xuICAgICAqIGlzIG5vdCBkZXN0cnVjdGl2ZV86IGl0IHJldHVybnMgYSBjb3B5IG9mIHRoZSBsaXN0IHdpdGggdGhlIGNoYW5nZXMuXG4gICAgICogPHNtYWxsPk5vIGxpc3RzIGhhdmUgYmVlbiBoYXJtZWQgaW4gdGhlIGFwcGxpY2F0aW9uIG9mIHRoaXMgZnVuY3Rpb24uPC9zbWFsbD5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFthXSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IFRoZSBwb3NpdGlvbiB0byBpbnNlcnQgdGhlIHN1Yi1saXN0XG4gICAgICogQHBhcmFtIHtBcnJheX0gZWx0cyBUaGUgc3ViLWxpc3QgdG8gaW5zZXJ0IGludG8gdGhlIEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpbnNlcnQgdGhlIHN1Yi1saXN0IGludG9cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgQXJyYXkgd2l0aCBgZWx0c2AgaW5zZXJ0ZWQgc3RhcnRpbmcgYXQgYGluZGV4YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmluc2VydEFsbCgyLCBbJ3gnLCd5JywneiddLCBbMSwyLDMsNF0pOyAvLz0+IFsxLDIsJ3gnLCd5JywneicsMyw0XVxuICAgICAqL1xuICAgIHZhciBpbnNlcnRBbGwgPSBfY3VycnkzKGZ1bmN0aW9uIGluc2VydEFsbChpZHgsIGVsdHMsIGxpc3QpIHtcbiAgICAgICAgaWR4ID0gaWR4IDwgbGlzdC5sZW5ndGggJiYgaWR4ID49IDAgPyBpZHggOiBsaXN0Lmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIF9jb25jYXQoX2NvbmNhdChfc2xpY2UobGlzdCwgMCwgaWR4KSwgZWx0cyksIF9zbGljZShsaXN0LCBpZHgpKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFNlZSBpZiBhbiBvYmplY3QgKGB2YWxgKSBpcyBhbiBpbnN0YW5jZSBvZiB0aGUgc3VwcGxpZWQgY29uc3RydWN0b3IuXG4gICAgICogVGhpcyBmdW5jdGlvbiB3aWxsIGNoZWNrIHVwIHRoZSBpbmhlcml0YW5jZSBjaGFpbiwgaWYgYW55LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBUeXBlXG4gICAgICogQHNpZyAoKiAtPiB7Kn0pIC0+IGEgLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjdG9yIEEgY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0geyp9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pcyhPYmplY3QsIHt9KTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzKE51bWJlciwgMSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pcyhPYmplY3QsIDEpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlzKFN0cmluZywgJ3MnKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzKFN0cmluZywgbmV3IFN0cmluZygnJykpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaXMoT2JqZWN0LCBuZXcgU3RyaW5nKCcnKSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pcyhPYmplY3QsICdzJyk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuaXMoTnVtYmVyLCB7fSk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgaXMgPSBfY3VycnkyKGZ1bmN0aW9uIGlzKEN0b3IsIHZhbCkge1xuICAgICAgICByZXR1cm4gdmFsICE9IG51bGwgJiYgdmFsLmNvbnN0cnVjdG9yID09PSBDdG9yIHx8IHZhbCBpbnN0YW5jZW9mIEN0b3I7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUZXN0cyB3aGV0aGVyIG9yIG5vdCBhbiBvYmplY3QgaXMgc2ltaWxhciB0byBhbiBhcnJheS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgVHlwZVxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAqIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0geyp9IHggVGhlIG9iamVjdCB0byB0ZXN0LlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBgeGAgaGFzIGEgbnVtZXJpYyBsZW5ndGggcHJvcGVydHkgYW5kIGV4dHJlbWUgaW5kaWNlcyBkZWZpbmVkOyBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmlzQXJyYXlMaWtlKFtdKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzQXJyYXlMaWtlKHRydWUpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlzQXJyYXlMaWtlKHt9KTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pc0FycmF5TGlrZSh7bGVuZ3RoOiAxMH0pOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlzQXJyYXlMaWtlKHswOiAnemVybycsIDk6ICduaW5lJywgbGVuZ3RoOiAxMH0pOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgaXNBcnJheUxpa2UgPSBfY3VycnkxKGZ1bmN0aW9uIGlzQXJyYXlMaWtlKHgpIHtcbiAgICAgICAgaWYgKF9pc0FycmF5KHgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXgpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIHggIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHggaW5zdGFuY2VvZiBTdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoeC5ub2RlVHlwZSA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuICEheC5sZW5ndGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHgubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoeC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4geC5oYXNPd25Qcm9wZXJ0eSgwKSAmJiB4Lmhhc093blByb3BlcnR5KHgubGVuZ3RoIC0gMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmVwb3J0cyB3aGV0aGVyIHRoZSBsaXN0IGhhcyB6ZXJvIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgW2FdIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0XG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmlzRW1wdHkoWzEsIDIsIDNdKTsgICAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlzRW1wdHkoW10pOyAgICAgICAgICAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaXNFbXB0eSgnJyk7ICAgICAgICAgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pc0VtcHR5KG51bGwpOyAgICAgICAgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pc0VtcHR5KFIua2V5cyh7fSkpOyAgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzRW1wdHkoe30pOyAgICAgICAgICAvLz0+IGZhbHNlICh7fSBkb2VzIG5vdCBoYXZlIGEgbGVuZ3RoIHByb3BlcnR5KVxuICAgICAqICAgICAgUi5pc0VtcHR5KHtsZW5ndGg6IDB9KTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGlzRW1wdHkgPSBfY3VycnkxKGZ1bmN0aW9uIGlzRW1wdHkobGlzdCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0KGxpc3QpLmxlbmd0aCA9PT0gMDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB0aGUgaW5wdXQgdmFsdWUgaXMgYG51bGxgIG9yIGB1bmRlZmluZWRgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBUeXBlXG4gICAgICogQHNpZyAqIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0geyp9IHggVGhlIHZhbHVlIHRvIHRlc3QuXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIGB4YCBpcyBgdW5kZWZpbmVkYCBvciBgbnVsbGAsIG90aGVyd2lzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuaXNOaWwobnVsbCk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pc05pbCh1bmRlZmluZWQpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaXNOaWwoMCk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuaXNOaWwoW10pOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGlzTmlsID0gX2N1cnJ5MShmdW5jdGlvbiBpc05pbCh4KSB7XG4gICAgICAgIHJldHVybiB4ID09IG51bGw7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBjb250YWluaW5nIHRoZSBuYW1lcyBvZiBhbGwgdGhlIGVudW1lcmFibGUgb3duXG4gICAgICogcHJvcGVydGllcyBvZiB0aGUgc3VwcGxpZWQgb2JqZWN0LlxuICAgICAqIE5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgdGhlIG91dHB1dCBhcnJheSBpcyBub3QgZ3VhcmFudGVlZCB0byBiZVxuICAgICAqIGNvbnNpc3RlbnQgYWNyb3NzIGRpZmZlcmVudCBKUyBwbGF0Zm9ybXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge2s6IHZ9IC0+IFtrXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBleHRyYWN0IHByb3BlcnRpZXMgZnJvbVxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiB0aGUgb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5rZXlzKHthOiAxLCBiOiAyLCBjOiAzfSk7IC8vPT4gWydhJywgJ2InLCAnYyddXG4gICAgICovXG4gICAgLy8gY292ZXIgSUUgPCA5IGtleXMgaXNzdWVzXG4gICAgdmFyIGtleXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGNvdmVyIElFIDwgOSBrZXlzIGlzc3Vlc1xuICAgICAgICB2YXIgaGFzRW51bUJ1ZyA9ICF7IHRvU3RyaW5nOiBudWxsIH0ucHJvcGVydHlJc0VudW1lcmFibGUoJ3RvU3RyaW5nJyk7XG4gICAgICAgIHZhciBub25FbnVtZXJhYmxlUHJvcHMgPSBbXG4gICAgICAgICAgICAnY29uc3RydWN0b3InLFxuICAgICAgICAgICAgJ3ZhbHVlT2YnLFxuICAgICAgICAgICAgJ2lzUHJvdG90eXBlT2YnLFxuICAgICAgICAgICAgJ3RvU3RyaW5nJyxcbiAgICAgICAgICAgICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsXG4gICAgICAgICAgICAnaGFzT3duUHJvcGVydHknLFxuICAgICAgICAgICAgJ3RvTG9jYWxlU3RyaW5nJ1xuICAgICAgICBdO1xuICAgICAgICB2YXIgY29udGFpbnMgPSBmdW5jdGlvbiBjb250YWlucyhsaXN0LCBpdGVtKSB7XG4gICAgICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChpZHggPCBsaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0W2lkeF0gPT09IGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdHlwZW9mIE9iamVjdC5rZXlzID09PSAnZnVuY3Rpb24nID8gX2N1cnJ5MShmdW5jdGlvbiBrZXlzKG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdChvYmopICE9PSBvYmogPyBbXSA6IE9iamVjdC5rZXlzKG9iaik7XG4gICAgICAgIH0pIDogX2N1cnJ5MShmdW5jdGlvbiBrZXlzKG9iaikge1xuICAgICAgICAgICAgaWYgKE9iamVjdChvYmopICE9PSBvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcHJvcCwga3MgPSBbXSwgbklkeDtcbiAgICAgICAgICAgIGZvciAocHJvcCBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICBpZiAoX2hhcyhwcm9wLCBvYmopKSB7XG4gICAgICAgICAgICAgICAgICAgIGtzW2tzLmxlbmd0aF0gPSBwcm9wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoYXNFbnVtQnVnKSB7XG4gICAgICAgICAgICAgICAgbklkeCA9IG5vbkVudW1lcmFibGVQcm9wcy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgIHdoaWxlIChuSWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcCA9IG5vbkVudW1lcmFibGVQcm9wc1tuSWR4XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9oYXMocHJvcCwgb2JqKSAmJiAhY29udGFpbnMoa3MsIHByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrc1trcy5sZW5ndGhdID0gcHJvcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuSWR4IC09IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGtzO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBjb250YWluaW5nIHRoZSBuYW1lcyBvZiBhbGwgdGhlXG4gICAgICogcHJvcGVydGllcyBvZiB0aGUgc3VwcGxpZWQgb2JqZWN0LCBpbmNsdWRpbmcgcHJvdG90eXBlIHByb3BlcnRpZXMuXG4gICAgICogTm90ZSB0aGF0IHRoZSBvcmRlciBvZiB0aGUgb3V0cHV0IGFycmF5IGlzIG5vdCBndWFyYW50ZWVkIHRvIGJlXG4gICAgICogY29uc2lzdGVudCBhY3Jvc3MgZGlmZmVyZW50IEpTIHBsYXRmb3Jtcy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7azogdn0gLT4gW2tdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGV4dHJhY3QgcHJvcGVydGllcyBmcm9tXG4gICAgICogQHJldHVybiB7QXJyYXl9IEFuIGFycmF5IG9mIHRoZSBvYmplY3QncyBvd24gYW5kIHByb3RvdHlwZSBwcm9wZXJ0aWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBGID0gZnVuY3Rpb24oKSB7IHRoaXMueCA9ICdYJzsgfTtcbiAgICAgKiAgICAgIEYucHJvdG90eXBlLnkgPSAnWSc7XG4gICAgICogICAgICB2YXIgZiA9IG5ldyBGKCk7XG4gICAgICogICAgICBSLmtleXNJbihmKTsgLy89PiBbJ3gnLCAneSddXG4gICAgICovXG4gICAgdmFyIGtleXNJbiA9IF9jdXJyeTEoZnVuY3Rpb24ga2V5c0luKG9iaikge1xuICAgICAgICB2YXIgcHJvcCwga3MgPSBbXTtcbiAgICAgICAgZm9yIChwcm9wIGluIG9iaikge1xuICAgICAgICAgICAga3Nba3MubGVuZ3RoXSA9IHByb3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGtzO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBhcnJheSBieSByZXR1cm5pbmcgYGxpc3QubGVuZ3RoYC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW2FdIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgbGVuZ3RoIG9mIHRoZSBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmxlbmd0aChbXSk7IC8vPT4gMFxuICAgICAqICAgICAgUi5sZW5ndGgoWzEsIDIsIDNdKTsgLy89PiAzXG4gICAgICovXG4gICAgdmFyIGxlbmd0aCA9IF9jdXJyeTEoZnVuY3Rpb24gbGVuZ3RoKGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIGxpc3QgIT0gbnVsbCAmJiBpcyhOdW1iZXIsIGxpc3QubGVuZ3RoKSA/IGxpc3QubGVuZ3RoIDogTmFOO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzIGxlc3MgdGhhbiB0aGUgc2Vjb25kO1xuICAgICAqIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgT3JkIGEgPT4gYSAtPiBhIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0geyp9IGFcbiAgICAgKiBAcGFyYW0geyp9IGJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBzZWUgUi5ndFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubHQoMiwgMSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIubHQoMiwgMik7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIubHQoMiwgMyk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5sdCgnYScsICd6Jyk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5sdCgneicsICdhJyk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgbHQgPSBfY3VycnkyKGZ1bmN0aW9uIGx0KGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgPCBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgc2Vjb25kO1xuICAgICAqIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgT3JkIGEgPT4gYSAtPiBhIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBiXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiBAc2VlIFIuZ3RlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5sdGUoMiwgMSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIubHRlKDIsIDIpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIubHRlKDIsIDMpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIubHRlKCdhJywgJ3onKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmx0ZSgneicsICdhJyk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgbHRlID0gX2N1cnJ5MihmdW5jdGlvbiBsdGUoYSwgYikge1xuICAgICAgICByZXR1cm4gYSA8PSBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhlIG1hcEFjY3VtIGZ1bmN0aW9uIGJlaGF2ZXMgbGlrZSBhIGNvbWJpbmF0aW9uIG9mIG1hcCBhbmQgcmVkdWNlOyBpdCBhcHBsaWVzIGFcbiAgICAgKiBmdW5jdGlvbiB0byBlYWNoIGVsZW1lbnQgb2YgYSBsaXN0LCBwYXNzaW5nIGFuIGFjY3VtdWxhdGluZyBwYXJhbWV0ZXIgZnJvbSBsZWZ0IHRvXG4gICAgICogcmlnaHQsIGFuZCByZXR1cm5pbmcgYSBmaW5hbCB2YWx1ZSBvZiB0aGlzIGFjY3VtdWxhdG9yIHRvZ2V0aGVyIHdpdGggdGhlIG5ldyBsaXN0LlxuICAgICAqXG4gICAgICogVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uIHJlY2VpdmVzIHR3byBhcmd1bWVudHMsICphY2MqIGFuZCAqdmFsdWUqLCBhbmQgc2hvdWxkIHJldHVyblxuICAgICAqIGEgdHVwbGUgKlthY2MsIHZhbHVlXSouXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhY2MgLT4geCAtPiAoYWNjLCB5KSkgLT4gYWNjIC0+IFt4XSAtPiAoYWNjLCBbeV0pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBvbiBldmVyeSBlbGVtZW50IG9mIHRoZSBpbnB1dCBgbGlzdGAuXG4gICAgICogQHBhcmFtIHsqfSBhY2MgVGhlIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBmaW5hbCwgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGRpZ2l0cyA9IFsnMScsICcyJywgJzMnLCAnNCddO1xuICAgICAqICAgICAgdmFyIGFwcGVuZCA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIFthICsgYiwgYSArIGJdO1xuICAgICAqICAgICAgfVxuICAgICAqXG4gICAgICogICAgICBSLm1hcEFjY3VtKGFwcGVuZCwgMCwgZGlnaXRzKTsgLy89PiBbJzAxMjM0JywgWycwMScsICcwMTInLCAnMDEyMycsICcwMTIzNCddXVxuICAgICAqL1xuICAgIHZhciBtYXBBY2N1bSA9IF9jdXJyeTMoZnVuY3Rpb24gbWFwQWNjdW0oZm4sIGFjYywgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGgsIHJlc3VsdCA9IFtdLCB0dXBsZSA9IFthY2NdO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICB0dXBsZSA9IGZuKHR1cGxlWzBdLCBsaXN0W2lkeF0pO1xuICAgICAgICAgICAgcmVzdWx0W2lkeF0gPSB0dXBsZVsxXTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB0dXBsZVswXSxcbiAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICBdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhlIG1hcEFjY3VtUmlnaHQgZnVuY3Rpb24gYmVoYXZlcyBsaWtlIGEgY29tYmluYXRpb24gb2YgbWFwIGFuZCByZWR1Y2U7IGl0IGFwcGxpZXMgYVxuICAgICAqIGZ1bmN0aW9uIHRvIGVhY2ggZWxlbWVudCBvZiBhIGxpc3QsIHBhc3NpbmcgYW4gYWNjdW11bGF0aW5nIHBhcmFtZXRlciBmcm9tIHJpZ2h0XG4gICAgICogdG8gbGVmdCwgYW5kIHJldHVybmluZyBhIGZpbmFsIHZhbHVlIG9mIHRoaXMgYWNjdW11bGF0b3IgdG9nZXRoZXIgd2l0aCB0aGUgbmV3IGxpc3QuXG4gICAgICpcbiAgICAgKiBTaW1pbGFyIHRvIGBtYXBBY2N1bWAsIGV4Y2VwdCBtb3ZlcyB0aHJvdWdoIHRoZSBpbnB1dCBsaXN0IGZyb20gdGhlIHJpZ2h0IHRvIHRoZVxuICAgICAqIGxlZnQuXG4gICAgICpcbiAgICAgKiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24gcmVjZWl2ZXMgdHdvIGFyZ3VtZW50cywgKmFjYyogYW5kICp2YWx1ZSosIGFuZCBzaG91bGQgcmV0dXJuXG4gICAgICogYSB0dXBsZSAqW2FjYywgdmFsdWVdKi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGFjYyAtPiB4IC0+IChhY2MsIHkpKSAtPiBhY2MgLT4gW3hdIC0+IChhY2MsIFt5XSlcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIG9uIGV2ZXJ5IGVsZW1lbnQgb2YgdGhlIGlucHV0IGBsaXN0YC5cbiAgICAgKiBAcGFyYW0geyp9IGFjYyBUaGUgYWNjdW11bGF0b3IgdmFsdWUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7Kn0gVGhlIGZpbmFsLCBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZGlnaXRzID0gWycxJywgJzInLCAnMycsICc0J107XG4gICAgICogICAgICB2YXIgYXBwZW5kID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAqICAgICAgICByZXR1cm4gW2EgKyBiLCBhICsgYl07XG4gICAgICogICAgICB9XG4gICAgICpcbiAgICAgKiAgICAgIFIubWFwQWNjdW1SaWdodChhcHBlbmQsIDAsIGRpZ2l0cyk7IC8vPT4gWycwNDMyMScsIFsnMDQzMjEnLCAnMDQzMicsICcwNDMnLCAnMDQnXV1cbiAgICAgKi9cbiAgICB2YXIgbWFwQWNjdW1SaWdodCA9IF9jdXJyeTMoZnVuY3Rpb24gbWFwQWNjdW1SaWdodChmbiwgYWNjLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSBsaXN0Lmxlbmd0aCAtIDEsIHJlc3VsdCA9IFtdLCB0dXBsZSA9IFthY2NdO1xuICAgICAgICB3aGlsZSAoaWR4ID49IDApIHtcbiAgICAgICAgICAgIHR1cGxlID0gZm4odHVwbGVbMF0sIGxpc3RbaWR4XSk7XG4gICAgICAgICAgICByZXN1bHRbaWR4XSA9IHR1cGxlWzFdO1xuICAgICAgICAgICAgaWR4IC09IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHR1cGxlWzBdLFxuICAgICAgICAgICAgcmVzdWx0XG4gICAgICAgIF07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUZXN0cyBhIHJlZ3VsYXIgZXhwcmVzc2lvbiBhZ2FpbnN0IGEgU3RyaW5nLiBOb3RlIHRoYXQgdGhpcyBmdW5jdGlvblxuICAgICAqIHdpbGwgcmV0dXJuIGFuIGVtcHR5IGFycmF5IHdoZW4gdGhlcmUgYXJlIG5vIG1hdGNoZXMuIFRoaXMgZGlmZmVyc1xuICAgICAqIGZyb20gW2BTdHJpbmcucHJvdG90eXBlLm1hdGNoYF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvU3RyaW5nL21hdGNoKVxuICAgICAqIHdoaWNoIHJldHVybnMgYG51bGxgIHdoZW4gdGhlcmUgYXJlIG5vIG1hdGNoZXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQHNlZSBSLnRlc3RcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBSZWdFeHAgLT4gU3RyaW5nIC0+IFtTdHJpbmcgfCBVbmRlZmluZWRdXG4gICAgICogQHBhcmFtIHtSZWdFeHB9IHJ4IEEgcmVndWxhciBleHByZXNzaW9uLlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byBtYXRjaCBhZ2FpbnN0XG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBsaXN0IG9mIG1hdGNoZXMgb3IgZW1wdHkgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tYXRjaCgvKFthLXpdYSkvZywgJ2JhbmFuYXMnKTsgLy89PiBbJ2JhJywgJ25hJywgJ25hJ11cbiAgICAgKiAgICAgIFIubWF0Y2goL2EvLCAnYicpOyAvLz0+IFtdXG4gICAgICogICAgICBSLm1hdGNoKC9hLywgbnVsbCk7IC8vPT4gVHlwZUVycm9yOiBudWxsIGRvZXMgbm90IGhhdmUgYSBtZXRob2QgbmFtZWQgXCJtYXRjaFwiXG4gICAgICovXG4gICAgdmFyIG1hdGNoID0gX2N1cnJ5MihmdW5jdGlvbiBtYXRjaChyeCwgc3RyKSB7XG4gICAgICAgIHJldHVybiBzdHIubWF0Y2gocngpIHx8IFtdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogbWF0aE1vZCBiZWhhdmVzIGxpa2UgdGhlIG1vZHVsbyBvcGVyYXRvciBzaG91bGQgbWF0aGVtYXRpY2FsbHksIHVubGlrZSB0aGUgYCVgXG4gICAgICogb3BlcmF0b3IgKGFuZCBieSBleHRlbnNpb24sIFIubW9kdWxvKS4gU28gd2hpbGUgXCItMTcgJSA1XCIgaXMgLTIsXG4gICAgICogbWF0aE1vZCgtMTcsIDUpIGlzIDMuIG1hdGhNb2QgcmVxdWlyZXMgSW50ZWdlciBhcmd1bWVudHMsIGFuZCByZXR1cm5zIE5hTlxuICAgICAqIHdoZW4gdGhlIG1vZHVsdXMgaXMgemVybyBvciBuZWdhdGl2ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gbSBUaGUgZGl2aWRlbmQuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHAgdGhlIG1vZHVsdXMuXG4gICAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgcmVzdWx0IG9mIGBiIG1vZCBhYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm1hdGhNb2QoLTE3LCA1KTsgIC8vPT4gM1xuICAgICAqICAgICAgUi5tYXRoTW9kKDE3LCA1KTsgICAvLz0+IDJcbiAgICAgKiAgICAgIFIubWF0aE1vZCgxNywgLTUpOyAgLy89PiBOYU5cbiAgICAgKiAgICAgIFIubWF0aE1vZCgxNywgMCk7ICAgLy89PiBOYU5cbiAgICAgKiAgICAgIFIubWF0aE1vZCgxNy4yLCA1KTsgLy89PiBOYU5cbiAgICAgKiAgICAgIFIubWF0aE1vZCgxNywgNS4zKTsgLy89PiBOYU5cbiAgICAgKlxuICAgICAqICAgICAgdmFyIGNsb2NrID0gUi5tYXRoTW9kKFIuX18sIDEyKTtcbiAgICAgKiAgICAgIGNsb2NrKDE1KTsgLy89PiAzXG4gICAgICogICAgICBjbG9jaygyNCk7IC8vPT4gMFxuICAgICAqXG4gICAgICogICAgICB2YXIgc2V2ZW50ZWVuTW9kID0gUi5tYXRoTW9kKDE3KTtcbiAgICAgKiAgICAgIHNldmVudGVlbk1vZCgzKTsgIC8vPT4gMlxuICAgICAqICAgICAgc2V2ZW50ZWVuTW9kKDQpOyAgLy89PiAxXG4gICAgICogICAgICBzZXZlbnRlZW5Nb2QoMTApOyAvLz0+IDdcbiAgICAgKi9cbiAgICB2YXIgbWF0aE1vZCA9IF9jdXJyeTIoZnVuY3Rpb24gbWF0aE1vZChtLCBwKSB7XG4gICAgICAgIGlmICghX2lzSW50ZWdlcihtKSkge1xuICAgICAgICAgICAgcmV0dXJuIE5hTjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIV9pc0ludGVnZXIocCkgfHwgcCA8IDEpIHtcbiAgICAgICAgICAgIHJldHVybiBOYU47XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChtICUgcCArIHApICUgcDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGxhcmdlciBvZiBpdHMgdHdvIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBhID0+IGEgLT4gYSAtPiBhXG4gICAgICogQHBhcmFtIHsqfSBhXG4gICAgICogQHBhcmFtIHsqfSBiXG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIubWF4QnksIFIubWluXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tYXgoNzg5LCAxMjMpOyAvLz0+IDc4OVxuICAgICAqICAgICAgUi5tYXgoJ2EnLCAnYicpOyAvLz0+ICdiJ1xuICAgICAqL1xuICAgIHZhciBtYXggPSBfY3VycnkyKGZ1bmN0aW9uIG1heChhLCBiKSB7XG4gICAgICAgIHJldHVybiBiID4gYSA/IGIgOiBhO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGFrZXMgYSBmdW5jdGlvbiBhbmQgdHdvIHZhbHVlcywgYW5kIHJldHVybnMgd2hpY2hldmVyIHZhbHVlIHByb2R1Y2VzXG4gICAgICogdGhlIGxhcmdlciByZXN1bHQgd2hlbiBwYXNzZWQgdG8gdGhlIHByb3ZpZGVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgT3JkIGIgPT4gKGEgLT4gYikgLT4gYSAtPiBhIC0+IGFcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmXG4gICAgICogQHBhcmFtIHsqfSBhXG4gICAgICogQHBhcmFtIHsqfSBiXG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIubWF4LCBSLm1pbkJ5XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tYXhCeShmdW5jdGlvbihuKSB7IHJldHVybiBuICogbjsgfSwgLTMsIDIpOyAvLz0+IC0zXG4gICAgICovXG4gICAgdmFyIG1heEJ5ID0gX2N1cnJ5MyhmdW5jdGlvbiBtYXhCeShmLCBhLCBiKSB7XG4gICAgICAgIHJldHVybiBmKGIpID4gZihhKSA/IGIgOiBhO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IG9iamVjdCB3aXRoIHRoZSBvd24gcHJvcGVydGllcyBvZiBgYWBcbiAgICAgKiBtZXJnZWQgd2l0aCB0aGUgb3duIHByb3BlcnRpZXMgb2Ygb2JqZWN0IGBiYC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7azogdn0gLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBhXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGJcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tZXJnZSh7ICduYW1lJzogJ2ZyZWQnLCAnYWdlJzogMTAgfSwgeyAnYWdlJzogNDAgfSk7XG4gICAgICogICAgICAvLz0+IHsgJ25hbWUnOiAnZnJlZCcsICdhZ2UnOiA0MCB9XG4gICAgICpcbiAgICAgKiAgICAgIHZhciByZXNldFRvRGVmYXVsdCA9IFIubWVyZ2UoUi5fXywge3g6IDB9KTtcbiAgICAgKiAgICAgIHJlc2V0VG9EZWZhdWx0KHt4OiA1LCB5OiAyfSk7IC8vPT4ge3g6IDAsIHk6IDJ9XG4gICAgICovXG4gICAgdmFyIG1lcmdlID0gX2N1cnJ5MihmdW5jdGlvbiBtZXJnZShhLCBiKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgdmFyIGtzID0ga2V5cyhhKTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBrcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJlc3VsdFtrc1tpZHhdXSA9IGFba3NbaWR4XV07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBrcyA9IGtleXMoYik7XG4gICAgICAgIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBrcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJlc3VsdFtrc1tpZHhdXSA9IGJba3NbaWR4XV07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgc21hbGxlciBvZiBpdHMgdHdvIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBhID0+IGEgLT4gYSAtPiBhXG4gICAgICogQHBhcmFtIHsqfSBhXG4gICAgICogQHBhcmFtIHsqfSBiXG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIubWluQnksIFIubWF4XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5taW4oNzg5LCAxMjMpOyAvLz0+IDEyM1xuICAgICAqICAgICAgUi5taW4oJ2EnLCAnYicpOyAvLz0+ICdhJ1xuICAgICAqL1xuICAgIHZhciBtaW4gPSBfY3VycnkyKGZ1bmN0aW9uIG1pbihhLCBiKSB7XG4gICAgICAgIHJldHVybiBiIDwgYSA/IGIgOiBhO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGFrZXMgYSBmdW5jdGlvbiBhbmQgdHdvIHZhbHVlcywgYW5kIHJldHVybnMgd2hpY2hldmVyIHZhbHVlIHByb2R1Y2VzXG4gICAgICogdGhlIHNtYWxsZXIgcmVzdWx0IHdoZW4gcGFzc2VkIHRvIHRoZSBwcm92aWRlZCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBiID0+IChhIC0+IGIpIC0+IGEgLT4gYSAtPiBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZlxuICAgICAqIEBwYXJhbSB7Kn0gYVxuICAgICAqIEBwYXJhbSB7Kn0gYlxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLm1pbiwgUi5tYXhCeVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubWluQnkoZnVuY3Rpb24obikgeyByZXR1cm4gbiAqIG47IH0sIC0zLCAyKTsgLy89PiAyXG4gICAgICovXG4gICAgdmFyIG1pbkJ5ID0gX2N1cnJ5MyhmdW5jdGlvbiBtaW5CeShmLCBhLCBiKSB7XG4gICAgICAgIHJldHVybiBmKGIpIDwgZihhKSA/IGIgOiBhO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogRGl2aWRlcyB0aGUgc2Vjb25kIHBhcmFtZXRlciBieSB0aGUgZmlyc3QgYW5kIHJldHVybnMgdGhlIHJlbWFpbmRlci5cbiAgICAgKiBOb3RlIHRoYXQgdGhpcyBmdW5jdGlvbnMgcHJlc2VydmVzIHRoZSBKYXZhU2NyaXB0LXN0eWxlIGJlaGF2aW9yIGZvclxuICAgICAqIG1vZHVsby4gRm9yIG1hdGhlbWF0aWNhbCBtb2R1bG8gc2VlIGBtYXRoTW9kYFxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBhIFRoZSB2YWx1ZSB0byB0aGUgZGl2aWRlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBiIFRoZSBwc2V1ZG8tbW9kdWx1c1xuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIHJlc3VsdCBvZiBgYiAlIGFgLlxuICAgICAqIEBzZWUgUi5tYXRoTW9kXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tb2R1bG8oMTcsIDMpOyAvLz0+IDJcbiAgICAgKiAgICAgIC8vIEpTIGJlaGF2aW9yOlxuICAgICAqICAgICAgUi5tb2R1bG8oLTE3LCAzKTsgLy89PiAtMlxuICAgICAqICAgICAgUi5tb2R1bG8oMTcsIC0zKTsgLy89PiAyXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpc09kZCA9IFIubW9kdWxvKFIuX18sIDIpO1xuICAgICAqICAgICAgaXNPZGQoNDIpOyAvLz0+IDBcbiAgICAgKiAgICAgIGlzT2RkKDIxKTsgLy89PiAxXG4gICAgICovXG4gICAgdmFyIG1vZHVsbyA9IF9jdXJyeTIoZnVuY3Rpb24gbW9kdWxvKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgJSBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogTXVsdGlwbGllcyB0d28gbnVtYmVycy4gRXF1aXZhbGVudCB0byBgYSAqIGJgIGJ1dCBjdXJyaWVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBhIFRoZSBmaXJzdCB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYiBUaGUgc2Vjb25kIHZhbHVlLlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIHJlc3VsdCBvZiBgYSAqIGJgLlxuICAgICAqIEBzZWUgUi5kaXZpZGVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZG91YmxlID0gUi5tdWx0aXBseSgyKTtcbiAgICAgKiAgICAgIHZhciB0cmlwbGUgPSBSLm11bHRpcGx5KDMpO1xuICAgICAqICAgICAgZG91YmxlKDMpOyAgICAgICAvLz0+ICA2XG4gICAgICogICAgICB0cmlwbGUoNCk7ICAgICAgIC8vPT4gMTJcbiAgICAgKiAgICAgIFIubXVsdGlwbHkoMiwgNSk7ICAvLz0+IDEwXG4gICAgICovXG4gICAgdmFyIG11bHRpcGx5ID0gX2N1cnJ5MihmdW5jdGlvbiBtdWx0aXBseShhLCBiKSB7XG4gICAgICAgIHJldHVybiBhICogYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFdyYXBzIGEgZnVuY3Rpb24gb2YgYW55IGFyaXR5IChpbmNsdWRpbmcgbnVsbGFyeSkgaW4gYSBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgZXhhY3RseSBgbmBcbiAgICAgKiBwYXJhbWV0ZXJzLiBBbnkgZXh0cmFuZW91cyBwYXJhbWV0ZXJzIHdpbGwgbm90IGJlIHBhc3NlZCB0byB0aGUgc3VwcGxpZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyBOdW1iZXIgLT4gKCogLT4gYSkgLT4gKCogLT4gYSlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gbiBUaGUgZGVzaXJlZCBhcml0eSBvZiB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byB3cmFwLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbiB3cmFwcGluZyBgZm5gLiBUaGUgbmV3IGZ1bmN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgb2ZcbiAgICAgKiAgICAgICAgIGFyaXR5IGBuYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgdGFrZXNUd29BcmdzID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAqICAgICAgICByZXR1cm4gW2EsIGJdO1xuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHRha2VzVHdvQXJncy5sZW5ndGg7IC8vPT4gMlxuICAgICAqICAgICAgdGFrZXNUd29BcmdzKDEsIDIpOyAvLz0+IFsxLCAyXVxuICAgICAqXG4gICAgICogICAgICB2YXIgdGFrZXNPbmVBcmcgPSBSLm5BcnkoMSwgdGFrZXNUd29BcmdzKTtcbiAgICAgKiAgICAgIHRha2VzT25lQXJnLmxlbmd0aDsgLy89PiAxXG4gICAgICogICAgICAvLyBPbmx5IGBuYCBhcmd1bWVudHMgYXJlIHBhc3NlZCB0byB0aGUgd3JhcHBlZCBmdW5jdGlvblxuICAgICAqICAgICAgdGFrZXNPbmVBcmcoMSwgMik7IC8vPT4gWzEsIHVuZGVmaW5lZF1cbiAgICAgKi9cbiAgICB2YXIgbkFyeSA9IF9jdXJyeTIoZnVuY3Rpb24gbkFyeShuLCBmbikge1xuICAgICAgICBzd2l0Y2ggKG4pIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYTApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGEwLCBhMSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEsIGEyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYTAsIGExLCBhMiwgYTMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEsIGEyLCBhMyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGEwLCBhMSwgYTIsIGEzLCBhNCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEsIGEyLCBhMywgYTQsIGE1KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNik7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2LCBhNykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2LCBhNyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2LCBhNywgYTgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcsIGE4KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2LCBhNywgYTgsIGE5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYsIGE3LCBhOCwgYTkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlyc3QgYXJndW1lbnQgdG8gbkFyeSBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIGludGVnZXIgbm8gZ3JlYXRlciB0aGFuIHRlbicpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBOZWdhdGVzIGl0cyBhcmd1bWVudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAgICogQHJldHVybiB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubmVnYXRlKDQyKTsgLy89PiAtNDJcbiAgICAgKi9cbiAgICB2YXIgbmVnYXRlID0gX2N1cnJ5MShmdW5jdGlvbiBuZWdhdGUobikge1xuICAgICAgICByZXR1cm4gLW47XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgYCFgIG9mIGl0cyBhcmd1bWVudC4gSXQgd2lsbCByZXR1cm4gYHRydWVgIHdoZW5cbiAgICAgKiBwYXNzZWQgZmFsc2UteSB2YWx1ZSwgYW5kIGBmYWxzZWAgd2hlbiBwYXNzZWQgYSB0cnV0aC15IG9uZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnICogLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7Kn0gYSBhbnkgdmFsdWVcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSB0aGUgbG9naWNhbCBpbnZlcnNlIG9mIHBhc3NlZCBhcmd1bWVudC5cbiAgICAgKiBAc2VlIFIuY29tcGxlbWVudFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubm90KHRydWUpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLm5vdChmYWxzZSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5ub3QoMCk7ID0+IHRydWVcbiAgICAgKiAgICAgIFIubm90KDEpOyA9PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBub3QgPSBfY3VycnkxKGZ1bmN0aW9uIG5vdChhKSB7XG4gICAgICAgIHJldHVybiAhYTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG50aCBlbGVtZW50IG9mIHRoZSBnaXZlbiBsaXN0IG9yIHN0cmluZy5cbiAgICAgKiBJZiBuIGlzIG5lZ2F0aXZlIHRoZSBlbGVtZW50IGF0IGluZGV4IGxlbmd0aCArIG4gaXMgcmV0dXJuZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBbYV0gLT4gYSB8IFVuZGVmaW5lZFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0XG4gICAgICogQHBhcmFtIHsqfSBsaXN0XG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbGlzdCA9IFsnZm9vJywgJ2JhcicsICdiYXonLCAncXV1eCddO1xuICAgICAqICAgICAgUi5udGgoMSwgbGlzdCk7IC8vPT4gJ2JhcidcbiAgICAgKiAgICAgIFIubnRoKC0xLCBsaXN0KTsgLy89PiAncXV1eCdcbiAgICAgKiAgICAgIFIubnRoKC05OSwgbGlzdCk7IC8vPT4gdW5kZWZpbmVkXG4gICAgICpcbiAgICAgKiAgICAgIFIubnRoKCdhYmMnLCAyKTsgLy89PiAnYydcbiAgICAgKiAgICAgIFIubnRoKCdhYmMnLCAzKTsgLy89PiAnJ1xuICAgICAqL1xuICAgIHZhciBudGggPSBfY3VycnkyKGZ1bmN0aW9uIG50aChvZmZzZXQsIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IG9mZnNldCA8IDAgPyBsaXN0Lmxlbmd0aCArIG9mZnNldCA6IG9mZnNldDtcbiAgICAgICAgcmV0dXJuIF9pc1N0cmluZyhsaXN0KSA/IGxpc3QuY2hhckF0KGlkeCkgOiBsaXN0W2lkeF07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBpdHMgbnRoIGFyZ3VtZW50LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgTnVtYmVyIC0+ICouLi4gLT4gKlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5udGhBcmcoMSkoJ2EnLCAnYicsICdjJyk7IC8vPT4gJ2InXG4gICAgICogICAgICBSLm50aEFyZygtMSkoJ2EnLCAnYicsICdjJyk7IC8vPT4gJ2MnXG4gICAgICovXG4gICAgdmFyIG50aEFyZyA9IF9jdXJyeTEoZnVuY3Rpb24gbnRoQXJnKG4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBudGgobiwgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG50aCBjaGFyYWN0ZXIgb2YgdGhlIGdpdmVuIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBOdW1iZXIgLT4gU3RyaW5nIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICAgICAqIEByZXR1cm4ge1N0cmluZ31cbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSB2MC4xNi4wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5udGhDaGFyKDIsICdSYW1kYScpOyAvLz0+ICdtJ1xuICAgICAqICAgICAgUi5udGhDaGFyKC0yLCAnUmFtZGEnKTsgLy89PiAnZCdcbiAgICAgKi9cbiAgICB2YXIgbnRoQ2hhciA9IF9jdXJyeTIoZnVuY3Rpb24gbnRoQ2hhcihuLCBzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5jaGFyQXQobiA8IDAgPyBzdHIubGVuZ3RoICsgbiA6IG4pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgY2hhcmFjdGVyIGNvZGUgb2YgdGhlIG50aCBjaGFyYWN0ZXIgb2YgdGhlIGdpdmVuIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBOdW1iZXIgLT4gU3RyaW5nIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICAgICAqIEByZXR1cm4ge051bWJlcn1cbiAgICAgKiBAZGVwcmVjYXRlZCBzaW5jZSB2MC4xNi4wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5udGhDaGFyQ29kZSgyLCAnUmFtZGEnKTsgLy89PiAnbScuY2hhckNvZGVBdCgwKVxuICAgICAqICAgICAgUi5udGhDaGFyQ29kZSgtMiwgJ1JhbWRhJyk7IC8vPT4gJ2QnLmNoYXJDb2RlQXQoMClcbiAgICAgKi9cbiAgICB2YXIgbnRoQ2hhckNvZGUgPSBfY3VycnkyKGZ1bmN0aW9uIG50aENoYXJDb2RlKG4sIHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLmNoYXJDb2RlQXQobiA8IDAgPyBzdHIubGVuZ3RoICsgbiA6IG4pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHNpbmdsZXRvbiBhcnJheSBjb250YWluaW5nIHRoZSB2YWx1ZSBwcm92aWRlZC5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhpcyBgb2ZgIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBFUzYgYG9mYDsgU2VlXG4gICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvb2ZcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIGEgLT4gW2FdXG4gICAgICogQHBhcmFtIHsqfSB4IGFueSB2YWx1ZVxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSB3cmFwcGluZyBgeGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5vZihudWxsKTsgLy89PiBbbnVsbF1cbiAgICAgKiAgICAgIFIub2YoWzQyXSk7IC8vPT4gW1s0Ml1dXG4gICAgICovXG4gICAgdmFyIG9mID0gX2N1cnJ5MShmdW5jdGlvbiBvZih4KSB7XG4gICAgICAgIHJldHVybiBbeF07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBY2NlcHRzIGEgZnVuY3Rpb24gYGZuYCBhbmQgcmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgZ3VhcmRzIGludm9jYXRpb24gb2YgYGZuYCBzdWNoIHRoYXRcbiAgICAgKiBgZm5gIGNhbiBvbmx5IGV2ZXIgYmUgY2FsbGVkIG9uY2UsIG5vIG1hdHRlciBob3cgbWFueSB0aW1lcyB0aGUgcmV0dXJuZWQgZnVuY3Rpb24gaXNcbiAgICAgKiBpbnZva2VkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKGEuLi4gLT4gYikgLT4gKGEuLi4gLT4gYilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gd3JhcCBpbiBhIGNhbGwtb25seS1vbmNlIHdyYXBwZXIuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IFRoZSB3cmFwcGVkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBhZGRPbmVPbmNlID0gUi5vbmNlKGZ1bmN0aW9uKHgpeyByZXR1cm4geCArIDE7IH0pO1xuICAgICAqICAgICAgYWRkT25lT25jZSgxMCk7IC8vPT4gMTFcbiAgICAgKiAgICAgIGFkZE9uZU9uY2UoYWRkT25lT25jZSg1MCkpOyAvLz0+IDExXG4gICAgICovXG4gICAgdmFyIG9uY2UgPSBfY3VycnkxKGZ1bmN0aW9uIG9uY2UoZm4pIHtcbiAgICAgICAgdmFyIGNhbGxlZCA9IGZhbHNlLCByZXN1bHQ7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoY2FsbGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhbGxlZCA9IHRydWU7XG4gICAgICAgICAgICByZXN1bHQgPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHJlc3VsdCBvZiBcInNldHRpbmdcIiB0aGUgcG9ydGlvbiBvZiB0aGUgZ2l2ZW4gZGF0YSBzdHJ1Y3R1cmVcbiAgICAgKiBmb2N1c2VkIGJ5IHRoZSBnaXZlbiBsZW5zIHRvIHRoZSBnaXZlbiB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHR5cGVkZWYgTGVucyBzIGEgPSBGdW5jdG9yIGYgPT4gKGEgLT4gZiBhKSAtPiBzIC0+IGYgc1xuICAgICAqIEBzaWcgTGVucyBzIGEgLT4gKGEgLT4gYSkgLT4gcyAtPiBzXG4gICAgICogQHBhcmFtIHtMZW5zfSBsZW5zXG4gICAgICogQHBhcmFtIHsqfSB2XG4gICAgICogQHBhcmFtIHsqfSB4XG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIucHJvcCwgUi5sZW5zSW5kZXgsIFIubGVuc1Byb3BcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaGVhZExlbnMgPSBSLmxlbnNJbmRleCgwKTtcbiAgICAgKlxuICAgICAqICAgICAgUi5vdmVyKGhlYWRMZW5zLCBSLnRvVXBwZXIsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydGT08nLCAnYmFyJywgJ2JheiddXG4gICAgICovXG4gICAgdmFyIG92ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBJZGVudGl0eSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB4LFxuICAgICAgICAgICAgICAgIG1hcDogZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIElkZW50aXR5KGYoeCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkzKGZ1bmN0aW9uIG92ZXIobGVucywgZiwgeCkge1xuICAgICAgICAgICAgcmV0dXJuIGxlbnMoZnVuY3Rpb24gKHkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSWRlbnRpdHkoZih5KSk7XG4gICAgICAgICAgICB9KSh4KS52YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgLyoqXG4gICAgICogUmV0cmlldmUgdGhlIHZhbHVlIGF0IGEgZ2l2ZW4gcGF0aC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBbU3RyaW5nXSAtPiB7azogdn0gLT4gdiB8IFVuZGVmaW5lZFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhdGggVGhlIHBhdGggdG8gdXNlLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBkYXRhIGF0IGBwYXRoYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnBhdGgoWydhJywgJ2InXSwge2E6IHtiOiAyfX0pOyAvLz0+IDJcbiAgICAgKiAgICAgIFIucGF0aChbJ2EnLCAnYiddLCB7Yzoge2I6IDJ9fSk7IC8vPT4gdW5kZWZpbmVkXG4gICAgICovXG4gICAgdmFyIHBhdGggPSBfY3VycnkyKGZ1bmN0aW9uIHBhdGgocGF0aHMsIG9iaikge1xuICAgICAgICBpZiAob2JqID09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSBvYmo7XG4gICAgICAgICAgICBmb3IgKHZhciBpZHggPSAwLCBsZW4gPSBwYXRocy5sZW5ndGg7IGlkeCA8IGxlbiAmJiB2YWwgIT0gbnVsbDsgaWR4ICs9IDEpIHtcbiAgICAgICAgICAgICAgICB2YWwgPSB2YWxbcGF0aHNbaWR4XV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcGFydGlhbCBjb3B5IG9mIGFuIG9iamVjdCBjb250YWluaW5nIG9ubHkgdGhlIGtleXMgc3BlY2lmaWVkLiAgSWYgdGhlIGtleSBkb2VzIG5vdCBleGlzdCwgdGhlXG4gICAgICogcHJvcGVydHkgaXMgaWdub3JlZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBba10gLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IG5hbWVzIGFuIGFycmF5IG9mIFN0cmluZyBwcm9wZXJ0eSBuYW1lcyB0byBjb3B5IG9udG8gYSBuZXcgb2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGNvcHkgZnJvbVxuICAgICAqIEByZXR1cm4ge09iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggb25seSBwcm9wZXJ0aWVzIGZyb20gYG5hbWVzYCBvbiBpdC5cbiAgICAgKiBAc2VlIFIub21pdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucGljayhbJ2EnLCAnZCddLCB7YTogMSwgYjogMiwgYzogMywgZDogNH0pOyAvLz0+IHthOiAxLCBkOiA0fVxuICAgICAqICAgICAgUi5waWNrKFsnYScsICdlJywgJ2YnXSwge2E6IDEsIGI6IDIsIGM6IDMsIGQ6IDR9KTsgLy89PiB7YTogMX1cbiAgICAgKi9cbiAgICB2YXIgcGljayA9IF9jdXJyeTIoZnVuY3Rpb24gcGljayhuYW1lcywgb2JqKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBuYW1lcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChuYW1lc1tpZHhdIGluIG9iaikge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtuYW1lc1tpZHhdXSA9IG9ialtuYW1lc1tpZHhdXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBTaW1pbGFyIHRvIGBwaWNrYCBleGNlcHQgdGhhdCB0aGlzIG9uZSBpbmNsdWRlcyBhIGBrZXk6IHVuZGVmaW5lZGAgcGFpciBmb3IgcHJvcGVydGllcyB0aGF0IGRvbid0IGV4aXN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIFtrXSAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtBcnJheX0gbmFtZXMgYW4gYXJyYXkgb2YgU3RyaW5nIHByb3BlcnR5IG5hbWVzIHRvIGNvcHkgb250byBhIG5ldyBvYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gY29weSBmcm9tXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBBIG5ldyBvYmplY3Qgd2l0aCBvbmx5IHByb3BlcnRpZXMgZnJvbSBgbmFtZXNgIG9uIGl0LlxuICAgICAqIEBzZWUgUi5waWNrXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5waWNrQWxsKFsnYScsICdkJ10sIHthOiAxLCBiOiAyLCBjOiAzLCBkOiA0fSk7IC8vPT4ge2E6IDEsIGQ6IDR9XG4gICAgICogICAgICBSLnBpY2tBbGwoWydhJywgJ2UnLCAnZiddLCB7YTogMSwgYjogMiwgYzogMywgZDogNH0pOyAvLz0+IHthOiAxLCBlOiB1bmRlZmluZWQsIGY6IHVuZGVmaW5lZH1cbiAgICAgKi9cbiAgICB2YXIgcGlja0FsbCA9IF9jdXJyeTIoZnVuY3Rpb24gcGlja0FsbChuYW1lcywgb2JqKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBsZW4gPSBuYW1lcy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIHZhciBuYW1lID0gbmFtZXNbaWR4XTtcbiAgICAgICAgICAgIHJlc3VsdFtuYW1lXSA9IG9ialtuYW1lXTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcGFydGlhbCBjb3B5IG9mIGFuIG9iamVjdCBjb250YWluaW5nIG9ubHkgdGhlIGtleXMgdGhhdFxuICAgICAqIHNhdGlzZnkgdGhlIHN1cHBsaWVkIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyAodiwgayAtPiBCb29sZWFuKSAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSB0byBkZXRlcm1pbmUgd2hldGhlciBvciBub3QgYSBrZXlcbiAgICAgKiAgICAgICAgc2hvdWxkIGJlIGluY2x1ZGVkIG9uIHRoZSBvdXRwdXQgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBjb3B5IGZyb21cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEEgbmV3IG9iamVjdCB3aXRoIG9ubHkgcHJvcGVydGllcyB0aGF0IHNhdGlzZnkgYHByZWRgXG4gICAgICogICAgICAgICBvbiBpdC5cbiAgICAgKiBAc2VlIFIucGlja1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpc1VwcGVyQ2FzZSA9IGZ1bmN0aW9uKHZhbCwga2V5KSB7IHJldHVybiBrZXkudG9VcHBlckNhc2UoKSA9PT0ga2V5OyB9XG4gICAgICogICAgICBSLnBpY2tCeShpc1VwcGVyQ2FzZSwge2E6IDEsIGI6IDIsIEE6IDMsIEI6IDR9KTsgLy89PiB7QTogMywgQjogNH1cbiAgICAgKi9cbiAgICB2YXIgcGlja0J5ID0gX2N1cnJ5MihmdW5jdGlvbiBwaWNrQnkodGVzdCwgb2JqKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmICh0ZXN0KG9ialtwcm9wXSwgcHJvcCwgb2JqKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtwcm9wXSA9IG9ialtwcm9wXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IHdpdGggdGhlIGdpdmVuIGVsZW1lbnQgYXQgdGhlIGZyb250LCBmb2xsb3dlZCBieSB0aGUgY29udGVudHMgb2YgdGhlXG4gICAgICogbGlzdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgYSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHsqfSBlbCBUaGUgaXRlbSB0byBhZGQgdG8gdGhlIGhlYWQgb2YgdGhlIG91dHB1dCBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGFkZCB0byB0aGUgdGFpbCBvZiB0aGUgb3V0cHV0IGxpc3QuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IGFycmF5LlxuICAgICAqIEBzZWUgUi5hcHBlbmRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnByZXBlbmQoJ2ZlZScsIFsnZmknLCAnZm8nLCAnZnVtJ10pOyAvLz0+IFsnZmVlJywgJ2ZpJywgJ2ZvJywgJ2Z1bSddXG4gICAgICovXG4gICAgdmFyIHByZXBlbmQgPSBfY3VycnkyKGZ1bmN0aW9uIHByZXBlbmQoZWwsIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIF9jb25jYXQoW2VsXSwgbGlzdCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCB3aGVuIHN1cHBsaWVkIGFuIG9iamVjdCByZXR1cm5zIHRoZSBpbmRpY2F0ZWQgcHJvcGVydHkgb2YgdGhhdCBvYmplY3QsIGlmIGl0IGV4aXN0cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBzIC0+IHtzOiBhfSAtPiBhIHwgVW5kZWZpbmVkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHAgVGhlIHByb3BlcnR5IG5hbWVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gcXVlcnlcbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgdmFsdWUgYXQgYG9iai5wYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnByb3AoJ3gnLCB7eDogMTAwfSk7IC8vPT4gMTAwXG4gICAgICogICAgICBSLnByb3AoJ3gnLCB7fSk7IC8vPT4gdW5kZWZpbmVkXG4gICAgICovXG4gICAgdmFyIHByb3AgPSBfY3VycnkyKGZ1bmN0aW9uIHByb3AocCwgb2JqKSB7XG4gICAgICAgIHJldHVybiBvYmpbcF07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgZ2l2ZW4sIG5vbi1udWxsIG9iamVjdCBoYXMgYW4gb3duIHByb3BlcnR5IHdpdGggdGhlIHNwZWNpZmllZCBuYW1lLFxuICAgICAqIHJldHVybnMgdGhlIHZhbHVlIG9mIHRoYXQgcHJvcGVydHkuXG4gICAgICogT3RoZXJ3aXNlIHJldHVybnMgdGhlIHByb3ZpZGVkIGRlZmF1bHQgdmFsdWUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgYSAtPiBTdHJpbmcgLT4gT2JqZWN0IC0+IGFcbiAgICAgKiBAcGFyYW0geyp9IHZhbCBUaGUgZGVmYXVsdCB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcCBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgdG8gcmV0dXJuLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgdmFsdWUgb2YgZ2l2ZW4gcHJvcGVydHkgb2YgdGhlIHN1cHBsaWVkIG9iamVjdCBvciB0aGUgZGVmYXVsdCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYWxpY2UgPSB7XG4gICAgICogICAgICAgIG5hbWU6ICdBTElDRScsXG4gICAgICogICAgICAgIGFnZTogMTAxXG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgdmFyIGZhdm9yaXRlID0gUi5wcm9wKCdmYXZvcml0ZUxpYnJhcnknKTtcbiAgICAgKiAgICAgIHZhciBmYXZvcml0ZVdpdGhEZWZhdWx0ID0gUi5wcm9wT3IoJ1JhbWRhJywgJ2Zhdm9yaXRlTGlicmFyeScpO1xuICAgICAqXG4gICAgICogICAgICBmYXZvcml0ZShhbGljZSk7ICAvLz0+IHVuZGVmaW5lZFxuICAgICAqICAgICAgZmF2b3JpdGVXaXRoRGVmYXVsdChhbGljZSk7ICAvLz0+ICdSYW1kYSdcbiAgICAgKi9cbiAgICB2YXIgcHJvcE9yID0gX2N1cnJ5MyhmdW5jdGlvbiBwcm9wT3IodmFsLCBwLCBvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iaiAhPSBudWxsICYmIF9oYXMocCwgb2JqKSA/IG9ialtwXSA6IHZhbDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHByb3BlcnR5IHNhdGlzZmllcyB0aGUgZ2l2ZW5cbiAgICAgKiBwcmVkaWNhdGU7IGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gU3RyaW5nIC0+IHtTdHJpbmc6IGF9IC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgICAgKiBAcGFyYW0geyp9IG9ialxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQHNlZSBSLnByb3BFcVxuICAgICAqIEBzZWUgUi5wcm9wSXNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnByb3BTYXRpc2ZpZXMoeCA9PiB4ID4gMCwgJ3gnLCB7eDogMSwgeTogMn0pOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgcHJvcFNhdGlzZmllcyA9IF9jdXJyeTMoZnVuY3Rpb24gcHJvcFNhdGlzZmllcyhwcmVkLCBuYW1lLCBvYmopIHtcbiAgICAgICAgcmV0dXJuIHByZWQob2JqW25hbWVdKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEFjdHMgYXMgbXVsdGlwbGUgYHByb3BgOiBhcnJheSBvZiBrZXlzIGluLCBhcnJheSBvZiB2YWx1ZXMgb3V0LiBQcmVzZXJ2ZXMgb3JkZXIuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgW2tdIC0+IHtrOiB2fSAtPiBbdl1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwcyBUaGUgcHJvcGVydHkgbmFtZXMgdG8gZmV0Y2hcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gcXVlcnlcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGNvcnJlc3BvbmRpbmcgdmFsdWVzIG9yIHBhcnRpYWxseSBhcHBsaWVkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucHJvcHMoWyd4JywgJ3knXSwge3g6IDEsIHk6IDJ9KTsgLy89PiBbMSwgMl1cbiAgICAgKiAgICAgIFIucHJvcHMoWydjJywgJ2EnLCAnYiddLCB7YjogMiwgYTogMX0pOyAvLz0+IFt1bmRlZmluZWQsIDEsIDJdXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBmdWxsTmFtZSA9IFIuY29tcG9zZShSLmpvaW4oJyAnKSwgUi5wcm9wcyhbJ2ZpcnN0JywgJ2xhc3QnXSkpO1xuICAgICAqICAgICAgZnVsbE5hbWUoe2xhc3Q6ICdCdWxsZXQtVG9vdGgnLCBhZ2U6IDMzLCBmaXJzdDogJ1RvbnknfSk7IC8vPT4gJ1RvbnkgQnVsbGV0LVRvb3RoJ1xuICAgICAqL1xuICAgIHZhciBwcm9wcyA9IF9jdXJyeTIoZnVuY3Rpb24gcHJvcHMocHMsIG9iaikge1xuICAgICAgICB2YXIgbGVuID0gcHMubGVuZ3RoO1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBvdXRbaWR4XSA9IG9ialtwc1tpZHhdXTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBudW1iZXJzIGZyb20gYGZyb21gIChpbmNsdXNpdmUpIHRvIGB0b2BcbiAgICAgKiAoZXhjbHVzaXZlKS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBbTnVtYmVyXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBmcm9tIFRoZSBmaXJzdCBudW1iZXIgaW4gdGhlIGxpc3QuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHRvIE9uZSBtb3JlIHRoYW4gdGhlIGxhc3QgbnVtYmVyIGluIHRoZSBsaXN0LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBvZiBudW1iZXJzIGluIHR0aGUgc2V0IGBbYSwgYilgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucmFuZ2UoMSwgNSk7ICAgIC8vPT4gWzEsIDIsIDMsIDRdXG4gICAgICogICAgICBSLnJhbmdlKDUwLCA1Myk7ICAvLz0+IFs1MCwgNTEsIDUyXVxuICAgICAqL1xuICAgIHZhciByYW5nZSA9IF9jdXJyeTIoZnVuY3Rpb24gcmFuZ2UoZnJvbSwgdG8pIHtcbiAgICAgICAgaWYgKCEoX2lzTnVtYmVyKGZyb20pICYmIF9pc051bWJlcih0bykpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb3RoIGFyZ3VtZW50cyB0byByYW5nZSBtdXN0IGJlIG51bWJlcnMnKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHZhciBuID0gZnJvbTtcbiAgICAgICAgd2hpbGUgKG4gPCB0bykge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gobik7XG4gICAgICAgICAgICBuICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzaW5nbGUgaXRlbSBieSBpdGVyYXRpbmcgdGhyb3VnaCB0aGUgbGlzdCwgc3VjY2Vzc2l2ZWx5IGNhbGxpbmcgdGhlIGl0ZXJhdG9yXG4gICAgICogZnVuY3Rpb24gYW5kIHBhc3NpbmcgaXQgYW4gYWNjdW11bGF0b3IgdmFsdWUgYW5kIHRoZSBjdXJyZW50IHZhbHVlIGZyb20gdGhlIGFycmF5LCBhbmRcbiAgICAgKiB0aGVuIHBhc3NpbmcgdGhlIHJlc3VsdCB0byB0aGUgbmV4dCBjYWxsLlxuICAgICAqXG4gICAgICogU2ltaWxhciB0byBgcmVkdWNlYCwgZXhjZXB0IG1vdmVzIHRocm91Z2ggdGhlIGlucHV0IGxpc3QgZnJvbSB0aGUgcmlnaHQgdG8gdGhlIGxlZnQuXG4gICAgICpcbiAgICAgKiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24gcmVjZWl2ZXMgdHdvIHZhbHVlczogKihhY2MsIHZhbHVlKSpcbiAgICAgKlxuICAgICAqIE5vdGU6IGBSLnJlZHVjZVJpZ2h0YCBkb2VzIG5vdCBza2lwIGRlbGV0ZWQgb3IgdW5hc3NpZ25lZCBpbmRpY2VzIChzcGFyc2UgYXJyYXlzKSwgdW5saWtlXG4gICAgICogdGhlIG5hdGl2ZSBgQXJyYXkucHJvdG90eXBlLnJlZHVjZWAgbWV0aG9kLiBGb3IgbW9yZSBkZXRhaWxzIG9uIHRoaXMgYmVoYXZpb3IsIHNlZTpcbiAgICAgKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9yZWR1Y2VSaWdodCNEZXNjcmlwdGlvblxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSxiIC0+IGEpIC0+IGEgLT4gW2JdIC0+IGFcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24uIFJlY2VpdmVzIHR3byB2YWx1ZXMsIHRoZSBhY2N1bXVsYXRvciBhbmQgdGhlXG4gICAgICogICAgICAgIGN1cnJlbnQgZWxlbWVudCBmcm9tIHRoZSBhcnJheS5cbiAgICAgKiBAcGFyYW0geyp9IGFjYyBUaGUgYWNjdW11bGF0b3IgdmFsdWUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7Kn0gVGhlIGZpbmFsLCBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgcGFpcnMgPSBbIFsnYScsIDFdLCBbJ2InLCAyXSwgWydjJywgM10gXTtcbiAgICAgKiAgICAgIHZhciBmbGF0dGVuUGFpcnMgPSBmdW5jdGlvbihhY2MsIHBhaXIpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGFjYy5jb25jYXQocGFpcik7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBSLnJlZHVjZVJpZ2h0KGZsYXR0ZW5QYWlycywgW10sIHBhaXJzKTsgLy89PiBbICdjJywgMywgJ2InLCAyLCAnYScsIDEgXVxuICAgICAqL1xuICAgIHZhciByZWR1Y2VSaWdodCA9IF9jdXJyeTMoZnVuY3Rpb24gcmVkdWNlUmlnaHQoZm4sIGFjYywgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICB3aGlsZSAoaWR4ID49IDApIHtcbiAgICAgICAgICAgIGFjYyA9IGZuKGFjYywgbGlzdFtpZHhdKTtcbiAgICAgICAgICAgIGlkeCAtPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgdmFsdWUgd3JhcHBlZCB0byBpbmRpY2F0ZSB0aGF0IGl0IGlzIHRoZSBmaW5hbCB2YWx1ZSBvZiB0aGVcbiAgICAgKiByZWR1Y2UgYW5kIHRyYW5zZHVjZSBmdW5jdGlvbnMuICBUaGUgcmV0dXJuZWQgdmFsdWVcbiAgICAgKiBzaG91bGQgYmUgY29uc2lkZXJlZCBhIGJsYWNrIGJveDogdGhlIGludGVybmFsIHN0cnVjdHVyZSBpcyBub3RcbiAgICAgKiBndWFyYW50ZWVkIHRvIGJlIHN0YWJsZS5cbiAgICAgKlxuICAgICAqIE5vdGU6IHRoaXMgb3B0aW1pemF0aW9uIGlzIHVuYXZhaWxhYmxlIHRvIGZ1bmN0aW9ucyBub3QgZXhwbGljaXRseSBsaXN0ZWRcbiAgICAgKiBhYm92ZS4gIEZvciBpbnN0YW5jZSwgaXQgaXMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgYnkgcmVkdWNlSW5kZXhlZCxcbiAgICAgKiByZWR1Y2VSaWdodCwgb3IgcmVkdWNlUmlnaHRJbmRleGVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNlZSBSLnJlZHVjZSwgUi50cmFuc2R1Y2VcbiAgICAgKiBAc2lnIGEgLT4gKlxuICAgICAqIEBwYXJhbSB7Kn0geCBUaGUgZmluYWwgdmFsdWUgb2YgdGhlIHJlZHVjZS5cbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgd3JhcHBlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnJlZHVjZShcbiAgICAgKiAgICAgICAgUi5waXBlKFIuYWRkLCBSLmlmRWxzZShSLmx0ZSgxMCksIFIucmVkdWNlZCwgUi5pZGVudGl0eSkpLFxuICAgICAqICAgICAgICAwLFxuICAgICAqICAgICAgICBbMSwgMiwgMywgNCwgNV0pIC8vIDEwXG4gICAgICovXG4gICAgdmFyIHJlZHVjZWQgPSBfY3VycnkxKF9yZWR1Y2VkKTtcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHN1Yi1saXN0IG9mIGBsaXN0YCBzdGFydGluZyBhdCBpbmRleCBgc3RhcnRgIGFuZCBjb250YWluaW5nXG4gICAgICogYGNvdW50YCBlbGVtZW50cy4gIF9Ob3RlIHRoYXQgdGhpcyBpcyBub3QgZGVzdHJ1Y3RpdmVfOiBpdCByZXR1cm5zIGFcbiAgICAgKiBjb3B5IG9mIHRoZSBsaXN0IHdpdGggdGhlIGNoYW5nZXMuXG4gICAgICogPHNtYWxsPk5vIGxpc3RzIGhhdmUgYmVlbiBoYXJtZWQgaW4gdGhlIGFwcGxpY2F0aW9uIG9mIHRoaXMgZnVuY3Rpb24uPC9zbWFsbD5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IFRoZSBwb3NpdGlvbiB0byBzdGFydCByZW1vdmluZyBlbGVtZW50c1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHJlbW92ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gcmVtb3ZlIGZyb21cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgQXJyYXkgd2l0aCBgY291bnRgIGVsZW1lbnRzIGZyb20gYHN0YXJ0YCByZW1vdmVkLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucmVtb3ZlKDIsIDMsIFsxLDIsMyw0LDUsNiw3LDhdKTsgLy89PiBbMSwyLDYsNyw4XVxuICAgICAqL1xuICAgIHZhciByZW1vdmUgPSBfY3VycnkzKGZ1bmN0aW9uIHJlbW92ZShzdGFydCwgY291bnQsIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIF9jb25jYXQoX3NsaWNlKGxpc3QsIDAsIE1hdGgubWluKHN0YXJ0LCBsaXN0Lmxlbmd0aCkpLCBfc2xpY2UobGlzdCwgTWF0aC5taW4obGlzdC5sZW5ndGgsIHN0YXJ0ICsgY291bnQpKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIGEgc3Vic3RyaW5nIG9yIHJlZ2V4IG1hdGNoIGluIGEgc3RyaW5nIHdpdGggYSByZXBsYWNlbWVudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBSZWdFeHB8U3RyaW5nIC0+IFN0cmluZyAtPiBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtSZWdFeHB8U3RyaW5nfSBwYXR0ZXJuIEEgcmVndWxhciBleHByZXNzaW9uIG9yIGEgc3Vic3RyaW5nIHRvIG1hdGNoLlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXBsYWNlbWVudCBUaGUgc3RyaW5nIHRvIHJlcGxhY2UgdGhlIG1hdGNoZXMgd2l0aC5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBTdHJpbmcgdG8gZG8gdGhlIHNlYXJjaCBhbmQgcmVwbGFjZW1lbnQgaW4uXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgcmVzdWx0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucmVwbGFjZSgnZm9vJywgJ2JhcicsICdmb28gZm9vIGZvbycpOyAvLz0+ICdiYXIgZm9vIGZvbydcbiAgICAgKiAgICAgIFIucmVwbGFjZSgvZm9vLywgJ2JhcicsICdmb28gZm9vIGZvbycpOyAvLz0+ICdiYXIgZm9vIGZvbydcbiAgICAgKlxuICAgICAqICAgICAgLy8gVXNlIHRoZSBcImdcIiAoZ2xvYmFsKSBmbGFnIHRvIHJlcGxhY2UgYWxsIG9jY3VycmVuY2VzOlxuICAgICAqICAgICAgUi5yZXBsYWNlKC9mb28vZywgJ2JhcicsICdmb28gZm9vIGZvbycpOyAvLz0+ICdiYXIgYmFyIGJhcidcbiAgICAgKi9cbiAgICB2YXIgcmVwbGFjZSA9IF9jdXJyeTMoZnVuY3Rpb24gcmVwbGFjZShyZWdleCwgcmVwbGFjZW1lbnQsIHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UocmVnZXgsIHJlcGxhY2VtZW50KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCB3aXRoIHRoZSBzYW1lIGVsZW1lbnRzIGFzIHRoZSBvcmlnaW5hbCBsaXN0LCBqdXN0XG4gICAgICogaW4gdGhlIHJldmVyc2Ugb3JkZXIuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIHJldmVyc2UuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgY29weSBvZiB0aGUgbGlzdCBpbiByZXZlcnNlIG9yZGVyLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucmV2ZXJzZShbMSwgMiwgM10pOyAgLy89PiBbMywgMiwgMV1cbiAgICAgKiAgICAgIFIucmV2ZXJzZShbMSwgMl0pOyAgICAgLy89PiBbMiwgMV1cbiAgICAgKiAgICAgIFIucmV2ZXJzZShbMV0pOyAgICAgICAgLy89PiBbMV1cbiAgICAgKiAgICAgIFIucmV2ZXJzZShbXSk7ICAgICAgICAgLy89PiBbXVxuICAgICAqL1xuICAgIHZhciByZXZlcnNlID0gX2N1cnJ5MShmdW5jdGlvbiByZXZlcnNlKGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIF9zbGljZShsaXN0KS5yZXZlcnNlKCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBTY2FuIGlzIHNpbWlsYXIgdG8gcmVkdWNlLCBidXQgcmV0dXJucyBhIGxpc3Qgb2Ygc3VjY2Vzc2l2ZWx5IHJlZHVjZWQgdmFsdWVzIGZyb20gdGhlIGxlZnRcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEsYiAtPiBhKSAtPiBhIC0+IFtiXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24uIFJlY2VpdmVzIHR3byB2YWx1ZXMsIHRoZSBhY2N1bXVsYXRvciBhbmQgdGhlXG4gICAgICogICAgICAgIGN1cnJlbnQgZWxlbWVudCBmcm9tIHRoZSBhcnJheVxuICAgICAqIEBwYXJhbSB7Kn0gYWNjIFRoZSBhY2N1bXVsYXRvciB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBsaXN0IG9mIGFsbCBpbnRlcm1lZGlhdGVseSByZWR1Y2VkIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbnVtYmVycyA9IFsxLCAyLCAzLCA0XTtcbiAgICAgKiAgICAgIHZhciBmYWN0b3JpYWxzID0gUi5zY2FuKFIubXVsdGlwbHksIDEsIG51bWJlcnMpOyAvLz0+IFsxLCAxLCAyLCA2LCAyNF1cbiAgICAgKi9cbiAgICB2YXIgc2NhbiA9IF9jdXJyeTMoZnVuY3Rpb24gc2NhbihmbiwgYWNjLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSAwLCBsZW4gPSBsaXN0Lmxlbmd0aCwgcmVzdWx0ID0gW2FjY107XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIGFjYyA9IGZuKGFjYywgbGlzdFtpZHhdKTtcbiAgICAgICAgICAgIHJlc3VsdFtpZHggKyAxXSA9IGFjYztcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXN1bHQgb2YgXCJzZXR0aW5nXCIgdGhlIHBvcnRpb24gb2YgdGhlIGdpdmVuIGRhdGEgc3RydWN0dXJlXG4gICAgICogZm9jdXNlZCBieSB0aGUgZ2l2ZW4gbGVucyB0byB0aGUgZ2l2ZW4gdmFsdWUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEB0eXBlZGVmIExlbnMgcyBhID0gRnVuY3RvciBmID0+IChhIC0+IGYgYSkgLT4gcyAtPiBmIHNcbiAgICAgKiBAc2lnIExlbnMgcyBhIC0+IGEgLT4gcyAtPiBzXG4gICAgICogQHBhcmFtIHtMZW5zfSBsZW5zXG4gICAgICogQHBhcmFtIHsqfSB2XG4gICAgICogQHBhcmFtIHsqfSB4XG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIucHJvcCwgUi5sZW5zSW5kZXgsIFIubGVuc1Byb3BcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgeExlbnMgPSBSLmxlbnNQcm9wKCd4Jyk7XG4gICAgICpcbiAgICAgKiAgICAgIFIuc2V0KHhMZW5zLCA0LCB7eDogMSwgeTogMn0pOyAgLy89PiB7eDogNCwgeTogMn1cbiAgICAgKiAgICAgIFIuc2V0KHhMZW5zLCA4LCB7eDogMSwgeTogMn0pOyAgLy89PiB7eDogOCwgeTogMn1cbiAgICAgKi9cbiAgICB2YXIgc2V0ID0gX2N1cnJ5MyhmdW5jdGlvbiBzZXQobGVucywgdiwgeCkge1xuICAgICAgICByZXR1cm4gb3ZlcihsZW5zLCBhbHdheXModiksIHgpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGNvcHkgb2YgdGhlIGxpc3QsIHNvcnRlZCBhY2NvcmRpbmcgdG8gdGhlIGNvbXBhcmF0b3IgZnVuY3Rpb24sIHdoaWNoIHNob3VsZCBhY2NlcHQgdHdvIHZhbHVlcyBhdCBhXG4gICAgICogdGltZSBhbmQgcmV0dXJuIGEgbmVnYXRpdmUgbnVtYmVyIGlmIHRoZSBmaXJzdCB2YWx1ZSBpcyBzbWFsbGVyLCBhIHBvc2l0aXZlIG51bWJlciBpZiBpdCdzIGxhcmdlciwgYW5kIHplcm9cbiAgICAgKiBpZiB0aGV5IGFyZSBlcXVhbC4gIFBsZWFzZSBub3RlIHRoYXQgdGhpcyBpcyBhICoqY29weSoqIG9mIHRoZSBsaXN0LiAgSXQgZG9lcyBub3QgbW9kaWZ5IHRoZSBvcmlnaW5hbC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEsYSAtPiBOdW1iZXIpIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb21wYXJhdG9yIEEgc29ydGluZyBmdW5jdGlvbiA6OiBhIC0+IGIgLT4gSW50XG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBzb3J0XG4gICAgICogQHJldHVybiB7QXJyYXl9IGEgbmV3IGFycmF5IHdpdGggaXRzIGVsZW1lbnRzIHNvcnRlZCBieSB0aGUgY29tcGFyYXRvciBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZGlmZiA9IGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9O1xuICAgICAqICAgICAgUi5zb3J0KGRpZmYsIFs0LDIsNyw1XSk7IC8vPT4gWzIsIDQsIDUsIDddXG4gICAgICovXG4gICAgdmFyIHNvcnQgPSBfY3VycnkyKGZ1bmN0aW9uIHNvcnQoY29tcGFyYXRvciwgbGlzdCkge1xuICAgICAgICByZXR1cm4gX3NsaWNlKGxpc3QpLnNvcnQoY29tcGFyYXRvcik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBTb3J0cyB0aGUgbGlzdCBhY2NvcmRpbmcgdG8gdGhlIHN1cHBsaWVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgT3JkIGIgPT4gKGEgLT4gYikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBzb3J0LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBsaXN0IHNvcnRlZCBieSB0aGUga2V5cyBnZW5lcmF0ZWQgYnkgYGZuYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgc29ydEJ5Rmlyc3RJdGVtID0gUi5zb3J0QnkocHJvcCgwKSk7XG4gICAgICogICAgICB2YXIgc29ydEJ5TmFtZUNhc2VJbnNlbnNpdGl2ZSA9IFIuc29ydEJ5KFIuY29tcG9zZShSLnRvTG93ZXIsIFIucHJvcCgnbmFtZScpKSk7XG4gICAgICogICAgICB2YXIgcGFpcnMgPSBbWy0xLCAxXSwgWy0yLCAyXSwgWy0zLCAzXV07XG4gICAgICogICAgICBzb3J0QnlGaXJzdEl0ZW0ocGFpcnMpOyAvLz0+IFtbLTMsIDNdLCBbLTIsIDJdLCBbLTEsIDFdXVxuICAgICAqICAgICAgdmFyIGFsaWNlID0ge1xuICAgICAqICAgICAgICBuYW1lOiAnQUxJQ0UnLFxuICAgICAqICAgICAgICBhZ2U6IDEwMVxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHZhciBib2IgPSB7XG4gICAgICogICAgICAgIG5hbWU6ICdCb2InLFxuICAgICAqICAgICAgICBhZ2U6IC0xMFxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHZhciBjbGFyYSA9IHtcbiAgICAgKiAgICAgICAgbmFtZTogJ2NsYXJhJyxcbiAgICAgKiAgICAgICAgYWdlOiAzMTQuMTU5XG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgdmFyIHBlb3BsZSA9IFtjbGFyYSwgYm9iLCBhbGljZV07XG4gICAgICogICAgICBzb3J0QnlOYW1lQ2FzZUluc2Vuc2l0aXZlKHBlb3BsZSk7IC8vPT4gW2FsaWNlLCBib2IsIGNsYXJhXVxuICAgICAqL1xuICAgIHZhciBzb3J0QnkgPSBfY3VycnkyKGZ1bmN0aW9uIHNvcnRCeShmbiwgbGlzdCkge1xuICAgICAgICByZXR1cm4gX3NsaWNlKGxpc3QpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHZhciBhYSA9IGZuKGEpO1xuICAgICAgICAgICAgdmFyIGJiID0gZm4oYik7XG4gICAgICAgICAgICByZXR1cm4gYWEgPCBiYiA/IC0xIDogYWEgPiBiYiA/IDEgOiAwO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFN1YnRyYWN0cyB0d28gbnVtYmVycy4gRXF1aXZhbGVudCB0byBgYSAtIGJgIGJ1dCBjdXJyaWVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBhIFRoZSBmaXJzdCB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYiBUaGUgc2Vjb25kIHZhbHVlLlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIHJlc3VsdCBvZiBgYSAtIGJgLlxuICAgICAqIEBzZWUgUi5hZGRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnN1YnRyYWN0KDEwLCA4KTsgLy89PiAyXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBtaW51czUgPSBSLnN1YnRyYWN0KFIuX18sIDUpO1xuICAgICAqICAgICAgbWludXM1KDE3KTsgLy89PiAxMlxuICAgICAqXG4gICAgICogICAgICB2YXIgY29tcGxlbWVudGFyeUFuZ2xlID0gUi5zdWJ0cmFjdCg5MCk7XG4gICAgICogICAgICBjb21wbGVtZW50YXJ5QW5nbGUoMzApOyAvLz0+IDYwXG4gICAgICogICAgICBjb21wbGVtZW50YXJ5QW5nbGUoNzIpOyAvLz0+IDE4XG4gICAgICovXG4gICAgdmFyIHN1YnRyYWN0ID0gX2N1cnJ5MihmdW5jdGlvbiBzdWJ0cmFjdChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhIC0gYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBsYXN0IGBuYCBlbGVtZW50cyBvZiBhIGdpdmVuIGxpc3QsIHBhc3NpbmcgZWFjaCB2YWx1ZVxuICAgICAqIHRvIHRoZSBzdXBwbGllZCBwcmVkaWNhdGUgZnVuY3Rpb24sIGFuZCB0ZXJtaW5hdGluZyB3aGVuIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gcmV0dXJuc1xuICAgICAqIGBmYWxzZWAuIEV4Y2x1ZGVzIHRoZSBlbGVtZW50IHRoYXQgY2F1c2VkIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gdG8gZmFpbC4gVGhlIHByZWRpY2F0ZVxuICAgICAqIGZ1bmN0aW9uIGlzIHBhc3NlZCBvbmUgYXJndW1lbnQ6ICoodmFsdWUpKi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgYXJyYXkuXG4gICAgICogQHNlZSBSLmRyb3BMYXN0V2hpbGVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaXNOb3RPbmUgPSBmdW5jdGlvbih4KSB7XG4gICAgICogICAgICAgIHJldHVybiAhKHggPT09IDEpO1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgUi50YWtlTGFzdFdoaWxlKGlzTm90T25lLCBbMSwgMiwgMywgNF0pOyAvLz0+IFsyLCAzLCA0XVxuICAgICAqL1xuICAgIHZhciB0YWtlTGFzdFdoaWxlID0gX2N1cnJ5MihmdW5jdGlvbiB0YWtlTGFzdFdoaWxlKGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgIHdoaWxlIChpZHggPj0gMCAmJiBmbihsaXN0W2lkeF0pKSB7XG4gICAgICAgICAgICBpZHggLT0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3NsaWNlKGxpc3QsIGlkeCArIDEsIEluZmluaXR5KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJ1bnMgdGhlIGdpdmVuIGZ1bmN0aW9uIHdpdGggdGhlIHN1cHBsaWVkIG9iamVjdCwgdGhlbiByZXR1cm5zIHRoZSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoYSAtPiAqKSAtPiBhIC0+IGFcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aXRoIGB4YC4gVGhlIHJldHVybiB2YWx1ZSBvZiBgZm5gIHdpbGwgYmUgdGhyb3duIGF3YXkuXG4gICAgICogQHBhcmFtIHsqfSB4XG4gICAgICogQHJldHVybiB7Kn0gYHhgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBzYXlYID0gZnVuY3Rpb24oeCkgeyBjb25zb2xlLmxvZygneCBpcyAnICsgeCk7IH07XG4gICAgICogICAgICBSLnRhcChzYXlYLCAxMDApOyAvLz0+IDEwMFxuICAgICAqICAgICAgLy8tPiAneCBpcyAxMDAnXG4gICAgICovXG4gICAgdmFyIHRhcCA9IF9jdXJyeTIoZnVuY3Rpb24gdGFwKGZuLCB4KSB7XG4gICAgICAgIGZuKHgpO1xuICAgICAgICByZXR1cm4geDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgd2hldGhlciBhIGdpdmVuIHN0cmluZyBtYXRjaGVzIGEgZ2l2ZW4gcmVndWxhciBleHByZXNzaW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBzZWUgUi5tYXRjaFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAc2lnIFJlZ0V4cCAtPiBTdHJpbmcgLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7UmVnRXhwfSBwYXR0ZXJuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50ZXN0KC9eeC8sICd4eXonKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLnRlc3QoL155LywgJ3h5eicpOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIHRlc3QgPSBfY3VycnkyKGZ1bmN0aW9uIHRlc3QocGF0dGVybiwgc3RyKSB7XG4gICAgICAgIHJldHVybiBfY2xvbmVSZWdFeHAocGF0dGVybikudGVzdChzdHIpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ2FsbHMgYW4gaW5wdXQgZnVuY3Rpb24gYG5gIHRpbWVzLCByZXR1cm5pbmcgYW4gYXJyYXkgY29udGFpbmluZyB0aGUgcmVzdWx0cyBvZiB0aG9zZVxuICAgICAqIGZ1bmN0aW9uIGNhbGxzLlxuICAgICAqXG4gICAgICogYGZuYCBpcyBwYXNzZWQgb25lIGFyZ3VtZW50OiBUaGUgY3VycmVudCB2YWx1ZSBvZiBgbmAsIHdoaWNoIGJlZ2lucyBhdCBgMGAgYW5kIGlzXG4gICAgICogZ3JhZHVhbGx5IGluY3JlbWVudGVkIHRvIGBuIC0gMWAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChpIC0+IGEpIC0+IGkgLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGludm9rZS4gUGFzc2VkIG9uZSBhcmd1bWVudCwgdGhlIGN1cnJlbnQgdmFsdWUgb2YgYG5gLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuIEEgdmFsdWUgYmV0d2VlbiBgMGAgYW5kIGBuIC0gMWAuIEluY3JlbWVudHMgYWZ0ZXIgZWFjaCBmdW5jdGlvbiBjYWxsLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBjb250YWluaW5nIHRoZSByZXR1cm4gdmFsdWVzIG9mIGFsbCBjYWxscyB0byBgZm5gLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudGltZXMoUi5pZGVudGl0eSwgNSk7IC8vPT4gWzAsIDEsIDIsIDMsIDRdXG4gICAgICovXG4gICAgdmFyIHRpbWVzID0gX2N1cnJ5MihmdW5jdGlvbiB0aW1lcyhmbiwgbikge1xuICAgICAgICB2YXIgbGVuID0gTnVtYmVyKG4pO1xuICAgICAgICB2YXIgbGlzdCA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgbGlzdFtpZHhdID0gZm4oaWR4KTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYW4gb2JqZWN0IGludG8gYW4gYXJyYXkgb2Yga2V5LCB2YWx1ZSBhcnJheXMuXG4gICAgICogT25seSB0aGUgb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMgYXJlIHVzZWQuXG4gICAgICogTm90ZSB0aGF0IHRoZSBvcmRlciBvZiB0aGUgb3V0cHV0IGFycmF5IGlzIG5vdCBndWFyYW50ZWVkIHRvIGJlXG4gICAgICogY29uc2lzdGVudCBhY3Jvc3MgZGlmZmVyZW50IEpTIHBsYXRmb3Jtcy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7U3RyaW5nOiAqfSAtPiBbW1N0cmluZywqXV1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gZXh0cmFjdCBmcm9tXG4gICAgICogQHJldHVybiB7QXJyYXl9IEFuIGFycmF5IG9mIGtleSwgdmFsdWUgYXJyYXlzIGZyb20gdGhlIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzLlxuICAgICAqIEBzZWUgUi5mcm9tUGFpcnNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnRvUGFpcnMoe2E6IDEsIGI6IDIsIGM6IDN9KTsgLy89PiBbWydhJywgMV0sIFsnYicsIDJdLCBbJ2MnLCAzXV1cbiAgICAgKi9cbiAgICB2YXIgdG9QYWlycyA9IF9jdXJyeTEoZnVuY3Rpb24gdG9QYWlycyhvYmopIHtcbiAgICAgICAgdmFyIHBhaXJzID0gW107XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAoX2hhcyhwcm9wLCBvYmopKSB7XG4gICAgICAgICAgICAgICAgcGFpcnNbcGFpcnMubGVuZ3RoXSA9IFtcbiAgICAgICAgICAgICAgICAgICAgcHJvcCxcbiAgICAgICAgICAgICAgICAgICAgb2JqW3Byb3BdXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFpcnM7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhbiBvYmplY3QgaW50byBhbiBhcnJheSBvZiBrZXksIHZhbHVlIGFycmF5cy5cbiAgICAgKiBUaGUgb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMgYW5kIHByb3RvdHlwZSBwcm9wZXJ0aWVzIGFyZSB1c2VkLlxuICAgICAqIE5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgdGhlIG91dHB1dCBhcnJheSBpcyBub3QgZ3VhcmFudGVlZCB0byBiZVxuICAgICAqIGNvbnNpc3RlbnQgYWNyb3NzIGRpZmZlcmVudCBKUyBwbGF0Zm9ybXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge1N0cmluZzogKn0gLT4gW1tTdHJpbmcsKl1dXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGV4dHJhY3QgZnJvbVxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiBrZXksIHZhbHVlIGFycmF5cyBmcm9tIHRoZSBvYmplY3QncyBvd25cbiAgICAgKiAgICAgICAgIGFuZCBwcm90b3R5cGUgcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgRiA9IGZ1bmN0aW9uKCkgeyB0aGlzLnggPSAnWCc7IH07XG4gICAgICogICAgICBGLnByb3RvdHlwZS55ID0gJ1knO1xuICAgICAqICAgICAgdmFyIGYgPSBuZXcgRigpO1xuICAgICAqICAgICAgUi50b1BhaXJzSW4oZik7IC8vPT4gW1sneCcsJ1gnXSwgWyd5JywnWSddXVxuICAgICAqL1xuICAgIHZhciB0b1BhaXJzSW4gPSBfY3VycnkxKGZ1bmN0aW9uIHRvUGFpcnNJbihvYmopIHtcbiAgICAgICAgdmFyIHBhaXJzID0gW107XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICBwYWlyc1twYWlycy5sZW5ndGhdID0gW1xuICAgICAgICAgICAgICAgIHByb3AsXG4gICAgICAgICAgICAgICAgb2JqW3Byb3BdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYWlycztcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgKHN0cmlwcykgd2hpdGVzcGFjZSBmcm9tIGJvdGggZW5kcyBvZiB0aGUgc3RyaW5nLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAc2lnIFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBzdHJpbmcgdG8gdHJpbS5cbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRyaW1tZWQgdmVyc2lvbiBvZiBgc3RyYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnRyaW0oJyAgIHh5eiAgJyk7IC8vPT4gJ3h5eidcbiAgICAgKiAgICAgIFIubWFwKFIudHJpbSwgUi5zcGxpdCgnLCcsICd4LCB5LCB6JykpOyAvLz0+IFsneCcsICd5JywgJ3onXVxuICAgICAqL1xuICAgIHZhciB0cmltID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgd3MgPSAnXFx0XFxuXFx4MEJcXGZcXHIgXFx4QTBcXHUxNjgwXFx1MTgwRVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDMnICsgJ1xcdTIwMDRcXHUyMDA1XFx1MjAwNlxcdTIwMDdcXHUyMDA4XFx1MjAwOVxcdTIwMEFcXHUyMDJGXFx1MjA1RlxcdTMwMDBcXHUyMDI4JyArICdcXHUyMDI5XFx1RkVGRic7XG4gICAgICAgIHZhciB6ZXJvV2lkdGggPSAnXFx1MjAwQic7XG4gICAgICAgIHZhciBoYXNQcm90b1RyaW0gPSB0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS50cmltID09PSAnZnVuY3Rpb24nO1xuICAgICAgICBpZiAoIWhhc1Byb3RvVHJpbSB8fCAod3MudHJpbSgpIHx8ICF6ZXJvV2lkdGgudHJpbSgpKSkge1xuICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZnVuY3Rpb24gdHJpbShzdHIpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmVnaW5SeCA9IG5ldyBSZWdFeHAoJ15bJyArIHdzICsgJ11bJyArIHdzICsgJ10qJyk7XG4gICAgICAgICAgICAgICAgdmFyIGVuZFJ4ID0gbmV3IFJlZ0V4cCgnWycgKyB3cyArICddWycgKyB3cyArICddKiQnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyLnJlcGxhY2UoYmVnaW5SeCwgJycpLnJlcGxhY2UoZW5kUngsICcnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZnVuY3Rpb24gdHJpbShzdHIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RyLnRyaW0oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSgpO1xuXG4gICAgLyoqXG4gICAgICogR2l2ZXMgYSBzaW5nbGUtd29yZCBzdHJpbmcgZGVzY3JpcHRpb24gb2YgdGhlIChuYXRpdmUpIHR5cGUgb2YgYSB2YWx1ZSwgcmV0dXJuaW5nIHN1Y2hcbiAgICAgKiBhbnN3ZXJzIGFzICdPYmplY3QnLCAnTnVtYmVyJywgJ0FycmF5Jywgb3IgJ051bGwnLiAgRG9lcyBub3QgYXR0ZW1wdCB0byBkaXN0aW5ndWlzaCB1c2VyXG4gICAgICogT2JqZWN0IHR5cGVzIGFueSBmdXJ0aGVyLCByZXBvcnRpbmcgdGhlbSBhbGwgYXMgJ09iamVjdCcuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFR5cGVcbiAgICAgKiBAc2lnICgqIC0+IHsqfSkgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50eXBlKHt9KTsgLy89PiBcIk9iamVjdFwiXG4gICAgICogICAgICBSLnR5cGUoMSk7IC8vPT4gXCJOdW1iZXJcIlxuICAgICAqICAgICAgUi50eXBlKGZhbHNlKTsgLy89PiBcIkJvb2xlYW5cIlxuICAgICAqICAgICAgUi50eXBlKCdzJyk7IC8vPT4gXCJTdHJpbmdcIlxuICAgICAqICAgICAgUi50eXBlKG51bGwpOyAvLz0+IFwiTnVsbFwiXG4gICAgICogICAgICBSLnR5cGUoW10pOyAvLz0+IFwiQXJyYXlcIlxuICAgICAqICAgICAgUi50eXBlKC9bQS16XS8pOyAvLz0+IFwiUmVnRXhwXCJcbiAgICAgKi9cbiAgICB2YXIgdHlwZSA9IF9jdXJyeTEoZnVuY3Rpb24gdHlwZSh2YWwpIHtcbiAgICAgICAgcmV0dXJuIHZhbCA9PT0gbnVsbCA/ICdOdWxsJyA6IHZhbCA9PT0gdW5kZWZpbmVkID8gJ1VuZGVmaW5lZCcgOiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodmFsKS5zbGljZSg4LCAtMSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyBhIGZ1bmN0aW9uIGBmbmAsIHdoaWNoIHRha2VzIGEgc2luZ2xlIGFycmF5IGFyZ3VtZW50LCBhbmQgcmV0dXJuc1xuICAgICAqIGEgZnVuY3Rpb24gd2hpY2g6XG4gICAgICpcbiAgICAgKiAgIC0gdGFrZXMgYW55IG51bWJlciBvZiBwb3NpdGlvbmFsIGFyZ3VtZW50cztcbiAgICAgKiAgIC0gcGFzc2VzIHRoZXNlIGFyZ3VtZW50cyB0byBgZm5gIGFzIGFuIGFycmF5OyBhbmRcbiAgICAgKiAgIC0gcmV0dXJucyB0aGUgcmVzdWx0LlxuICAgICAqXG4gICAgICogSW4gb3RoZXIgd29yZHMsIFIudW5hcHBseSBkZXJpdmVzIGEgdmFyaWFkaWMgZnVuY3Rpb24gZnJvbSBhIGZ1bmN0aW9uXG4gICAgICogd2hpY2ggdGFrZXMgYW4gYXJyYXkuIFIudW5hcHBseSBpcyB0aGUgaW52ZXJzZSBvZiBSLmFwcGx5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKFsqLi4uXSAtPiBhKSAtPiAoKi4uLiAtPiBhKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQHNlZSBSLmFwcGx5XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi51bmFwcGx5KEpTT04uc3RyaW5naWZ5KSgxLCAyLCAzKTsgLy89PiAnWzEsMiwzXSdcbiAgICAgKi9cbiAgICB2YXIgdW5hcHBseSA9IF9jdXJyeTEoZnVuY3Rpb24gdW5hcHBseShmbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZuKF9zbGljZShhcmd1bWVudHMpKTtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFdyYXBzIGEgZnVuY3Rpb24gb2YgYW55IGFyaXR5IChpbmNsdWRpbmcgbnVsbGFyeSkgaW4gYSBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgZXhhY3RseSAxXG4gICAgICogcGFyYW1ldGVyLiBBbnkgZXh0cmFuZW91cyBwYXJhbWV0ZXJzIHdpbGwgbm90IGJlIHBhc3NlZCB0byB0aGUgc3VwcGxpZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKiAtPiBiKSAtPiAoYSAtPiBiKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byB3cmFwLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbiB3cmFwcGluZyBgZm5gLiBUaGUgbmV3IGZ1bmN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgb2ZcbiAgICAgKiAgICAgICAgIGFyaXR5IDEuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRha2VzVHdvQXJncyA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIFthLCBiXTtcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICB0YWtlc1R3b0FyZ3MubGVuZ3RoOyAvLz0+IDJcbiAgICAgKiAgICAgIHRha2VzVHdvQXJncygxLCAyKTsgLy89PiBbMSwgMl1cbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRha2VzT25lQXJnID0gUi51bmFyeSh0YWtlc1R3b0FyZ3MpO1xuICAgICAqICAgICAgdGFrZXNPbmVBcmcubGVuZ3RoOyAvLz0+IDFcbiAgICAgKiAgICAgIC8vIE9ubHkgMSBhcmd1bWVudCBpcyBwYXNzZWQgdG8gdGhlIHdyYXBwZWQgZnVuY3Rpb25cbiAgICAgKiAgICAgIHRha2VzT25lQXJnKDEsIDIpOyAvLz0+IFsxLCB1bmRlZmluZWRdXG4gICAgICovXG4gICAgdmFyIHVuYXJ5ID0gX2N1cnJ5MShmdW5jdGlvbiB1bmFyeShmbikge1xuICAgICAgICByZXR1cm4gbkFyeSgxLCBmbik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24gb2YgYXJpdHkgYG5gIGZyb20gYSAobWFudWFsbHkpIGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyBOdW1iZXIgLT4gKGEgLT4gYikgLT4gKGEgLT4gYylcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gbGVuZ3RoIFRoZSBhcml0eSBmb3IgdGhlIHJldHVybmVkIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byB1bmN1cnJ5LlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAc2VlIFIuY3VycnlcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYWRkRm91ciA9IGZ1bmN0aW9uKGEpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGIpIHtcbiAgICAgKiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oYykge1xuICAgICAqICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGQpIHtcbiAgICAgKiAgICAgICAgICAgICAgcmV0dXJuIGEgKyBiICsgYyArIGQ7XG4gICAgICogICAgICAgICAgICB9O1xuICAgICAqICAgICAgICAgIH07XG4gICAgICogICAgICAgIH07XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICB2YXIgdW5jdXJyaWVkQWRkRm91ciA9IFIudW5jdXJyeU4oNCwgYWRkRm91cik7XG4gICAgICogICAgICBjdXJyaWVkQWRkRm91cigxLCAyLCAzLCA0KTsgLy89PiAxMFxuICAgICAqL1xuICAgIHZhciB1bmN1cnJ5TiA9IF9jdXJyeTIoZnVuY3Rpb24gdW5jdXJyeU4oZGVwdGgsIGZuKSB7XG4gICAgICAgIHJldHVybiBjdXJyeU4oZGVwdGgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50RGVwdGggPSAxO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gZm47XG4gICAgICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgICAgIHZhciBlbmRJZHg7XG4gICAgICAgICAgICB3aGlsZSAoY3VycmVudERlcHRoIDw9IGRlcHRoICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGVuZElkeCA9IGN1cnJlbnREZXB0aCA9PT0gZGVwdGggPyBhcmd1bWVudHMubGVuZ3RoIDogaWR4ICsgdmFsdWUubGVuZ3RoO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUuYXBwbHkodGhpcywgX3NsaWNlKGFyZ3VtZW50cywgaWR4LCBlbmRJZHgpKTtcbiAgICAgICAgICAgICAgICBjdXJyZW50RGVwdGggKz0gMTtcbiAgICAgICAgICAgICAgICBpZHggPSBlbmRJZHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQnVpbGRzIGEgbGlzdCBmcm9tIGEgc2VlZCB2YWx1ZS4gQWNjZXB0cyBhbiBpdGVyYXRvciBmdW5jdGlvbiwgd2hpY2ggcmV0dXJucyBlaXRoZXIgZmFsc2VcbiAgICAgKiB0byBzdG9wIGl0ZXJhdGlvbiBvciBhbiBhcnJheSBvZiBsZW5ndGggMiBjb250YWluaW5nIHRoZSB2YWx1ZSB0byBhZGQgdG8gdGhlIHJlc3VsdGluZ1xuICAgICAqIGxpc3QgYW5kIHRoZSBzZWVkIHRvIGJlIHVzZWQgaW4gdGhlIG5leHQgY2FsbCB0byB0aGUgaXRlcmF0b3IgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24gcmVjZWl2ZXMgb25lIGFyZ3VtZW50OiAqKHNlZWQpKi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gW2JdKSAtPiAqIC0+IFtiXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBpdGVyYXRvciBmdW5jdGlvbi4gcmVjZWl2ZXMgb25lIGFyZ3VtZW50LCBgc2VlZGAsIGFuZCByZXR1cm5zXG4gICAgICogICAgICAgIGVpdGhlciBmYWxzZSB0byBxdWl0IGl0ZXJhdGlvbiBvciBhbiBhcnJheSBvZiBsZW5ndGggdHdvIHRvIHByb2NlZWQuIFRoZSBlbGVtZW50XG4gICAgICogICAgICAgIGF0IGluZGV4IDAgb2YgdGhpcyBhcnJheSB3aWxsIGJlIGFkZGVkIHRvIHRoZSByZXN1bHRpbmcgYXJyYXksIGFuZCB0aGUgZWxlbWVudFxuICAgICAqICAgICAgICBhdCBpbmRleCAxIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBuZXh0IGNhbGwgdG8gYGZuYC5cbiAgICAgKiBAcGFyYW0geyp9IHNlZWQgVGhlIHNlZWQgdmFsdWUuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBmaW5hbCBsaXN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBmID0gZnVuY3Rpb24obikgeyByZXR1cm4gbiA+IDUwID8gZmFsc2UgOiBbLW4sIG4gKyAxMF0gfTtcbiAgICAgKiAgICAgIFIudW5mb2xkKGYsIDEwKTsgLy89PiBbLTEwLCAtMjAsIC0zMCwgLTQwLCAtNTBdXG4gICAgICovXG4gICAgdmFyIHVuZm9sZCA9IF9jdXJyeTIoZnVuY3Rpb24gdW5mb2xkKGZuLCBzZWVkKSB7XG4gICAgICAgIHZhciBwYWlyID0gZm4oc2VlZCk7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgd2hpbGUgKHBhaXIgJiYgcGFpci5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoXSA9IHBhaXJbMF07XG4gICAgICAgICAgICBwYWlyID0gZm4ocGFpclsxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIG9ubHkgb25lIGNvcHkgb2YgZWFjaCBlbGVtZW50IGluIHRoZSBvcmlnaW5hbCBsaXN0LCBiYXNlZFxuICAgICAqIHVwb24gdGhlIHZhbHVlIHJldHVybmVkIGJ5IGFwcGx5aW5nIHRoZSBzdXBwbGllZCBwcmVkaWNhdGUgdG8gdHdvIGxpc3QgZWxlbWVudHMuIFByZWZlcnNcbiAgICAgKiB0aGUgZmlyc3QgaXRlbSBpZiB0d28gaXRlbXMgY29tcGFyZSBlcXVhbCBiYXNlZCBvbiB0aGUgcHJlZGljYXRlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSwgYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSB1c2VkIHRvIHRlc3Qgd2hldGhlciB0d28gaXRlbXMgYXJlIGVxdWFsLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBvZiB1bmlxdWUgaXRlbXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHN0ckVxID0gZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gU3RyaW5nKGEpID09PSBTdHJpbmcoYik7IH07XG4gICAgICogICAgICBSLnVuaXFXaXRoKHN0ckVxKShbMSwgJzEnLCAyLCAxXSk7IC8vPT4gWzEsIDJdXG4gICAgICogICAgICBSLnVuaXFXaXRoKHN0ckVxKShbe30sIHt9XSk7ICAgICAgIC8vPT4gW3t9XVxuICAgICAqICAgICAgUi51bmlxV2l0aChzdHJFcSkoWzEsICcxJywgMV0pOyAgICAvLz0+IFsxXVxuICAgICAqICAgICAgUi51bmlxV2l0aChzdHJFcSkoWycxJywgMSwgMV0pOyAgICAvLz0+IFsnMSddXG4gICAgICovXG4gICAgdmFyIHVuaXFXaXRoID0gX2N1cnJ5MihmdW5jdGlvbiB1bmlxV2l0aChwcmVkLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSAwLCBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdLCBpdGVtO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBpdGVtID0gbGlzdFtpZHhdO1xuICAgICAgICAgICAgaWYgKCFfY29udGFpbnNXaXRoKHByZWQsIGl0ZW0sIHJlc3VsdCkpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBpdGVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgY29weSBvZiB0aGUgYXJyYXkgd2l0aCB0aGUgZWxlbWVudCBhdCB0aGVcbiAgICAgKiBwcm92aWRlZCBpbmRleCByZXBsYWNlZCB3aXRoIHRoZSBnaXZlbiB2YWx1ZS5cbiAgICAgKiBAc2VlIFIuYWRqdXN0XG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBhIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaWR4IFRoZSBpbmRleCB0byB1cGRhdGUuXG4gICAgICogQHBhcmFtIHsqfSB4IFRoZSB2YWx1ZSB0byBleGlzdCBhdCB0aGUgZ2l2ZW4gaW5kZXggb2YgdGhlIHJldHVybmVkIGFycmF5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl8QXJndW1lbnRzfSBsaXN0IFRoZSBzb3VyY2UgYXJyYXktbGlrZSBvYmplY3QgdG8gYmUgdXBkYXRlZC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBjb3B5IG9mIGBsaXN0YCB3aXRoIHRoZSB2YWx1ZSBhdCBpbmRleCBgaWR4YCByZXBsYWNlZCB3aXRoIGB4YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnVwZGF0ZSgxLCAxMSwgWzAsIDEsIDJdKTsgICAgIC8vPT4gWzAsIDExLCAyXVxuICAgICAqICAgICAgUi51cGRhdGUoMSkoMTEpKFswLCAxLCAyXSk7ICAgICAvLz0+IFswLCAxMSwgMl1cbiAgICAgKi9cbiAgICB2YXIgdXBkYXRlID0gX2N1cnJ5MyhmdW5jdGlvbiB1cGRhdGUoaWR4LCB4LCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBhZGp1c3QoYWx3YXlzKHgpLCBpZHgsIGxpc3QpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxpc3Qgb2YgYWxsIHRoZSBlbnVtZXJhYmxlIG93biBwcm9wZXJ0aWVzIG9mIHRoZSBzdXBwbGllZCBvYmplY3QuXG4gICAgICogTm90ZSB0aGF0IHRoZSBvcmRlciBvZiB0aGUgb3V0cHV0IGFycmF5IGlzIG5vdCBndWFyYW50ZWVkIGFjcm9zc1xuICAgICAqIGRpZmZlcmVudCBKUyBwbGF0Zm9ybXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge2s6IHZ9IC0+IFt2XVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBleHRyYWN0IHZhbHVlcyBmcm9tXG4gICAgICogQHJldHVybiB7QXJyYXl9IEFuIGFycmF5IG9mIHRoZSB2YWx1ZXMgb2YgdGhlIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudmFsdWVzKHthOiAxLCBiOiAyLCBjOiAzfSk7IC8vPT4gWzEsIDIsIDNdXG4gICAgICovXG4gICAgdmFyIHZhbHVlcyA9IF9jdXJyeTEoZnVuY3Rpb24gdmFsdWVzKG9iaikge1xuICAgICAgICB2YXIgcHJvcHMgPSBrZXlzKG9iaik7XG4gICAgICAgIHZhciBsZW4gPSBwcm9wcy5sZW5ndGg7XG4gICAgICAgIHZhciB2YWxzID0gW107XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICB2YWxzW2lkeF0gPSBvYmpbcHJvcHNbaWR4XV07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFscztcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsaXN0IG9mIGFsbCB0aGUgcHJvcGVydGllcywgaW5jbHVkaW5nIHByb3RvdHlwZSBwcm9wZXJ0aWVzLFxuICAgICAqIG9mIHRoZSBzdXBwbGllZCBvYmplY3QuXG4gICAgICogTm90ZSB0aGF0IHRoZSBvcmRlciBvZiB0aGUgb3V0cHV0IGFycmF5IGlzIG5vdCBndWFyYW50ZWVkIHRvIGJlXG4gICAgICogY29uc2lzdGVudCBhY3Jvc3MgZGlmZmVyZW50IEpTIHBsYXRmb3Jtcy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7azogdn0gLT4gW3ZdXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGV4dHJhY3QgdmFsdWVzIGZyb21cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2YgdGhlIHZhbHVlcyBvZiB0aGUgb2JqZWN0J3Mgb3duIGFuZCBwcm90b3R5cGUgcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgRiA9IGZ1bmN0aW9uKCkgeyB0aGlzLnggPSAnWCc7IH07XG4gICAgICogICAgICBGLnByb3RvdHlwZS55ID0gJ1knO1xuICAgICAqICAgICAgdmFyIGYgPSBuZXcgRigpO1xuICAgICAqICAgICAgUi52YWx1ZXNJbihmKTsgLy89PiBbJ1gnLCAnWSddXG4gICAgICovXG4gICAgdmFyIHZhbHVlc0luID0gX2N1cnJ5MShmdW5jdGlvbiB2YWx1ZXNJbihvYmopIHtcbiAgICAgICAgdmFyIHByb3AsIHZzID0gW107XG4gICAgICAgIGZvciAocHJvcCBpbiBvYmopIHtcbiAgICAgICAgICAgIHZzW3ZzLmxlbmd0aF0gPSBvYmpbcHJvcF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZzO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFwidmlld1wiIG9mIHRoZSBnaXZlbiBkYXRhIHN0cnVjdHVyZSwgZGV0ZXJtaW5lZCBieSB0aGUgZ2l2ZW4gbGVucy5cbiAgICAgKiBUaGUgbGVucydzIGZvY3VzIGRldGVybWluZXMgd2hpY2ggcG9ydGlvbiBvZiB0aGUgZGF0YSBzdHJ1Y3R1cmUgaXMgdmlzaWJsZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHR5cGVkZWYgTGVucyBzIGEgPSBGdW5jdG9yIGYgPT4gKGEgLT4gZiBhKSAtPiBzIC0+IGYgc1xuICAgICAqIEBzaWcgTGVucyBzIGEgLT4gcyAtPiBhXG4gICAgICogQHBhcmFtIHtMZW5zfSBsZW5zXG4gICAgICogQHBhcmFtIHsqfSB4XG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIucHJvcCwgUi5sZW5zSW5kZXgsIFIubGVuc1Byb3BcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgeExlbnMgPSBSLmxlbnNQcm9wKCd4Jyk7XG4gICAgICpcbiAgICAgKiAgICAgIFIudmlldyh4TGVucywge3g6IDEsIHk6IDJ9KTsgIC8vPT4gMVxuICAgICAqICAgICAgUi52aWV3KHhMZW5zLCB7eDogNCwgeTogMn0pOyAgLy89PiA0XG4gICAgICovXG4gICAgdmFyIHZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBDb25zdCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB4LFxuICAgICAgICAgICAgICAgIG1hcDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiB2aWV3KGxlbnMsIHgpIHtcbiAgICAgICAgICAgIHJldHVybiBsZW5zKENvbnN0KSh4KS52YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgLyoqXG4gICAgICogVGFrZXMgYSBzcGVjIG9iamVjdCBhbmQgYSB0ZXN0IG9iamVjdDsgcmV0dXJucyB0cnVlIGlmIHRoZSB0ZXN0IHNhdGlzZmllc1xuICAgICAqIHRoZSBzcGVjLiBFYWNoIG9mIHRoZSBzcGVjJ3Mgb3duIHByb3BlcnRpZXMgbXVzdCBiZSBhIHByZWRpY2F0ZSBmdW5jdGlvbi5cbiAgICAgKiBFYWNoIHByZWRpY2F0ZSBpcyBhcHBsaWVkIHRvIHRoZSB2YWx1ZSBvZiB0aGUgY29ycmVzcG9uZGluZyBwcm9wZXJ0eSBvZlxuICAgICAqIHRoZSB0ZXN0IG9iamVjdC4gYHdoZXJlYCByZXR1cm5zIHRydWUgaWYgYWxsIHRoZSBwcmVkaWNhdGVzIHJldHVybiB0cnVlLFxuICAgICAqIGZhbHNlIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIGB3aGVyZWAgaXMgd2VsbCBzdWl0ZWQgdG8gZGVjbGFyYXRpdmVseSBleHByZXNzaW5nIGNvbnN0cmFpbnRzIGZvciBvdGhlclxuICAgICAqIGZ1bmN0aW9ucyBzdWNoIGFzIGBmaWx0ZXJgIGFuZCBgZmluZGAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge1N0cmluZzogKCogLT4gQm9vbGVhbil9IC0+IHtTdHJpbmc6ICp9IC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc3BlY1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0ZXN0T2JqXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICAvLyBwcmVkIDo6IE9iamVjdCAtPiBCb29sZWFuXG4gICAgICogICAgICB2YXIgcHJlZCA9IFIud2hlcmUoe1xuICAgICAqICAgICAgICBhOiBSLmVxdWFscygnZm9vJyksXG4gICAgICogICAgICAgIGI6IFIuY29tcGxlbWVudChSLmVxdWFscygnYmFyJykpLFxuICAgICAqICAgICAgICB4OiBSLmd0KF8sIDEwKSxcbiAgICAgKiAgICAgICAgeTogUi5sdChfLCAyMClcbiAgICAgKiAgICAgIH0pO1xuICAgICAqXG4gICAgICogICAgICBwcmVkKHthOiAnZm9vJywgYjogJ3h4eCcsIHg6IDExLCB5OiAxOX0pOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIHByZWQoe2E6ICd4eHgnLCBiOiAneHh4JywgeDogMTEsIHk6IDE5fSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIHByZWQoe2E6ICdmb28nLCBiOiAnYmFyJywgeDogMTEsIHk6IDE5fSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIHByZWQoe2E6ICdmb28nLCBiOiAneHh4JywgeDogMTAsIHk6IDE5fSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIHByZWQoe2E6ICdmb28nLCBiOiAneHh4JywgeDogMTEsIHk6IDIwfSk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgd2hlcmUgPSBfY3VycnkyKGZ1bmN0aW9uIHdoZXJlKHNwZWMsIHRlc3RPYmopIHtcbiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBzcGVjKSB7XG4gICAgICAgICAgICBpZiAoX2hhcyhwcm9wLCBzcGVjKSAmJiAhc3BlY1twcm9wXSh0ZXN0T2JqW3Byb3BdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFdyYXAgYSBmdW5jdGlvbiBpbnNpZGUgYW5vdGhlciB0byBhbGxvdyB5b3UgdG8gbWFrZSBhZGp1c3RtZW50cyB0byB0aGUgcGFyYW1ldGVycywgb3IgZG9cbiAgICAgKiBvdGhlciBwcm9jZXNzaW5nIGVpdGhlciBiZWZvcmUgdGhlIGludGVybmFsIGZ1bmN0aW9uIGlzIGNhbGxlZCBvciB3aXRoIGl0cyByZXN1bHRzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKGEuLi4gLT4gYikgLT4gKChhLi4uIC0+IGIpIC0+IGEuLi4gLT4gYykgLT4gKGEuLi4gLT4gYylcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB3cmFwcGVyIFRoZSB3cmFwcGVyIGZ1bmN0aW9uLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBUaGUgd3JhcHBlZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZ3JlZXQgPSBmdW5jdGlvbihuYW1lKSB7cmV0dXJuICdIZWxsbyAnICsgbmFtZTt9O1xuICAgICAqXG4gICAgICogICAgICB2YXIgc2hvdXRlZEdyZWV0ID0gUi53cmFwKGdyZWV0LCBmdW5jdGlvbihnciwgbmFtZSkge1xuICAgICAqICAgICAgICByZXR1cm4gZ3IobmFtZSkudG9VcHBlckNhc2UoKTtcbiAgICAgKiAgICAgIH0pO1xuICAgICAqICAgICAgc2hvdXRlZEdyZWV0KFwiS2F0aHlcIik7IC8vPT4gXCJIRUxMTyBLQVRIWVwiXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBzaG9ydGVuZWRHcmVldCA9IFIud3JhcChncmVldCwgZnVuY3Rpb24oZ3IsIG5hbWUpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGdyKG5hbWUuc3Vic3RyaW5nKDAsIDMpKTtcbiAgICAgKiAgICAgIH0pO1xuICAgICAqICAgICAgc2hvcnRlbmVkR3JlZXQoXCJSb2JlcnRcIik7IC8vPT4gXCJIZWxsbyBSb2JcIlxuICAgICAqL1xuICAgIHZhciB3cmFwID0gX2N1cnJ5MihmdW5jdGlvbiB3cmFwKGZuLCB3cmFwcGVyKSB7XG4gICAgICAgIHJldHVybiBjdXJyeU4oZm4ubGVuZ3RoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gd3JhcHBlci5hcHBseSh0aGlzLCBfY29uY2F0KFtmbl0sIGFyZ3VtZW50cykpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgbGlzdCBvdXQgb2YgdGhlIHR3byBzdXBwbGllZCBieSBjcmVhdGluZyBlYWNoIHBvc3NpYmxlXG4gICAgICogcGFpciBmcm9tIHRoZSBsaXN0cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW2FdIC0+IFtiXSAtPiBbW2EsYl1dXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXMgVGhlIGZpcnN0IGxpc3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gYnMgVGhlIHNlY29uZCBsaXN0LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBtYWRlIGJ5IGNvbWJpbmluZyBlYWNoIHBvc3NpYmxlIHBhaXIgZnJvbVxuICAgICAqICAgICAgICAgYGFzYCBhbmQgYGJzYCBpbnRvIHBhaXJzIChgW2EsIGJdYCkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi54cHJvZChbMSwgMl0sIFsnYScsICdiJ10pOyAvLz0+IFtbMSwgJ2EnXSwgWzEsICdiJ10sIFsyLCAnYSddLCBbMiwgJ2InXV1cbiAgICAgKi9cbiAgICAvLyA9IHhwcm9kV2l0aChwcmVwZW5kKTsgKHRha2VzIGFib3V0IDMgdGltZXMgYXMgbG9uZy4uLilcbiAgICB2YXIgeHByb2QgPSBfY3VycnkyKGZ1bmN0aW9uIHhwcm9kKGEsIGIpIHtcbiAgICAgICAgLy8gPSB4cHJvZFdpdGgocHJlcGVuZCk7ICh0YWtlcyBhYm91dCAzIHRpbWVzIGFzIGxvbmcuLi4pXG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB2YXIgaWxlbiA9IGEubGVuZ3RoO1xuICAgICAgICB2YXIgajtcbiAgICAgICAgdmFyIGpsZW4gPSBiLmxlbmd0aDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB3aGlsZSAoaWR4IDwgaWxlbikge1xuICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoaiA8IGpsZW4pIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBbXG4gICAgICAgICAgICAgICAgICAgIGFbaWR4XSxcbiAgICAgICAgICAgICAgICAgICAgYltqXVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgaiArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgbGlzdCBvdXQgb2YgdGhlIHR3byBzdXBwbGllZCBieSBwYWlyaW5nIHVwXG4gICAgICogZXF1YWxseS1wb3NpdGlvbmVkIGl0ZW1zIGZyb20gYm90aCBsaXN0cy4gIFRoZSByZXR1cm5lZCBsaXN0IGlzXG4gICAgICogdHJ1bmNhdGVkIHRvIHRoZSBsZW5ndGggb2YgdGhlIHNob3J0ZXIgb2YgdGhlIHR3byBpbnB1dCBsaXN0cy5cbiAgICAgKiBOb3RlOiBgemlwYCBpcyBlcXVpdmFsZW50IHRvIGB6aXBXaXRoKGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIFthLCBiXSB9KWAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBbYl0gLT4gW1thLGJdXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QxIFRoZSBmaXJzdCBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MiBUaGUgc2Vjb25kIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBtYWRlIGJ5IHBhaXJpbmcgdXAgc2FtZS1pbmRleGVkIGVsZW1lbnRzIG9mIGBsaXN0MWAgYW5kIGBsaXN0MmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi56aXAoWzEsIDIsIDNdLCBbJ2EnLCAnYicsICdjJ10pOyAvLz0+IFtbMSwgJ2EnXSwgWzIsICdiJ10sIFszLCAnYyddXVxuICAgICAqL1xuICAgIHZhciB6aXAgPSBfY3VycnkyKGZ1bmN0aW9uIHppcChhLCBiKSB7XG4gICAgICAgIHZhciBydiA9IFtdO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgdmFyIGxlbiA9IE1hdGgubWluKGEubGVuZ3RoLCBiLmxlbmd0aCk7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIHJ2W2lkeF0gPSBbXG4gICAgICAgICAgICAgICAgYVtpZHhdLFxuICAgICAgICAgICAgICAgIGJbaWR4XVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBydjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgb2JqZWN0IG91dCBvZiBhIGxpc3Qgb2Yga2V5cyBhbmQgYSBsaXN0IG9mIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW1N0cmluZ10gLT4gWypdIC0+IHtTdHJpbmc6ICp9XG4gICAgICogQHBhcmFtIHtBcnJheX0ga2V5cyBUaGUgYXJyYXkgdGhhdCB3aWxsIGJlIHByb3BlcnRpZXMgb24gdGhlIG91dHB1dCBvYmplY3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gdmFsdWVzIFRoZSBsaXN0IG9mIHZhbHVlcyBvbiB0aGUgb3V0cHV0IG9iamVjdC5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IFRoZSBvYmplY3QgbWFkZSBieSBwYWlyaW5nIHVwIHNhbWUtaW5kZXhlZCBlbGVtZW50cyBvZiBga2V5c2AgYW5kIGB2YWx1ZXNgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuemlwT2JqKFsnYScsICdiJywgJ2MnXSwgWzEsIDIsIDNdKTsgLy89PiB7YTogMSwgYjogMiwgYzogM31cbiAgICAgKi9cbiAgICB2YXIgemlwT2JqID0gX2N1cnJ5MihmdW5jdGlvbiB6aXBPYmooa2V5cywgdmFsdWVzKSB7XG4gICAgICAgIHZhciBpZHggPSAwLCBsZW4gPSBrZXlzLmxlbmd0aCwgb3V0ID0ge307XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIG91dFtrZXlzW2lkeF1dID0gdmFsdWVzW2lkeF07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBsaXN0IG91dCBvZiB0aGUgdHdvIHN1cHBsaWVkIGJ5IGFwcGx5aW5nIHRoZSBmdW5jdGlvbiB0b1xuICAgICAqIGVhY2ggZXF1YWxseS1wb3NpdGlvbmVkIHBhaXIgaW4gdGhlIGxpc3RzLiBUaGUgcmV0dXJuZWQgbGlzdCBpc1xuICAgICAqIHRydW5jYXRlZCB0byB0aGUgbGVuZ3RoIG9mIHRoZSBzaG9ydGVyIG9mIHRoZSB0d28gaW5wdXQgbGlzdHMuXG4gICAgICpcbiAgICAgKiBAZnVuY3Rpb25cbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSxiIC0+IGMpIC0+IFthXSAtPiBbYl0gLT4gW2NdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHVzZWQgdG8gY29tYmluZSB0aGUgdHdvIGVsZW1lbnRzIGludG8gb25lIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QxIFRoZSBmaXJzdCBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MiBUaGUgc2Vjb25kIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBtYWRlIGJ5IGNvbWJpbmluZyBzYW1lLWluZGV4ZWQgZWxlbWVudHMgb2YgYGxpc3QxYCBhbmQgYGxpc3QyYFxuICAgICAqICAgICAgICAgdXNpbmcgYGZuYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZiA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgKiAgICAgICAgLy8gLi4uXG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgUi56aXBXaXRoKGYsIFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddKTtcbiAgICAgKiAgICAgIC8vPT4gW2YoMSwgJ2EnKSwgZigyLCAnYicpLCBmKDMsICdjJyldXG4gICAgICovXG4gICAgdmFyIHppcFdpdGggPSBfY3VycnkzKGZ1bmN0aW9uIHppcFdpdGgoZm4sIGEsIGIpIHtcbiAgICAgICAgdmFyIHJ2ID0gW10sIGlkeCA9IDAsIGxlbiA9IE1hdGgubWluKGEubGVuZ3RoLCBiLmxlbmd0aCk7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIHJ2W2lkeF0gPSBmbihhW2lkeF0sIGJbaWR4XSk7XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcnY7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRoYXQgYWx3YXlzIHJldHVybnMgYGZhbHNlYC4gQW55IHBhc3NlZCBpbiBwYXJhbWV0ZXJzIGFyZSBpZ25vcmVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKiAtPiBmYWxzZVxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGZhbHNlXG4gICAgICogQHNlZSBSLmFsd2F5cywgUi5UXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5GKCk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgRiA9IGFsd2F5cyhmYWxzZSk7XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRoYXQgYWx3YXlzIHJldHVybnMgYHRydWVgLiBBbnkgcGFzc2VkIGluIHBhcmFtZXRlcnMgYXJlIGlnbm9yZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAqIC0+IHRydWVcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAuXG4gICAgICogQHNlZSBSLmFsd2F5cywgUi5GXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5UKCk7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBUID0gYWx3YXlzKHRydWUpO1xuXG4gICAgLyoqXG4gICAgICogU2ltaWxhciB0byBoYXNNZXRob2QsIHRoaXMgY2hlY2tzIHdoZXRoZXIgYSBmdW5jdGlvbiBoYXMgYSBbbWV0aG9kbmFtZV1cbiAgICAgKiBmdW5jdGlvbi4gSWYgaXQgaXNuJ3QgYW4gYXJyYXkgaXQgd2lsbCBleGVjdXRlIHRoYXQgZnVuY3Rpb24gb3RoZXJ3aXNlIGl0IHdpbGxcbiAgICAgKiBkZWZhdWx0IHRvIHRoZSByYW1kYSBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gcmFtZGEgaW1wbGVtdGF0aW9uXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZG5hbWUgcHJvcGVydHkgdG8gY2hlY2sgZm9yIGEgY3VzdG9tIGltcGxlbWVudGF0aW9uXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBXaGF0ZXZlciB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBtZXRob2QgaXMuXG4gICAgICovXG4gICAgdmFyIF9jaGVja0Zvck1ldGhvZCA9IGZ1bmN0aW9uIF9jaGVja0Zvck1ldGhvZChtZXRob2RuYW1lLCBmbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgICAgICBpZiAobGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzW2xlbmd0aCAtIDFdO1xuICAgICAgICAgICAgcmV0dXJuIF9pc0FycmF5KG9iaikgfHwgdHlwZW9mIG9ialttZXRob2RuYW1lXSAhPT0gJ2Z1bmN0aW9uJyA/IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgOiBvYmpbbWV0aG9kbmFtZV0uYXBwbHkob2JqLCBfc2xpY2UoYXJndW1lbnRzLCAwLCBsZW5ndGggLSAxKSk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENvcGllcyBhbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGJlIGNvcGllZFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHJlZkZyb20gQXJyYXkgY29udGFpbmluZyB0aGUgc291cmNlIHJlZmVyZW5jZXNcbiAgICAgKiBAcGFyYW0ge0FycmF5fSByZWZUbyBBcnJheSBjb250YWluaW5nIHRoZSBjb3BpZWQgc291cmNlIHJlZmVyZW5jZXNcbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgY29waWVkIHZhbHVlLlxuICAgICAqL1xuICAgIHZhciBfY2xvbmUgPSBmdW5jdGlvbiBfY2xvbmUodmFsdWUsIHJlZkZyb20sIHJlZlRvKSB7XG4gICAgICAgIHZhciBjb3B5ID0gZnVuY3Rpb24gY29weShjb3BpZWRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGxlbiA9IHJlZkZyb20ubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSByZWZGcm9tW2lkeF0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZlRvW2lkeF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVmRnJvbVtpZHggKyAxXSA9IHZhbHVlO1xuICAgICAgICAgICAgcmVmVG9baWR4ICsgMV0gPSBjb3BpZWRWYWx1ZTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIGNvcGllZFZhbHVlW2tleV0gPSBfY2xvbmUodmFsdWVba2V5XSwgcmVmRnJvbSwgcmVmVG8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvcGllZFZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBzd2l0Y2ggKHR5cGUodmFsdWUpKSB7XG4gICAgICAgIGNhc2UgJ09iamVjdCc6XG4gICAgICAgICAgICByZXR1cm4gY29weSh7fSk7XG4gICAgICAgIGNhc2UgJ0FycmF5JzpcbiAgICAgICAgICAgIHJldHVybiBjb3B5KFtdKTtcbiAgICAgICAgY2FzZSAnRGF0ZSc6XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUodmFsdWUpO1xuICAgICAgICBjYXNlICdSZWdFeHAnOlxuICAgICAgICAgICAgcmV0dXJuIF9jbG9uZVJlZ0V4cCh2YWx1ZSk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIF9jcmVhdGVQYXJ0aWFsQXBwbGljYXRvciA9IGZ1bmN0aW9uIF9jcmVhdGVQYXJ0aWFsQXBwbGljYXRvcihjb25jYXQpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBfc2xpY2UoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgICAgIHJldHVybiBfYXJpdHkoTWF0aC5tYXgoMCwgZm4ubGVuZ3RoIC0gYXJncy5sZW5ndGgpLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGNvbmNhdChhcmdzLCBhcmd1bWVudHMpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCBkaXNwYXRjaGVzIHdpdGggZGlmZmVyZW50IHN0cmF0ZWdpZXMgYmFzZWQgb24gdGhlXG4gICAgICogb2JqZWN0IGluIGxpc3QgcG9zaXRpb24gKGxhc3QgYXJndW1lbnQpLiBJZiBpdCBpcyBhbiBhcnJheSwgZXhlY3V0ZXMgW2ZuXS5cbiAgICAgKiBPdGhlcndpc2UsIGlmIGl0IGhhcyBhICBmdW5jdGlvbiB3aXRoIFttZXRob2RuYW1lXSwgaXQgd2lsbCBleGVjdXRlIHRoYXRcbiAgICAgKiBmdW5jdGlvbiAoZnVuY3RvciBjYXNlKS4gT3RoZXJ3aXNlLCBpZiBpdCBpcyBhIHRyYW5zZm9ybWVyLCB1c2VzIHRyYW5zZHVjZXJcbiAgICAgKiBbeGZdIHRvIHJldHVybiBhIG5ldyB0cmFuc2Zvcm1lciAodHJhbnNkdWNlciBjYXNlKS4gT3RoZXJ3aXNlLCBpdCB3aWxsXG4gICAgICogZGVmYXVsdCB0byBleGVjdXRpbmcgW2ZuXS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1ldGhvZG5hbWUgcHJvcGVydHkgdG8gY2hlY2sgZm9yIGEgY3VzdG9tIGltcGxlbWVudGF0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0geGYgdHJhbnNkdWNlciB0byBpbml0aWFsaXplIGlmIG9iamVjdCBpcyB0cmFuc2Zvcm1lclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIGRlZmF1bHQgcmFtZGEgaW1wbGVtZW50YXRpb25cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBmdW5jdGlvbiB0aGF0IGRpc3BhdGNoZXMgb24gb2JqZWN0IGluIGxpc3QgcG9zaXRpb25cbiAgICAgKi9cbiAgICB2YXIgX2Rpc3BhdGNoYWJsZSA9IGZ1bmN0aW9uIF9kaXNwYXRjaGFibGUobWV0aG9kbmFtZSwgeGYsIGZuKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChsZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvYmogPSBhcmd1bWVudHNbbGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBpZiAoIV9pc0FycmF5KG9iaikpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IF9zbGljZShhcmd1bWVudHMsIDAsIGxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb2JqW21ldGhvZG5hbWVdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpbbWV0aG9kbmFtZV0uYXBwbHkob2JqLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKF9pc1RyYW5zZm9ybWVyKG9iaikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zZHVjZXIgPSB4Zi5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zZHVjZXIob2JqKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLy8gVGhlIGFsZ29yaXRobSB1c2VkIHRvIGhhbmRsZSBjeWNsaWMgc3RydWN0dXJlcyBpc1xuICAgIC8vIGluc3BpcmVkIGJ5IHVuZGVyc2NvcmUncyBpc0VxdWFsXG4gICAgLy8gUmVnRXhwIGVxdWFsaXR5IGFsZ29yaXRobTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTA3NzY2MzVcbiAgICB2YXIgX2VxdWFscyA9IGZ1bmN0aW9uIF9lcXVhbHMoYSwgYiwgc3RhY2tBLCBzdGFja0IpIHtcbiAgICAgICAgdmFyIHR5cGVBID0gdHlwZShhKTtcbiAgICAgICAgaWYgKHR5cGVBICE9PSB0eXBlKGIpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVBID09PSAnQm9vbGVhbicgfHwgdHlwZUEgPT09ICdOdW1iZXInIHx8IHR5cGVBID09PSAnU3RyaW5nJykge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBhID09PSAnb2JqZWN0JyA/IHR5cGVvZiBiID09PSAnb2JqZWN0JyAmJiBpZGVudGljYWwoYS52YWx1ZU9mKCksIGIudmFsdWVPZigpKSA6IGlkZW50aWNhbChhLCBiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaWRlbnRpY2FsKGEsIGIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZUEgPT09ICdSZWdFeHAnKSB7XG4gICAgICAgICAgICAvLyBSZWdFeHAgZXF1YWxpdHkgYWxnb3JpdGhtOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMDc3NjYzNVxuICAgICAgICAgICAgcmV0dXJuIGEuc291cmNlID09PSBiLnNvdXJjZSAmJiBhLmdsb2JhbCA9PT0gYi5nbG9iYWwgJiYgYS5pZ25vcmVDYXNlID09PSBiLmlnbm9yZUNhc2UgJiYgYS5tdWx0aWxpbmUgPT09IGIubXVsdGlsaW5lICYmIGEuc3RpY2t5ID09PSBiLnN0aWNreSAmJiBhLnVuaWNvZGUgPT09IGIudW5pY29kZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoT2JqZWN0KGEpID09PSBhKSB7XG4gICAgICAgICAgICBpZiAodHlwZUEgPT09ICdEYXRlJyAmJiBhLmdldFRpbWUoKSAhPT0gYi5nZXRUaW1lKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIga2V5c0EgPSBrZXlzKGEpO1xuICAgICAgICAgICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5cyhiKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaWR4ID0gc3RhY2tBLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB3aGlsZSAoaWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhY2tBW2lkeF0gPT09IGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN0YWNrQltpZHhdID09PSBiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHggLT0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0YWNrQVtzdGFja0EubGVuZ3RoXSA9IGE7XG4gICAgICAgICAgICBzdGFja0Jbc3RhY2tCLmxlbmd0aF0gPSBiO1xuICAgICAgICAgICAgaWR4ID0ga2V5c0EubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHdoaWxlIChpZHggPj0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzQVtpZHhdO1xuICAgICAgICAgICAgICAgIGlmICghX2hhcyhrZXksIGIpIHx8ICFfZXF1YWxzKGJba2V5XSwgYVtrZXldLCBzdGFja0EsIHN0YWNrQikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHggLT0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0YWNrQS5wb3AoKTtcbiAgICAgICAgICAgIHN0YWNrQi5wb3AoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUHJpdmF0ZSBmdW5jdGlvbiB0aGF0IGRldGVybWluZXMgd2hldGhlciBvciBub3QgYSBwcm92aWRlZCBvYmplY3QgaGFzIGEgZ2l2ZW4gbWV0aG9kLlxuICAgICAqIERvZXMgbm90IGlnbm9yZSBtZXRob2RzIHN0b3JlZCBvbiB0aGUgb2JqZWN0J3MgcHJvdG90eXBlIGNoYWluLiBVc2VkIGZvciBkeW5hbWljYWxseVxuICAgICAqIGRpc3BhdGNoaW5nIFJhbWRhIG1ldGhvZHMgdG8gbm9uLUFycmF5IG9iamVjdHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2ROYW1lIFRoZSBuYW1lIG9mIHRoZSBtZXRob2QgdG8gY2hlY2sgZm9yLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byB0ZXN0LlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBoYXMgYSBnaXZlbiBtZXRob2QsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBwZXJzb24gPSB7IG5hbWU6ICdKb2huJyB9O1xuICAgICAqICAgICAgcGVyc29uLnNob3V0ID0gZnVuY3Rpb24oKSB7IGFsZXJ0KHRoaXMubmFtZSk7IH07XG4gICAgICpcbiAgICAgKiAgICAgIF9oYXNNZXRob2QoJ3Nob3V0JywgcGVyc29uKTsgLy89PiB0cnVlXG4gICAgICogICAgICBfaGFzTWV0aG9kKCdmb28nLCBwZXJzb24pOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIF9oYXNNZXRob2QgPSBmdW5jdGlvbiBfaGFzTWV0aG9kKG1ldGhvZE5hbWUsIG9iaikge1xuICAgICAgICByZXR1cm4gb2JqICE9IG51bGwgJiYgIV9pc0FycmF5KG9iaikgJiYgdHlwZW9mIG9ialttZXRob2ROYW1lXSA9PT0gJ2Z1bmN0aW9uJztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYF9tYWtlRmxhdGAgaXMgYSBoZWxwZXIgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGEgb25lLWxldmVsIG9yIGZ1bGx5IHJlY3Vyc2l2ZSBmdW5jdGlvblxuICAgICAqIGJhc2VkIG9uIHRoZSBmbGFnIHBhc3NlZCBpbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgdmFyIF9tYWtlRmxhdCA9IGZ1bmN0aW9uIF9tYWtlRmxhdChyZWN1cnNpdmUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGZsYXR0KGxpc3QpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSwgcmVzdWx0ID0gW10sIGlkeCA9IDAsIGosIGlsZW4gPSBsaXN0Lmxlbmd0aCwgamxlbjtcbiAgICAgICAgICAgIHdoaWxlIChpZHggPCBpbGVuKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzQXJyYXlMaWtlKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSByZWN1cnNpdmUgPyBmbGF0dChsaXN0W2lkeF0pIDogbGlzdFtpZHhdO1xuICAgICAgICAgICAgICAgICAgICBqID0gMDtcbiAgICAgICAgICAgICAgICAgICAgamxlbiA9IHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGogPCBqbGVuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSB2YWx1ZVtqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoXSA9IGxpc3RbaWR4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgX3JlZHVjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gX2FycmF5UmVkdWNlKHhmLCBhY2MsIGxpc3QpIHtcbiAgICAgICAgICAgIHZhciBpZHggPSAwLCBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgICAgICBhY2MgPSB4ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShhY2MsIGxpc3RbaWR4XSk7XG4gICAgICAgICAgICAgICAgaWYgKGFjYyAmJiBhY2NbJ0BAdHJhbnNkdWNlci9yZWR1Y2VkJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjID0gYWNjWydAQHRyYW5zZHVjZXIvdmFsdWUnXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10oYWNjKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBfaXRlcmFibGVSZWR1Y2UoeGYsIGFjYywgaXRlcikge1xuICAgICAgICAgICAgdmFyIHN0ZXAgPSBpdGVyLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghc3RlcC5kb25lKSB7XG4gICAgICAgICAgICAgICAgYWNjID0geGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10oYWNjLCBzdGVwLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoYWNjICYmIGFjY1snQEB0cmFuc2R1Y2VyL3JlZHVjZWQnXSkge1xuICAgICAgICAgICAgICAgICAgICBhY2MgPSBhY2NbJ0BAdHJhbnNkdWNlci92YWx1ZSddO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RlcCA9IGl0ZXIubmV4dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10oYWNjKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBfbWV0aG9kUmVkdWNlKHhmLCBhY2MsIG9iaikge1xuICAgICAgICAgICAgcmV0dXJuIHhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ob2JqLnJlZHVjZShiaW5kKHhmWydAQHRyYW5zZHVjZXIvc3RlcCddLCB4ZiksIGFjYykpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzeW1JdGVyYXRvciA9IHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnID8gU3ltYm9sLml0ZXJhdG9yIDogJ0BAaXRlcmF0b3InO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX3JlZHVjZShmbiwgYWNjLCBsaXN0KSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgZm4gPSBfeHdyYXAoZm4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlzQXJyYXlMaWtlKGxpc3QpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9hcnJheVJlZHVjZShmbiwgYWNjLCBsaXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgbGlzdC5yZWR1Y2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX21ldGhvZFJlZHVjZShmbiwgYWNjLCBsaXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaXN0W3N5bUl0ZXJhdG9yXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9pdGVyYWJsZVJlZHVjZShmbiwgYWNjLCBsaXN0W3N5bUl0ZXJhdG9yXSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgbGlzdC5uZXh0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9pdGVyYWJsZVJlZHVjZShmbiwgYWNjLCBsaXN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3JlZHVjZTogbGlzdCBtdXN0IGJlIGFycmF5IG9yIGl0ZXJhYmxlJyk7XG4gICAgICAgIH07XG4gICAgfSgpO1xuXG4gICAgdmFyIF9zdGVwQ2F0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3N0ZXBDYXRBcnJheSA9IHtcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvaW5pdCc6IEFycmF5LFxuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9zdGVwJzogZnVuY3Rpb24gKHhzLCB4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jb25jYXQoeHMsIFt4XSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9yZXN1bHQnOiBfaWRlbnRpdHlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF9zdGVwQ2F0U3RyaW5nID0ge1xuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9pbml0JzogU3RyaW5nLFxuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9zdGVwJzogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYSArIGI7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9yZXN1bHQnOiBfaWRlbnRpdHlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF9zdGVwQ2F0T2JqZWN0ID0ge1xuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9pbml0JzogT2JqZWN0LFxuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9zdGVwJzogZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVyZ2UocmVzdWx0LCBpc0FycmF5TGlrZShpbnB1dCkgPyBjcmVhdGVNYXBFbnRyeShpbnB1dFswXSwgaW5wdXRbMV0pIDogaW5wdXQpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvcmVzdWx0JzogX2lkZW50aXR5XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfc3RlcENhdChvYmopIHtcbiAgICAgICAgICAgIGlmIChfaXNUcmFuc2Zvcm1lcihvYmopKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0FycmF5TGlrZShvYmopKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zdGVwQ2F0QXJyYXk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3N0ZXBDYXRTdHJpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3N0ZXBDYXRPYmplY3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBjcmVhdGUgdHJhbnNmb3JtZXIgZm9yICcgKyBvYmopO1xuICAgICAgICB9O1xuICAgIH0oKTtcblxuICAgIHZhciBfeGFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWEFsbChmLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5mID0gZjtcbiAgICAgICAgICAgIHRoaXMuYWxsID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBYQWxsLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWEFsbC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFsbCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ocmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgWEFsbC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmYoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbGwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBfcmVkdWNlZCh0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgZmFsc2UpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94YWxsKGYsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhBbGwoZiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hhbnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhBbnkoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgICAgICB0aGlzLmFueSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIFhBbnkucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYQW55LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmFueSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIFhBbnkucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmYoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbnkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9yZWR1Y2VkKHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCB0cnVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGFueShmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYQW55KGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94ZHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWERyb3AobiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMubiA9IG47XG4gICAgICAgIH1cbiAgICAgICAgWERyb3AucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYRHJvcC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IF94ZkJhc2UucmVzdWx0O1xuICAgICAgICBYRHJvcC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubiA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLm4gLT0gMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCBpbnB1dCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94ZHJvcChuLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRHJvcChuLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeGRyb3BXaGlsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWERyb3BXaGlsZShmLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5mID0gZjtcbiAgICAgICAgfVxuICAgICAgICBYRHJvcFdoaWxlLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWERyb3BXaGlsZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IF94ZkJhc2UucmVzdWx0O1xuICAgICAgICBYRHJvcFdoaWxlLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5mKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZihpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5mID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgaW5wdXQpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGRyb3BXaGlsZShmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRHJvcFdoaWxlKGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94Z3JvdXBCeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWEdyb3VwQnkoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgICAgICB0aGlzLmlucHV0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIFhHcm91cEJ5LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWEdyb3VwQnkucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICB2YXIga2V5O1xuICAgICAgICAgICAgZm9yIChrZXkgaW4gdGhpcy5pbnB1dHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoX2hhcyhrZXksIHRoaXMuaW5wdXRzKSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdGhpcy5pbnB1dHNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ0BAdHJhbnNkdWNlci9yZWR1Y2VkJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFsnQEB0cmFuc2R1Y2VyL3ZhbHVlJ107XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ocmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgWEdyb3VwQnkucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzLmYoaW5wdXQpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dHNba2V5XSA9IHRoaXMuaW5wdXRzW2tleV0gfHwgW1xuICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICBbXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHRoaXMuaW5wdXRzW2tleV1bMV0gPSBhcHBlbmQoaW5wdXQsIHRoaXMuaW5wdXRzW2tleV1bMV0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3hncm91cEJ5KGYsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhHcm91cEJ5KGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBsaXN0IGl0ZXJhdGlvbiBmdW5jdGlvbiBmcm9tIGFuIGV4aXN0aW5nIG9uZSBieSBhZGRpbmcgdHdvIG5ldyBwYXJhbWV0ZXJzXG4gICAgICogdG8gaXRzIGNhbGxiYWNrIGZ1bmN0aW9uOiB0aGUgY3VycmVudCBpbmRleCwgYW5kIHRoZSBlbnRpcmUgbGlzdC5cbiAgICAgKlxuICAgICAqIFRoaXMgd291bGQgdHVybiwgZm9yIGluc3RhbmNlLCBSYW1kYSdzIHNpbXBsZSBgbWFwYCBmdW5jdGlvbiBpbnRvIG9uZSB0aGF0IG1vcmUgY2xvc2VseVxuICAgICAqIHJlc2VtYmxlcyBgQXJyYXkucHJvdG90eXBlLm1hcGAuICBOb3RlIHRoYXQgdGhpcyB3aWxsIG9ubHkgd29yayBmb3IgZnVuY3Rpb25zIGluIHdoaWNoXG4gICAgICogdGhlIGl0ZXJhdGlvbiBjYWxsYmFjayBmdW5jdGlvbiBpcyB0aGUgZmlyc3QgcGFyYW1ldGVyLCBhbmQgd2hlcmUgdGhlIGxpc3QgaXMgdGhlIGxhc3RcbiAgICAgKiBwYXJhbWV0ZXIuICAoVGhpcyBsYXR0ZXIgbWlnaHQgYmUgdW5pbXBvcnRhbnQgaWYgdGhlIGxpc3QgcGFyYW1ldGVyIGlzIG5vdCB1c2VkLilcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKChhIC4uLiAtPiBiKSAuLi4gLT4gW2FdIC0+ICopIC0+IChhIC4uLiwgSW50LCBbYV0gLT4gYikgLi4uIC0+IFthXSAtPiAqKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIEEgbGlzdCBpdGVyYXRpb24gZnVuY3Rpb24gdGhhdCBkb2VzIG5vdCBwYXNzIGluZGV4IG9yIGxpc3QgdG8gaXRzIGNhbGxiYWNrXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEFuIGFsdGVyZWQgbGlzdCBpdGVyYXRpb24gZnVuY3Rpb24gdGhhdCBwYXNzZXMgKGl0ZW0sIGluZGV4LCBsaXN0KSB0byBpdHMgY2FsbGJhY2tcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbWFwSW5kZXhlZCA9IFIuYWRkSW5kZXgoUi5tYXApO1xuICAgICAqICAgICAgbWFwSW5kZXhlZChmdW5jdGlvbih2YWwsIGlkeCkge3JldHVybiBpZHggKyAnLScgKyB2YWw7fSwgWydmJywgJ28nLCAnbycsICdiJywgJ2EnLCAnciddKTtcbiAgICAgKiAgICAgIC8vPT4gWycwLWYnLCAnMS1vJywgJzItbycsICczLWInLCAnNC1hJywgJzUtciddXG4gICAgICovXG4gICAgdmFyIGFkZEluZGV4ID0gX2N1cnJ5MShmdW5jdGlvbiBhZGRJbmRleChmbikge1xuICAgICAgICByZXR1cm4gY3VycnlOKGZuLmxlbmd0aCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgICAgICB2YXIgb3JpZ0ZuID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgdmFyIGxpc3QgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBfc2xpY2UoYXJndW1lbnRzKTtcbiAgICAgICAgICAgIGFyZ3NbMF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG9yaWdGbi5hcHBseSh0aGlzLCBfY29uY2F0KGFyZ3VtZW50cywgW1xuICAgICAgICAgICAgICAgICAgICBpZHgsXG4gICAgICAgICAgICAgICAgICAgIGxpc3RcbiAgICAgICAgICAgICAgICBdKSk7XG4gICAgICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgYWxsIGVsZW1lbnRzIG9mIHRoZSBsaXN0IG1hdGNoIHRoZSBwcmVkaWNhdGUsIGBmYWxzZWAgaWYgdGhlcmUgYXJlIGFueVxuICAgICAqIHRoYXQgZG9uJ3QuXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBwcmVkaWNhdGUgaXMgc2F0aXNmaWVkIGJ5IGV2ZXJ5IGVsZW1lbnQsIGBmYWxzZWBcbiAgICAgKiAgICAgICAgIG90aGVyd2lzZS5cbiAgICAgKiBAc2VlIFIuYW55LCBSLm5vbmVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbGVzc1RoYW4yID0gUi5mbGlwKFIubHQpKDIpO1xuICAgICAqICAgICAgdmFyIGxlc3NUaGFuMyA9IFIuZmxpcChSLmx0KSgzKTtcbiAgICAgKiAgICAgIFIuYWxsKGxlc3NUaGFuMikoWzEsIDJdKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5hbGwobGVzc1RoYW4zKShbMSwgMl0pOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgYWxsID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdhbGwnLCBfeGFsbCwgZnVuY3Rpb24gYWxsKGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmICghZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBmaXJzdCBhcmd1bWVudCBpZiBpdCdzIGZhbHN5IG90aGVyd2lzZSB0aGUgc2Vjb25kXG4gICAgICogYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGlzIE5PVCBzaG9ydC1jaXJjdWl0ZWQsIG1lYW5pbmcgdGhhdCBpZiBleHByZXNzaW9uc1xuICAgICAqIGFyZSBwYXNzZWQgdGhleSBhcmUgYm90aCBldmFsdWF0ZWQuXG4gICAgICpcbiAgICAgKiBEaXNwYXRjaGVzIHRvIHRoZSBgYW5kYCBtZXRob2Qgb2YgdGhlIGZpcnN0IGFyZ3VtZW50IGlmIGFwcGxpY2FibGUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExvZ2ljXG4gICAgICogQHNpZyAqIC0+ICogLT4gKlxuICAgICAqIEBwYXJhbSB7Kn0gYSBhbnkgdmFsdWVcbiAgICAgKiBAcGFyYW0geyp9IGIgYW55IG90aGVyIHZhbHVlXG4gICAgICogQHJldHVybiB7Kn0gdGhlIGZpcnN0IGFyZ3VtZW50IGlmIGZhbHN5IG90aGVyd2lzZSB0aGUgc2Vjb25kIGFyZ3VtZW50LlxuICAgICAqIEBzZWUgUi5ib3RoXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5hbmQoZmFsc2UsIHRydWUpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmFuZCgwLCBbXSk7IC8vPT4gMFxuICAgICAqICAgICAgUi5hbmQobnVsbCwgJycpOyA9PiBudWxsXG4gICAgICovXG4gICAgdmFyIGFuZCA9IF9jdXJyeTIoZnVuY3Rpb24gYW5kKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIF9oYXNNZXRob2QoJ2FuZCcsIGEpID8gYS5hbmQoYikgOiBhICYmIGI7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiBhdCBsZWFzdCBvbmUgb2YgZWxlbWVudHMgb2YgdGhlIGxpc3QgbWF0Y2ggdGhlIHByZWRpY2F0ZSwgYGZhbHNlYFxuICAgICAqIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEFjdHMgYXMgYSB0cmFuc2R1Y2VyIGlmIGEgdHJhbnNmb3JtZXIgaXMgZ2l2ZW4gaW4gbGlzdCBwb3NpdGlvbi5cbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIHByZWRpY2F0ZSBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgdGhlIHByZWRpY2F0ZSBpcyBzYXRpc2ZpZWQgYnkgYXQgbGVhc3Qgb25lIGVsZW1lbnQsIGBmYWxzZWBcbiAgICAgKiAgICAgICAgIG90aGVyd2lzZS5cbiAgICAgKiBAc2VlIFIuYWxsLCBSLm5vbmVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbGVzc1RoYW4wID0gUi5mbGlwKFIubHQpKDApO1xuICAgICAqICAgICAgdmFyIGxlc3NUaGFuMiA9IFIuZmxpcChSLmx0KSgyKTtcbiAgICAgKiAgICAgIFIuYW55KGxlc3NUaGFuMCkoWzEsIDJdKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5hbnkobGVzc1RoYW4yKShbMSwgMl0pOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgYW55ID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdhbnknLCBfeGFueSwgZnVuY3Rpb24gYW55KGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChmbihsaXN0W2lkeF0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogV3JhcHMgYSBmdW5jdGlvbiBvZiBhbnkgYXJpdHkgKGluY2x1ZGluZyBudWxsYXJ5KSBpbiBhIGZ1bmN0aW9uIHRoYXQgYWNjZXB0cyBleGFjdGx5IDJcbiAgICAgKiBwYXJhbWV0ZXJzLiBBbnkgZXh0cmFuZW91cyBwYXJhbWV0ZXJzIHdpbGwgbm90IGJlIHBhc3NlZCB0byB0aGUgc3VwcGxpZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKiAtPiBjKSAtPiAoYSwgYiAtPiBjKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byB3cmFwLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbiB3cmFwcGluZyBgZm5gLiBUaGUgbmV3IGZ1bmN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgb2ZcbiAgICAgKiAgICAgICAgIGFyaXR5IDIuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRha2VzVGhyZWVBcmdzID0gZnVuY3Rpb24oYSwgYiwgYykge1xuICAgICAqICAgICAgICByZXR1cm4gW2EsIGIsIGNdO1xuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHRha2VzVGhyZWVBcmdzLmxlbmd0aDsgLy89PiAzXG4gICAgICogICAgICB0YWtlc1RocmVlQXJncygxLCAyLCAzKTsgLy89PiBbMSwgMiwgM11cbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRha2VzVHdvQXJncyA9IFIuYmluYXJ5KHRha2VzVGhyZWVBcmdzKTtcbiAgICAgKiAgICAgIHRha2VzVHdvQXJncy5sZW5ndGg7IC8vPT4gMlxuICAgICAqICAgICAgLy8gT25seSAyIGFyZ3VtZW50cyBhcmUgcGFzc2VkIHRvIHRoZSB3cmFwcGVkIGZ1bmN0aW9uXG4gICAgICogICAgICB0YWtlc1R3b0FyZ3MoMSwgMiwgMyk7IC8vPT4gWzEsIDIsIHVuZGVmaW5lZF1cbiAgICAgKi9cbiAgICB2YXIgYmluYXJ5ID0gX2N1cnJ5MShmdW5jdGlvbiBiaW5hcnkoZm4pIHtcbiAgICAgICAgcmV0dXJuIG5BcnkoMiwgZm4pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGRlZXAgY29weSBvZiB0aGUgdmFsdWUgd2hpY2ggbWF5IGNvbnRhaW4gKG5lc3RlZCkgYEFycmF5YHMgYW5kXG4gICAgICogYE9iamVjdGBzLCBgTnVtYmVyYHMsIGBTdHJpbmdgcywgYEJvb2xlYW5gcyBhbmQgYERhdGVgcy4gYEZ1bmN0aW9uYHMgYXJlXG4gICAgICogbm90IGNvcGllZCwgYnV0IGFzc2lnbmVkIGJ5IHRoZWlyIHJlZmVyZW5jZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7Kn0gLT4geyp9XG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgb2JqZWN0IG9yIGFycmF5IHRvIGNsb25lXG4gICAgICogQHJldHVybiB7Kn0gQSBuZXcgb2JqZWN0IG9yIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBvYmplY3RzID0gW3t9LCB7fSwge31dO1xuICAgICAqICAgICAgdmFyIG9iamVjdHNDbG9uZSA9IFIuY2xvbmUob2JqZWN0cyk7XG4gICAgICogICAgICBvYmplY3RzWzBdID09PSBvYmplY3RzQ2xvbmVbMF07IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgY2xvbmUgPSBfY3VycnkxKGZ1bmN0aW9uIGNsb25lKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBfY2xvbmUodmFsdWUsIFtdLCBbXSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29uc2lzdGluZyBvZiB0aGUgZWxlbWVudHMgb2YgdGhlIGZpcnN0IGxpc3QgZm9sbG93ZWQgYnkgdGhlIGVsZW1lbnRzXG4gICAgICogb2YgdGhlIHNlY29uZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW2FdIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MSBUaGUgZmlyc3QgbGlzdCB0byBtZXJnZS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MiBUaGUgc2Vjb25kIHNldCB0byBtZXJnZS5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgYXJyYXkgY29uc2lzdGluZyBvZiB0aGUgY29udGVudHMgb2YgYGxpc3QxYCBmb2xsb3dlZCBieSB0aGVcbiAgICAgKiAgICAgICAgIGNvbnRlbnRzIG9mIGBsaXN0MmAuIElmLCBpbnN0ZWFkIG9mIGFuIEFycmF5IGZvciBgbGlzdDFgLCB5b3UgcGFzcyBhblxuICAgICAqICAgICAgICAgb2JqZWN0IHdpdGggYSBgY29uY2F0YCBtZXRob2Qgb24gaXQsIGBjb25jYXRgIHdpbGwgY2FsbCBgbGlzdDEuY29uY2F0YFxuICAgICAqICAgICAgICAgYW5kIHBhc3MgaXQgdGhlIHZhbHVlIG9mIGBsaXN0MmAuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmNvbmNhdChbXSwgW10pOyAvLz0+IFtdXG4gICAgICogICAgICBSLmNvbmNhdChbNCwgNSwgNl0sIFsxLCAyLCAzXSk7IC8vPT4gWzQsIDUsIDYsIDEsIDIsIDNdXG4gICAgICogICAgICBSLmNvbmNhdCgnQUJDJywgJ0RFRicpOyAvLyAnQUJDREVGJ1xuICAgICAqL1xuICAgIHZhciBjb25jYXQgPSBfY3VycnkyKGZ1bmN0aW9uIGNvbmNhdChzZXQxLCBzZXQyKSB7XG4gICAgICAgIGlmIChfaXNBcnJheShzZXQyKSkge1xuICAgICAgICAgICAgcmV0dXJuIF9jb25jYXQoc2V0MSwgc2V0Mik7XG4gICAgICAgIH0gZWxzZSBpZiAoX2hhc01ldGhvZCgnY29uY2F0Jywgc2V0MSkpIHtcbiAgICAgICAgICAgIHJldHVybiBzZXQxLmNvbmNhdChzZXQyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2NhblxcJ3QgY29uY2F0ICcgKyB0eXBlb2Ygc2V0MSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBjdXJyaWVkIGVxdWl2YWxlbnQgb2YgdGhlIHByb3ZpZGVkIGZ1bmN0aW9uLiBUaGUgY3VycmllZFxuICAgICAqIGZ1bmN0aW9uIGhhcyB0d28gdW51c3VhbCBjYXBhYmlsaXRpZXMuIEZpcnN0LCBpdHMgYXJndW1lbnRzIG5lZWRuJ3RcbiAgICAgKiBiZSBwcm92aWRlZCBvbmUgYXQgYSB0aW1lLiBJZiBgZmAgaXMgYSB0ZXJuYXJ5IGZ1bmN0aW9uIGFuZCBgZ2AgaXNcbiAgICAgKiBgUi5jdXJyeShmKWAsIHRoZSBmb2xsb3dpbmcgYXJlIGVxdWl2YWxlbnQ6XG4gICAgICpcbiAgICAgKiAgIC0gYGcoMSkoMikoMylgXG4gICAgICogICAtIGBnKDEpKDIsIDMpYFxuICAgICAqICAgLSBgZygxLCAyKSgzKWBcbiAgICAgKiAgIC0gYGcoMSwgMiwgMylgXG4gICAgICpcbiAgICAgKiBTZWNvbmRseSwgdGhlIHNwZWNpYWwgcGxhY2Vob2xkZXIgdmFsdWUgYFIuX19gIG1heSBiZSB1c2VkIHRvIHNwZWNpZnlcbiAgICAgKiBcImdhcHNcIiwgYWxsb3dpbmcgcGFydGlhbCBhcHBsaWNhdGlvbiBvZiBhbnkgY29tYmluYXRpb24gb2YgYXJndW1lbnRzLFxuICAgICAqIHJlZ2FyZGxlc3Mgb2YgdGhlaXIgcG9zaXRpb25zLiBJZiBgZ2AgaXMgYXMgYWJvdmUgYW5kIGBfYCBpcyBgUi5fX2AsXG4gICAgICogdGhlIGZvbGxvd2luZyBhcmUgZXF1aXZhbGVudDpcbiAgICAgKlxuICAgICAqICAgLSBgZygxLCAyLCAzKWBcbiAgICAgKiAgIC0gYGcoXywgMiwgMykoMSlgXG4gICAgICogICAtIGBnKF8sIF8sIDMpKDEpKDIpYFxuICAgICAqICAgLSBgZyhfLCBfLCAzKSgxLCAyKWBcbiAgICAgKiAgIC0gYGcoXywgMikoMSkoMylgXG4gICAgICogICAtIGBnKF8sIDIpKDEsIDMpYFxuICAgICAqICAgLSBgZyhfLCAyKShfLCAzKSgxKWBcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICgqIC0+IGEpIC0+ICgqIC0+IGEpXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGN1cnJ5LlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldywgY3VycmllZCBmdW5jdGlvbi5cbiAgICAgKiBAc2VlIFIuY3VycnlOXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGFkZEZvdXJOdW1iZXJzID0gZnVuY3Rpb24oYSwgYiwgYywgZCkge1xuICAgICAqICAgICAgICByZXR1cm4gYSArIGIgKyBjICsgZDtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIHZhciBjdXJyaWVkQWRkRm91ck51bWJlcnMgPSBSLmN1cnJ5KGFkZEZvdXJOdW1iZXJzKTtcbiAgICAgKiAgICAgIHZhciBmID0gY3VycmllZEFkZEZvdXJOdW1iZXJzKDEsIDIpO1xuICAgICAqICAgICAgdmFyIGcgPSBmKDMpO1xuICAgICAqICAgICAgZyg0KTsgLy89PiAxMFxuICAgICAqL1xuICAgIHZhciBjdXJyeSA9IF9jdXJyeTEoZnVuY3Rpb24gY3VycnkoZm4pIHtcbiAgICAgICAgcmV0dXJuIGN1cnJ5Tihmbi5sZW5ndGgsIGZuKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBsYXN0IGBuYCBlbGVtZW50cyBvZiBhIGdpdmVuIGxpc3QsIHBhc3NpbmcgZWFjaCB2YWx1ZVxuICAgICAqIHRvIHRoZSBzdXBwbGllZCBwcmVkaWNhdGUgZnVuY3Rpb24sIHNraXBwaW5nIGVsZW1lbnRzIHdoaWxlIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gcmV0dXJuc1xuICAgICAqIGB0cnVlYC4gVGhlIHByZWRpY2F0ZSBmdW5jdGlvbiBpcyBwYXNzZWQgb25lIGFyZ3VtZW50OiAqKHZhbHVlKSouXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBhcnJheS5cbiAgICAgKiBAc2VlIFIudGFrZVdoaWxlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGx0ZVR3byA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIHggPD0gMjtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIFIuZHJvcFdoaWxlKGx0ZVR3bywgWzEsIDIsIDMsIDQsIDMsIDIsIDFdKTsgLy89PiBbMywgNCwgMywgMiwgMV1cbiAgICAgKi9cbiAgICB2YXIgZHJvcFdoaWxlID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdkcm9wV2hpbGUnLCBfeGRyb3BXaGlsZSwgZnVuY3Rpb24gZHJvcFdoaWxlKHByZWQsIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuICYmIHByZWQobGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zbGljZShsaXN0LCBpZHgpO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIGl0cyBhcmd1bWVudHMgYXJlIGVxdWl2YWxlbnQsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqIERpc3BhdGNoZXMgdG8gYW4gYGVxdWFsc2AgbWV0aG9kIGlmIHByZXNlbnQuIEhhbmRsZXMgY3ljbGljYWwgZGF0YVxuICAgICAqIHN0cnVjdHVyZXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBhIC0+IGIgLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7Kn0gYVxuICAgICAqIEBwYXJhbSB7Kn0gYlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5lcXVhbHMoMSwgMSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5lcXVhbHMoMSwgJzEnKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5lcXVhbHMoWzEsIDIsIDNdLCBbMSwgMiwgM10pOyAvLz0+IHRydWVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGEgPSB7fTsgYS52ID0gYTtcbiAgICAgKiAgICAgIHZhciBiID0ge307IGIudiA9IGI7XG4gICAgICogICAgICBSLmVxdWFscyhhLCBiKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGVxdWFscyA9IF9jdXJyeTIoZnVuY3Rpb24gZXF1YWxzKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIF9oYXNNZXRob2QoJ2VxdWFscycsIGEpID8gYS5lcXVhbHMoYikgOiBfaGFzTWV0aG9kKCdlcXVhbHMnLCBiKSA/IGIuZXF1YWxzKGEpIDogX2VxdWFscyhhLCBiLCBbXSwgW10pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IGNvbnRhaW5pbmcgb25seSB0aG9zZSBpdGVtcyB0aGF0IG1hdGNoIGEgZ2l2ZW4gcHJlZGljYXRlIGZ1bmN0aW9uLlxuICAgICAqIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gaXMgcGFzc2VkIG9uZSBhcmd1bWVudDogKih2YWx1ZSkqLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IGBSLmZpbHRlcmAgZG9lcyBub3Qgc2tpcCBkZWxldGVkIG9yIHVuYXNzaWduZWQgaW5kaWNlcywgdW5saWtlIHRoZSBuYXRpdmVcbiAgICAgKiBgQXJyYXkucHJvdG90eXBlLmZpbHRlcmAgbWV0aG9kLiBGb3IgbW9yZSBkZXRhaWxzIG9uIHRoaXMgYmVoYXZpb3IsIHNlZTpcbiAgICAgKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9maWx0ZXIjRGVzY3JpcHRpb25cbiAgICAgKlxuICAgICAqIEFjdHMgYXMgYSB0cmFuc2R1Y2VyIGlmIGEgdHJhbnNmb3JtZXIgaXMgZ2l2ZW4gaW4gbGlzdCBwb3NpdGlvbi5cbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBuZXcgZmlsdGVyZWQgYXJyYXkuXG4gICAgICogQHNlZSBSLnJlamVjdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpc0V2ZW4gPSBmdW5jdGlvbihuKSB7XG4gICAgICogICAgICAgIHJldHVybiBuICUgMiA9PT0gMDtcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICBSLmZpbHRlcihpc0V2ZW4sIFsxLCAyLCAzLCA0XSk7IC8vPT4gWzIsIDRdXG4gICAgICovXG4gICAgdmFyIGZpbHRlciA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgnZmlsdGVyJywgX3hmaWx0ZXIsIF9maWx0ZXIpKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlLCBvciBgdW5kZWZpbmVkYCBpZiBub1xuICAgICAqIGVsZW1lbnQgbWF0Y2hlcy5cbiAgICAgKlxuICAgICAqIEFjdHMgYXMgYSB0cmFuc2R1Y2VyIGlmIGEgdHJhbnNmb3JtZXIgaXMgZ2l2ZW4gaW4gbGlzdCBwb3NpdGlvbi5cbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBhIHwgdW5kZWZpbmVkXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIHByZWRpY2F0ZSBmdW5jdGlvbiB1c2VkIHRvIGRldGVybWluZSBpZiB0aGUgZWxlbWVudCBpcyB0aGVcbiAgICAgKiAgICAgICAgZGVzaXJlZCBvbmUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgZWxlbWVudCBmb3VuZCwgb3IgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhzID0gW3thOiAxfSwge2E6IDJ9LCB7YTogM31dO1xuICAgICAqICAgICAgUi5maW5kKFIucHJvcEVxKCdhJywgMikpKHhzKTsgLy89PiB7YTogMn1cbiAgICAgKiAgICAgIFIuZmluZChSLnByb3BFcSgnYScsIDQpKSh4cyk7IC8vPT4gdW5kZWZpbmVkXG4gICAgICovXG4gICAgdmFyIGZpbmQgPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ2ZpbmQnLCBfeGZpbmQsIGZ1bmN0aW9uIGZpbmQoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGZuKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFtpZHhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGUsIG9yIGAtMWBcbiAgICAgKiBpZiBubyBlbGVtZW50IG1hdGNoZXMuXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIHByZWRpY2F0ZSBmdW5jdGlvbiB1c2VkIHRvIGRldGVybWluZSBpZiB0aGUgZWxlbWVudCBpcyB0aGVcbiAgICAgKiBkZXNpcmVkIG9uZS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCBmb3VuZCwgb3IgYC0xYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgeHMgPSBbe2E6IDF9LCB7YTogMn0sIHthOiAzfV07XG4gICAgICogICAgICBSLmZpbmRJbmRleChSLnByb3BFcSgnYScsIDIpKSh4cyk7IC8vPT4gMVxuICAgICAqICAgICAgUi5maW5kSW5kZXgoUi5wcm9wRXEoJ2EnLCA0KSkoeHMpOyAvLz0+IC0xXG4gICAgICovXG4gICAgdmFyIGZpbmRJbmRleCA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgnZmluZEluZGV4JywgX3hmaW5kSW5kZXgsIGZ1bmN0aW9uIGZpbmRJbmRleChmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgdmFyIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZSwgb3IgYHVuZGVmaW5lZGAgaWYgbm9cbiAgICAgKiBlbGVtZW50IG1hdGNoZXMuXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gYSB8IHVuZGVmaW5lZFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gdXNlZCB0byBkZXRlcm1pbmUgaWYgdGhlIGVsZW1lbnQgaXMgdGhlXG4gICAgICogZGVzaXJlZCBvbmUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgZWxlbWVudCBmb3VuZCwgb3IgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhzID0gW3thOiAxLCBiOiAwfSwge2E6MSwgYjogMX1dO1xuICAgICAqICAgICAgUi5maW5kTGFzdChSLnByb3BFcSgnYScsIDEpKSh4cyk7IC8vPT4ge2E6IDEsIGI6IDF9XG4gICAgICogICAgICBSLmZpbmRMYXN0KFIucHJvcEVxKCdhJywgNCkpKHhzKTsgLy89PiB1bmRlZmluZWRcbiAgICAgKi9cbiAgICB2YXIgZmluZExhc3QgPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ2ZpbmRMYXN0JywgX3hmaW5kTGFzdCwgZnVuY3Rpb24gZmluZExhc3QoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgd2hpbGUgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICBpZiAoZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaXN0W2lkeF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggLT0gMTtcbiAgICAgICAgfVxuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlLCBvclxuICAgICAqIGAtMWAgaWYgbm8gZWxlbWVudCBtYXRjaGVzLlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gdXNlZCB0byBkZXRlcm1pbmUgaWYgdGhlIGVsZW1lbnQgaXMgdGhlXG4gICAgICogZGVzaXJlZCBvbmUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgaW5kZXggb2YgdGhlIGVsZW1lbnQgZm91bmQsIG9yIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhzID0gW3thOiAxLCBiOiAwfSwge2E6MSwgYjogMX1dO1xuICAgICAqICAgICAgUi5maW5kTGFzdEluZGV4KFIucHJvcEVxKCdhJywgMSkpKHhzKTsgLy89PiAxXG4gICAgICogICAgICBSLmZpbmRMYXN0SW5kZXgoUi5wcm9wRXEoJ2EnLCA0KSkoeHMpOyAvLz0+IC0xXG4gICAgICovXG4gICAgdmFyIGZpbmRMYXN0SW5kZXggPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ2ZpbmRMYXN0SW5kZXgnLCBfeGZpbmRMYXN0SW5kZXgsIGZ1bmN0aW9uIGZpbmRMYXN0SW5kZXgoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgd2hpbGUgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICBpZiAoZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggLT0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IGJ5IHB1bGxpbmcgZXZlcnkgaXRlbSBvdXQgb2YgaXQgKGFuZCBhbGwgaXRzIHN1Yi1hcnJheXMpIGFuZCBwdXR0aW5nXG4gICAgICogdGhlbSBpbiBhIG5ldyBhcnJheSwgZGVwdGgtZmlyc3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBbYl1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGZsYXR0ZW5lZCBsaXN0LlxuICAgICAqIEBzZWUgUi51bm5lc3RcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmZsYXR0ZW4oWzEsIDIsIFszLCA0XSwgNSwgWzYsIFs3LCA4LCBbOSwgWzEwLCAxMV0sIDEyXV1dXSk7XG4gICAgICogICAgICAvLz0+IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDEyXVxuICAgICAqL1xuICAgIHZhciBmbGF0dGVuID0gX2N1cnJ5MShfbWFrZUZsYXQodHJ1ZSkpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBmdW5jdGlvbiBtdWNoIGxpa2UgdGhlIHN1cHBsaWVkIG9uZSwgZXhjZXB0IHRoYXQgdGhlIGZpcnN0IHR3byBhcmd1bWVudHMnXG4gICAgICogb3JkZXIgaXMgcmV2ZXJzZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoYSAtPiBiIC0+IGMgLT4gLi4uIC0+IHopIC0+IChiIC0+IGEgLT4gYyAtPiAuLi4gLT4geilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIHdpdGggaXRzIGZpcnN0IHR3byBwYXJhbWV0ZXJzIHJldmVyc2VkLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSByZXN1bHQgb2YgaW52b2tpbmcgYGZuYCB3aXRoIGl0cyBmaXJzdCB0d28gcGFyYW1ldGVycycgb3JkZXIgcmV2ZXJzZWQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG1lcmdlVGhyZWUgPSBmdW5jdGlvbihhLCBiLCBjKSB7XG4gICAgICogICAgICAgIHJldHVybiAoW10pLmNvbmNhdChhLCBiLCBjKTtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIG1lcmdlVGhyZWUoMSwgMiwgMyk7IC8vPT4gWzEsIDIsIDNdXG4gICAgICpcbiAgICAgKiAgICAgIFIuZmxpcChtZXJnZVRocmVlKSgxLCAyLCAzKTsgLy89PiBbMiwgMSwgM11cbiAgICAgKi9cbiAgICB2YXIgZmxpcCA9IF9jdXJyeTEoZnVuY3Rpb24gZmxpcChmbikge1xuICAgICAgICByZXR1cm4gY3VycnkoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gX3NsaWNlKGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBhcmdzWzBdID0gYjtcbiAgICAgICAgICAgIGFyZ3NbMV0gPSBhO1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGUgb3ZlciBhbiBpbnB1dCBgbGlzdGAsIGNhbGxpbmcgYSBwcm92aWRlZCBmdW5jdGlvbiBgZm5gIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlXG4gICAgICogbGlzdC5cbiAgICAgKlxuICAgICAqIGBmbmAgcmVjZWl2ZXMgb25lIGFyZ3VtZW50OiAqKHZhbHVlKSouXG4gICAgICpcbiAgICAgKiBOb3RlOiBgUi5mb3JFYWNoYCBkb2VzIG5vdCBza2lwIGRlbGV0ZWQgb3IgdW5hc3NpZ25lZCBpbmRpY2VzIChzcGFyc2UgYXJyYXlzKSwgdW5saWtlXG4gICAgICogdGhlIG5hdGl2ZSBgQXJyYXkucHJvdG90eXBlLmZvckVhY2hgIG1ldGhvZC4gRm9yIG1vcmUgZGV0YWlscyBvbiB0aGlzIGJlaGF2aW9yLCBzZWU6XG4gICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvZm9yRWFjaCNEZXNjcmlwdGlvblxuICAgICAqXG4gICAgICogQWxzbyBub3RlIHRoYXQsIHVubGlrZSBgQXJyYXkucHJvdG90eXBlLmZvckVhY2hgLCBSYW1kYSdzIGBmb3JFYWNoYCByZXR1cm5zIHRoZSBvcmlnaW5hbFxuICAgICAqIGFycmF5LiBJbiBzb21lIGxpYnJhcmllcyB0aGlzIGZ1bmN0aW9uIGlzIG5hbWVkIGBlYWNoYC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gKikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBpbnZva2UuIFJlY2VpdmVzIG9uZSBhcmd1bWVudCwgYHZhbHVlYC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIG9yaWdpbmFsIGxpc3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHByaW50WFBsdXNGaXZlID0gZnVuY3Rpb24oeCkgeyBjb25zb2xlLmxvZyh4ICsgNSk7IH07XG4gICAgICogICAgICBSLmZvckVhY2gocHJpbnRYUGx1c0ZpdmUsIFsxLCAyLCAzXSk7IC8vPT4gWzEsIDIsIDNdXG4gICAgICogICAgICAvLy0+IDZcbiAgICAgKiAgICAgIC8vLT4gN1xuICAgICAqICAgICAgLy8tPiA4XG4gICAgICovXG4gICAgdmFyIGZvckVhY2ggPSBfY3VycnkyKF9jaGVja0Zvck1ldGhvZCgnZm9yRWFjaCcsIGZ1bmN0aW9uIGZvckVhY2goZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgZm4obGlzdFtpZHhdKTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsaXN0IG9mIGZ1bmN0aW9uIG5hbWVzIG9mIG9iamVjdCdzIG93biBmdW5jdGlvbnNcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7Kn0gLT4gW1N0cmluZ11cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3RzIHdpdGggZnVuY3Rpb25zIGluIGl0XG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbGlzdCBvZiB0aGUgb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMgdGhhdCBtYXAgdG8gZnVuY3Rpb25zLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZnVuY3Rpb25zKFIpOyAvLyByZXR1cm5zIGxpc3Qgb2YgcmFtZGEncyBvd24gZnVuY3Rpb24gbmFtZXNcbiAgICAgKlxuICAgICAqICAgICAgdmFyIEYgPSBmdW5jdGlvbigpIHsgdGhpcy54ID0gZnVuY3Rpb24oKXt9OyB0aGlzLnkgPSAxOyB9XG4gICAgICogICAgICBGLnByb3RvdHlwZS56ID0gZnVuY3Rpb24oKSB7fTtcbiAgICAgKiAgICAgIEYucHJvdG90eXBlLmEgPSAxMDA7XG4gICAgICogICAgICBSLmZ1bmN0aW9ucyhuZXcgRigpKTsgLy89PiBbXCJ4XCJdXG4gICAgICovXG4gICAgdmFyIGZ1bmN0aW9ucyA9IF9jdXJyeTEoX2Z1bmN0aW9uc1dpdGgoa2V5cykpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxpc3Qgb2YgZnVuY3Rpb24gbmFtZXMgb2Ygb2JqZWN0J3Mgb3duIGFuZCBwcm90b3R5cGUgZnVuY3Rpb25zXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgeyp9IC0+IFtTdHJpbmddXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0cyB3aXRoIGZ1bmN0aW9ucyBpbiBpdFxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIGxpc3Qgb2YgdGhlIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzIGFuZCBwcm90b3R5cGVcbiAgICAgKiAgICAgICAgIHByb3BlcnRpZXMgdGhhdCBtYXAgdG8gZnVuY3Rpb25zLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZnVuY3Rpb25zSW4oUik7IC8vIHJldHVybnMgbGlzdCBvZiByYW1kYSdzIG93biBhbmQgcHJvdG90eXBlIGZ1bmN0aW9uIG5hbWVzXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBGID0gZnVuY3Rpb24oKSB7IHRoaXMueCA9IGZ1bmN0aW9uKCl7fTsgdGhpcy55ID0gMTsgfVxuICAgICAqICAgICAgRi5wcm90b3R5cGUueiA9IGZ1bmN0aW9uKCkge307XG4gICAgICogICAgICBGLnByb3RvdHlwZS5hID0gMTAwO1xuICAgICAqICAgICAgUi5mdW5jdGlvbnNJbihuZXcgRigpKTsgLy89PiBbXCJ4XCIsIFwielwiXVxuICAgICAqL1xuICAgIHZhciBmdW5jdGlvbnNJbiA9IF9jdXJyeTEoX2Z1bmN0aW9uc1dpdGgoa2V5c0luKSk7XG5cbiAgICAvKipcbiAgICAgKiBTcGxpdHMgYSBsaXN0IGludG8gc3ViLWxpc3RzIHN0b3JlZCBpbiBhbiBvYmplY3QsIGJhc2VkIG9uIHRoZSByZXN1bHQgb2YgY2FsbGluZyBhIFN0cmluZy1yZXR1cm5pbmcgZnVuY3Rpb25cbiAgICAgKiBvbiBlYWNoIGVsZW1lbnQsIGFuZCBncm91cGluZyB0aGUgcmVzdWx0cyBhY2NvcmRpbmcgdG8gdmFsdWVzIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gU3RyaW5nKSAtPiBbYV0gLT4ge1N0cmluZzogW2FdfVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIEZ1bmN0aW9uIDo6IGEgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gZ3JvdXBcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEFuIG9iamVjdCB3aXRoIHRoZSBvdXRwdXQgb2YgYGZuYCBmb3Iga2V5cywgbWFwcGVkIHRvIGFycmF5cyBvZiBlbGVtZW50c1xuICAgICAqICAgICAgICAgdGhhdCBwcm9kdWNlZCB0aGF0IGtleSB3aGVuIHBhc3NlZCB0byBgZm5gLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBieUdyYWRlID0gUi5ncm91cEJ5KGZ1bmN0aW9uKHN0dWRlbnQpIHtcbiAgICAgKiAgICAgICAgdmFyIHNjb3JlID0gc3R1ZGVudC5zY29yZTtcbiAgICAgKiAgICAgICAgcmV0dXJuIHNjb3JlIDwgNjUgPyAnRicgOlxuICAgICAqICAgICAgICAgICAgICAgc2NvcmUgPCA3MCA/ICdEJyA6XG4gICAgICogICAgICAgICAgICAgICBzY29yZSA8IDgwID8gJ0MnIDpcbiAgICAgKiAgICAgICAgICAgICAgIHNjb3JlIDwgOTAgPyAnQicgOiAnQSc7XG4gICAgICogICAgICB9KTtcbiAgICAgKiAgICAgIHZhciBzdHVkZW50cyA9IFt7bmFtZTogJ0FiYnknLCBzY29yZTogODR9LFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOiAnRWRkeScsIHNjb3JlOiA1OH0sXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgLy8gLi4uXG4gICAgICogICAgICAgICAgICAgICAgICAgICAge25hbWU6ICdKYWNrJywgc2NvcmU6IDY5fV07XG4gICAgICogICAgICBieUdyYWRlKHN0dWRlbnRzKTtcbiAgICAgKiAgICAgIC8vIHtcbiAgICAgKiAgICAgIC8vICAgJ0EnOiBbe25hbWU6ICdEaWFubmUnLCBzY29yZTogOTl9XSxcbiAgICAgKiAgICAgIC8vICAgJ0InOiBbe25hbWU6ICdBYmJ5Jywgc2NvcmU6IDg0fV1cbiAgICAgKiAgICAgIC8vICAgLy8gLi4uLFxuICAgICAqICAgICAgLy8gICAnRic6IFt7bmFtZTogJ0VkZHknLCBzY29yZTogNTh9XVxuICAgICAqICAgICAgLy8gfVxuICAgICAqL1xuICAgIHZhciBncm91cEJ5ID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdncm91cEJ5JywgX3hncm91cEJ5LCBmdW5jdGlvbiBncm91cEJ5KGZuLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKGZ1bmN0aW9uIChhY2MsIGVsdCkge1xuICAgICAgICAgICAgdmFyIGtleSA9IGZuKGVsdCk7XG4gICAgICAgICAgICBhY2Nba2V5XSA9IGFwcGVuZChlbHQsIGFjY1trZXldIHx8IChhY2Nba2V5XSA9IFtdKSk7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCB7fSwgbGlzdCk7XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgZ2l2ZW4gbGlzdCBvciBzdHJpbmcuIEluIHNvbWUgbGlicmFyaWVzXG4gICAgICogdGhpcyBmdW5jdGlvbiBpcyBuYW1lZCBgZmlyc3RgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNlZSBSLnRhaWwsIFIuaW5pdCwgUi5sYXN0XG4gICAgICogQHNpZyBbYV0gLT4gYSB8IFVuZGVmaW5lZFxuICAgICAqIEBzaWcgU3RyaW5nIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7Kn0gbGlzdFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5oZWFkKFsnZmknLCAnZm8nLCAnZnVtJ10pOyAvLz0+ICdmaSdcbiAgICAgKiAgICAgIFIuaGVhZChbXSk7IC8vPT4gdW5kZWZpbmVkXG4gICAgICpcbiAgICAgKiAgICAgIFIuaGVhZCgnYWJjJyk7IC8vPT4gJ2EnXG4gICAgICogICAgICBSLmhlYWQoJycpOyAvLz0+ICcnXG4gICAgICovXG4gICAgdmFyIGhlYWQgPSBudGgoMCk7XG5cbiAgICAvKipcbiAgICAgKiBDb21iaW5lcyB0d28gbGlzdHMgaW50byBhIHNldCAoaS5lLiBubyBkdXBsaWNhdGVzKSBjb21wb3NlZCBvZiB0aG9zZVxuICAgICAqIGVsZW1lbnRzIGNvbW1vbiB0byBib3RoIGxpc3RzLiAgRHVwbGljYXRpb24gaXMgZGV0ZXJtaW5lZCBhY2NvcmRpbmdcbiAgICAgKiB0byB0aGUgdmFsdWUgcmV0dXJuZWQgYnkgYXBwbHlpbmcgdGhlIHN1cHBsaWVkIHByZWRpY2F0ZSB0byB0d28gbGlzdFxuICAgICAqIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgKGEsYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgQSBwcmVkaWNhdGUgZnVuY3Rpb24gdGhhdCBkZXRlcm1pbmVzIHdoZXRoZXJcbiAgICAgKiAgICAgICAgdGhlIHR3byBzdXBwbGllZCBlbGVtZW50cyBhcmUgZXF1YWwuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdDEgT25lIGxpc3Qgb2YgaXRlbXMgdG8gY29tcGFyZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QyIEEgc2Vjb25kIGxpc3Qgb2YgaXRlbXMgdG8gY29tcGFyZVxuICAgICAqIEBzZWUgUi5pbnRlcnNlY3Rpb25cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgbGlzdCBjb250YWluaW5nIHRob3NlIGVsZW1lbnRzIGNvbW1vbiB0byBib3RoIGxpc3RzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBidWZmYWxvU3ByaW5nZmllbGQgPSBbXG4gICAgICogICAgICAgIHtpZDogODI0LCBuYW1lOiAnUmljaGllIEZ1cmF5J30sXG4gICAgICogICAgICAgIHtpZDogOTU2LCBuYW1lOiAnRGV3ZXkgTWFydGluJ30sXG4gICAgICogICAgICAgIHtpZDogMzEzLCBuYW1lOiAnQnJ1Y2UgUGFsbWVyJ30sXG4gICAgICogICAgICAgIHtpZDogNDU2LCBuYW1lOiAnU3RlcGhlbiBTdGlsbHMnfSxcbiAgICAgKiAgICAgICAge2lkOiAxNzcsIG5hbWU6ICdOZWlsIFlvdW5nJ31cbiAgICAgKiAgICAgIF07XG4gICAgICogICAgICB2YXIgY3NueSA9IFtcbiAgICAgKiAgICAgICAge2lkOiAyMDQsIG5hbWU6ICdEYXZpZCBDcm9zYnknfSxcbiAgICAgKiAgICAgICAge2lkOiA0NTYsIG5hbWU6ICdTdGVwaGVuIFN0aWxscyd9LFxuICAgICAqICAgICAgICB7aWQ6IDUzOSwgbmFtZTogJ0dyYWhhbSBOYXNoJ30sXG4gICAgICogICAgICAgIHtpZDogMTc3LCBuYW1lOiAnTmVpbCBZb3VuZyd9XG4gICAgICogICAgICBdO1xuICAgICAqXG4gICAgICogICAgICB2YXIgc2FtZUlkID0gZnVuY3Rpb24obzEsIG8yKSB7cmV0dXJuIG8xLmlkID09PSBvMi5pZDt9O1xuICAgICAqXG4gICAgICogICAgICBSLmludGVyc2VjdGlvbldpdGgoc2FtZUlkLCBidWZmYWxvU3ByaW5nZmllbGQsIGNzbnkpO1xuICAgICAqICAgICAgLy89PiBbe2lkOiA0NTYsIG5hbWU6ICdTdGVwaGVuIFN0aWxscyd9LCB7aWQ6IDE3NywgbmFtZTogJ05laWwgWW91bmcnfV1cbiAgICAgKi9cbiAgICB2YXIgaW50ZXJzZWN0aW9uV2l0aCA9IF9jdXJyeTMoZnVuY3Rpb24gaW50ZXJzZWN0aW9uV2l0aChwcmVkLCBsaXN0MSwgbGlzdDIpIHtcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBbXSwgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxpc3QxLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKF9jb250YWluc1dpdGgocHJlZCwgbGlzdDFbaWR4XSwgbGlzdDIpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0c1tyZXN1bHRzLmxlbmd0aF0gPSBsaXN0MVtpZHhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuaXFXaXRoKHByZWQsIHJlc3VsdHMpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBsaXN0IHdpdGggdGhlIHNlcGFyYXRvciBpbnRlcnBvc2VkIGJldHdlZW4gZWxlbWVudHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGEgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7Kn0gc2VwYXJhdG9yIFRoZSBlbGVtZW50IHRvIGFkZCB0byB0aGUgbGlzdC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIGJlIGludGVycG9zZWQuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBuZXcgbGlzdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmludGVyc3BlcnNlKCduJywgWydiYScsICdhJywgJ2EnXSk7IC8vPT4gWydiYScsICduJywgJ2EnLCAnbicsICdhJ11cbiAgICAgKi9cbiAgICB2YXIgaW50ZXJzcGVyc2UgPSBfY3VycnkyKF9jaGVja0Zvck1ldGhvZCgnaW50ZXJzcGVyc2UnLCBmdW5jdGlvbiBpbnRlcnNwZXJzZShzZXBhcmF0b3IsIGxpc3QpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgdmFyIGxlbmd0aCA9IGxpc3QubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoaWR4ID09PSBsZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobGlzdFtpZHhdKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb3V0LnB1c2gobGlzdFtpZHhdLCBzZXBhcmF0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBUcmFuc2Zvcm1zIHRoZSBpdGVtcyBvZiB0aGUgbGlzdCB3aXRoIHRoZSB0cmFuc2R1Y2VyIGFuZCBhcHBlbmRzIHRoZSB0cmFuc2Zvcm1lZCBpdGVtcyB0b1xuICAgICAqIHRoZSBhY2N1bXVsYXRvciB1c2luZyBhbiBhcHByb3ByaWF0ZSBpdGVyYXRvciBmdW5jdGlvbiBiYXNlZCBvbiB0aGUgYWNjdW11bGF0b3IgdHlwZS5cbiAgICAgKlxuICAgICAqIFRoZSBhY2N1bXVsYXRvciBjYW4gYmUgYW4gYXJyYXksIHN0cmluZywgb2JqZWN0IG9yIGEgdHJhbnNmb3JtZXIuIEl0ZXJhdGVkIGl0ZW1zIHdpbGxcbiAgICAgKiBiZSBhcHBlbmRlZCB0byBhcnJheXMgYW5kIGNvbmNhdGVuYXRlZCB0byBzdHJpbmdzLiBPYmplY3RzIHdpbGwgYmUgbWVyZ2VkIGRpcmVjdGx5IG9yIDItaXRlbVxuICAgICAqIGFycmF5cyB3aWxsIGJlIG1lcmdlZCBhcyBrZXksIHZhbHVlIHBhaXJzLlxuICAgICAqXG4gICAgICogVGhlIGFjY3VtdWxhdG9yIGNhbiBhbHNvIGJlIGEgdHJhbnNmb3JtZXIgb2JqZWN0IHRoYXQgcHJvdmlkZXMgYSAyLWFyaXR5IHJlZHVjaW5nIGl0ZXJhdG9yXG4gICAgICogZnVuY3Rpb24sIHN0ZXAsIDAtYXJpdHkgaW5pdGlhbCB2YWx1ZSBmdW5jdGlvbiwgaW5pdCwgYW5kIDEtYXJpdHkgcmVzdWx0IGV4dHJhY3Rpb24gZnVuY3Rpb25cbiAgICAgKiByZXN1bHQuIFRoZSBzdGVwIGZ1bmN0aW9uIGlzIHVzZWQgYXMgdGhlIGl0ZXJhdG9yIGZ1bmN0aW9uIGluIHJlZHVjZS4gVGhlIHJlc3VsdCBmdW5jdGlvbiBpc1xuICAgICAqIHVzZWQgdG8gY29udmVydCB0aGUgZmluYWwgYWNjdW11bGF0b3IgaW50byB0aGUgcmV0dXJuIHR5cGUgYW5kIGluIG1vc3QgY2FzZXMgaXMgUi5pZGVudGl0eS5cbiAgICAgKiBUaGUgaW5pdCBmdW5jdGlvbiBpcyB1c2VkIHRvIHByb3ZpZGUgdGhlIGluaXRpYWwgYWNjdW11bGF0b3IuXG4gICAgICpcbiAgICAgKiBUaGUgaXRlcmF0aW9uIGlzIHBlcmZvcm1lZCB3aXRoIFIucmVkdWNlIGFmdGVyIGluaXRpYWxpemluZyB0aGUgdHJhbnNkdWNlci5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgYSAtPiAoYiAtPiBiKSAtPiBbY10gLT4gYVxuICAgICAqIEBwYXJhbSB7Kn0gYWNjIFRoZSBpbml0aWFsIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHhmIFRoZSB0cmFuc2R1Y2VyIGZ1bmN0aW9uLiBSZWNlaXZlcyBhIHRyYW5zZm9ybWVyIGFuZCByZXR1cm5zIGEgdHJhbnNmb3JtZXIuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7Kn0gVGhlIGZpbmFsLCBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbnVtYmVycyA9IFsxLCAyLCAzLCA0XTtcbiAgICAgKiAgICAgIHZhciB0cmFuc2R1Y2VyID0gUi5jb21wb3NlKFIubWFwKFIuYWRkKDEpKSwgUi50YWtlKDIpKTtcbiAgICAgKlxuICAgICAqICAgICAgUi5pbnRvKFtdLCB0cmFuc2R1Y2VyLCBudW1iZXJzKTsgLy89PiBbMiwgM11cbiAgICAgKlxuICAgICAqICAgICAgdmFyIGludG9BcnJheSA9IFIuaW50byhbXSk7XG4gICAgICogICAgICBpbnRvQXJyYXkodHJhbnNkdWNlciwgbnVtYmVycyk7IC8vPT4gWzIsIDNdXG4gICAgICovXG4gICAgdmFyIGludG8gPSBfY3VycnkzKGZ1bmN0aW9uIGludG8oYWNjLCB4ZiwgbGlzdCkge1xuICAgICAgICByZXR1cm4gX2lzVHJhbnNmb3JtZXIoYWNjKSA/IF9yZWR1Y2UoeGYoYWNjKSwgYWNjWydAQHRyYW5zZHVjZXIvaW5pdCddKCksIGxpc3QpIDogX3JlZHVjZSh4Zihfc3RlcENhdChhY2MpKSwgYWNjLCBsaXN0KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFNhbWUgYXMgUi5pbnZlcnRPYmosIGhvd2V2ZXIgdGhpcyBhY2NvdW50cyBmb3Igb2JqZWN0c1xuICAgICAqIHdpdGggZHVwbGljYXRlIHZhbHVlcyBieSBwdXR0aW5nIHRoZSB2YWx1ZXMgaW50byBhblxuICAgICAqIGFycmF5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHtzOiB4fSAtPiB7eDogWyBzLCAuLi4gXX1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3Qgb3IgYXJyYXkgdG8gaW52ZXJ0XG4gICAgICogQHJldHVybiB7T2JqZWN0fSBvdXQgQSBuZXcgb2JqZWN0IHdpdGgga2V5c1xuICAgICAqIGluIGFuIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciByYWNlUmVzdWx0c0J5Rmlyc3ROYW1lID0ge1xuICAgICAqICAgICAgICBmaXJzdDogJ2FsaWNlJyxcbiAgICAgKiAgICAgICAgc2Vjb25kOiAnamFrZScsXG4gICAgICogICAgICAgIHRoaXJkOiAnYWxpY2UnLFxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIFIuaW52ZXJ0KHJhY2VSZXN1bHRzQnlGaXJzdE5hbWUpO1xuICAgICAqICAgICAgLy89PiB7ICdhbGljZSc6IFsnZmlyc3QnLCAndGhpcmQnXSwgJ2pha2UnOlsnc2Vjb25kJ10gfVxuICAgICAqL1xuICAgIHZhciBpbnZlcnQgPSBfY3VycnkxKGZ1bmN0aW9uIGludmVydChvYmopIHtcbiAgICAgICAgdmFyIHByb3BzID0ga2V5cyhvYmopO1xuICAgICAgICB2YXIgbGVuID0gcHJvcHMubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgdmFyIG91dCA9IHt9O1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gcHJvcHNbaWR4XTtcbiAgICAgICAgICAgIHZhciB2YWwgPSBvYmpba2V5XTtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gX2hhcyh2YWwsIG91dCkgPyBvdXRbdmFsXSA6IG91dFt2YWxdID0gW107XG4gICAgICAgICAgICBsaXN0W2xpc3QubGVuZ3RoXSA9IGtleTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHRoZSBrZXlzIG9mIHRoZSBnaXZlbiBvYmplY3RcbiAgICAgKiBhcyB2YWx1ZXMsIGFuZCB0aGUgdmFsdWVzIG9mIHRoZSBnaXZlbiBvYmplY3QgYXMga2V5cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7czogeH0gLT4ge3g6IHN9XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IG9yIGFycmF5IHRvIGludmVydFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gb3V0IEEgbmV3IG9iamVjdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciByYWNlUmVzdWx0cyA9IHtcbiAgICAgKiAgICAgICAgZmlyc3Q6ICdhbGljZScsXG4gICAgICogICAgICAgIHNlY29uZDogJ2pha2UnXG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgUi5pbnZlcnRPYmoocmFjZVJlc3VsdHMpO1xuICAgICAqICAgICAgLy89PiB7ICdhbGljZSc6ICdmaXJzdCcsICdqYWtlJzonc2Vjb25kJyB9XG4gICAgICpcbiAgICAgKiAgICAgIC8vIEFsdGVybmF0aXZlbHk6XG4gICAgICogICAgICB2YXIgcmFjZVJlc3VsdHMgPSBbJ2FsaWNlJywgJ2pha2UnXTtcbiAgICAgKiAgICAgIFIuaW52ZXJ0T2JqKHJhY2VSZXN1bHRzKTtcbiAgICAgKiAgICAgIC8vPT4geyAnYWxpY2UnOiAnMCcsICdqYWtlJzonMScgfVxuICAgICAqL1xuICAgIHZhciBpbnZlcnRPYmogPSBfY3VycnkxKGZ1bmN0aW9uIGludmVydE9iaihvYmopIHtcbiAgICAgICAgdmFyIHByb3BzID0ga2V5cyhvYmopO1xuICAgICAgICB2YXIgbGVuID0gcHJvcHMubGVuZ3RoO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgdmFyIG91dCA9IHt9O1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gcHJvcHNbaWR4XTtcbiAgICAgICAgICAgIG91dFtvYmpba2V5XV0gPSBrZXk7XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBnaXZlbiBsaXN0IG9yIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzZWUgUi5pbml0LCBSLmhlYWQsIFIudGFpbFxuICAgICAqIEBzaWcgW2FdIC0+IGEgfCBVbmRlZmluZWRcbiAgICAgKiBAc2lnIFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubGFzdChbJ2ZpJywgJ2ZvJywgJ2Z1bSddKTsgLy89PiAnZnVtJ1xuICAgICAqICAgICAgUi5sYXN0KFtdKTsgLy89PiB1bmRlZmluZWRcbiAgICAgKlxuICAgICAqICAgICAgUi5sYXN0KCdhYmMnKTsgLy89PiAnYydcbiAgICAgKiAgICAgIFIubGFzdCgnJyk7IC8vPT4gJydcbiAgICAgKi9cbiAgICB2YXIgbGFzdCA9IG50aCgtMSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBwb3NpdGlvbiBvZiB0aGUgbGFzdCBvY2N1cnJlbmNlIG9mIGFuIGl0ZW0gaW5cbiAgICAgKiBhbiBhcnJheSwgb3IgLTEgaWYgdGhlIGl0ZW0gaXMgbm90IGluY2x1ZGVkIGluIHRoZSBhcnJheS5cbiAgICAgKiBgUi5lcXVhbHNgIGlzIHVzZWQgdG8gZGV0ZXJtaW5lIGVxdWFsaXR5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBhIC0+IFthXSAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCBUaGUgaXRlbSB0byBmaW5kLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHhzIFRoZSBhcnJheSB0byBzZWFyY2ggaW4uXG4gICAgICogQHJldHVybiB7TnVtYmVyfSB0aGUgaW5kZXggb2YgdGhlIHRhcmdldCwgb3IgLTEgaWYgdGhlIHRhcmdldCBpcyBub3QgZm91bmQuXG4gICAgICogQHNlZSBSLmluZGV4T2ZcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmxhc3RJbmRleE9mKDMsIFstMSwzLDMsMCwxLDIsMyw0XSk7IC8vPT4gNlxuICAgICAqICAgICAgUi5sYXN0SW5kZXhPZigxMCwgWzEsMiwzLDRdKTsgLy89PiAtMVxuICAgICAqL1xuICAgIHZhciBsYXN0SW5kZXhPZiA9IF9jdXJyeTIoZnVuY3Rpb24gbGFzdEluZGV4T2YodGFyZ2V0LCB4cykge1xuICAgICAgICBpZiAoX2hhc01ldGhvZCgnbGFzdEluZGV4T2YnLCB4cykpIHtcbiAgICAgICAgICAgIHJldHVybiB4cy5sYXN0SW5kZXhPZih0YXJnZXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIGlkeCA9IHhzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB3aGlsZSAoaWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoZXF1YWxzKHhzW2lkeF0sIHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4IC09IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCwgY29uc3RydWN0ZWQgYnkgYXBwbHlpbmcgdGhlIHN1cHBsaWVkIGZ1bmN0aW9uIHRvIGV2ZXJ5IGVsZW1lbnQgb2YgdGhlXG4gICAgICogc3VwcGxpZWQgbGlzdC5cbiAgICAgKlxuICAgICAqIE5vdGU6IGBSLm1hcGAgZG9lcyBub3Qgc2tpcCBkZWxldGVkIG9yIHVuYXNzaWduZWQgaW5kaWNlcyAoc3BhcnNlIGFycmF5cyksIHVubGlrZSB0aGVcbiAgICAgKiBuYXRpdmUgYEFycmF5LnByb3RvdHlwZS5tYXBgIG1ldGhvZC4gRm9yIG1vcmUgZGV0YWlscyBvbiB0aGlzIGJlaGF2aW9yLCBzZWU6XG4gICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvbWFwI0Rlc2NyaXB0aW9uXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBiKSAtPiBbYV0gLT4gW2JdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBvbiBldmVyeSBlbGVtZW50IG9mIHRoZSBpbnB1dCBgbGlzdGAuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBiZSBpdGVyYXRlZCBvdmVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbmV3IGxpc3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGRvdWJsZSA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIHggKiAyO1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgUi5tYXAoZG91YmxlLCBbMSwgMiwgM10pOyAvLz0+IFsyLCA0LCA2XVxuICAgICAqL1xuICAgIHZhciBtYXAgPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ21hcCcsIF94bWFwLCBfbWFwKSk7XG5cbiAgICAvKipcbiAgICAgKiBNYXAsIGJ1dCBmb3Igb2JqZWN0cy4gQ3JlYXRlcyBhbiBvYmplY3Qgd2l0aCB0aGUgc2FtZSBrZXlzIGFzIGBvYmpgIGFuZCB2YWx1ZXNcbiAgICAgKiBnZW5lcmF0ZWQgYnkgcnVubmluZyBlYWNoIHByb3BlcnR5IG9mIGBvYmpgIHRocm91Z2ggYGZuYC4gYGZuYCBpcyBwYXNzZWQgb25lIGFyZ3VtZW50OlxuICAgICAqICoodmFsdWUpKi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyAodiAtPiB2KSAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gQSBmdW5jdGlvbiBjYWxsZWQgZm9yIGVhY2ggcHJvcGVydHkgaW4gYG9iamAuIEl0cyByZXR1cm4gdmFsdWUgd2lsbFxuICAgICAqIGJlY29tZSBhIG5ldyBwcm9wZXJ0eSBvbiB0aGUgcmV0dXJuIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggdGhlIHNhbWUga2V5cyBhcyBgb2JqYCBhbmQgdmFsdWVzIHRoYXQgYXJlIHRoZSByZXN1bHRcbiAgICAgKiAgICAgICAgIG9mIHJ1bm5pbmcgZWFjaCBwcm9wZXJ0eSB0aHJvdWdoIGBmbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHZhbHVlcyA9IHsgeDogMSwgeTogMiwgejogMyB9O1xuICAgICAqICAgICAgdmFyIGRvdWJsZSA9IGZ1bmN0aW9uKG51bSkge1xuICAgICAqICAgICAgICByZXR1cm4gbnVtICogMjtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIFIubWFwT2JqKGRvdWJsZSwgdmFsdWVzKTsgLy89PiB7IHg6IDIsIHk6IDQsIHo6IDYgfVxuICAgICAqL1xuICAgIHZhciBtYXBPYmogPSBfY3VycnkyKGZ1bmN0aW9uIG1hcE9iaihmbiwgb2JqKSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKGZ1bmN0aW9uIChhY2MsIGtleSkge1xuICAgICAgICAgICAgYWNjW2tleV0gPSBmbihvYmpba2V5XSk7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCB7fSwga2V5cyhvYmopKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIExpa2UgYG1hcE9iamAsIGJ1dCBidXQgcGFzc2VzIGFkZGl0aW9uYWwgYXJndW1lbnRzIHRvIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24uIFRoZVxuICAgICAqIHByZWRpY2F0ZSBmdW5jdGlvbiBpcyBwYXNzZWQgdGhyZWUgYXJndW1lbnRzOiAqKHZhbHVlLCBrZXksIG9iaikqLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnICh2LCBrLCB7azogdn0gLT4gdikgLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIEEgZnVuY3Rpb24gY2FsbGVkIGZvciBlYWNoIHByb3BlcnR5IGluIGBvYmpgLiBJdHMgcmV0dXJuIHZhbHVlIHdpbGxcbiAgICAgKiAgICAgICAgYmVjb21lIGEgbmV3IHByb3BlcnR5IG9uIHRoZSByZXR1cm4gb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBBIG5ldyBvYmplY3Qgd2l0aCB0aGUgc2FtZSBrZXlzIGFzIGBvYmpgIGFuZCB2YWx1ZXMgdGhhdCBhcmUgdGhlIHJlc3VsdFxuICAgICAqICAgICAgICAgb2YgcnVubmluZyBlYWNoIHByb3BlcnR5IHRocm91Z2ggYGZuYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgdmFsdWVzID0geyB4OiAxLCB5OiAyLCB6OiAzIH07XG4gICAgICogICAgICB2YXIgcHJlcGVuZEtleUFuZERvdWJsZSA9IGZ1bmN0aW9uKG51bSwga2V5LCBvYmopIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGtleSArIChudW0gKiAyKTtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIFIubWFwT2JqSW5kZXhlZChwcmVwZW5kS2V5QW5kRG91YmxlLCB2YWx1ZXMpOyAvLz0+IHsgeDogJ3gyJywgeTogJ3k0JywgejogJ3o2JyB9XG4gICAgICovXG4gICAgdmFyIG1hcE9iakluZGV4ZWQgPSBfY3VycnkyKGZ1bmN0aW9uIG1hcE9iakluZGV4ZWQoZm4sIG9iaikge1xuICAgICAgICByZXR1cm4gX3JlZHVjZShmdW5jdGlvbiAoYWNjLCBrZXkpIHtcbiAgICAgICAgICAgIGFjY1trZXldID0gZm4ob2JqW2tleV0sIGtleSwgb2JqKTtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIHt9LCBrZXlzKG9iaikpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgbm8gZWxlbWVudHMgb2YgdGhlIGxpc3QgbWF0Y2ggdGhlIHByZWRpY2F0ZSxcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgcHJlZGljYXRlIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiB0aGUgcHJlZGljYXRlIGlzIG5vdCBzYXRpc2ZpZWQgYnkgZXZlcnkgZWxlbWVudCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICogQHNlZSBSLmFsbCwgUi5hbnlcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm5vbmUoUi5pc05hTiwgWzEsIDIsIDNdKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLm5vbmUoUi5pc05hTiwgWzEsIDIsIDMsIE5hTl0pOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIG5vbmUgPSBfY3VycnkyKF9jb21wbGVtZW50KF9kaXNwYXRjaGFibGUoJ2FueScsIF94YW55LCBhbnkpKSk7XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgZmlyc3QgdHJ1dGh5IG9mIHR3byBhcmd1bWVudHMgb3RoZXJ3aXNlIHRoZVxuICAgICAqIGxhc3QgYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGlzIE5PVCBzaG9ydC1jaXJjdWl0ZWQsIG1lYW5pbmcgdGhhdCBpZlxuICAgICAqIGV4cHJlc3Npb25zIGFyZSBwYXNzZWQgdGhleSBhcmUgYm90aCBldmFsdWF0ZWQuXG4gICAgICpcbiAgICAgKiBEaXNwYXRjaGVzIHRvIHRoZSBgb3JgIG1ldGhvZCBvZiB0aGUgZmlyc3QgYXJndW1lbnQgaWYgYXBwbGljYWJsZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnICogLT4gKiAtPiAqXG4gICAgICogQHBhcmFtIHsqfSBhIGFueSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7Kn0gYiBhbnkgb3RoZXIgdmFsdWVcbiAgICAgKiBAcmV0dXJuIHsqfSB0aGUgZmlyc3QgdHJ1dGh5IGFyZ3VtZW50LCBvdGhlcndpc2UgdGhlIGxhc3QgYXJndW1lbnQuXG4gICAgICogQHNlZSBSLmVpdGhlclxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIub3IoZmFsc2UsIHRydWUpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIub3IoMCwgW10pOyAvLz0+IFtdXG4gICAgICogICAgICBSLm9yKG51bGwsICcnKTsgPT4gJydcbiAgICAgKi9cbiAgICB2YXIgb3IgPSBfY3VycnkyKGZ1bmN0aW9uIG9yKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIF9oYXNNZXRob2QoJ29yJywgYSkgPyBhLm9yKGIpIDogYSB8fCBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQWNjZXB0cyBhcyBpdHMgYXJndW1lbnRzIGEgZnVuY3Rpb24gYW5kIGFueSBudW1iZXIgb2YgdmFsdWVzIGFuZCByZXR1cm5zIGEgZnVuY3Rpb24gdGhhdCxcbiAgICAgKiB3aGVuIGludm9rZWQsIGNhbGxzIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiB3aXRoIGFsbCBvZiB0aGUgdmFsdWVzIHByZXBlbmRlZCB0byB0aGVcbiAgICAgKiBvcmlnaW5hbCBmdW5jdGlvbidzIGFyZ3VtZW50cyBsaXN0LiBJbiBzb21lIGxpYnJhcmllcyB0aGlzIGZ1bmN0aW9uIGlzIG5hbWVkIGBhcHBseUxlZnRgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKGEgLT4gYiAtPiAuLi4gLT4gaSAtPiBqIC0+IC4uLiAtPiBtIC0+IG4pIC0+IGEgLT4gYi0+IC4uLiAtPiBpIC0+IChqIC0+IC4uLiAtPiBtIC0+IG4pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGludm9rZS5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmdzXSBBcmd1bWVudHMgdG8gcHJlcGVuZCB0byBgZm5gIHdoZW4gdGhlIHJldHVybmVkIGZ1bmN0aW9uIGlzIGludm9rZWQuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgbmV3IGZ1bmN0aW9uIHdyYXBwaW5nIGBmbmAuIFdoZW4gaW52b2tlZCwgaXQgd2lsbCBjYWxsIGBmbmBcbiAgICAgKiAgICAgICAgIHdpdGggYGFyZ3NgIHByZXBlbmRlZCB0byBgZm5gJ3MgYXJndW1lbnRzIGxpc3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG11bHRpcGx5ID0gZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYSAqIGI7IH07XG4gICAgICogICAgICB2YXIgZG91YmxlID0gUi5wYXJ0aWFsKG11bHRpcGx5LCAyKTtcbiAgICAgKiAgICAgIGRvdWJsZSgyKTsgLy89PiA0XG4gICAgICpcbiAgICAgKiAgICAgIHZhciBncmVldCA9IGZ1bmN0aW9uKHNhbHV0YXRpb24sIHRpdGxlLCBmaXJzdE5hbWUsIGxhc3ROYW1lKSB7XG4gICAgICogICAgICAgIHJldHVybiBzYWx1dGF0aW9uICsgJywgJyArIHRpdGxlICsgJyAnICsgZmlyc3ROYW1lICsgJyAnICsgbGFzdE5hbWUgKyAnISc7XG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgdmFyIHNheUhlbGxvID0gUi5wYXJ0aWFsKGdyZWV0LCAnSGVsbG8nKTtcbiAgICAgKiAgICAgIHZhciBzYXlIZWxsb1RvTXMgPSBSLnBhcnRpYWwoc2F5SGVsbG8sICdNcy4nKTtcbiAgICAgKiAgICAgIHNheUhlbGxvVG9NcygnSmFuZScsICdKb25lcycpOyAvLz0+ICdIZWxsbywgTXMuIEphbmUgSm9uZXMhJ1xuICAgICAqL1xuICAgIHZhciBwYXJ0aWFsID0gY3VycnkoX2NyZWF0ZVBhcnRpYWxBcHBsaWNhdG9yKF9jb25jYXQpKTtcblxuICAgIC8qKlxuICAgICAqIEFjY2VwdHMgYXMgaXRzIGFyZ3VtZW50cyBhIGZ1bmN0aW9uIGFuZCBhbnkgbnVtYmVyIG9mIHZhbHVlcyBhbmQgcmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQsXG4gICAgICogd2hlbiBpbnZva2VkLCBjYWxscyB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gd2l0aCBhbGwgb2YgdGhlIHZhbHVlcyBhcHBlbmRlZCB0byB0aGUgb3JpZ2luYWxcbiAgICAgKiBmdW5jdGlvbidzIGFyZ3VtZW50cyBsaXN0LlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IGBwYXJ0aWFsUmlnaHRgIGlzIHRoZSBvcHBvc2l0ZSBvZiBgcGFydGlhbGA6IGBwYXJ0aWFsUmlnaHRgIGZpbGxzIGBmbmAncyBhcmd1bWVudHNcbiAgICAgKiBmcm9tIHRoZSByaWdodCB0byB0aGUgbGVmdC4gIEluIHNvbWUgbGlicmFyaWVzIHRoaXMgZnVuY3Rpb24gaXMgbmFtZWQgYGFwcGx5UmlnaHRgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKGEgLT4gYi0+IC4uLiAtPiBpIC0+IGogLT4gLi4uIC0+IG0gLT4gbikgLT4gaiAtPiAuLi4gLT4gbSAtPiBuIC0+IChhIC0+IGItPiAuLi4gLT4gaSlcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gaW52b2tlLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW2FyZ3NdIEFyZ3VtZW50cyB0byBhcHBlbmQgdG8gYGZuYCB3aGVuIHRoZSByZXR1cm5lZCBmdW5jdGlvbiBpcyBpbnZva2VkLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbiB3cmFwcGluZyBgZm5gLiBXaGVuIGludm9rZWQsIGl0IHdpbGwgY2FsbCBgZm5gIHdpdGhcbiAgICAgKiAgICAgICAgIGBhcmdzYCBhcHBlbmRlZCB0byBgZm5gJ3MgYXJndW1lbnRzIGxpc3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGdyZWV0ID0gZnVuY3Rpb24oc2FsdXRhdGlvbiwgdGl0bGUsIGZpcnN0TmFtZSwgbGFzdE5hbWUpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIHNhbHV0YXRpb24gKyAnLCAnICsgdGl0bGUgKyAnICcgKyBmaXJzdE5hbWUgKyAnICcgKyBsYXN0TmFtZSArICchJztcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICB2YXIgZ3JlZXRNc0phbmVKb25lcyA9IFIucGFydGlhbFJpZ2h0KGdyZWV0LCAnTXMuJywgJ0phbmUnLCAnSm9uZXMnKTtcbiAgICAgKlxuICAgICAqICAgICAgZ3JlZXRNc0phbmVKb25lcygnSGVsbG8nKTsgLy89PiAnSGVsbG8sIE1zLiBKYW5lIEpvbmVzISdcbiAgICAgKi9cbiAgICB2YXIgcGFydGlhbFJpZ2h0ID0gY3VycnkoX2NyZWF0ZVBhcnRpYWxBcHBsaWNhdG9yKGZsaXAoX2NvbmNhdCkpKTtcblxuICAgIC8qKlxuICAgICAqIFRha2VzIGEgcHJlZGljYXRlIGFuZCBhIGxpc3QgYW5kIHJldHVybnMgdGhlIHBhaXIgb2YgbGlzdHMgb2ZcbiAgICAgKiBlbGVtZW50cyB3aGljaCBkbyBhbmQgZG8gbm90IHNhdGlzZnkgdGhlIHByZWRpY2F0ZSwgcmVzcGVjdGl2ZWx5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW1thXSxbYV1dXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSB0byBkZXRlcm1pbmUgd2hpY2ggYXJyYXkgdGhlIGVsZW1lbnQgYmVsb25ncyB0by5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBwYXJ0aXRpb24uXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmVzdGVkIGFycmF5LCBjb250YWluaW5nIGZpcnN0IGFuIGFycmF5IG9mIGVsZW1lbnRzIHRoYXQgc2F0aXNmaWVkIHRoZSBwcmVkaWNhdGUsXG4gICAgICogICAgICAgICBhbmQgc2Vjb25kIGFuIGFycmF5IG9mIGVsZW1lbnRzIHRoYXQgZGlkIG5vdCBzYXRpc2Z5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucGFydGl0aW9uKFIuY29udGFpbnMoJ3MnKSwgWydzc3MnLCAndHR0JywgJ2ZvbycsICdiYXJzJ10pO1xuICAgICAqICAgICAgLy89PiBbIFsgJ3NzcycsICdiYXJzJyBdLCAgWyAndHR0JywgJ2ZvbycgXSBdXG4gICAgICovXG4gICAgdmFyIHBhcnRpdGlvbiA9IF9jdXJyeTIoZnVuY3Rpb24gcGFydGl0aW9uKHByZWQsIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UoZnVuY3Rpb24gKGFjYywgZWx0KSB7XG4gICAgICAgICAgICB2YXIgeHMgPSBhY2NbcHJlZChlbHQpID8gMCA6IDFdO1xuICAgICAgICAgICAgeHNbeHMubGVuZ3RoXSA9IGVsdDtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH0sIFtcbiAgICAgICAgICAgIFtdLFxuICAgICAgICAgICAgW11cbiAgICAgICAgXSwgbGlzdCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgYSBuZXN0ZWQgcGF0aCBvbiBhbiBvYmplY3QgaGFzIGEgc3BlY2lmaWMgdmFsdWUsXG4gICAgICogaW4gYFIuZXF1YWxzYCB0ZXJtcy4gTW9zdCBsaWtlbHkgdXNlZCB0byBmaWx0ZXIgYSBsaXN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgW1N0cmluZ10gLT4gKiAtPiB7U3RyaW5nOiAqfSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGF0aCBUaGUgcGF0aCBvZiB0aGUgbmVzdGVkIHByb3BlcnR5IHRvIHVzZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsIFRoZSB2YWx1ZSB0byBjb21wYXJlIHRoZSBuZXN0ZWQgcHJvcGVydHkgd2l0aFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBjaGVjayB0aGUgbmVzdGVkIHByb3BlcnR5IGluXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSB2YWx1ZSBlcXVhbHMgdGhlIG5lc3RlZCBvYmplY3QgcHJvcGVydHksXG4gICAgICogICAgICAgICBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgdXNlcjEgPSB7IGFkZHJlc3M6IHsgemlwQ29kZTogOTAyMTAgfSB9O1xuICAgICAqICAgICAgdmFyIHVzZXIyID0geyBhZGRyZXNzOiB7IHppcENvZGU6IDU1NTU1IH0gfTtcbiAgICAgKiAgICAgIHZhciB1c2VyMyA9IHsgbmFtZTogJ0JvYicgfTtcbiAgICAgKiAgICAgIHZhciB1c2VycyA9IFsgdXNlcjEsIHVzZXIyLCB1c2VyMyBdO1xuICAgICAqICAgICAgdmFyIGlzRmFtb3VzID0gUi5wYXRoRXEoWydhZGRyZXNzJywgJ3ppcENvZGUnXSwgOTAyMTApO1xuICAgICAqICAgICAgUi5maWx0ZXIoaXNGYW1vdXMsIHVzZXJzKTsgLy89PiBbIHVzZXIxIF1cbiAgICAgKi9cbiAgICB2YXIgcGF0aEVxID0gX2N1cnJ5MyhmdW5jdGlvbiBwYXRoRXEoX3BhdGgsIHZhbCwgb2JqKSB7XG4gICAgICAgIHJldHVybiBlcXVhbHMocGF0aChfcGF0aCwgb2JqKSwgdmFsKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBieSBwbHVja2luZyB0aGUgc2FtZSBuYW1lZCBwcm9wZXJ0eSBvZmYgYWxsIG9iamVjdHMgaW4gdGhlIGxpc3Qgc3VwcGxpZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGsgLT4gW3trOiB2fV0gLT4gW3ZdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ8U3RyaW5nfSBrZXkgVGhlIGtleSBuYW1lIHRvIHBsdWNrIG9mZiBvZiBlYWNoIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3Qgb2YgdmFsdWVzIGZvciB0aGUgZ2l2ZW4ga2V5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucGx1Y2soJ2EnKShbe2E6IDF9LCB7YTogMn1dKTsgLy89PiBbMSwgMl1cbiAgICAgKiAgICAgIFIucGx1Y2soMCkoW1sxLCAyXSwgWzMsIDRdXSk7ICAgLy89PiBbMSwgM11cbiAgICAgKi9cbiAgICB2YXIgcGx1Y2sgPSBfY3VycnkyKGZ1bmN0aW9uIHBsdWNrKHAsIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIG1hcChwcm9wKHApLCBsaXN0KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHByb3BlcnR5IGlzIGVxdWFsLCBpbiBgUi5lcXVhbHNgXG4gICAgICogdGVybXMsIHRvIHRoZSBnaXZlbiB2YWx1ZTsgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBTdHJpbmcgLT4gYSAtPiBPYmplY3QgLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAgICogQHBhcmFtIHsqfSB2YWxcbiAgICAgKiBAcGFyYW0geyp9IG9ialxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQHNlZSBSLmVxdWFscywgUi5wcm9wU2F0aXNmaWVzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGFiYnkgPSB7bmFtZTogJ0FiYnknLCBhZ2U6IDcsIGhhaXI6ICdibG9uZCd9O1xuICAgICAqICAgICAgdmFyIGZyZWQgPSB7bmFtZTogJ0ZyZWQnLCBhZ2U6IDEyLCBoYWlyOiAnYnJvd24nfTtcbiAgICAgKiAgICAgIHZhciBydXN0eSA9IHtuYW1lOiAnUnVzdHknLCBhZ2U6IDEwLCBoYWlyOiAnYnJvd24nfTtcbiAgICAgKiAgICAgIHZhciBhbG9pcyA9IHtuYW1lOiAnQWxvaXMnLCBhZ2U6IDE1LCBkaXNwb3NpdGlvbjogJ3N1cmx5J307XG4gICAgICogICAgICB2YXIga2lkcyA9IFthYmJ5LCBmcmVkLCBydXN0eSwgYWxvaXNdO1xuICAgICAqICAgICAgdmFyIGhhc0Jyb3duSGFpciA9IFIucHJvcEVxKCdoYWlyJywgJ2Jyb3duJyk7XG4gICAgICogICAgICBSLmZpbHRlcihoYXNCcm93bkhhaXIsIGtpZHMpOyAvLz0+IFtmcmVkLCBydXN0eV1cbiAgICAgKi9cbiAgICB2YXIgcHJvcEVxID0gX2N1cnJ5MyhmdW5jdGlvbiBwcm9wRXEobmFtZSwgdmFsLCBvYmopIHtcbiAgICAgICAgcmV0dXJuIHByb3BTYXRpc2ZpZXMoZXF1YWxzKHZhbCksIG5hbWUsIG9iaik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgc3BlY2lmaWVkIG9iamVjdCBwcm9wZXJ0eSBpcyBvZiB0aGUgZ2l2ZW4gdHlwZTtcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgVHlwZVxuICAgICAqIEBzaWcgVHlwZSAtPiBTdHJpbmcgLT4gT2JqZWN0IC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB0eXBlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgICAgKiBAcGFyYW0geyp9IG9ialxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQHNlZSBSLmlzXG4gICAgICogQHNlZSBSLnByb3BTYXRpc2ZpZXNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnByb3BJcyhOdW1iZXIsICd4Jywge3g6IDEsIHk6IDJ9KTsgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5wcm9wSXMoTnVtYmVyLCAneCcsIHt4OiAnZm9vJ30pOyAgICAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLnByb3BJcyhOdW1iZXIsICd4Jywge30pOyAgICAgICAgICAgIC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgcHJvcElzID0gX2N1cnJ5MyhmdW5jdGlvbiBwcm9wSXModHlwZSwgbmFtZSwgb2JqKSB7XG4gICAgICAgIHJldHVybiBwcm9wU2F0aXNmaWVzKGlzKHR5cGUpLCBuYW1lLCBvYmopO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHNpbmdsZSBpdGVtIGJ5IGl0ZXJhdGluZyB0aHJvdWdoIHRoZSBsaXN0LCBzdWNjZXNzaXZlbHkgY2FsbGluZyB0aGUgaXRlcmF0b3JcbiAgICAgKiBmdW5jdGlvbiBhbmQgcGFzc2luZyBpdCBhbiBhY2N1bXVsYXRvciB2YWx1ZSBhbmQgdGhlIGN1cnJlbnQgdmFsdWUgZnJvbSB0aGUgYXJyYXksIGFuZFxuICAgICAqIHRoZW4gcGFzc2luZyB0aGUgcmVzdWx0IHRvIHRoZSBuZXh0IGNhbGwuXG4gICAgICpcbiAgICAgKiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24gcmVjZWl2ZXMgdHdvIHZhbHVlczogKihhY2MsIHZhbHVlKSouICBJdCBtYXkgdXNlIGBSLnJlZHVjZWRgIHRvXG4gICAgICogc2hvcnRjdXQgdGhlIGl0ZXJhdGlvbi5cbiAgICAgKlxuICAgICAqIE5vdGU6IGBSLnJlZHVjZWAgZG9lcyBub3Qgc2tpcCBkZWxldGVkIG9yIHVuYXNzaWduZWQgaW5kaWNlcyAoc3BhcnNlIGFycmF5cyksIHVubGlrZVxuICAgICAqIHRoZSBuYXRpdmUgYEFycmF5LnByb3RvdHlwZS5yZWR1Y2VgIG1ldGhvZC4gRm9yIG1vcmUgZGV0YWlscyBvbiB0aGlzIGJlaGF2aW9yLCBzZWU6XG4gICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvcmVkdWNlI0Rlc2NyaXB0aW9uXG4gICAgICogQHNlZSBSLnJlZHVjZWRcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEsYiAtPiBhKSAtPiBhIC0+IFtiXSAtPiBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uLiBSZWNlaXZlcyB0d28gdmFsdWVzLCB0aGUgYWNjdW11bGF0b3IgYW5kIHRoZVxuICAgICAqICAgICAgICBjdXJyZW50IGVsZW1lbnQgZnJvbSB0aGUgYXJyYXkuXG4gICAgICogQHBhcmFtIHsqfSBhY2MgVGhlIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBmaW5hbCwgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG51bWJlcnMgPSBbMSwgMiwgM107XG4gICAgICogICAgICB2YXIgYWRkID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAqICAgICAgICByZXR1cm4gYSArIGI7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBSLnJlZHVjZShhZGQsIDEwLCBudW1iZXJzKTsgLy89PiAxNlxuICAgICAqL1xuICAgIHZhciByZWR1Y2UgPSBfY3VycnkzKF9yZWR1Y2UpO1xuXG4gICAgLyoqXG4gICAgICogU2ltaWxhciB0byBgZmlsdGVyYCwgZXhjZXB0IHRoYXQgaXQga2VlcHMgb25seSB2YWx1ZXMgZm9yIHdoaWNoIHRoZSBnaXZlbiBwcmVkaWNhdGVcbiAgICAgKiBmdW5jdGlvbiByZXR1cm5zIGZhbHN5LiBUaGUgcHJlZGljYXRlIGZ1bmN0aW9uIGlzIHBhc3NlZCBvbmUgYXJndW1lbnQ6ICoodmFsdWUpKi5cbiAgICAgKlxuICAgICAqIEFjdHMgYXMgYSB0cmFuc2R1Y2VyIGlmIGEgdHJhbnNmb3JtZXIgaXMgZ2l2ZW4gaW4gbGlzdCBwb3NpdGlvbi5cbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBuZXcgZmlsdGVyZWQgYXJyYXkuXG4gICAgICogQHNlZSBSLmZpbHRlclxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpc09kZCA9IGZ1bmN0aW9uKG4pIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIG4gJSAyID09PSAxO1xuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIFIucmVqZWN0KGlzT2RkLCBbMSwgMiwgMywgNF0pOyAvLz0+IFsyLCA0XVxuICAgICAqL1xuICAgIHZhciByZWplY3QgPSBfY3VycnkyKGZ1bmN0aW9uIHJlamVjdChmbiwgbGlzdCkge1xuICAgICAgICByZXR1cm4gZmlsdGVyKF9jb21wbGVtZW50KGZuKSwgbGlzdCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZml4ZWQgbGlzdCBvZiBzaXplIGBuYCBjb250YWluaW5nIGEgc3BlY2lmaWVkIGlkZW50aWNhbCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgYSAtPiBuIC0+IFthXVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHJlcGVhdC5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gbiBUaGUgZGVzaXJlZCBzaXplIG9mIHRoZSBvdXRwdXQgbGlzdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgYXJyYXkgY29udGFpbmluZyBgbmAgYHZhbHVlYHMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5yZXBlYXQoJ2hpJywgNSk7IC8vPT4gWydoaScsICdoaScsICdoaScsICdoaScsICdoaSddXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgKiAgICAgIHZhciByZXBlYXRlZE9ianMgPSBSLnJlcGVhdChvYmosIDUpOyAvLz0+IFt7fSwge30sIHt9LCB7fSwge31dXG4gICAgICogICAgICByZXBlYXRlZE9ianNbMF0gPT09IHJlcGVhdGVkT2Jqc1sxXTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIHJlcGVhdCA9IF9jdXJyeTIoZnVuY3Rpb24gcmVwZWF0KHZhbHVlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aW1lcyhhbHdheXModmFsdWUpLCBuKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBsaXN0IG9yIHN0cmluZyAob3Igb2JqZWN0IHdpdGggYSBgc2xpY2VgXG4gICAgICogbWV0aG9kKSBmcm9tIGBmcm9tSW5kZXhgIChpbmNsdXNpdmUpIHRvIGB0b0luZGV4YCAoZXhjbHVzaXZlKS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBbYV0gLT4gW2FdXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyIC0+IFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZnJvbUluZGV4IFRoZSBzdGFydCBpbmRleCAoaW5jbHVzaXZlKS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gdG9JbmRleCBUaGUgZW5kIGluZGV4IChleGNsdXNpdmUpLlxuICAgICAqIEBwYXJhbSB7Kn0gbGlzdFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5zbGljZSgxLCAzLCBbJ2EnLCAnYicsICdjJywgJ2QnXSk7ICAgICAgICAvLz0+IFsnYicsICdjJ11cbiAgICAgKiAgICAgIFIuc2xpY2UoMSwgSW5maW5pdHksIFsnYScsICdiJywgJ2MnLCAnZCddKTsgLy89PiBbJ2InLCAnYycsICdkJ11cbiAgICAgKiAgICAgIFIuc2xpY2UoMCwgLTEsIFsnYScsICdiJywgJ2MnLCAnZCddKTsgICAgICAgLy89PiBbJ2EnLCAnYicsICdjJ11cbiAgICAgKiAgICAgIFIuc2xpY2UoLTMsIC0xLCBbJ2EnLCAnYicsICdjJywgJ2QnXSk7ICAgICAgLy89PiBbJ2InLCAnYyddXG4gICAgICogICAgICBSLnNsaWNlKDAsIDMsICdyYW1kYScpOyAgICAgICAgICAgICAgICAgICAgIC8vPT4gJ3JhbSdcbiAgICAgKi9cbiAgICB2YXIgc2xpY2UgPSBfY3VycnkzKF9jaGVja0Zvck1ldGhvZCgnc2xpY2UnLCBmdW5jdGlvbiBzbGljZShmcm9tSW5kZXgsIHRvSW5kZXgsIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGxpc3QsIGZyb21JbmRleCwgdG9JbmRleCk7XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogU3BsaXRzIGEgY29sbGVjdGlvbiBpbnRvIHNsaWNlcyBvZiB0aGUgc3BlY2lmaWVkIGxlbmd0aC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFthXSAtPiBbW2FdXVxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFN0cmluZyAtPiBbU3RyaW5nXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdFxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuc3BsaXRFdmVyeSgzLCBbMSwgMiwgMywgNCwgNSwgNiwgN10pOyAvLz0+IFtbMSwgMiwgM10sIFs0LCA1LCA2XSwgWzddXVxuICAgICAqICAgICAgUi5zcGxpdEV2ZXJ5KDMsICdmb29iYXJiYXonKTsgLy89PiBbJ2ZvbycsICdiYXInLCAnYmF6J11cbiAgICAgKi9cbiAgICB2YXIgc3BsaXRFdmVyeSA9IF9jdXJyeTIoZnVuY3Rpb24gc3BsaXRFdmVyeShuLCBsaXN0KSB7XG4gICAgICAgIGlmIChuIDw9IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlyc3QgYXJndW1lbnQgdG8gc3BsaXRFdmVyeSBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlcicpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goc2xpY2UoaWR4LCBpZHggKz0gbiwgbGlzdCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIHRvZ2V0aGVyIGFsbCB0aGUgZWxlbWVudHMgb2YgYSBsaXN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBbTnVtYmVyXSAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IEFuIGFycmF5IG9mIG51bWJlcnNcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSBzdW0gb2YgYWxsIHRoZSBudW1iZXJzIGluIHRoZSBsaXN0LlxuICAgICAqIEBzZWUgUi5yZWR1Y2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnN1bShbMiw0LDYsOCwxMDAsMV0pOyAvLz0+IDEyMVxuICAgICAqL1xuICAgIHZhciBzdW0gPSByZWR1Y2UoYWRkLCAwKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYWxsIGJ1dCB0aGUgZmlyc3QgZWxlbWVudCBvZiB0aGUgZ2l2ZW4gbGlzdCBvciBzdHJpbmcgKG9yIG9iamVjdFxuICAgICAqIHdpdGggYSBgdGFpbGAgbWV0aG9kKS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzZWUgUi5oZWFkLCBSLmluaXQsIFIubGFzdFxuICAgICAqIEBzaWcgW2FdIC0+IFthXVxuICAgICAqIEBzaWcgU3RyaW5nIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7Kn0gbGlzdFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50YWlsKFsxLCAyLCAzXSk7ICAvLz0+IFsyLCAzXVxuICAgICAqICAgICAgUi50YWlsKFsxLCAyXSk7ICAgICAvLz0+IFsyXVxuICAgICAqICAgICAgUi50YWlsKFsxXSk7ICAgICAgICAvLz0+IFtdXG4gICAgICogICAgICBSLnRhaWwoW10pOyAgICAgICAgIC8vPT4gW11cbiAgICAgKlxuICAgICAqICAgICAgUi50YWlsKCdhYmMnKTsgIC8vPT4gJ2JjJ1xuICAgICAqICAgICAgUi50YWlsKCdhYicpOyAgIC8vPT4gJ2InXG4gICAgICogICAgICBSLnRhaWwoJ2EnKTsgICAgLy89PiAnJ1xuICAgICAqICAgICAgUi50YWlsKCcnKTsgICAgIC8vPT4gJydcbiAgICAgKi9cbiAgICB2YXIgdGFpbCA9IF9jaGVja0Zvck1ldGhvZCgndGFpbCcsIHNsaWNlKDEsIEluZmluaXR5KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBmaXJzdCBgbmAgZWxlbWVudHMgb2YgdGhlIGdpdmVuIGxpc3QsIHN0cmluZywgb3JcbiAgICAgKiB0cmFuc2R1Y2VyL3RyYW5zZm9ybWVyIChvciBvYmplY3Qgd2l0aCBhIGB0YWtlYCBtZXRob2QpLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBOdW1iZXIgLT4gW2FdIC0+IFthXVxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEBwYXJhbSB7Kn0gbGlzdFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLmRyb3BcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnRha2UoMSwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2ZvbyddXG4gICAgICogICAgICBSLnRha2UoMiwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2ZvbycsICdiYXInXVxuICAgICAqICAgICAgUi50YWtlKDMsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydmb28nLCAnYmFyJywgJ2JheiddXG4gICAgICogICAgICBSLnRha2UoNCwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2ZvbycsICdiYXInLCAnYmF6J11cbiAgICAgKiAgICAgIFIudGFrZSgzLCAncmFtZGEnKTsgICAgICAgICAgICAgICAvLz0+ICdyYW0nXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBwZXJzb25uZWwgPSBbXG4gICAgICogICAgICAgICdEYXZlIEJydWJlY2snLFxuICAgICAqICAgICAgICAnUGF1bCBEZXNtb25kJyxcbiAgICAgKiAgICAgICAgJ0V1Z2VuZSBXcmlnaHQnLFxuICAgICAqICAgICAgICAnSm9lIE1vcmVsbG8nLFxuICAgICAqICAgICAgICAnR2VycnkgTXVsbGlnYW4nLFxuICAgICAqICAgICAgICAnQm9iIEJhdGVzJyxcbiAgICAgKiAgICAgICAgJ0pvZSBEb2RnZScsXG4gICAgICogICAgICAgICdSb24gQ3JvdHR5J1xuICAgICAqICAgICAgXTtcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRha2VGaXZlID0gUi50YWtlKDUpO1xuICAgICAqICAgICAgdGFrZUZpdmUocGVyc29ubmVsKTtcbiAgICAgKiAgICAgIC8vPT4gWydEYXZlIEJydWJlY2snLCAnUGF1bCBEZXNtb25kJywgJ0V1Z2VuZSBXcmlnaHQnLCAnSm9lIE1vcmVsbG8nLCAnR2VycnkgTXVsbGlnYW4nXVxuICAgICAqL1xuICAgIHZhciB0YWtlID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCd0YWtlJywgX3h0YWtlLCBmdW5jdGlvbiB0YWtlKG4sIHhzKSB7XG4gICAgICAgIHJldHVybiBzbGljZSgwLCBuIDwgMCA/IEluZmluaXR5IDogbiwgeHMpO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBmaXJzdCBgbmAgZWxlbWVudHMgb2YgYSBnaXZlbiBsaXN0LCBwYXNzaW5nIGVhY2ggdmFsdWVcbiAgICAgKiB0byB0aGUgc3VwcGxpZWQgcHJlZGljYXRlIGZ1bmN0aW9uLCBhbmQgdGVybWluYXRpbmcgd2hlbiB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uIHJldHVybnNcbiAgICAgKiBgZmFsc2VgLiBFeGNsdWRlcyB0aGUgZWxlbWVudCB0aGF0IGNhdXNlZCB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uIHRvIGZhaWwuIFRoZSBwcmVkaWNhdGVcbiAgICAgKiBmdW5jdGlvbiBpcyBwYXNzZWQgb25lIGFyZ3VtZW50OiAqKHZhbHVlKSouXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBhcnJheS5cbiAgICAgKiBAc2VlIFIuZHJvcFdoaWxlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGlzTm90Rm91ciA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuICEoeCA9PT0gNCk7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBSLnRha2VXaGlsZShpc05vdEZvdXIsIFsxLCAyLCAzLCA0XSk7IC8vPT4gWzEsIDIsIDNdXG4gICAgICovXG4gICAgdmFyIHRha2VXaGlsZSA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgndGFrZVdoaWxlJywgX3h0YWtlV2hpbGUsIGZ1bmN0aW9uIHRha2VXaGlsZShmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4gJiYgZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zbGljZShsaXN0LCAwLCBpZHgpO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIGEgdHJhbnNkdWNlciB1c2luZyBzdXBwbGllZCBpdGVyYXRvciBmdW5jdGlvbi4gUmV0dXJucyBhIHNpbmdsZSBpdGVtIGJ5XG4gICAgICogaXRlcmF0aW5nIHRocm91Z2ggdGhlIGxpc3QsIHN1Y2Nlc3NpdmVseSBjYWxsaW5nIHRoZSB0cmFuc2Zvcm1lZCBpdGVyYXRvciBmdW5jdGlvbiBhbmRcbiAgICAgKiBwYXNzaW5nIGl0IGFuIGFjY3VtdWxhdG9yIHZhbHVlIGFuZCB0aGUgY3VycmVudCB2YWx1ZSBmcm9tIHRoZSBhcnJheSwgYW5kIHRoZW4gcGFzc2luZ1xuICAgICAqIHRoZSByZXN1bHQgdG8gdGhlIG5leHQgY2FsbC5cbiAgICAgKlxuICAgICAqIFRoZSBpdGVyYXRvciBmdW5jdGlvbiByZWNlaXZlcyB0d28gdmFsdWVzOiAqKGFjYywgdmFsdWUpKi4gSXQgd2lsbCBiZSB3cmFwcGVkIGFzIGFcbiAgICAgKiB0cmFuc2Zvcm1lciB0byBpbml0aWFsaXplIHRoZSB0cmFuc2R1Y2VyLiBBIHRyYW5zZm9ybWVyIGNhbiBiZSBwYXNzZWQgZGlyZWN0bHkgaW4gcGxhY2VcbiAgICAgKiBvZiBhbiBpdGVyYXRvciBmdW5jdGlvbi4gIEluIGJvdGggY2FzZXMsIGl0ZXJhdGlvbiBtYXkgYmUgc3RvcHBlZCBlYXJseSB3aXRoIHRoZVxuICAgICAqIGBSLnJlZHVjZWRgIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQSB0cmFuc2R1Y2VyIGlzIGEgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIGEgdHJhbnNmb3JtZXIgYW5kIHJldHVybnMgYSB0cmFuc2Zvcm1lciBhbmQgY2FuXG4gICAgICogYmUgY29tcG9zZWQgZGlyZWN0bHkuXG4gICAgICpcbiAgICAgKiBBIHRyYW5zZm9ybWVyIGlzIGFuIGFuIG9iamVjdCB0aGF0IHByb3ZpZGVzIGEgMi1hcml0eSByZWR1Y2luZyBpdGVyYXRvciBmdW5jdGlvbiwgc3RlcCxcbiAgICAgKiAwLWFyaXR5IGluaXRpYWwgdmFsdWUgZnVuY3Rpb24sIGluaXQsIGFuZCAxLWFyaXR5IHJlc3VsdCBleHRyYWN0aW9uIGZ1bmN0aW9uLCByZXN1bHQuXG4gICAgICogVGhlIHN0ZXAgZnVuY3Rpb24gaXMgdXNlZCBhcyB0aGUgaXRlcmF0b3IgZnVuY3Rpb24gaW4gcmVkdWNlLiBUaGUgcmVzdWx0IGZ1bmN0aW9uIGlzIHVzZWRcbiAgICAgKiB0byBjb252ZXJ0IHRoZSBmaW5hbCBhY2N1bXVsYXRvciBpbnRvIHRoZSByZXR1cm4gdHlwZSBhbmQgaW4gbW9zdCBjYXNlcyBpcyBSLmlkZW50aXR5LlxuICAgICAqIFRoZSBpbml0IGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIHByb3ZpZGUgYW4gaW5pdGlhbCBhY2N1bXVsYXRvciwgYnV0IGlzIGlnbm9yZWQgYnkgdHJhbnNkdWNlLlxuICAgICAqXG4gICAgICogVGhlIGl0ZXJhdGlvbiBpcyBwZXJmb3JtZWQgd2l0aCBSLnJlZHVjZSBhZnRlciBpbml0aWFsaXppbmcgdGhlIHRyYW5zZHVjZXIuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2VlIFIucmVkdWNlLCBSLnJlZHVjZWQsIFIuaW50b1xuICAgICAqIEBzaWcgKGMgLT4gYykgLT4gKGEsYiAtPiBhKSAtPiBhIC0+IFtiXSAtPiBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0geGYgVGhlIHRyYW5zZHVjZXIgZnVuY3Rpb24uIFJlY2VpdmVzIGEgdHJhbnNmb3JtZXIgYW5kIHJldHVybnMgYSB0cmFuc2Zvcm1lci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24uIFJlY2VpdmVzIHR3byB2YWx1ZXMsIHRoZSBhY2N1bXVsYXRvciBhbmQgdGhlXG4gICAgICogICAgICAgIGN1cnJlbnQgZWxlbWVudCBmcm9tIHRoZSBhcnJheS4gV3JhcHBlZCBhcyB0cmFuc2Zvcm1lciwgaWYgbmVjZXNzYXJ5LCBhbmQgdXNlZCB0b1xuICAgICAqICAgICAgICBpbml0aWFsaXplIHRoZSB0cmFuc2R1Y2VyXG4gICAgICogQHBhcmFtIHsqfSBhY2MgVGhlIGluaXRpYWwgYWNjdW11bGF0b3IgdmFsdWUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7Kn0gVGhlIGZpbmFsLCBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbnVtYmVycyA9IFsxLCAyLCAzLCA0XTtcbiAgICAgKiAgICAgIHZhciB0cmFuc2R1Y2VyID0gUi5jb21wb3NlKFIubWFwKFIuYWRkKDEpKSwgUi50YWtlKDIpKTtcbiAgICAgKlxuICAgICAqICAgICAgUi50cmFuc2R1Y2UodHJhbnNkdWNlciwgUi5mbGlwKFIuYXBwZW5kKSwgW10sIG51bWJlcnMpOyAvLz0+IFsyLCAzXVxuICAgICAqL1xuICAgIHZhciB0cmFuc2R1Y2UgPSBjdXJyeU4oNCwgZnVuY3Rpb24gdHJhbnNkdWNlKHhmLCBmbiwgYWNjLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKHhmKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJyA/IF94d3JhcChmbikgOiBmbiksIGFjYywgbGlzdCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDb21iaW5lcyB0d28gbGlzdHMgaW50byBhIHNldCAoaS5lLiBubyBkdXBsaWNhdGVzKSBjb21wb3NlZCBvZiB0aGUgZWxlbWVudHMgb2YgZWFjaCBsaXN0LiAgRHVwbGljYXRpb24gaXNcbiAgICAgKiBkZXRlcm1pbmVkIGFjY29yZGluZyB0byB0aGUgdmFsdWUgcmV0dXJuZWQgYnkgYXBwbHlpbmcgdGhlIHN1cHBsaWVkIHByZWRpY2F0ZSB0byB0d28gbGlzdCBlbGVtZW50cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIChhLGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkIEEgcHJlZGljYXRlIHVzZWQgdG8gdGVzdCB3aGV0aGVyIHR3byBpdGVtcyBhcmUgZXF1YWwuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdDEgVGhlIGZpcnN0IGxpc3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdDIgVGhlIHNlY29uZCBsaXN0LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgZmlyc3QgYW5kIHNlY29uZCBsaXN0cyBjb25jYXRlbmF0ZWQsIHdpdGhcbiAgICAgKiAgICAgICAgIGR1cGxpY2F0ZXMgcmVtb3ZlZC5cbiAgICAgKiBAc2VlIFIudW5pb25cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBmdW5jdGlvbiBjbXAoeCwgeSkgeyByZXR1cm4geC5hID09PSB5LmE7IH1cbiAgICAgKiAgICAgIHZhciBsMSA9IFt7YTogMX0sIHthOiAyfV07XG4gICAgICogICAgICB2YXIgbDIgPSBbe2E6IDF9LCB7YTogNH1dO1xuICAgICAqICAgICAgUi51bmlvbldpdGgoY21wLCBsMSwgbDIpOyAvLz0+IFt7YTogMX0sIHthOiAyfSwge2E6IDR9XVxuICAgICAqL1xuICAgIHZhciB1bmlvbldpdGggPSBfY3VycnkzKGZ1bmN0aW9uIHVuaW9uV2l0aChwcmVkLCBsaXN0MSwgbGlzdDIpIHtcbiAgICAgICAgcmV0dXJuIHVuaXFXaXRoKHByZWQsIF9jb25jYXQobGlzdDEsIGxpc3QyKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29udGFpbmluZyBvbmx5IG9uZSBjb3B5IG9mIGVhY2ggZWxlbWVudCBpbiB0aGUgb3JpZ2luYWwgbGlzdC5cbiAgICAgKiBgUi5lcXVhbHNgIGlzIHVzZWQgdG8gZGV0ZXJtaW5lIGVxdWFsaXR5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBsaXN0IG9mIHVuaXF1ZSBpdGVtcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnVuaXEoWzEsIDEsIDIsIDFdKTsgLy89PiBbMSwgMl1cbiAgICAgKiAgICAgIFIudW5pcShbMSwgJzEnXSk7ICAgICAvLz0+IFsxLCAnMSddXG4gICAgICogICAgICBSLnVuaXEoW1s0Ml0sIFs0Ml1dKTsgLy89PiBbWzQyXV1cbiAgICAgKi9cbiAgICB2YXIgdW5pcSA9IHVuaXFXaXRoKGVxdWFscyk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgYnkgcHVsbGluZyBldmVyeSBpdGVtIGF0IHRoZSBmaXJzdCBsZXZlbCBvZiBuZXN0aW5nIG91dCwgYW5kIHB1dHRpbmdcbiAgICAgKiB0aGVtIGluIGEgbmV3IGFycmF5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbYV0gLT4gW2JdXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBmbGF0dGVuZWQgbGlzdC5cbiAgICAgKiBAc2VlIFIuZmxhdHRlblxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudW5uZXN0KFsxLCBbMl0sIFtbM11dXSk7IC8vPT4gWzEsIDIsIFszXV1cbiAgICAgKiAgICAgIFIudW5uZXN0KFtbMSwgMl0sIFszLCA0XSwgWzUsIDZdXSk7IC8vPT4gWzEsIDIsIDMsIDQsIDUsIDZdXG4gICAgICovXG4gICAgdmFyIHVubmVzdCA9IF9jdXJyeTEoX21ha2VGbGF0KGZhbHNlKSk7XG5cbiAgICAvKipcbiAgICAgKiBBY2NlcHRzIGEgZnVuY3Rpb24gYGZuYCBhbmQgYW55IG51bWJlciBvZiB0cmFuc2Zvcm1lciBmdW5jdGlvbnMgYW5kIHJldHVybnMgYSBuZXdcbiAgICAgKiBmdW5jdGlvbi4gV2hlbiB0aGUgbmV3IGZ1bmN0aW9uIGlzIGludm9rZWQsIGl0IGNhbGxzIHRoZSBmdW5jdGlvbiBgZm5gIHdpdGggcGFyYW1ldGVyc1xuICAgICAqIGNvbnNpc3Rpbmcgb2YgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGVhY2ggc3VwcGxpZWQgaGFuZGxlciBvbiBzdWNjZXNzaXZlIGFyZ3VtZW50cyB0byB0aGVcbiAgICAgKiBuZXcgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBJZiBtb3JlIGFyZ3VtZW50cyBhcmUgcGFzc2VkIHRvIHRoZSByZXR1cm5lZCBmdW5jdGlvbiB0aGFuIHRyYW5zZm9ybWVyIGZ1bmN0aW9ucywgdGhvc2VcbiAgICAgKiBhcmd1bWVudHMgYXJlIHBhc3NlZCBkaXJlY3RseSB0byBgZm5gIGFzIGFkZGl0aW9uYWwgcGFyYW1ldGVycy4gSWYgeW91IGV4cGVjdCBhZGRpdGlvbmFsXG4gICAgICogYXJndW1lbnRzIHRoYXQgZG9uJ3QgbmVlZCB0byBiZSB0cmFuc2Zvcm1lZCwgYWx0aG91Z2ggeW91IGNhbiBpZ25vcmUgdGhlbSwgaXQncyBiZXN0IHRvXG4gICAgICogcGFzcyBhbiBpZGVudGl0eSBmdW5jdGlvbiBzbyB0aGF0IHRoZSBuZXcgZnVuY3Rpb24gcmVwb3J0cyB0aGUgY29ycmVjdCBhcml0eS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICh4MSAtPiB4MiAtPiAuLi4gLT4geikgLT4gKChhIC0+IHgxKSwgKGIgLT4geDIpLCAuLi4pIC0+IChhIC0+IGIgLT4gLi4uIC0+IHopXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIHdyYXAuXG4gICAgICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gdHJhbnNmb3JtZXJzIEEgdmFyaWFibGUgbnVtYmVyIG9mIHRyYW5zZm9ybWVyIGZ1bmN0aW9uc1xuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBUaGUgd3JhcHBlZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZG91YmxlID0gZnVuY3Rpb24oeSkgeyByZXR1cm4geSAqIDI7IH07XG4gICAgICogICAgICB2YXIgc3F1YXJlID0gZnVuY3Rpb24oeCkgeyByZXR1cm4geCAqIHg7IH07XG4gICAgICogICAgICB2YXIgYWRkID0gZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYSArIGI7IH07XG4gICAgICogICAgICAvLyBBZGRzIGFueSBudW1iZXIgb2YgYXJndW1lbnRzIHRvZ2V0aGVyXG4gICAgICogICAgICB2YXIgYWRkQWxsID0gZnVuY3Rpb24oKSB7XG4gICAgICogICAgICAgIHJldHVybiBSLnJlZHVjZShhZGQsIDAsIGFyZ3VtZW50cyk7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICAvLyBCYXNpYyBleGFtcGxlXG4gICAgICogICAgICB2YXIgYWRkRG91YmxlQW5kU3F1YXJlID0gUi51c2VXaXRoKGFkZEFsbCwgZG91YmxlLCBzcXVhcmUpO1xuICAgICAqXG4gICAgICogICAgICAvL+KJhSBhZGRBbGwoZG91YmxlKDEwKSwgc3F1YXJlKDUpKTtcbiAgICAgKiAgICAgIGFkZERvdWJsZUFuZFNxdWFyZSgxMCwgNSk7IC8vPT4gNDVcbiAgICAgKlxuICAgICAqICAgICAgLy8gRXhhbXBsZSBvZiBwYXNzaW5nIG1vcmUgYXJndW1lbnRzIHRoYW4gdHJhbnNmb3JtZXJzXG4gICAgICogICAgICAvL+KJhSBhZGRBbGwoZG91YmxlKDEwKSwgc3F1YXJlKDUpLCAxMDApO1xuICAgICAqICAgICAgYWRkRG91YmxlQW5kU3F1YXJlKDEwLCA1LCAxMDApOyAvLz0+IDE0NVxuICAgICAqXG4gICAgICogICAgICAvLyBJZiB0aGVyZSBhcmUgZXh0cmEgX2V4cGVjdGVkXyBhcmd1bWVudHMgdGhhdCBkb24ndCBuZWVkIHRvIGJlIHRyYW5zZm9ybWVkLCBhbHRob3VnaFxuICAgICAqICAgICAgLy8geW91IGNhbiBpZ25vcmUgdGhlbSwgaXQgbWlnaHQgYmUgYmVzdCB0byBwYXNzIGluIHRoZSBpZGVudGl0eSBmdW5jdGlvbiBzbyB0aGF0IHRoZSBuZXdcbiAgICAgKiAgICAgIC8vIGZ1bmN0aW9uIGNvcnJlY3RseSByZXBvcnRzIGFyaXR5LlxuICAgICAqICAgICAgdmFyIGFkZERvdWJsZUFuZFNxdWFyZVdpdGhFeHRyYVBhcmFtcyA9IFIudXNlV2l0aChhZGRBbGwsIGRvdWJsZSwgc3F1YXJlLCBSLmlkZW50aXR5KTtcbiAgICAgKiAgICAgIC8vIGFkZERvdWJsZUFuZFNxdWFyZVdpdGhFeHRyYVBhcmFtcy5sZW5ndGggLy89PiAzXG4gICAgICogICAgICAvL+KJhSBhZGRBbGwoZG91YmxlKDEwKSwgc3F1YXJlKDUpLCBSLmlkZW50aXR5KDEwMCkpO1xuICAgICAqICAgICAgYWRkRG91YmxlQW5kU3F1YXJlKDEwLCA1LCAxMDApOyAvLz0+IDE0NVxuICAgICAqL1xuICAgIC8qLCB0cmFuc2Zvcm1lcnMgKi9cbiAgICB2YXIgdXNlV2l0aCA9IGN1cnJ5KGZ1bmN0aW9uIHVzZVdpdGgoZm4pIHtcbiAgICAgICAgdmFyIHRyYW5zZm9ybWVycyA9IF9zbGljZShhcmd1bWVudHMsIDEpO1xuICAgICAgICB2YXIgdGxlbiA9IHRyYW5zZm9ybWVycy5sZW5ndGg7XG4gICAgICAgIHJldHVybiBjdXJyeShfYXJpdHkodGxlbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXSwgaWR4ID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChpZHggPCB0bGVuKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tpZHhdID0gdHJhbnNmb3JtZXJzW2lkeF0oYXJndW1lbnRzW2lkeF0pO1xuICAgICAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3MuY29uY2F0KF9zbGljZShhcmd1bWVudHMsIHRsZW4pKSk7XG4gICAgICAgIH0pKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRha2VzIGEgc3BlYyBvYmplY3QgYW5kIGEgdGVzdCBvYmplY3Q7IHJldHVybnMgdHJ1ZSBpZiB0aGUgdGVzdCBzYXRpc2ZpZXNcbiAgICAgKiB0aGUgc3BlYywgZmFsc2Ugb3RoZXJ3aXNlLiBBbiBvYmplY3Qgc2F0aXNmaWVzIHRoZSBzcGVjIGlmLCBmb3IgZWFjaCBvZiB0aGVcbiAgICAgKiBzcGVjJ3Mgb3duIHByb3BlcnRpZXMsIGFjY2Vzc2luZyB0aGF0IHByb3BlcnR5IG9mIHRoZSBvYmplY3QgZ2l2ZXMgdGhlIHNhbWVcbiAgICAgKiB2YWx1ZSAoaW4gYFIuZXF1YWxzYCB0ZXJtcykgYXMgYWNjZXNzaW5nIHRoYXQgcHJvcGVydHkgb2YgdGhlIHNwZWMuXG4gICAgICpcbiAgICAgKiBgd2hlcmVFcWAgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBbYHdoZXJlYF0oI3doZXJlKS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7U3RyaW5nOiAqfSAtPiB7U3RyaW5nOiAqfSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNwZWNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdGVzdE9ialxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQHNlZSBSLndoZXJlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gcHJlZCA6OiBPYmplY3QgLT4gQm9vbGVhblxuICAgICAqICAgICAgdmFyIHByZWQgPSBSLndoZXJlRXEoe2E6IDEsIGI6IDJ9KTtcbiAgICAgKlxuICAgICAqICAgICAgcHJlZCh7YTogMX0pOyAgICAgICAgICAgICAgLy89PiBmYWxzZVxuICAgICAqICAgICAgcHJlZCh7YTogMSwgYjogMn0pOyAgICAgICAgLy89PiB0cnVlXG4gICAgICogICAgICBwcmVkKHthOiAxLCBiOiAyLCBjOiAzfSk7ICAvLz0+IHRydWVcbiAgICAgKiAgICAgIHByZWQoe2E6IDEsIGI6IDF9KTsgICAgICAgIC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgd2hlcmVFcSA9IF9jdXJyeTIoZnVuY3Rpb24gd2hlcmVFcShzcGVjLCB0ZXN0T2JqKSB7XG4gICAgICAgIHJldHVybiB3aGVyZShtYXBPYmooZXF1YWxzLCBzcGVjKSwgdGVzdE9iaik7XG4gICAgfSk7XG5cbiAgICB2YXIgX2ZsYXRDYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwcmVzZXJ2aW5nUmVkdWNlZCA9IGZ1bmN0aW9uICh4Zikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL2luaXQnOiBfeGZCYXNlLmluaXQsXG4gICAgICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9yZXN1bHQnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL3N0ZXAnOiBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0ID0geGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCBpbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXRbJ0BAdHJhbnNkdWNlci9yZWR1Y2VkJ10gPyBfZm9yY2VSZWR1Y2VkKHJldCkgOiByZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF94Y2F0KHhmKSB7XG4gICAgICAgICAgICB2YXIgcnhmID0gcHJlc2VydmluZ1JlZHVjZWQoeGYpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL2luaXQnOiBfeGZCYXNlLmluaXQsXG4gICAgICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9yZXN1bHQnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByeGZbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXShyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9zdGVwJzogZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFpc0FycmF5TGlrZShpbnB1dCkgPyBfcmVkdWNlKHJ4ZiwgcmVzdWx0LCBbaW5wdXRdKSA6IF9yZWR1Y2UocnhmLCByZXN1bHQsIGlucHV0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH0oKTtcblxuICAgIHZhciBfaW5kZXhPZiA9IGZ1bmN0aW9uIF9pbmRleE9mKGxpc3QsIGl0ZW0sIGZyb20pIHtcbiAgICAgICAgdmFyIGlkeCA9IGZyb207XG4gICAgICAgIHdoaWxlIChpZHggPCBsaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGVxdWFscyhsaXN0W2lkeF0sIGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgcHJlZGljYXRlIHdyYXBwZXIgd2hpY2ggd2lsbCBjYWxsIGEgcGljayBmdW5jdGlvbiAoYWxsL2FueSkgZm9yIGVhY2ggcHJlZGljYXRlXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBzZWUgUi5hbGxcbiAgICAgKiBAc2VlIFIuYW55XG4gICAgICovXG4gICAgLy8gQ2FsbCBmdW5jdGlvbiBpbW1lZGlhdGVseSBpZiBnaXZlbiBhcmd1bWVudHNcbiAgICAvLyBSZXR1cm4gYSBmdW5jdGlvbiB3aGljaCB3aWxsIGNhbGwgdGhlIHByZWRpY2F0ZXMgd2l0aCB0aGUgcHJvdmlkZWQgYXJndW1lbnRzXG4gICAgdmFyIF9wcmVkaWNhdGVXcmFwID0gZnVuY3Rpb24gX3ByZWRpY2F0ZVdyYXAocHJlZFBpY2tlcikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHByZWRzKSB7XG4gICAgICAgICAgICB2YXIgcHJlZEl0ZXJhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgICAgIHJldHVybiBwcmVkUGlja2VyKGZ1bmN0aW9uIChwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZWRpY2F0ZS5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9LCBwcmVkcyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gLy8gQ2FsbCBmdW5jdGlvbiBpbW1lZGlhdGVseSBpZiBnaXZlbiBhcmd1bWVudHNcbiAgICAgICAgICAgIHByZWRJdGVyYXRvci5hcHBseShudWxsLCBfc2xpY2UoYXJndW1lbnRzLCAxKSkgOiAvLyBSZXR1cm4gYSBmdW5jdGlvbiB3aGljaCB3aWxsIGNhbGwgdGhlIHByZWRpY2F0ZXMgd2l0aCB0aGUgcHJvdmlkZWQgYXJndW1lbnRzXG4gICAgICAgICAgICBfYXJpdHkoTWF0aC5tYXguYXBwbHkoTWF0aCwgcGx1Y2soJ2xlbmd0aCcsIHByZWRzKSksIHByZWRJdGVyYXRvcik7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBfeGNoYWluID0gX2N1cnJ5MihmdW5jdGlvbiBfeGNoYWluKGYsIHhmKSB7XG4gICAgICAgIHJldHVybiBtYXAoZiwgX2ZsYXRDYXQoeGYpKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEdpdmVuIGEgbGlzdCBvZiBwcmVkaWNhdGVzLCByZXR1cm5zIGEgbmV3IHByZWRpY2F0ZSB0aGF0IHdpbGwgYmUgdHJ1ZSBleGFjdGx5IHdoZW4gYWxsIG9mIHRoZW0gYXJlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgWygqLi4uIC0+IEJvb2xlYW4pXSAtPiAoKi4uLiAtPiBCb29sZWFuKVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgQW4gYXJyYXkgb2YgcHJlZGljYXRlIGZ1bmN0aW9uc1xuICAgICAqIEBwYXJhbSB7Kn0gb3B0aW9uYWwgQW55IGFyZ3VtZW50cyB0byBwYXNzIGludG8gdGhlIHByZWRpY2F0ZXNcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gYSBmdW5jdGlvbiB0aGF0IGFwcGxpZXMgaXRzIGFyZ3VtZW50cyB0byBlYWNoIG9mXG4gICAgICogICAgICAgICB0aGUgcHJlZGljYXRlcywgcmV0dXJuaW5nIGB0cnVlYCBpZiBhbGwgYXJlIHNhdGlzZmllZC5cbiAgICAgKiBAc2VlIFIuYW55UGFzc1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBndDEwID0gZnVuY3Rpb24oeCkgeyByZXR1cm4geCA+IDEwOyB9O1xuICAgICAqICAgICAgdmFyIGV2ZW4gPSBmdW5jdGlvbih4KSB7IHJldHVybiB4ICUgMiA9PT0gMH07XG4gICAgICogICAgICB2YXIgZiA9IFIuYWxsUGFzcyhbZ3QxMCwgZXZlbl0pO1xuICAgICAqICAgICAgZigxMSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIGYoMTIpOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgYWxsUGFzcyA9IF9jdXJyeTEoX3ByZWRpY2F0ZVdyYXAoYWxsKSk7XG5cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIGxpc3Qgb2YgcHJlZGljYXRlcyByZXR1cm5zIGEgbmV3IHByZWRpY2F0ZSB0aGF0IHdpbGwgYmUgdHJ1ZSBleGFjdGx5IHdoZW4gYW55IG9uZSBvZiB0aGVtIGlzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgWygqLi4uIC0+IEJvb2xlYW4pXSAtPiAoKi4uLiAtPiBCb29sZWFuKVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgQW4gYXJyYXkgb2YgcHJlZGljYXRlIGZ1bmN0aW9uc1xuICAgICAqIEBwYXJhbSB7Kn0gb3B0aW9uYWwgQW55IGFyZ3VtZW50cyB0byBwYXNzIGludG8gdGhlIHByZWRpY2F0ZXNcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBmdW5jdGlvbiB0aGF0IGFwcGxpZXMgaXRzIGFyZ3VtZW50cyB0byBlYWNoIG9mIHRoZSBwcmVkaWNhdGVzLCByZXR1cm5pbmdcbiAgICAgKiAgICAgICAgIGB0cnVlYCBpZiBhbGwgYXJlIHNhdGlzZmllZC5cbiAgICAgKiBAc2VlIFIuYWxsUGFzc1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBndDEwID0gZnVuY3Rpb24oeCkgeyByZXR1cm4geCA+IDEwOyB9O1xuICAgICAqICAgICAgdmFyIGV2ZW4gPSBmdW5jdGlvbih4KSB7IHJldHVybiB4ICUgMiA9PT0gMH07XG4gICAgICogICAgICB2YXIgZiA9IFIuYW55UGFzcyhbZ3QxMCwgZXZlbl0pO1xuICAgICAqICAgICAgZigxMSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgZig4KTsgLy89PiB0cnVlXG4gICAgICogICAgICBmKDkpOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGFueVBhc3MgPSBfY3VycnkxKF9wcmVkaWNhdGVXcmFwKGFueSkpO1xuXG4gICAgLyoqXG4gICAgICogYXAgYXBwbGllcyBhIGxpc3Qgb2YgZnVuY3Rpb25zIHRvIGEgbGlzdCBvZiB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyBbZl0gLT4gW2FdIC0+IFtmIGFdXG4gICAgICogQHBhcmFtIHtBcnJheX0gZm5zIEFuIGFycmF5IG9mIGZ1bmN0aW9uc1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZzIEFuIGFycmF5IG9mIHZhbHVlc1xuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiByZXN1bHRzIG9mIGFwcGx5aW5nIGVhY2ggb2YgYGZuc2AgdG8gYWxsIG9mIGB2c2AgaW4gdHVybi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmFwKFtSLm11bHRpcGx5KDIpLCBSLmFkZCgzKV0sIFsxLDIsM10pOyAvLz0+IFsyLCA0LCA2LCA0LCA1LCA2XVxuICAgICAqL1xuICAgIHZhciBhcCA9IF9jdXJyeTIoZnVuY3Rpb24gYXAoZm5zLCB2cykge1xuICAgICAgICByZXR1cm4gX2hhc01ldGhvZCgnYXAnLCBmbnMpID8gZm5zLmFwKHZzKSA6IF9yZWR1Y2UoZnVuY3Rpb24gKGFjYywgZm4pIHtcbiAgICAgICAgICAgIHJldHVybiBfY29uY2F0KGFjYywgbWFwKGZuLCB2cykpO1xuICAgICAgICB9LCBbXSwgZm5zKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGl0cyBmaXJzdCBhcmd1bWVudCB3aXRoIHRoZSByZW1haW5pbmdcbiAgICAgKiBhcmd1bWVudHMuIFRoaXMgaXMgb2NjYXNpb25hbGx5IHVzZWZ1bCBhcyBhIGNvbnZlcmdpbmcgZnVuY3Rpb24gZm9yXG4gICAgICogYFIuY29udmVyZ2VgOiB0aGUgbGVmdCBicmFuY2ggY2FuIHByb2R1Y2UgYSBmdW5jdGlvbiB3aGlsZSB0aGUgcmlnaHRcbiAgICAgKiBicmFuY2ggcHJvZHVjZXMgYSB2YWx1ZSB0byBiZSBwYXNzZWQgdG8gdGhhdCBmdW5jdGlvbiBhcyBhbiBhcmd1bWVudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICgqLi4uIC0+IGEpLCouLi4gLT4gYVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBhcHBseSB0byB0aGUgcmVtYWluaW5nIGFyZ3VtZW50cy5cbiAgICAgKiBAcGFyYW0gey4uLip9IGFyZ3MgQW55IG51bWJlciBvZiBwb3NpdGlvbmFsIGFyZ3VtZW50cy5cbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBzZWUgUi5hcHBseVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpbmRlbnROID0gUi5waXBlKFIudGltZXMoUi5hbHdheXMoJyAnKSksXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICBSLmpvaW4oJycpLFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgUi5yZXBsYWNlKC9eKD8hJCkvZ20pKTtcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGZvcm1hdCA9IFIuY29udmVyZ2UoUi5jYWxsLFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUi5waXBlKFIucHJvcCgnaW5kZW50JyksIGluZGVudE4pLFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUi5wcm9wKCd2YWx1ZScpKTtcbiAgICAgKlxuICAgICAqICAgICAgZm9ybWF0KHtpbmRlbnQ6IDIsIHZhbHVlOiAnZm9vXFxuYmFyXFxuYmF6XFxuJ30pOyAvLz0+ICcgIGZvb1xcbiAgYmFyXFxuICBiYXpcXG4nXG4gICAgICovXG4gICAgdmFyIGNhbGwgPSBjdXJyeShmdW5jdGlvbiBjYWxsKGZuKSB7XG4gICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBfc2xpY2UoYXJndW1lbnRzLCAxKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBgY2hhaW5gIG1hcHMgYSBmdW5jdGlvbiBvdmVyIGEgbGlzdCBhbmQgY29uY2F0ZW5hdGVzIHRoZSByZXN1bHRzLlxuICAgICAqIFRoaXMgaW1wbGVtZW50YXRpb24gaXMgY29tcGF0aWJsZSB3aXRoIHRoZVxuICAgICAqIEZhbnRhc3ktbGFuZCBDaGFpbiBzcGVjLCBhbmQgd2lsbCB3b3JrIHdpdGggdHlwZXMgdGhhdCBpbXBsZW1lbnQgdGhhdCBzcGVjLlxuICAgICAqIGBjaGFpbmAgaXMgYWxzbyBrbm93biBhcyBgZmxhdE1hcGAgaW4gc29tZSBsaWJyYXJpZXNcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gW2JdKSAtPiBbYV0gLT4gW2JdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0XG4gICAgICogQHJldHVybiB7QXJyYXl9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGR1cGxpY2F0ZSA9IGZ1bmN0aW9uKG4pIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIFtuLCBuXTtcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICBSLmNoYWluKGR1cGxpY2F0ZSwgWzEsIDIsIDNdKTsgLy89PiBbMSwgMSwgMiwgMiwgMywgM11cbiAgICAgKi9cbiAgICB2YXIgY2hhaW4gPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ2NoYWluJywgX3hjaGFpbiwgZnVuY3Rpb24gY2hhaW4oZm4sIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIHVubmVzdChtYXAoZm4sIGxpc3QpKTtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBUdXJucyBhIGxpc3Qgb2YgRnVuY3RvcnMgaW50byBhIEZ1bmN0b3Igb2YgYSBsaXN0LCBhcHBseWluZ1xuICAgICAqIGEgbWFwcGluZyBmdW5jdGlvbiB0byB0aGUgZWxlbWVudHMgb2YgdGhlIGxpc3QgYWxvbmcgdGhlIHdheS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzZWUgUi5jb21tdXRlXG4gICAgICogQHNpZyBGdW5jdG9yIGYgPT4gKGYgYSAtPiBmIGIpIC0+ICh4IC0+IGYgeCkgLT4gW2YgYV0gLT4gZiBbYl1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgdHJhbnNmb3JtYXRpb24gZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvZiBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgZGF0YSB0eXBlIHRvIHJldHVyblxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgQW4gYXJyYXkgb2YgZnVuY3RvcnMgb2YgdGhlIHNhbWUgdHlwZVxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5jb21tdXRlTWFwKFIubWFwKFIuYWRkKDEwKSksIFIub2YsIFtbMV0sIFsyLCAzXV0pOyAgIC8vPT4gW1sxMSwgMTJdLCBbMTEsIDEzXV1cbiAgICAgKiAgICAgIFIuY29tbXV0ZU1hcChSLm1hcChSLmFkZCgxMCkpLCBSLm9mLCBbWzEsIDJdLCBbM11dKTsgICAvLz0+IFtbMTEsIDEzXSwgWzEyLCAxM11dXG4gICAgICogICAgICBSLmNvbW11dGVNYXAoUi5tYXAoUi5hZGQoMTApKSwgUi5vZiwgW1sxXSwgWzJdLCBbM11dKTsgLy89PiBbWzExLCAxMiwgMTNdXVxuICAgICAqICAgICAgUi5jb21tdXRlTWFwKFIubWFwKFIuYWRkKDEwKSksIE1heWJlLm9mLCBbSnVzdCgxKSwgSnVzdCgyKSwgSnVzdCgzKV0pOyAgIC8vPT4gSnVzdChbMTEsIDEyLCAxM10pXG4gICAgICogICAgICBSLmNvbW11dGVNYXAoUi5tYXAoUi5hZGQoMTApKSwgTWF5YmUub2YsIFtKdXN0KDEpLCBKdXN0KDIpLCBOb3RoaW5nKCldKTsgLy89PiBOb3RoaW5nKClcbiAgICAgKi9cbiAgICB2YXIgY29tbXV0ZU1hcCA9IF9jdXJyeTMoZnVuY3Rpb24gY29tbXV0ZU1hcChmbiwgb2YsIGxpc3QpIHtcbiAgICAgICAgZnVuY3Rpb24gY29uc0YoYWNjLCBmdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gYXAobWFwKGFwcGVuZCwgZm4oZnRvcikpLCBhY2MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfcmVkdWNlKGNvbnNGLCBvZihbXSksIGxpc3QpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogV3JhcHMgYSBjb25zdHJ1Y3RvciBmdW5jdGlvbiBpbnNpZGUgYSBjdXJyaWVkIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIGNhbGxlZCB3aXRoIHRoZSBzYW1lXG4gICAgICogYXJndW1lbnRzIGFuZCByZXR1cm5zIHRoZSBzYW1lIHR5cGUuIFRoZSBhcml0eSBvZiB0aGUgZnVuY3Rpb24gcmV0dXJuZWQgaXMgc3BlY2lmaWVkXG4gICAgICogdG8gYWxsb3cgdXNpbmcgdmFyaWFkaWMgY29uc3RydWN0b3IgZnVuY3Rpb25zLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgTnVtYmVyIC0+ICgqIC0+IHsqfSkgLT4gKCogLT4geyp9KVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuIFRoZSBhcml0eSBvZiB0aGUgY29uc3RydWN0b3IgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gRm4gVGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIHdyYXAuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgd3JhcHBlZCwgY3VycmllZCBjb25zdHJ1Y3RvciBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICAvLyBWYXJpYWRpYyBjb25zdHJ1Y3RvciBmdW5jdGlvblxuICAgICAqICAgICAgdmFyIFdpZGdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAqICAgICAgICB0aGlzLmNoaWxkcmVuID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgKiAgICAgICAgLy8gLi4uXG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgV2lkZ2V0LnByb3RvdHlwZSA9IHtcbiAgICAgKiAgICAgICAgLy8gLi4uXG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgdmFyIGFsbENvbmZpZ3MgPSBbXG4gICAgICogICAgICAgIC8vIC4uLlxuICAgICAqICAgICAgXTtcbiAgICAgKiAgICAgIFIubWFwKFIuY29uc3RydWN0TigxLCBXaWRnZXQpLCBhbGxDb25maWdzKTsgLy8gYSBsaXN0IG9mIFdpZGdldHNcbiAgICAgKi9cbiAgICB2YXIgY29uc3RydWN0TiA9IF9jdXJyeTIoZnVuY3Rpb24gY29uc3RydWN0TihuLCBGbikge1xuICAgICAgICBpZiAobiA+IDEwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbnN0cnVjdG9yIHdpdGggZ3JlYXRlciB0aGFuIHRlbiBhcmd1bWVudHMnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZuKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdXJyeShuQXJ5KG4sIGZ1bmN0aW9uICgkMCwgJDEsICQyLCAkMywgJDQsICQ1LCAkNiwgJDcsICQ4LCAkOSkge1xuICAgICAgICAgICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbigkMCk7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbigkMCwgJDEpO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMik7XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbigkMCwgJDEsICQyLCAkMyk7XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbigkMCwgJDEsICQyLCAkMywgJDQpO1xuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMiwgJDMsICQ0LCAkNSk7XG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbigkMCwgJDEsICQyLCAkMywgJDQsICQ1LCAkNik7XG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbigkMCwgJDEsICQyLCAkMywgJDQsICQ1LCAkNiwgJDcpO1xuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMiwgJDMsICQ0LCAkNSwgJDYsICQ3LCAkOCk7XG4gICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMiwgJDMsICQ0LCAkNSwgJDYsICQ3LCAkOCwgJDkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBY2NlcHRzIGF0IGxlYXN0IHRocmVlIGZ1bmN0aW9ucyBhbmQgcmV0dXJucyBhIG5ldyBmdW5jdGlvbi4gV2hlbiBpbnZva2VkLCB0aGlzIG5ld1xuICAgICAqIGZ1bmN0aW9uIHdpbGwgaW52b2tlIHRoZSBmaXJzdCBmdW5jdGlvbiwgYGFmdGVyYCwgcGFzc2luZyBhcyBpdHMgYXJndW1lbnRzIHRoZVxuICAgICAqIHJlc3VsdHMgb2YgaW52b2tpbmcgdGhlIHN1YnNlcXVlbnQgZnVuY3Rpb25zIHdpdGggd2hhdGV2ZXIgYXJndW1lbnRzIGFyZSBwYXNzZWQgdG9cbiAgICAgKiB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKHgxIC0+IHgyIC0+IC4uLiAtPiB6KSAtPiAoKGEgLT4gYiAtPiAuLi4gLT4geDEpLCAoYSAtPiBiIC0+IC4uLiAtPiB4MiksIC4uLikgLT4gKGEgLT4gYiAtPiAuLi4gLT4geilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhZnRlciBBIGZ1bmN0aW9uLiBgYWZ0ZXJgIHdpbGwgYmUgaW52b2tlZCB3aXRoIHRoZSByZXR1cm4gdmFsdWVzIG9mXG4gICAgICogICAgICAgIGBmbjFgIGFuZCBgZm4yYCBhcyBpdHMgYXJndW1lbnRzLlxuICAgICAqIEBwYXJhbSB7Li4uRnVuY3Rpb259IGZ1bmN0aW9ucyBBIHZhcmlhYmxlIG51bWJlciBvZiBmdW5jdGlvbnMuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBhZGQgPSBmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhICsgYjsgfTtcbiAgICAgKiAgICAgIHZhciBtdWx0aXBseSA9IGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEgKiBiOyB9O1xuICAgICAqICAgICAgdmFyIHN1YnRyYWN0ID0gZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYSAtIGI7IH07XG4gICAgICpcbiAgICAgKiAgICAgIC8v4omFIG11bHRpcGx5KCBhZGQoMSwgMiksIHN1YnRyYWN0KDEsIDIpICk7XG4gICAgICogICAgICBSLmNvbnZlcmdlKG11bHRpcGx5LCBhZGQsIHN1YnRyYWN0KSgxLCAyKTsgLy89PiAtM1xuICAgICAqXG4gICAgICogICAgICB2YXIgYWRkMyA9IGZ1bmN0aW9uKGEsIGIsIGMpIHsgcmV0dXJuIGEgKyBiICsgYzsgfTtcbiAgICAgKiAgICAgIFIuY29udmVyZ2UoYWRkMywgbXVsdGlwbHksIGFkZCwgc3VidHJhY3QpKDEsIDIpOyAvLz0+IDRcbiAgICAgKi9cbiAgICB2YXIgY29udmVyZ2UgPSBjdXJyeU4oMywgZnVuY3Rpb24gY29udmVyZ2UoYWZ0ZXIpIHtcbiAgICAgICAgdmFyIGZucyA9IF9zbGljZShhcmd1bWVudHMsIDEpO1xuICAgICAgICByZXR1cm4gY3VycnlOKE1hdGgubWF4LmFwcGx5KE1hdGgsIHBsdWNrKCdsZW5ndGgnLCBmbnMpKSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICB2YXIgY29udGV4dCA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gYWZ0ZXIuYXBwbHkoY29udGV4dCwgX21hcChmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgICAgICB9LCBmbnMpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFsbCBidXQgdGhlIGZpcnN0IGBuYCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gbGlzdCwgc3RyaW5nLCBvclxuICAgICAqIHRyYW5zZHVjZXIvdHJhbnNmb3JtZXIgKG9yIG9iamVjdCB3aXRoIGEgYGRyb3BgIG1ldGhvZCkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICogQHNpZyBOdW1iZXIgLT4gW2FdIC0+IFthXVxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEBwYXJhbSB7Kn0gbGlzdFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLnRha2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmRyb3AoMSwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2JhcicsICdiYXonXVxuICAgICAqICAgICAgUi5kcm9wKDIsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydiYXonXVxuICAgICAqICAgICAgUi5kcm9wKDMsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gW11cbiAgICAgKiAgICAgIFIuZHJvcCg0LCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFtdXG4gICAgICogICAgICBSLmRyb3AoMywgJ3JhbWRhJyk7ICAgICAgICAgICAgICAgLy89PiAnZGEnXG4gICAgICovXG4gICAgdmFyIGRyb3AgPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ2Ryb3AnLCBfeGRyb3AsIGZ1bmN0aW9uIGRyb3AobiwgeHMpIHtcbiAgICAgICAgcmV0dXJuIHNsaWNlKE1hdGgubWF4KDAsIG4pLCBJbmZpbml0eSwgeHMpO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsaXN0IGNvbnRhaW5pbmcgYWxsIGJ1dCB0aGUgbGFzdCBgbmAgZWxlbWVudHMgb2YgdGhlIGdpdmVuIGBsaXN0YC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAc2lnIE51bWJlciAtPiBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG4gVGhlIG51bWJlciBvZiBlbGVtZW50cyBvZiBgeHNgIHRvIHNraXAuXG4gICAgICogQHBhcmFtIHtBcnJheX0geHMgVGhlIGNvbGxlY3Rpb24gdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9XG4gICAgICogQHNlZSBSLnRha2VMYXN0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5kcm9wTGFzdCgxLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnZm9vJywgJ2JhciddXG4gICAgICogICAgICBSLmRyb3BMYXN0KDIsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydmb28nXVxuICAgICAqICAgICAgUi5kcm9wTGFzdCgzLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFtdXG4gICAgICogICAgICBSLmRyb3BMYXN0KDQsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gW11cbiAgICAgKiAgICAgIFIuZHJvcExhc3QoMywgJ3JhbWRhJyk7ICAgICAgICAgICAgICAgLy89PiAncmEnXG4gICAgICovXG4gICAgdmFyIGRyb3BMYXN0ID0gX2N1cnJ5MihmdW5jdGlvbiBkcm9wTGFzdChuLCB4cykge1xuICAgICAgICByZXR1cm4gdGFrZShuIDwgeHMubGVuZ3RoID8geHMubGVuZ3RoIC0gbiA6IDAsIHhzKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCB3aXRob3V0IGFueSBjb25zZWN1dGl2ZWx5IHJlcGVhdGluZyBlbGVtZW50cy4gRXF1YWxpdHkgaXNcbiAgICAgKiBkZXRlcm1pbmVkIGJ5IGFwcGx5aW5nIHRoZSBzdXBwbGllZCBwcmVkaWNhdGUgdHdvIGNvbnNlY3V0aXZlIGVsZW1lbnRzLlxuICAgICAqIFRoZSBmaXJzdCBlbGVtZW50IGluIGEgc2VyaWVzIG9mIGVxdWFsIGVsZW1lbnQgaXMgdGhlIG9uZSBiZWluZyBwcmVzZXJ2ZWQuXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSwgYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSB1c2VkIHRvIHRlc3Qgd2hldGhlciB0d28gaXRlbXMgYXJlIGVxdWFsLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBgbGlzdGAgd2l0aG91dCByZXBlYXRpbmcgZWxlbWVudHMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgZnVuY3Rpb24gbGVuZ3RoRXEoeCwgeSkgeyByZXR1cm4gTWF0aC5hYnMoeCkgPT09IE1hdGguYWJzKHkpOyB9O1xuICAgICAqICAgICAgdmFyIGwgPSBbMSwgLTEsIDEsIDMsIDQsIC00LCAtNCwgLTUsIDUsIDMsIDNdO1xuICAgICAqICAgICAgUi5kcm9wUmVwZWF0c1dpdGgobGVuZ3RoRXEsIGwpOyAvLz0+IFsxLCAzLCA0LCAtNSwgM11cbiAgICAgKi9cbiAgICB2YXIgZHJvcFJlcGVhdHNXaXRoID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdkcm9wUmVwZWF0c1dpdGgnLCBfeGRyb3BSZXBlYXRzV2l0aCwgZnVuY3Rpb24gZHJvcFJlcGVhdHNXaXRoKHByZWQsIGxpc3QpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgaWR4ID0gMTtcbiAgICAgICAgdmFyIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICBpZiAobGVuICE9PSAwKSB7XG4gICAgICAgICAgICByZXN1bHRbMF0gPSBsaXN0WzBdO1xuICAgICAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgICAgIGlmICghcHJlZChsYXN0KHJlc3VsdCksIGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gbGlzdFtpZHhdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJlcG9ydHMgd2hldGhlciB0d28gb2JqZWN0cyBoYXZlIHRoZSBzYW1lIHZhbHVlLCBpbiBgUi5lcXVhbHNgIHRlcm1zLFxuICAgICAqIGZvciB0aGUgc3BlY2lmaWVkIHByb3BlcnR5LiBVc2VmdWwgYXMgYSBjdXJyaWVkIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBrIC0+IHtrOiB2fSAtPiB7azogdn0gLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byBjb21wYXJlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iajFcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqMlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbzEgPSB7IGE6IDEsIGI6IDIsIGM6IDMsIGQ6IDQgfTtcbiAgICAgKiAgICAgIHZhciBvMiA9IHsgYTogMTAsIGI6IDIwLCBjOiAzLCBkOiA0MCB9O1xuICAgICAqICAgICAgUi5lcVByb3BzKCdhJywgbzEsIG8yKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5lcVByb3BzKCdjJywgbzEsIG8yKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGVxUHJvcHMgPSBfY3VycnkzKGZ1bmN0aW9uIGVxUHJvcHMocHJvcCwgb2JqMSwgb2JqMikge1xuICAgICAgICByZXR1cm4gZXF1YWxzKG9iajFbcHJvcF0sIG9iajJbcHJvcF0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcG9zaXRpb24gb2YgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYW4gaXRlbSBpbiBhbiBhcnJheSxcbiAgICAgKiBvciAtMSBpZiB0aGUgaXRlbSBpcyBub3QgaW5jbHVkZWQgaW4gdGhlIGFycmF5LiBgUi5lcXVhbHNgIGlzIHVzZWQgdG9cbiAgICAgKiBkZXRlcm1pbmUgZXF1YWxpdHkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGEgLT4gW2FdIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IFRoZSBpdGVtIHRvIGZpbmQuXG4gICAgICogQHBhcmFtIHtBcnJheX0geHMgVGhlIGFycmF5IHRvIHNlYXJjaCBpbi5cbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IHRoZSBpbmRleCBvZiB0aGUgdGFyZ2V0LCBvciAtMSBpZiB0aGUgdGFyZ2V0IGlzIG5vdCBmb3VuZC5cbiAgICAgKiBAc2VlIFIubGFzdEluZGV4T2ZcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmluZGV4T2YoMywgWzEsMiwzLDRdKTsgLy89PiAyXG4gICAgICogICAgICBSLmluZGV4T2YoMTAsIFsxLDIsMyw0XSk7IC8vPT4gLTFcbiAgICAgKi9cbiAgICB2YXIgaW5kZXhPZiA9IF9jdXJyeTIoZnVuY3Rpb24gaW5kZXhPZih0YXJnZXQsIHhzKSB7XG4gICAgICAgIHJldHVybiBfaGFzTWV0aG9kKCdpbmRleE9mJywgeHMpID8geHMuaW5kZXhPZih0YXJnZXQpIDogX2luZGV4T2YoeHMsIHRhcmdldCwgMCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgZ2l2ZW4gbGlzdCBvciBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2VlIFIubGFzdCwgUi5oZWFkLCBSLnRhaWxcbiAgICAgKiBAc2lnIFthXSAtPiBbYV1cbiAgICAgKiBAc2lnIFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuaW5pdChbMSwgMiwgM10pOyAgLy89PiBbMSwgMl1cbiAgICAgKiAgICAgIFIuaW5pdChbMSwgMl0pOyAgICAgLy89PiBbMV1cbiAgICAgKiAgICAgIFIuaW5pdChbMV0pOyAgICAgICAgLy89PiBbXVxuICAgICAqICAgICAgUi5pbml0KFtdKTsgICAgICAgICAvLz0+IFtdXG4gICAgICpcbiAgICAgKiAgICAgIFIuaW5pdCgnYWJjJyk7ICAvLz0+ICdhYidcbiAgICAgKiAgICAgIFIuaW5pdCgnYWInKTsgICAvLz0+ICdhJ1xuICAgICAqICAgICAgUi5pbml0KCdhJyk7ICAgIC8vPT4gJydcbiAgICAgKiAgICAgIFIuaW5pdCgnJyk7ICAgICAvLz0+ICcnXG4gICAgICovXG4gICAgdmFyIGluaXQgPSBzbGljZSgwLCAtMSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiBhbGwgZWxlbWVudHMgYXJlIHVuaXF1ZSwgaW4gYFIuZXF1YWxzYCB0ZXJtcyxcbiAgICAgKiBvdGhlcndpc2UgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW2FdIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgYWxsIGVsZW1lbnRzIGFyZSB1bmlxdWUsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmlzU2V0KFsnMScsIDFdKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzU2V0KFsxLCAxXSk7ICAgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pc1NldChbWzQyXSwgWzQyXV0pOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGlzU2V0ID0gX2N1cnJ5MShmdW5jdGlvbiBpc1NldChsaXN0KSB7XG4gICAgICAgIHZhciBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChfaW5kZXhPZihsaXN0LCBsaXN0W2lkeF0sIGlkeCArIDEpID49IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsZW5zIGZvciB0aGUgZ2l2ZW4gZ2V0dGVyIGFuZCBzZXR0ZXIgZnVuY3Rpb25zLiBUaGUgZ2V0dGVyIFwiZ2V0c1wiXG4gICAgICogdGhlIHZhbHVlIG9mIHRoZSBmb2N1czsgdGhlIHNldHRlciBcInNldHNcIiB0aGUgdmFsdWUgb2YgdGhlIGZvY3VzLiBUaGUgc2V0dGVyXG4gICAgICogc2hvdWxkIG5vdCBtdXRhdGUgdGhlIGRhdGEgc3RydWN0dXJlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAdHlwZWRlZiBMZW5zIHMgYSA9IEZ1bmN0b3IgZiA9PiAoYSAtPiBmIGEpIC0+IHMgLT4gZiBzXG4gICAgICogQHNpZyAocyAtPiBhKSAtPiAoKGEsIHMpIC0+IHMpIC0+IExlbnMgcyBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZ2V0dGVyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gc2V0dGVyXG4gICAgICogQHJldHVybiB7TGVuc31cbiAgICAgKiBAc2VlIFIudmlldywgUi5zZXQsIFIub3ZlciwgUi5sZW5zSW5kZXgsIFIubGVuc1Byb3BcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgeExlbnMgPSBSLmxlbnMoUi5wcm9wKCd4JyksIFIuYXNzb2MoJ3gnKSk7XG4gICAgICpcbiAgICAgKiAgICAgIFIudmlldyh4TGVucywge3g6IDEsIHk6IDJ9KTsgICAgICAgICAgICAvLz0+IDFcbiAgICAgKiAgICAgIFIuc2V0KHhMZW5zLCA0LCB7eDogMSwgeTogMn0pOyAgICAgICAgICAvLz0+IHt4OiA0LCB5OiAyfVxuICAgICAqICAgICAgUi5vdmVyKHhMZW5zLCBSLm5lZ2F0ZSwge3g6IDEsIHk6IDJ9KTsgIC8vPT4ge3g6IC0xLCB5OiAyfVxuICAgICAqL1xuICAgIHZhciBsZW5zID0gX2N1cnJ5MihmdW5jdGlvbiBsZW5zKGdldHRlciwgc2V0dGVyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZikge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcChmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0dGVyKHYsIHMpO1xuICAgICAgICAgICAgICAgIH0sIGYoZ2V0dGVyKHMpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxlbnMgd2hvc2UgZm9jdXMgaXMgdGhlIHNwZWNpZmllZCBpbmRleC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHR5cGVkZWYgTGVucyBzIGEgPSBGdW5jdG9yIGYgPT4gKGEgLT4gZiBhKSAtPiBzIC0+IGYgc1xuICAgICAqIEBzaWcgTnVtYmVyIC0+IExlbnMgcyBhXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG5cbiAgICAgKiBAcmV0dXJuIHtMZW5zfVxuICAgICAqIEBzZWUgUi52aWV3LCBSLnNldCwgUi5vdmVyXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGhlYWRMZW5zID0gUi5sZW5zSW5kZXgoMCk7XG4gICAgICpcbiAgICAgKiAgICAgIFIudmlldyhoZWFkTGVucywgWydhJywgJ2InLCAnYyddKTsgICAgICAgICAgICAvLz0+ICdhJ1xuICAgICAqICAgICAgUi5zZXQoaGVhZExlbnMsICd4JywgWydhJywgJ2InLCAnYyddKTsgICAgICAgIC8vPT4gWyd4JywgJ2InLCAnYyddXG4gICAgICogICAgICBSLm92ZXIoaGVhZExlbnMsIFIudG9VcHBlciwgWydhJywgJ2InLCAnYyddKTsgLy89PiBbJ0EnLCAnYicsICdjJ11cbiAgICAgKi9cbiAgICB2YXIgbGVuc0luZGV4ID0gX2N1cnJ5MShmdW5jdGlvbiBsZW5zSW5kZXgobikge1xuICAgICAgICByZXR1cm4gbGVucyhudGgobiksIHVwZGF0ZShuKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGVucyB3aG9zZSBmb2N1cyBpcyB0aGUgc3BlY2lmaWVkIHByb3BlcnR5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAdHlwZWRlZiBMZW5zIHMgYSA9IEZ1bmN0b3IgZiA9PiAoYSAtPiBmIGEpIC0+IHMgLT4gZiBzXG4gICAgICogQHNpZyBTdHJpbmcgLT4gTGVucyBzIGFcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga1xuICAgICAqIEByZXR1cm4ge0xlbnN9XG4gICAgICogQHNlZSBSLnZpZXcsIFIuc2V0LCBSLm92ZXJcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgeExlbnMgPSBSLmxlbnNQcm9wKCd4Jyk7XG4gICAgICpcbiAgICAgKiAgICAgIFIudmlldyh4TGVucywge3g6IDEsIHk6IDJ9KTsgICAgICAgICAgICAvLz0+IDFcbiAgICAgKiAgICAgIFIuc2V0KHhMZW5zLCA0LCB7eDogMSwgeTogMn0pOyAgICAgICAgICAvLz0+IHt4OiA0LCB5OiAyfVxuICAgICAqICAgICAgUi5vdmVyKHhMZW5zLCBSLm5lZ2F0ZSwge3g6IDEsIHk6IDJ9KTsgIC8vPT4ge3g6IC0xLCB5OiAyfVxuICAgICAqL1xuICAgIHZhciBsZW5zUHJvcCA9IF9jdXJyeTEoZnVuY3Rpb24gbGVuc1Byb3Aoaykge1xuICAgICAgICByZXR1cm4gbGVucyhwcm9wKGspLCBhc3NvYyhrKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBcImxpZnRzXCIgYSBmdW5jdGlvbiB0byBiZSB0aGUgc3BlY2lmaWVkIGFyaXR5LCBzbyB0aGF0IGl0IG1heSBcIm1hcCBvdmVyXCIgdGhhdCBtYW55XG4gICAgICogbGlzdHMgKG9yIG90aGVyIEZ1bmN0b3JzKS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAc2VlIFIubGlmdFxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgTnVtYmVyIC0+ICgqLi4uIC0+ICopIC0+IChbKl0uLi4gLT4gWypdKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBsaWZ0IGludG8gaGlnaGVyIGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gVGhlIGZ1bmN0aW9uIGBmbmAgYXBwbGljYWJsZSB0byBtYXBwYWJsZSBvYmplY3RzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBtYWRkMyA9IFIubGlmdE4oMywgUi5jdXJyeU4oMywgZnVuY3Rpb24oKSB7XG4gICAgICogICAgICAgIHJldHVybiBSLnJlZHVjZShSLmFkZCwgMCwgYXJndW1lbnRzKTtcbiAgICAgKiAgICAgIH0pKTtcbiAgICAgKiAgICAgIG1hZGQzKFsxLDIsM10sIFsxLDIsM10sIFsxXSk7IC8vPT4gWzMsIDQsIDUsIDQsIDUsIDYsIDUsIDYsIDddXG4gICAgICovXG4gICAgdmFyIGxpZnROID0gX2N1cnJ5MihmdW5jdGlvbiBsaWZ0Tihhcml0eSwgZm4pIHtcbiAgICAgICAgdmFyIGxpZnRlZCA9IGN1cnJ5Tihhcml0eSwgZm4pO1xuICAgICAgICByZXR1cm4gY3VycnlOKGFyaXR5LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX3JlZHVjZShhcCwgbWFwKGxpZnRlZCwgYXJndW1lbnRzWzBdKSwgX3NsaWNlKGFyZ3VtZW50cywgMSkpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG1lYW4gb2YgdGhlIGdpdmVuIGxpc3Qgb2YgbnVtYmVycy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgW051bWJlcl0gLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdFxuICAgICAqIEByZXR1cm4ge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm1lYW4oWzIsIDcsIDldKTsgLy89PiA2XG4gICAgICogICAgICBSLm1lYW4oW10pOyAvLz0+IE5hTlxuICAgICAqL1xuICAgIHZhciBtZWFuID0gX2N1cnJ5MShmdW5jdGlvbiBtZWFuKGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIHN1bShsaXN0KSAvIGxpc3QubGVuZ3RoO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbWVkaWFuIG9mIHRoZSBnaXZlbiBsaXN0IG9mIG51bWJlcnMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIFtOdW1iZXJdIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tZWRpYW4oWzIsIDksIDddKTsgLy89PiA3XG4gICAgICogICAgICBSLm1lZGlhbihbNywgMiwgMTAsIDldKTsgLy89PiA4XG4gICAgICogICAgICBSLm1lZGlhbihbXSk7IC8vPT4gTmFOXG4gICAgICovXG4gICAgdmFyIG1lZGlhbiA9IF9jdXJyeTEoZnVuY3Rpb24gbWVkaWFuKGxpc3QpIHtcbiAgICAgICAgdmFyIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gTmFOO1xuICAgICAgICB9XG4gICAgICAgIHZhciB3aWR0aCA9IDIgLSBsZW4gJSAyO1xuICAgICAgICB2YXIgaWR4ID0gKGxlbiAtIHdpZHRoKSAvIDI7XG4gICAgICAgIHJldHVybiBtZWFuKF9zbGljZShsaXN0KS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gYSA8IGIgPyAtMSA6IGEgPiBiID8gMSA6IDA7XG4gICAgICAgIH0pLnNsaWNlKGlkeCwgaWR4ICsgd2lkdGgpKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIE1lcmdlcyBhIGxpc3Qgb2Ygb2JqZWN0cyB0b2dldGhlciBpbnRvIG9uZSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFt7azogdn1dIC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgQW4gYXJyYXkgb2Ygb2JqZWN0c1xuICAgICAqIEByZXR1cm4ge09iamVjdH0gQSBtZXJnZWQgb2JqZWN0LlxuICAgICAqIEBzZWUgUi5yZWR1Y2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm1lcmdlQWxsKFt7Zm9vOjF9LHtiYXI6Mn0se2JhejozfV0pOyAvLz0+IHtmb286MSxiYXI6MixiYXo6M31cbiAgICAgKiAgICAgIFIubWVyZ2VBbGwoW3tmb286MX0se2ZvbzoyfSx7YmFyOjJ9XSk7IC8vPT4ge2ZvbzoyLGJhcjoyfVxuICAgICAqL1xuICAgIHZhciBtZXJnZUFsbCA9IF9jdXJyeTEoZnVuY3Rpb24gbWVyZ2VBbGwobGlzdCkge1xuICAgICAgICByZXR1cm4gcmVkdWNlKG1lcmdlLCB7fSwgbGlzdCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBsZWZ0LXRvLXJpZ2h0IGZ1bmN0aW9uIGNvbXBvc2l0aW9uLiBUaGUgbGVmdG1vc3QgZnVuY3Rpb24gbWF5IGhhdmVcbiAgICAgKiBhbnkgYXJpdHk7IHRoZSByZW1haW5pbmcgZnVuY3Rpb25zIG11c3QgYmUgdW5hcnkuXG4gICAgICpcbiAgICAgKiBJbiBzb21lIGxpYnJhcmllcyB0aGlzIGZ1bmN0aW9uIGlzIG5hbWVkIGBzZXF1ZW5jZWAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKChhLCBiLCAuLi4sIG4pIC0+IG8pLCAobyAtPiBwKSwgLi4uLCAoeCAtPiB5KSwgKHkgLT4geikpIC0+IChhIC0+IGIgLT4gLi4uIC0+IG4gLT4geilcbiAgICAgKiBAcGFyYW0gey4uLkZ1bmN0aW9ufSBmdW5jdGlvbnNcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgKiBAc2VlIFIuY29tcG9zZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBmID0gUi5waXBlKE1hdGgucG93LCBSLm5lZ2F0ZSwgUi5pbmMpO1xuICAgICAqXG4gICAgICogICAgICBmKDMsIDQpOyAvLyAtKDNeNCkgKyAxXG4gICAgICovXG4gICAgdmFyIHBpcGUgPSBmdW5jdGlvbiBwaXBlKCkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdwaXBlIHJlcXVpcmVzIGF0IGxlYXN0IG9uZSBhcmd1bWVudCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdXJyeU4oYXJndW1lbnRzWzBdLmxlbmd0aCwgcmVkdWNlKF9waXBlLCBhcmd1bWVudHNbMF0sIHRhaWwoYXJndW1lbnRzKSkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBsZWZ0LXRvLXJpZ2h0IGNvbXBvc2l0aW9uIG9mIG9uZSBvciBtb3JlIFByb21pc2UtcmV0dXJuaW5nXG4gICAgICogZnVuY3Rpb25zLiBUaGUgbGVmdG1vc3QgZnVuY3Rpb24gbWF5IGhhdmUgYW55IGFyaXR5OyB0aGUgcmVtYWluaW5nXG4gICAgICogZnVuY3Rpb25zIG11c3QgYmUgdW5hcnkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKGEgLT4gUHJvbWlzZSBiKSwgKGIgLT4gUHJvbWlzZSBjKSwgLi4uLCAoeSAtPiBQcm9taXNlIHopKSAtPiAoYSAtPiBQcm9taXNlIHopXG4gICAgICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gZnVuY3Rpb25zXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQHNlZSBSLmNvbXBvc2VQXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gIGZvbGxvd2Vyc0ZvclVzZXIgOjogU3RyaW5nIC0+IFByb21pc2UgW1VzZXJdXG4gICAgICogICAgICB2YXIgZm9sbG93ZXJzRm9yVXNlciA9IFIucGlwZVAoZGIuZ2V0VXNlckJ5SWQsIGRiLmdldEZvbGxvd2Vycyk7XG4gICAgICovXG4gICAgdmFyIHBpcGVQID0gZnVuY3Rpb24gcGlwZVAoKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BpcGVQIHJlcXVpcmVzIGF0IGxlYXN0IG9uZSBhcmd1bWVudCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdXJyeU4oYXJndW1lbnRzWzBdLmxlbmd0aCwgcmVkdWNlKF9waXBlUCwgYXJndW1lbnRzWzBdLCB0YWlsKGFyZ3VtZW50cykpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogTXVsdGlwbGllcyB0b2dldGhlciBhbGwgdGhlIGVsZW1lbnRzIG9mIGEgbGlzdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgW051bWJlcl0gLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBBbiBhcnJheSBvZiBudW1iZXJzXG4gICAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgcHJvZHVjdCBvZiBhbGwgdGhlIG51bWJlcnMgaW4gdGhlIGxpc3QuXG4gICAgICogQHNlZSBSLnJlZHVjZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucHJvZHVjdChbMiw0LDYsOCwxMDAsMV0pOyAvLz0+IDM4NDAwXG4gICAgICovXG4gICAgdmFyIHByb2R1Y3QgPSByZWR1Y2UobXVsdGlwbHksIDEpO1xuXG4gICAgLyoqXG4gICAgICogUmVhc29uYWJsZSBhbmFsb2cgdG8gU1FMIGBzZWxlY3RgIHN0YXRlbWVudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBba10gLT4gW3trOiB2fV0gLT4gW3trOiB2fV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwcm9wcyBUaGUgcHJvcGVydHkgbmFtZXMgdG8gcHJvamVjdFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IG9ianMgVGhlIG9iamVjdHMgdG8gcXVlcnlcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoIGp1c3QgdGhlIGBwcm9wc2AgcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYWJieSA9IHtuYW1lOiAnQWJieScsIGFnZTogNywgaGFpcjogJ2Jsb25kJywgZ3JhZGU6IDJ9O1xuICAgICAqICAgICAgdmFyIGZyZWQgPSB7bmFtZTogJ0ZyZWQnLCBhZ2U6IDEyLCBoYWlyOiAnYnJvd24nLCBncmFkZTogN307XG4gICAgICogICAgICB2YXIga2lkcyA9IFthYmJ5LCBmcmVkXTtcbiAgICAgKiAgICAgIFIucHJvamVjdChbJ25hbWUnLCAnZ3JhZGUnXSwga2lkcyk7IC8vPT4gW3tuYW1lOiAnQWJieScsIGdyYWRlOiAyfSwge25hbWU6ICdGcmVkJywgZ3JhZGU6IDd9XVxuICAgICAqL1xuICAgIC8vIHBhc3NpbmcgYGlkZW50aXR5YCBnaXZlcyBjb3JyZWN0IGFyaXR5XG4gICAgdmFyIHByb2plY3QgPSB1c2VXaXRoKF9tYXAsIHBpY2tBbGwsIGlkZW50aXR5KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBsYXN0IGBuYCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gbGlzdC5cbiAgICAgKiBJZiBgbiA+IGxpc3QubGVuZ3RoYCwgcmV0dXJucyBhIGxpc3Qgb2YgYGxpc3QubGVuZ3RoYCBlbGVtZW50cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAc2lnIE51bWJlciAtPiBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG4gVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byByZXR1cm4uXG4gICAgICogQHBhcmFtIHtBcnJheX0geHMgVGhlIGNvbGxlY3Rpb24gdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9XG4gICAgICogQHNlZSBSLmRyb3BMYXN0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50YWtlTGFzdCgxLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnYmF6J11cbiAgICAgKiAgICAgIFIudGFrZUxhc3QoMiwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2ZvcicsICdiYXonXVxuICAgICAqICAgICAgUi50YWtlTGFzdCgzLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnZm9vJywgJ2JhcicsICdiYXonXVxuICAgICAqICAgICAgUi50YWtlTGFzdCg0LCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnZm9vJywgJ2JhcicsICdiYXonXVxuICAgICAqICAgICAgUi50YWtlTGFzdCgzLCAncmFtZGEnKTsgICAgICAgICAgICAgICAvLz0+ICdtZGEnXG4gICAgICovXG4gICAgdmFyIHRha2VMYXN0ID0gX2N1cnJ5MihmdW5jdGlvbiB0YWtlTGFzdChuLCB4cykge1xuICAgICAgICByZXR1cm4gZHJvcChuID49IDAgPyB4cy5sZW5ndGggLSBuIDogMCwgeHMpO1xuICAgIH0pO1xuXG4gICAgdmFyIF9jb250YWlucyA9IGZ1bmN0aW9uIF9jb250YWlucyhhLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBfaW5kZXhPZihsaXN0LCBhLCAwKSA+PSAwO1xuICAgIH07XG5cbiAgICAvLyAgbWFwUGFpcnMgOjogKE9iamVjdCwgW1N0cmluZ10pIC0+IFtTdHJpbmddXG4gICAgLy8gRnVuY3Rpb24sIFJlZ0V4cCwgdXNlci1kZWZpbmVkIHR5cGVzXG4gICAgdmFyIF90b1N0cmluZyA9IGZ1bmN0aW9uIF90b1N0cmluZyh4LCBzZWVuKSB7XG4gICAgICAgIHZhciByZWN1ciA9IGZ1bmN0aW9uIHJlY3VyKHkpIHtcbiAgICAgICAgICAgIHZhciB4cyA9IHNlZW4uY29uY2F0KFt4XSk7XG4gICAgICAgICAgICByZXR1cm4gX2NvbnRhaW5zKHksIHhzKSA/ICc8Q2lyY3VsYXI+JyA6IF90b1N0cmluZyh5LCB4cyk7XG4gICAgICAgIH07XG4gICAgICAgIC8vICBtYXBQYWlycyA6OiAoT2JqZWN0LCBbU3RyaW5nXSkgLT4gW1N0cmluZ11cbiAgICAgICAgdmFyIG1hcFBhaXJzID0gZnVuY3Rpb24gKG9iaiwga2V5cykge1xuICAgICAgICAgICAgcmV0dXJuIF9tYXAoZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3F1b3RlKGspICsgJzogJyArIHJlY3VyKG9ialtrXSk7XG4gICAgICAgICAgICB9LCBrZXlzLnNsaWNlKCkuc29ydCgpKTtcbiAgICAgICAgfTtcbiAgICAgICAgc3dpdGNoIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeCkpIHtcbiAgICAgICAgY2FzZSAnW29iamVjdCBBcmd1bWVudHNdJzpcbiAgICAgICAgICAgIHJldHVybiAnKGZ1bmN0aW9uKCkgeyByZXR1cm4gYXJndW1lbnRzOyB9KCcgKyBfbWFwKHJlY3VyLCB4KS5qb2luKCcsICcpICsgJykpJztcbiAgICAgICAgY2FzZSAnW29iamVjdCBBcnJheV0nOlxuICAgICAgICAgICAgcmV0dXJuICdbJyArIF9tYXAocmVjdXIsIHgpLmNvbmNhdChtYXBQYWlycyh4LCByZWplY3QodGVzdCgvXlxcZCskLyksIGtleXMoeCkpKSkuam9pbignLCAnKSArICddJztcbiAgICAgICAgY2FzZSAnW29iamVjdCBCb29sZWFuXSc6XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdvYmplY3QnID8gJ25ldyBCb29sZWFuKCcgKyByZWN1cih4LnZhbHVlT2YoKSkgKyAnKScgOiB4LnRvU3RyaW5nKCk7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgRGF0ZV0nOlxuICAgICAgICAgICAgcmV0dXJuICduZXcgRGF0ZSgnICsgX3F1b3RlKF90b0lTT1N0cmluZyh4KSkgKyAnKSc7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgTnVsbF0nOlxuICAgICAgICAgICAgcmV0dXJuICdudWxsJztcbiAgICAgICAgY2FzZSAnW29iamVjdCBOdW1iZXJdJzpcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgeCA9PT0gJ29iamVjdCcgPyAnbmV3IE51bWJlcignICsgcmVjdXIoeC52YWx1ZU9mKCkpICsgJyknIDogMSAvIHggPT09IC1JbmZpbml0eSA/ICctMCcgOiB4LnRvU3RyaW5nKDEwKTtcbiAgICAgICAgY2FzZSAnW29iamVjdCBTdHJpbmddJzpcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgeCA9PT0gJ29iamVjdCcgPyAnbmV3IFN0cmluZygnICsgcmVjdXIoeC52YWx1ZU9mKCkpICsgJyknIDogX3F1b3RlKHgpO1xuICAgICAgICBjYXNlICdbb2JqZWN0IFVuZGVmaW5lZF0nOlxuICAgICAgICAgICAgcmV0dXJuICd1bmRlZmluZWQnO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB4LmNvbnN0cnVjdG9yID09PSAnZnVuY3Rpb24nICYmIHguY29uc3RydWN0b3IubmFtZSAhPT0gJ09iamVjdCcgJiYgdHlwZW9mIHgudG9TdHJpbmcgPT09ICdmdW5jdGlvbicgJiYgeC50b1N0cmluZygpICE9PSAnW29iamVjdCBPYmplY3RdJyA/IHgudG9TdHJpbmcoKSA6IC8vIEZ1bmN0aW9uLCBSZWdFeHAsIHVzZXItZGVmaW5lZCB0eXBlc1xuICAgICAgICAgICAgJ3snICsgbWFwUGFpcnMoeCwga2V5cyh4KSkuam9pbignLCAnKSArICd9JztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUdXJucyBhIGxpc3Qgb2YgRnVuY3RvcnMgaW50byBhIEZ1bmN0b3Igb2YgYSBsaXN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNlZSBSLmNvbW11dGVNYXBcbiAgICAgKiBAc2lnIEZ1bmN0b3IgZiA9PiAoeCAtPiBmIHgpIC0+IFtmIGFdIC0+IGYgW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb2YgQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGRhdGEgdHlwZSB0byByZXR1cm5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IEFuIGFycmF5IG9mIGZ1bmN0b3JzIG9mIHRoZSBzYW1lIHR5cGVcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuY29tbXV0ZShSLm9mLCBbWzFdLCBbMiwgM11dKTsgICAvLz0+IFtbMSwgMl0sIFsxLCAzXV1cbiAgICAgKiAgICAgIFIuY29tbXV0ZShSLm9mLCBbWzEsIDJdLCBbM11dKTsgICAvLz0+IFtbMSwgM10sIFsyLCAzXV1cbiAgICAgKiAgICAgIFIuY29tbXV0ZShSLm9mLCBbWzFdLCBbMl0sIFszXV0pOyAvLz0+IFtbMSwgMiwgM11dXG4gICAgICogICAgICBSLmNvbW11dGUoTWF5YmUub2YsIFtKdXN0KDEpLCBKdXN0KDIpLCBKdXN0KDMpXSk7ICAgLy89PiBKdXN0KFsxLCAyLCAzXSlcbiAgICAgKiAgICAgIFIuY29tbXV0ZShNYXliZS5vZiwgW0p1c3QoMSksIEp1c3QoMiksIE5vdGhpbmcoKV0pOyAvLz0+IE5vdGhpbmcoKVxuICAgICAqL1xuICAgIHZhciBjb21tdXRlID0gY29tbXV0ZU1hcChpZGVudGl0eSk7XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyByaWdodC10by1sZWZ0IGZ1bmN0aW9uIGNvbXBvc2l0aW9uLiBUaGUgcmlnaHRtb3N0IGZ1bmN0aW9uIG1heSBoYXZlXG4gICAgICogYW55IGFyaXR5OyB0aGUgcmVtYWluaW5nIGZ1bmN0aW9ucyBtdXN0IGJlIHVuYXJ5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKCh5IC0+IHopLCAoeCAtPiB5KSwgLi4uLCAobyAtPiBwKSwgKChhLCBiLCAuLi4sIG4pIC0+IG8pKSAtPiAoYSAtPiBiIC0+IC4uLiAtPiBuIC0+IHopXG4gICAgICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gZnVuY3Rpb25zXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQHNlZSBSLnBpcGVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZiA9IFIuY29tcG9zZShSLmluYywgUi5uZWdhdGUsIE1hdGgucG93KTtcbiAgICAgKlxuICAgICAqICAgICAgZigzLCA0KTsgLy8gLSgzXjQpICsgMVxuICAgICAqL1xuICAgIHZhciBjb21wb3NlID0gZnVuY3Rpb24gY29tcG9zZSgpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY29tcG9zZSByZXF1aXJlcyBhdCBsZWFzdCBvbmUgYXJndW1lbnQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGlwZS5hcHBseSh0aGlzLCByZXZlcnNlKGFyZ3VtZW50cykpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByaWdodC10by1sZWZ0IEtsZWlzbGkgY29tcG9zaXRpb24gb2YgdGhlIHByb3ZpZGVkIGZ1bmN0aW9ucyxcbiAgICAgKiBlYWNoIG9mIHdoaWNoIG11c3QgcmV0dXJuIGEgdmFsdWUgb2YgYSB0eXBlIHN1cHBvcnRlZCBieSBbYGNoYWluYF0oI2NoYWluKS5cbiAgICAgKlxuICAgICAqIGBSLmNvbXBvc2VLKGgsIGcsIGYpYCBpcyBlcXVpdmFsZW50IHRvIGBSLmNvbXBvc2UoUi5jaGFpbihoKSwgUi5jaGFpbihnKSwgUi5jaGFpbihmKSlgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzZWUgUi5waXBlS1xuICAgICAqIEBzaWcgQ2hhaW4gbSA9PiAoKHkgLT4gbSB6KSwgKHggLT4gbSB5KSwgLi4uLCAoYSAtPiBtIGIpKSAtPiAobSBhIC0+IG0geilcbiAgICAgKiBAcGFyYW0gey4uLkZ1bmN0aW9ufVxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIC8vICBwYXJzZUpzb24gOjogU3RyaW5nIC0+IE1heWJlICpcbiAgICAgKiAgICAgIC8vICBnZXQgOjogU3RyaW5nIC0+IE9iamVjdCAtPiBNYXliZSAqXG4gICAgICpcbiAgICAgKiAgICAgIC8vICBnZXRTdGF0ZUNvZGUgOjogTWF5YmUgU3RyaW5nIC0+IE1heWJlIFN0cmluZ1xuICAgICAqICAgICAgdmFyIGdldFN0YXRlQ29kZSA9IFIuY29tcG9zZUsoXG4gICAgICogICAgICAgIFIuY29tcG9zZShNYXliZS5vZiwgUi50b1VwcGVyKSxcbiAgICAgKiAgICAgICAgZ2V0KCdzdGF0ZScpLFxuICAgICAqICAgICAgICBnZXQoJ2FkZHJlc3MnKSxcbiAgICAgKiAgICAgICAgZ2V0KCd1c2VyJyksXG4gICAgICogICAgICAgIHBhcnNlSnNvblxuICAgICAqICAgICAgKTtcbiAgICAgKlxuICAgICAqICAgICAgZ2V0U3RhdGVDb2RlKE1heWJlLm9mKCd7XCJ1c2VyXCI6e1wiYWRkcmVzc1wiOntcInN0YXRlXCI6XCJueVwifX19JykpO1xuICAgICAqICAgICAgLy89PiBKdXN0KCdOWScpXG4gICAgICogICAgICBnZXRTdGF0ZUNvZGUoTWF5YmUub2YoJ1tJbnZhbGlkIEpTT05dJykpO1xuICAgICAqICAgICAgLy89PiBOb3RoaW5nKClcbiAgICAgKi9cbiAgICB2YXIgY29tcG9zZUsgPSBmdW5jdGlvbiBjb21wb3NlSygpIHtcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT09IDAgPyBpZGVudGl0eSA6IGNvbXBvc2UuYXBwbHkodGhpcywgbWFwKGNoYWluLCBhcmd1bWVudHMpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgcmlnaHQtdG8tbGVmdCBjb21wb3NpdGlvbiBvZiBvbmUgb3IgbW9yZSBQcm9taXNlLXJldHVybmluZ1xuICAgICAqIGZ1bmN0aW9ucy4gVGhlIHJpZ2h0bW9zdCBmdW5jdGlvbiBtYXkgaGF2ZSBhbnkgYXJpdHk7IHRoZSByZW1haW5pbmdcbiAgICAgKiBmdW5jdGlvbnMgbXVzdCBiZSB1bmFyeS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICgoeSAtPiBQcm9taXNlIHopLCAoeCAtPiBQcm9taXNlIHkpLCAuLi4sIChhIC0+IFByb21pc2UgYikpIC0+IChhIC0+IFByb21pc2UgeilcbiAgICAgKiBAcGFyYW0gey4uLkZ1bmN0aW9ufSBmdW5jdGlvbnNcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgKiBAc2VlIFIucGlwZVBcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICAvLyAgZm9sbG93ZXJzRm9yVXNlciA6OiBTdHJpbmcgLT4gUHJvbWlzZSBbVXNlcl1cbiAgICAgKiAgICAgIHZhciBmb2xsb3dlcnNGb3JVc2VyID0gUi5jb21wb3NlUChkYi5nZXRGb2xsb3dlcnMsIGRiLmdldFVzZXJCeUlkKTtcbiAgICAgKi9cbiAgICB2YXIgY29tcG9zZVAgPSBmdW5jdGlvbiBjb21wb3NlUCgpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY29tcG9zZVAgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIGFyZ3VtZW50Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBpcGVQLmFwcGx5KHRoaXMsIHJldmVyc2UoYXJndW1lbnRzKSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFdyYXBzIGEgY29uc3RydWN0b3IgZnVuY3Rpb24gaW5zaWRlIGEgY3VycmllZCBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjYWxsZWQgd2l0aCB0aGUgc2FtZVxuICAgICAqIGFyZ3VtZW50cyBhbmQgcmV0dXJucyB0aGUgc2FtZSB0eXBlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKCogLT4geyp9KSAtPiAoKiAtPiB7Kn0pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gRm4gVGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIHRvIHdyYXAuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgd3JhcHBlZCwgY3VycmllZCBjb25zdHJ1Y3RvciBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICAvLyBDb25zdHJ1Y3RvciBmdW5jdGlvblxuICAgICAqICAgICAgdmFyIFdpZGdldCA9IGZ1bmN0aW9uKGNvbmZpZykge1xuICAgICAqICAgICAgICAvLyAuLi5cbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICBXaWRnZXQucHJvdG90eXBlID0ge1xuICAgICAqICAgICAgICAvLyAuLi5cbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICB2YXIgYWxsQ29uZmlncyA9IFtcbiAgICAgKiAgICAgICAgLy8gLi4uXG4gICAgICogICAgICBdO1xuICAgICAqICAgICAgUi5tYXAoUi5jb25zdHJ1Y3QoV2lkZ2V0KSwgYWxsQ29uZmlncyk7IC8vIGEgbGlzdCBvZiBXaWRnZXRzXG4gICAgICovXG4gICAgdmFyIGNvbnN0cnVjdCA9IF9jdXJyeTEoZnVuY3Rpb24gY29uc3RydWN0KEZuKSB7XG4gICAgICAgIHJldHVybiBjb25zdHJ1Y3ROKEZuLmxlbmd0aCwgRm4pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHNwZWNpZmllZCB2YWx1ZSBpcyBlcXVhbCwgaW4gYFIuZXF1YWxzYCB0ZXJtcyxcbiAgICAgKiB0byBhdCBsZWFzdCBvbmUgZWxlbWVudCBvZiB0aGUgZ2l2ZW4gbGlzdDsgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGEgLT4gW2FdIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYSBUaGUgaXRlbSB0byBjb21wYXJlIGFnYWluc3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBpdGVtIGlzIGluIHRoZSBsaXN0LCBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuY29udGFpbnMoMywgWzEsIDIsIDNdKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmNvbnRhaW5zKDQsIFsxLCAyLCAzXSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuY29udGFpbnMoWzQyXSwgW1s0Ml1dKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGNvbnRhaW5zID0gX2N1cnJ5MihfY29udGFpbnMpO1xuXG4gICAgLyoqXG4gICAgICogRmluZHMgdGhlIHNldCAoaS5lLiBubyBkdXBsaWNhdGVzKSBvZiBhbGwgZWxlbWVudHMgaW4gdGhlIGZpcnN0IGxpc3Qgbm90IGNvbnRhaW5lZCBpbiB0aGUgc2Vjb25kIGxpc3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBbYV0gLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QxIFRoZSBmaXJzdCBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QyIFRoZSBzZWNvbmQgbGlzdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGVsZW1lbnRzIGluIGBsaXN0MWAgdGhhdCBhcmUgbm90IGluIGBsaXN0MmAuXG4gICAgICogQHNlZSBSLmRpZmZlcmVuY2VXaXRoXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5kaWZmZXJlbmNlKFsxLDIsMyw0XSwgWzcsNiw1LDQsM10pOyAvLz0+IFsxLDJdXG4gICAgICogICAgICBSLmRpZmZlcmVuY2UoWzcsNiw1LDQsM10sIFsxLDIsMyw0XSk7IC8vPT4gWzcsNiw1XVxuICAgICAqL1xuICAgIHZhciBkaWZmZXJlbmNlID0gX2N1cnJ5MihmdW5jdGlvbiBkaWZmZXJlbmNlKGZpcnN0LCBzZWNvbmQpIHtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgdmFyIGZpcnN0TGVuID0gZmlyc3QubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaWR4IDwgZmlyc3RMZW4pIHtcbiAgICAgICAgICAgIGlmICghX2NvbnRhaW5zKGZpcnN0W2lkeF0sIHNlY29uZCkgJiYgIV9jb250YWlucyhmaXJzdFtpZHhdLCBvdXQpKSB7XG4gICAgICAgICAgICAgICAgb3V0W291dC5sZW5ndGhdID0gZmlyc3RbaWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3Qgd2l0aG91dCBhbnkgY29uc2VjdXRpdmVseSByZXBlYXRpbmcgZWxlbWVudHMuXG4gICAgICogYFIuZXF1YWxzYCBpcyB1c2VkIHRvIGRldGVybWluZSBlcXVhbGl0eS5cbiAgICAgKlxuICAgICAqIEFjdHMgYXMgYSB0cmFuc2R1Y2VyIGlmIGEgdHJhbnNmb3JtZXIgaXMgZ2l2ZW4gaW4gbGlzdCBwb3NpdGlvbi5cbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gYGxpc3RgIHdpdGhvdXQgcmVwZWF0aW5nIGVsZW1lbnRzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgUi5kcm9wUmVwZWF0cyhbMSwgMSwgMSwgMiwgMywgNCwgNCwgMiwgMl0pOyAvLz0+IFsxLCAyLCAzLCA0LCAyXVxuICAgICAqL1xuICAgIHZhciBkcm9wUmVwZWF0cyA9IF9jdXJyeTEoX2Rpc3BhdGNoYWJsZSgnZHJvcFJlcGVhdHMnLCBfeGRyb3BSZXBlYXRzV2l0aChlcXVhbHMpLCBkcm9wUmVwZWF0c1dpdGgoZXF1YWxzKSkpO1xuXG4gICAgLyoqXG4gICAgICogQ29tYmluZXMgdHdvIGxpc3RzIGludG8gYSBzZXQgKGkuZS4gbm8gZHVwbGljYXRlcykgY29tcG9zZWQgb2YgdGhvc2UgZWxlbWVudHMgY29tbW9uIHRvIGJvdGggbGlzdHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBbYV0gLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QxIFRoZSBmaXJzdCBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QyIFRoZSBzZWNvbmQgbGlzdC5cbiAgICAgKiBAc2VlIFIuaW50ZXJzZWN0aW9uV2l0aFxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBvZiBlbGVtZW50cyBmb3VuZCBpbiBib3RoIGBsaXN0MWAgYW5kIGBsaXN0MmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pbnRlcnNlY3Rpb24oWzEsMiwzLDRdLCBbNyw2LDUsNCwzXSk7IC8vPT4gWzQsIDNdXG4gICAgICovXG4gICAgdmFyIGludGVyc2VjdGlvbiA9IF9jdXJyeTIoZnVuY3Rpb24gaW50ZXJzZWN0aW9uKGxpc3QxLCBsaXN0Mikge1xuICAgICAgICByZXR1cm4gdW5pcShfZmlsdGVyKGZsaXAoX2NvbnRhaW5zKShsaXN0MSksIGxpc3QyKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBcImxpZnRzXCIgYSBmdW5jdGlvbiBvZiBhcml0eSA+IDEgc28gdGhhdCBpdCBtYXkgXCJtYXAgb3ZlclwiIGFuIEFycmF5IG9yXG4gICAgICogb3RoZXIgRnVuY3Rvci5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAc2VlIFIubGlmdE5cbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICgqLi4uIC0+ICopIC0+IChbKl0uLi4gLT4gWypdKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBsaWZ0IGludG8gaGlnaGVyIGNvbnRleHRcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gVGhlIGZ1bmN0aW9uIGBmbmAgYXBwbGljYWJsZSB0byBtYXBwYWJsZSBvYmplY3RzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBtYWRkMyA9IFIubGlmdChSLmN1cnJ5KGZ1bmN0aW9uKGEsIGIsIGMpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGEgKyBiICsgYztcbiAgICAgKiAgICAgIH0pKTtcbiAgICAgKiAgICAgIG1hZGQzKFsxLDIsM10sIFsxLDIsM10sIFsxXSk7IC8vPT4gWzMsIDQsIDUsIDQsIDUsIDYsIDUsIDYsIDddXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBtYWRkNSA9IFIubGlmdChSLmN1cnJ5KGZ1bmN0aW9uKGEsIGIsIGMsIGQsIGUpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGEgKyBiICsgYyArIGQgKyBlO1xuICAgICAqICAgICAgfSkpO1xuICAgICAqICAgICAgbWFkZDUoWzEsMl0sIFszXSwgWzQsIDVdLCBbNl0sIFs3LCA4XSk7IC8vPT4gWzIxLCAyMiwgMjIsIDIzLCAyMiwgMjMsIDIzLCAyNF1cbiAgICAgKi9cbiAgICB2YXIgbGlmdCA9IF9jdXJyeTEoZnVuY3Rpb24gbGlmdChmbikge1xuICAgICAgICByZXR1cm4gbGlmdE4oZm4ubGVuZ3RoLCBmbik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcGFydGlhbCBjb3B5IG9mIGFuIG9iamVjdCBvbWl0dGluZyB0aGUga2V5cyBzcGVjaWZpZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgW1N0cmluZ10gLT4ge1N0cmluZzogKn0gLT4ge1N0cmluZzogKn1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBuYW1lcyBhbiBhcnJheSBvZiBTdHJpbmcgcHJvcGVydHkgbmFtZXMgdG8gb21pdCBmcm9tIHRoZSBuZXcgb2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGNvcHkgZnJvbVxuICAgICAqIEByZXR1cm4ge09iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggcHJvcGVydGllcyBmcm9tIGBuYW1lc2Agbm90IG9uIGl0LlxuICAgICAqIEBzZWUgUi5waWNrXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5vbWl0KFsnYScsICdkJ10sIHthOiAxLCBiOiAyLCBjOiAzLCBkOiA0fSk7IC8vPT4ge2I6IDIsIGM6IDN9XG4gICAgICovXG4gICAgdmFyIG9taXQgPSBfY3VycnkyKGZ1bmN0aW9uIG9taXQobmFtZXMsIG9iaikge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAoIV9jb250YWlucyhwcm9wLCBuYW1lcykpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbcHJvcF0gPSBvYmpbcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGxlZnQtdG8tcmlnaHQgS2xlaXNsaSBjb21wb3NpdGlvbiBvZiB0aGUgcHJvdmlkZWQgZnVuY3Rpb25zLFxuICAgICAqIGVhY2ggb2Ygd2hpY2ggbXVzdCByZXR1cm4gYSB2YWx1ZSBvZiBhIHR5cGUgc3VwcG9ydGVkIGJ5IFtgY2hhaW5gXSgjY2hhaW4pLlxuICAgICAqXG4gICAgICogYFIucGlwZUsoZiwgZywgaClgIGlzIGVxdWl2YWxlbnQgdG8gYFIucGlwZShSLmNoYWluKGYpLCBSLmNoYWluKGcpLCBSLmNoYWluKGgpKWAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNlZSBSLmNvbXBvc2VLXG4gICAgICogQHNpZyBDaGFpbiBtID0+ICgoYSAtPiBtIGIpLCAoYiAtPiBtIGMpLCAuLi4sICh5IC0+IG0geikpIC0+IChtIGEgLT4gbSB6KVxuICAgICAqIEBwYXJhbSB7Li4uRnVuY3Rpb259XG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gIHBhcnNlSnNvbiA6OiBTdHJpbmcgLT4gTWF5YmUgKlxuICAgICAqICAgICAgLy8gIGdldCA6OiBTdHJpbmcgLT4gT2JqZWN0IC0+IE1heWJlICpcbiAgICAgKlxuICAgICAqICAgICAgLy8gIGdldFN0YXRlQ29kZSA6OiBNYXliZSBTdHJpbmcgLT4gTWF5YmUgU3RyaW5nXG4gICAgICogICAgICB2YXIgZ2V0U3RhdGVDb2RlID0gUi5waXBlSyhcbiAgICAgKiAgICAgICAgcGFyc2VKc29uLFxuICAgICAqICAgICAgICBnZXQoJ3VzZXInKSxcbiAgICAgKiAgICAgICAgZ2V0KCdhZGRyZXNzJyksXG4gICAgICogICAgICAgIGdldCgnc3RhdGUnKSxcbiAgICAgKiAgICAgICAgUi5jb21wb3NlKE1heWJlLm9mLCBSLnRvVXBwZXIpXG4gICAgICogICAgICApO1xuICAgICAqXG4gICAgICogICAgICBnZXRTdGF0ZUNvZGUoTWF5YmUub2YoJ3tcInVzZXJcIjp7XCJhZGRyZXNzXCI6e1wic3RhdGVcIjpcIm55XCJ9fX0nKSk7XG4gICAgICogICAgICAvLz0+IEp1c3QoJ05ZJylcbiAgICAgKiAgICAgIGdldFN0YXRlQ29kZShNYXliZS5vZignW0ludmFsaWQgSlNPTl0nKSk7XG4gICAgICogICAgICAvLz0+IE5vdGhpbmcoKVxuICAgICAqL1xuICAgIHZhciBwaXBlSyA9IGZ1bmN0aW9uIHBpcGVLKCkge1xuICAgICAgICByZXR1cm4gY29tcG9zZUsuYXBwbHkodGhpcywgcmV2ZXJzZShhcmd1bWVudHMpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiB2YWx1ZS4gYGV2YWxgJ2luZyB0aGUgb3V0cHV0XG4gICAgICogc2hvdWxkIHJlc3VsdCBpbiBhIHZhbHVlIGVxdWl2YWxlbnQgdG8gdGhlIGlucHV0IHZhbHVlLiBNYW55IG9mIHRoZSBidWlsdC1pblxuICAgICAqIGB0b1N0cmluZ2AgbWV0aG9kcyBkbyBub3Qgc2F0aXNmeSB0aGlzIHJlcXVpcmVtZW50LlxuICAgICAqXG4gICAgICogSWYgdGhlIGdpdmVuIHZhbHVlIGlzIGFuIGBbb2JqZWN0IE9iamVjdF1gIHdpdGggYSBgdG9TdHJpbmdgIG1ldGhvZCBvdGhlclxuICAgICAqIHRoYW4gYE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdgLCB0aGlzIG1ldGhvZCBpcyBpbnZva2VkIHdpdGggbm8gYXJndW1lbnRzXG4gICAgICogdG8gcHJvZHVjZSB0aGUgcmV0dXJuIHZhbHVlLiBUaGlzIG1lYW5zIHVzZXItZGVmaW5lZCBjb25zdHJ1Y3RvciBmdW5jdGlvbnNcbiAgICAgKiBjYW4gcHJvdmlkZSBhIHN1aXRhYmxlIGB0b1N0cmluZ2AgbWV0aG9kLiBGb3IgZXhhbXBsZTpcbiAgICAgKlxuICAgICAqICAgICBmdW5jdGlvbiBQb2ludCh4LCB5KSB7XG4gICAgICogICAgICAgdGhpcy54ID0geDtcbiAgICAgKiAgICAgICB0aGlzLnkgPSB5O1xuICAgICAqICAgICB9XG4gICAgICpcbiAgICAgKiAgICAgUG9pbnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgICogICAgICAgcmV0dXJuICduZXcgUG9pbnQoJyArIHRoaXMueCArICcsICcgKyB0aGlzLnkgKyAnKSc7XG4gICAgICogICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgUi50b1N0cmluZyhuZXcgUG9pbnQoMSwgMikpOyAvLz0+ICduZXcgUG9pbnQoMSwgMiknXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBzaWcgKiAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbFxuICAgICAqIEByZXR1cm4ge1N0cmluZ31cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnRvU3RyaW5nKDQyKTsgLy89PiAnNDInXG4gICAgICogICAgICBSLnRvU3RyaW5nKCdhYmMnKTsgLy89PiAnXCJhYmNcIidcbiAgICAgKiAgICAgIFIudG9TdHJpbmcoWzEsIDIsIDNdKTsgLy89PiAnWzEsIDIsIDNdJ1xuICAgICAqICAgICAgUi50b1N0cmluZyh7Zm9vOiAxLCBiYXI6IDIsIGJhejogM30pOyAvLz0+ICd7XCJiYXJcIjogMiwgXCJiYXpcIjogMywgXCJmb29cIjogMX0nXG4gICAgICogICAgICBSLnRvU3RyaW5nKG5ldyBEYXRlKCcyMDAxLTAyLTAzVDA0OjA1OjA2WicpKTsgLy89PiAnbmV3IERhdGUoXCIyMDAxLTAyLTAzVDA0OjA1OjA2LjAwMFpcIiknXG4gICAgICovXG4gICAgdmFyIHRvU3RyaW5nID0gX2N1cnJ5MShmdW5jdGlvbiB0b1N0cmluZyh2YWwpIHtcbiAgICAgICAgcmV0dXJuIF90b1N0cmluZyh2YWwsIFtdKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENvbWJpbmVzIHR3byBsaXN0cyBpbnRvIGEgc2V0IChpLmUuIG5vIGR1cGxpY2F0ZXMpIGNvbXBvc2VkIG9mIHRoZVxuICAgICAqIGVsZW1lbnRzIG9mIGVhY2ggbGlzdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIFthXSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXMgVGhlIGZpcnN0IGxpc3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gYnMgVGhlIHNlY29uZCBsaXN0LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgZmlyc3QgYW5kIHNlY29uZCBsaXN0cyBjb25jYXRlbmF0ZWQsIHdpdGhcbiAgICAgKiAgICAgICAgIGR1cGxpY2F0ZXMgcmVtb3ZlZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnVuaW9uKFsxLCAyLCAzXSwgWzIsIDMsIDRdKTsgLy89PiBbMSwgMiwgMywgNF1cbiAgICAgKi9cbiAgICB2YXIgdW5pb24gPSBfY3VycnkyKGNvbXBvc2UodW5pcSwgX2NvbmNhdCkpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IGNvbnRhaW5pbmcgb25seSBvbmUgY29weSBvZiBlYWNoIGVsZW1lbnQgaW4gdGhlXG4gICAgICogb3JpZ2luYWwgbGlzdCwgYmFzZWQgdXBvbiB0aGUgdmFsdWUgcmV0dXJuZWQgYnkgYXBwbHlpbmcgdGhlIHN1cHBsaWVkXG4gICAgICogZnVuY3Rpb24gdG8gZWFjaCBsaXN0IGVsZW1lbnQuIFByZWZlcnMgdGhlIGZpcnN0IGl0ZW0gaWYgdGhlIHN1cHBsaWVkXG4gICAgICogZnVuY3Rpb24gcHJvZHVjZXMgdGhlIHNhbWUgdmFsdWUgb24gdHdvIGl0ZW1zLiBgUi5lcXVhbHNgIGlzIHVzZWQgZm9yXG4gICAgICogY29tcGFyaXNvbi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gYikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIEEgZnVuY3Rpb24gdXNlZCB0byBwcm9kdWNlIGEgdmFsdWUgdG8gdXNlIGR1cmluZyBjb21wYXJpc29ucy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3Qgb2YgdW5pcXVlIGl0ZW1zLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudW5pcUJ5KE1hdGguYWJzLCBbLTEsIC01LCAyLCAxMCwgMSwgMl0pOyAvLz0+IFstMSwgLTUsIDIsIDEwXVxuICAgICAqL1xuICAgIHZhciB1bmlxQnkgPSBfY3VycnkyKGZ1bmN0aW9uIHVuaXFCeShmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgYXBwbGllZCA9IFtdLCByZXN1bHQgPSBbXSwgYXBwbGllZEl0ZW0sIGl0ZW07XG4gICAgICAgIHdoaWxlIChpZHggPCBsaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgaXRlbSA9IGxpc3RbaWR4XTtcbiAgICAgICAgICAgIGFwcGxpZWRJdGVtID0gZm4oaXRlbSk7XG4gICAgICAgICAgICBpZiAoIV9jb250YWlucyhhcHBsaWVkSXRlbSwgYXBwbGllZCkpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICBhcHBsaWVkLnB1c2goYXBwbGllZEl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFR1cm5zIGEgbmFtZWQgbWV0aG9kIHdpdGggYSBzcGVjaWZpZWQgYXJpdHkgaW50byBhIGZ1bmN0aW9uXG4gICAgICogdGhhdCBjYW4gYmUgY2FsbGVkIGRpcmVjdGx5IHN1cHBsaWVkIHdpdGggYXJndW1lbnRzIGFuZCBhIHRhcmdldCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBUaGUgcmV0dXJuZWQgZnVuY3Rpb24gaXMgY3VycmllZCBhbmQgYWNjZXB0cyBgYXJpdHkgKyAxYCBwYXJhbWV0ZXJzIHdoZXJlXG4gICAgICogdGhlIGZpbmFsIHBhcmFtZXRlciBpcyB0aGUgdGFyZ2V0IG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIE51bWJlciAtPiBTdHJpbmcgLT4gKGEgLT4gYiAtPiAuLi4gLT4gbiAtPiBPYmplY3QgLT4gKilcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYXJpdHkgTnVtYmVyIG9mIGFyZ3VtZW50cyB0aGUgcmV0dXJuZWQgZnVuY3Rpb24gc2hvdWxkIHRha2VcbiAgICAgKiAgICAgICAgYmVmb3JlIHRoZSB0YXJnZXQgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG1ldGhvZCBOYW1lIG9mIHRoZSBtZXRob2QgdG8gY2FsbC5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcgY3VycmllZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgc2xpY2VGcm9tID0gUi5pbnZva2VyKDEsICdzbGljZScpO1xuICAgICAqICAgICAgc2xpY2VGcm9tKDYsICdhYmNkZWZnaGlqa2xtJyk7IC8vPT4gJ2doaWprbG0nXG4gICAgICogICAgICB2YXIgc2xpY2VGcm9tNiA9IFIuaW52b2tlcigyLCAnc2xpY2UnKSg2KTtcbiAgICAgKiAgICAgIHNsaWNlRnJvbTYoOCwgJ2FiY2RlZmdoaWprbG0nKTsgLy89PiAnZ2gnXG4gICAgICovXG4gICAgdmFyIGludm9rZXIgPSBfY3VycnkyKGZ1bmN0aW9uIGludm9rZXIoYXJpdHksIG1ldGhvZCkge1xuICAgICAgICByZXR1cm4gY3VycnlOKGFyaXR5ICsgMSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGFyZ3VtZW50c1thcml0eV07XG4gICAgICAgICAgICBpZiAodGFyZ2V0ICE9IG51bGwgJiYgaXMoRnVuY3Rpb24sIHRhcmdldFttZXRob2RdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbbWV0aG9kXS5hcHBseSh0YXJnZXQsIF9zbGljZShhcmd1bWVudHMsIDAsIGFyaXR5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHRvU3RyaW5nKHRhcmdldCkgKyAnIGRvZXMgbm90IGhhdmUgYSBtZXRob2QgbmFtZWQgXCInICsgbWV0aG9kICsgJ1wiJyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyBtYWRlIGJ5IGluc2VydGluZyB0aGUgYHNlcGFyYXRvcmAgYmV0d2VlbiBlYWNoXG4gICAgICogZWxlbWVudCBhbmQgY29uY2F0ZW5hdGluZyBhbGwgdGhlIGVsZW1lbnRzIGludG8gYSBzaW5nbGUgc3RyaW5nLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBTdHJpbmcgLT4gW2FdIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfFN0cmluZ30gc2VwYXJhdG9yIFRoZSBzdHJpbmcgdXNlZCB0byBzZXBhcmF0ZSB0aGUgZWxlbWVudHMuXG4gICAgICogQHBhcmFtIHtBcnJheX0geHMgVGhlIGVsZW1lbnRzIHRvIGpvaW4gaW50byBhIHN0cmluZy5cbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIG1hZGUgYnkgY29uY2F0ZW5hdGluZyBgeHNgIHdpdGggYHNlcGFyYXRvcmAuXG4gICAgICogQHNlZSBSLnNwbGl0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHNwYWNlciA9IFIuam9pbignICcpO1xuICAgICAqICAgICAgc3BhY2VyKFsnYScsIDIsIDMuNF0pOyAgIC8vPT4gJ2EgMiAzLjQnXG4gICAgICogICAgICBSLmpvaW4oJ3wnLCBbMSwgMiwgM10pOyAgICAvLz0+ICcxfDJ8MydcbiAgICAgKi9cbiAgICB2YXIgam9pbiA9IGludm9rZXIoMSwgJ2pvaW4nKTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgZnVuY3Rpb24gdGhhdCwgd2hlbiBpbnZva2VkLCBjYWNoZXMgdGhlIHJlc3VsdCBvZiBjYWxsaW5nIGBmbmAgZm9yIGEgZ2l2ZW5cbiAgICAgKiBhcmd1bWVudCBzZXQgYW5kIHJldHVybnMgdGhlIHJlc3VsdC4gU3Vic2VxdWVudCBjYWxscyB0byB0aGUgbWVtb2l6ZWQgYGZuYCB3aXRoIHRoZSBzYW1lXG4gICAgICogYXJndW1lbnQgc2V0IHdpbGwgbm90IHJlc3VsdCBpbiBhbiBhZGRpdGlvbmFsIGNhbGwgdG8gYGZuYDsgaW5zdGVhZCwgdGhlIGNhY2hlZCByZXN1bHRcbiAgICAgKiBmb3IgdGhhdCBzZXQgb2YgYXJndW1lbnRzIHdpbGwgYmUgcmV0dXJuZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKi4uLiAtPiBhKSAtPiAoKi4uLiAtPiBhKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBtZW1vaXplLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBNZW1vaXplZCB2ZXJzaW9uIG9mIGBmbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGNvdW50ID0gMDtcbiAgICAgKiAgICAgIHZhciBmYWN0b3JpYWwgPSBSLm1lbW9pemUoZnVuY3Rpb24obikge1xuICAgICAqICAgICAgICBjb3VudCArPSAxO1xuICAgICAqICAgICAgICByZXR1cm4gUi5wcm9kdWN0KFIucmFuZ2UoMSwgbiArIDEpKTtcbiAgICAgKiAgICAgIH0pO1xuICAgICAqICAgICAgZmFjdG9yaWFsKDUpOyAvLz0+IDEyMFxuICAgICAqICAgICAgZmFjdG9yaWFsKDUpOyAvLz0+IDEyMFxuICAgICAqICAgICAgZmFjdG9yaWFsKDUpOyAvLz0+IDEyMFxuICAgICAqICAgICAgY291bnQ7IC8vPT4gMVxuICAgICAqL1xuICAgIHZhciBtZW1vaXplID0gX2N1cnJ5MShmdW5jdGlvbiBtZW1vaXplKGZuKSB7XG4gICAgICAgIHZhciBjYWNoZSA9IHt9O1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGtleSA9IHRvU3RyaW5nKGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBpZiAoIV9oYXMoa2V5LCBjYWNoZSkpIHtcbiAgICAgICAgICAgICAgICBjYWNoZVtrZXldID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjYWNoZVtrZXldO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogU3BsaXRzIGEgc3RyaW5nIGludG8gYW4gYXJyYXkgb2Ygc3RyaW5ncyBiYXNlZCBvbiB0aGUgZ2l2ZW5cbiAgICAgKiBzZXBhcmF0b3IuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBzaWcgU3RyaW5nIC0+IFN0cmluZyAtPiBbU3RyaW5nXVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzZXAgVGhlIHNlcGFyYXRvciBzdHJpbmcuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIHNlcGFyYXRlIGludG8gYW4gYXJyYXkuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBhcnJheSBvZiBzdHJpbmdzIGZyb20gYHN0cmAgc2VwYXJhdGVkIGJ5IGBzdHJgLlxuICAgICAqIEBzZWUgUi5qb2luXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHBhdGhDb21wb25lbnRzID0gUi5zcGxpdCgnLycpO1xuICAgICAqICAgICAgUi50YWlsKHBhdGhDb21wb25lbnRzKCcvdXNyL2xvY2FsL2Jpbi9ub2RlJykpOyAvLz0+IFsndXNyJywgJ2xvY2FsJywgJ2JpbicsICdub2RlJ11cbiAgICAgKlxuICAgICAqICAgICAgUi5zcGxpdCgnLicsICdhLmIuYy54eXouZCcpOyAvLz0+IFsnYScsICdiJywgJ2MnLCAneHl6JywgJ2QnXVxuICAgICAqL1xuICAgIHZhciBzcGxpdCA9IGludm9rZXIoMSwgJ3NwbGl0Jyk7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgbG93ZXIgY2FzZSB2ZXJzaW9uIG9mIGEgc3RyaW5nLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAc2lnIFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBzdHJpbmcgdG8gbG93ZXIgY2FzZS5cbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9IFRoZSBsb3dlciBjYXNlIHZlcnNpb24gb2YgYHN0cmAuXG4gICAgICogQHNlZSBSLnRvVXBwZXJcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnRvTG93ZXIoJ1hZWicpOyAvLz0+ICd4eXonXG4gICAgICovXG4gICAgdmFyIHRvTG93ZXIgPSBpbnZva2VyKDAsICd0b0xvd2VyQ2FzZScpO1xuXG4gICAgLyoqXG4gICAgICogVGhlIHVwcGVyIGNhc2UgdmVyc2lvbiBvZiBhIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIHVwcGVyIGNhc2UuXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgdXBwZXIgY2FzZSB2ZXJzaW9uIG9mIGBzdHJgLlxuICAgICAqIEBzZWUgUi50b0xvd2VyXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50b1VwcGVyKCdhYmMnKTsgLy89PiAnQUJDJ1xuICAgICAqL1xuICAgIHZhciB0b1VwcGVyID0gaW52b2tlcigwLCAndG9VcHBlckNhc2UnKTtcblxuICAgIHZhciBSID0ge1xuICAgICAgICBGOiBGLFxuICAgICAgICBUOiBULFxuICAgICAgICBfXzogX18sXG4gICAgICAgIGFkZDogYWRkLFxuICAgICAgICBhZGRJbmRleDogYWRkSW5kZXgsXG4gICAgICAgIGFkanVzdDogYWRqdXN0LFxuICAgICAgICBhbGw6IGFsbCxcbiAgICAgICAgYWxsUGFzczogYWxsUGFzcyxcbiAgICAgICAgYWx3YXlzOiBhbHdheXMsXG4gICAgICAgIGFuZDogYW5kLFxuICAgICAgICBhbnk6IGFueSxcbiAgICAgICAgYW55UGFzczogYW55UGFzcyxcbiAgICAgICAgYXA6IGFwLFxuICAgICAgICBhcGVydHVyZTogYXBlcnR1cmUsXG4gICAgICAgIGFwcGVuZDogYXBwZW5kLFxuICAgICAgICBhcHBseTogYXBwbHksXG4gICAgICAgIGFzc29jOiBhc3NvYyxcbiAgICAgICAgYXNzb2NQYXRoOiBhc3NvY1BhdGgsXG4gICAgICAgIGJpbmFyeTogYmluYXJ5LFxuICAgICAgICBiaW5kOiBiaW5kLFxuICAgICAgICBib3RoOiBib3RoLFxuICAgICAgICBjYWxsOiBjYWxsLFxuICAgICAgICBjaGFpbjogY2hhaW4sXG4gICAgICAgIGNsb25lOiBjbG9uZSxcbiAgICAgICAgY29tbXV0ZTogY29tbXV0ZSxcbiAgICAgICAgY29tbXV0ZU1hcDogY29tbXV0ZU1hcCxcbiAgICAgICAgY29tcGFyYXRvcjogY29tcGFyYXRvcixcbiAgICAgICAgY29tcGxlbWVudDogY29tcGxlbWVudCxcbiAgICAgICAgY29tcG9zZTogY29tcG9zZSxcbiAgICAgICAgY29tcG9zZUs6IGNvbXBvc2VLLFxuICAgICAgICBjb21wb3NlUDogY29tcG9zZVAsXG4gICAgICAgIGNvbmNhdDogY29uY2F0LFxuICAgICAgICBjb25kOiBjb25kLFxuICAgICAgICBjb25zdHJ1Y3Q6IGNvbnN0cnVjdCxcbiAgICAgICAgY29uc3RydWN0TjogY29uc3RydWN0TixcbiAgICAgICAgY29udGFpbnM6IGNvbnRhaW5zLFxuICAgICAgICBjb250YWluc1dpdGg6IGNvbnRhaW5zV2l0aCxcbiAgICAgICAgY29udmVyZ2U6IGNvbnZlcmdlLFxuICAgICAgICBjb3VudEJ5OiBjb3VudEJ5LFxuICAgICAgICBjcmVhdGVNYXBFbnRyeTogY3JlYXRlTWFwRW50cnksXG4gICAgICAgIGN1cnJ5OiBjdXJyeSxcbiAgICAgICAgY3VycnlOOiBjdXJyeU4sXG4gICAgICAgIGRlYzogZGVjLFxuICAgICAgICBkZWZhdWx0VG86IGRlZmF1bHRUbyxcbiAgICAgICAgZGlmZmVyZW5jZTogZGlmZmVyZW5jZSxcbiAgICAgICAgZGlmZmVyZW5jZVdpdGg6IGRpZmZlcmVuY2VXaXRoLFxuICAgICAgICBkaXNzb2M6IGRpc3NvYyxcbiAgICAgICAgZGlzc29jUGF0aDogZGlzc29jUGF0aCxcbiAgICAgICAgZGl2aWRlOiBkaXZpZGUsXG4gICAgICAgIGRyb3A6IGRyb3AsXG4gICAgICAgIGRyb3BMYXN0OiBkcm9wTGFzdCxcbiAgICAgICAgZHJvcExhc3RXaGlsZTogZHJvcExhc3RXaGlsZSxcbiAgICAgICAgZHJvcFJlcGVhdHM6IGRyb3BSZXBlYXRzLFxuICAgICAgICBkcm9wUmVwZWF0c1dpdGg6IGRyb3BSZXBlYXRzV2l0aCxcbiAgICAgICAgZHJvcFdoaWxlOiBkcm9wV2hpbGUsXG4gICAgICAgIGVpdGhlcjogZWl0aGVyLFxuICAgICAgICBlbXB0eTogZW1wdHksXG4gICAgICAgIGVxUHJvcHM6IGVxUHJvcHMsXG4gICAgICAgIGVxdWFsczogZXF1YWxzLFxuICAgICAgICBldm9sdmU6IGV2b2x2ZSxcbiAgICAgICAgZmlsdGVyOiBmaWx0ZXIsXG4gICAgICAgIGZpbmQ6IGZpbmQsXG4gICAgICAgIGZpbmRJbmRleDogZmluZEluZGV4LFxuICAgICAgICBmaW5kTGFzdDogZmluZExhc3QsXG4gICAgICAgIGZpbmRMYXN0SW5kZXg6IGZpbmRMYXN0SW5kZXgsXG4gICAgICAgIGZsYXR0ZW46IGZsYXR0ZW4sXG4gICAgICAgIGZsaXA6IGZsaXAsXG4gICAgICAgIGZvckVhY2g6IGZvckVhY2gsXG4gICAgICAgIGZyb21QYWlyczogZnJvbVBhaXJzLFxuICAgICAgICBmdW5jdGlvbnM6IGZ1bmN0aW9ucyxcbiAgICAgICAgZnVuY3Rpb25zSW46IGZ1bmN0aW9uc0luLFxuICAgICAgICBncm91cEJ5OiBncm91cEJ5LFxuICAgICAgICBndDogZ3QsXG4gICAgICAgIGd0ZTogZ3RlLFxuICAgICAgICBoYXM6IGhhcyxcbiAgICAgICAgaGFzSW46IGhhc0luLFxuICAgICAgICBoZWFkOiBoZWFkLFxuICAgICAgICBpZGVudGljYWw6IGlkZW50aWNhbCxcbiAgICAgICAgaWRlbnRpdHk6IGlkZW50aXR5LFxuICAgICAgICBpZkVsc2U6IGlmRWxzZSxcbiAgICAgICAgaW5jOiBpbmMsXG4gICAgICAgIGluZGV4T2Y6IGluZGV4T2YsXG4gICAgICAgIGluaXQ6IGluaXQsXG4gICAgICAgIGluc2VydDogaW5zZXJ0LFxuICAgICAgICBpbnNlcnRBbGw6IGluc2VydEFsbCxcbiAgICAgICAgaW50ZXJzZWN0aW9uOiBpbnRlcnNlY3Rpb24sXG4gICAgICAgIGludGVyc2VjdGlvbldpdGg6IGludGVyc2VjdGlvbldpdGgsXG4gICAgICAgIGludGVyc3BlcnNlOiBpbnRlcnNwZXJzZSxcbiAgICAgICAgaW50bzogaW50byxcbiAgICAgICAgaW52ZXJ0OiBpbnZlcnQsXG4gICAgICAgIGludmVydE9iajogaW52ZXJ0T2JqLFxuICAgICAgICBpbnZva2VyOiBpbnZva2VyLFxuICAgICAgICBpczogaXMsXG4gICAgICAgIGlzQXJyYXlMaWtlOiBpc0FycmF5TGlrZSxcbiAgICAgICAgaXNFbXB0eTogaXNFbXB0eSxcbiAgICAgICAgaXNOaWw6IGlzTmlsLFxuICAgICAgICBpc1NldDogaXNTZXQsXG4gICAgICAgIGpvaW46IGpvaW4sXG4gICAgICAgIGtleXM6IGtleXMsXG4gICAgICAgIGtleXNJbjoga2V5c0luLFxuICAgICAgICBsYXN0OiBsYXN0LFxuICAgICAgICBsYXN0SW5kZXhPZjogbGFzdEluZGV4T2YsXG4gICAgICAgIGxlbmd0aDogbGVuZ3RoLFxuICAgICAgICBsZW5zOiBsZW5zLFxuICAgICAgICBsZW5zSW5kZXg6IGxlbnNJbmRleCxcbiAgICAgICAgbGVuc1Byb3A6IGxlbnNQcm9wLFxuICAgICAgICBsaWZ0OiBsaWZ0LFxuICAgICAgICBsaWZ0TjogbGlmdE4sXG4gICAgICAgIGx0OiBsdCxcbiAgICAgICAgbHRlOiBsdGUsXG4gICAgICAgIG1hcDogbWFwLFxuICAgICAgICBtYXBBY2N1bTogbWFwQWNjdW0sXG4gICAgICAgIG1hcEFjY3VtUmlnaHQ6IG1hcEFjY3VtUmlnaHQsXG4gICAgICAgIG1hcE9iajogbWFwT2JqLFxuICAgICAgICBtYXBPYmpJbmRleGVkOiBtYXBPYmpJbmRleGVkLFxuICAgICAgICBtYXRjaDogbWF0Y2gsXG4gICAgICAgIG1hdGhNb2Q6IG1hdGhNb2QsXG4gICAgICAgIG1heDogbWF4LFxuICAgICAgICBtYXhCeTogbWF4QnksXG4gICAgICAgIG1lYW46IG1lYW4sXG4gICAgICAgIG1lZGlhbjogbWVkaWFuLFxuICAgICAgICBtZW1vaXplOiBtZW1vaXplLFxuICAgICAgICBtZXJnZTogbWVyZ2UsXG4gICAgICAgIG1lcmdlQWxsOiBtZXJnZUFsbCxcbiAgICAgICAgbWluOiBtaW4sXG4gICAgICAgIG1pbkJ5OiBtaW5CeSxcbiAgICAgICAgbW9kdWxvOiBtb2R1bG8sXG4gICAgICAgIG11bHRpcGx5OiBtdWx0aXBseSxcbiAgICAgICAgbkFyeTogbkFyeSxcbiAgICAgICAgbmVnYXRlOiBuZWdhdGUsXG4gICAgICAgIG5vbmU6IG5vbmUsXG4gICAgICAgIG5vdDogbm90LFxuICAgICAgICBudGg6IG50aCxcbiAgICAgICAgbnRoQXJnOiBudGhBcmcsXG4gICAgICAgIG50aENoYXI6IG50aENoYXIsXG4gICAgICAgIG50aENoYXJDb2RlOiBudGhDaGFyQ29kZSxcbiAgICAgICAgb2Y6IG9mLFxuICAgICAgICBvbWl0OiBvbWl0LFxuICAgICAgICBvbmNlOiBvbmNlLFxuICAgICAgICBvcjogb3IsXG4gICAgICAgIG92ZXI6IG92ZXIsXG4gICAgICAgIHBhcnRpYWw6IHBhcnRpYWwsXG4gICAgICAgIHBhcnRpYWxSaWdodDogcGFydGlhbFJpZ2h0LFxuICAgICAgICBwYXJ0aXRpb246IHBhcnRpdGlvbixcbiAgICAgICAgcGF0aDogcGF0aCxcbiAgICAgICAgcGF0aEVxOiBwYXRoRXEsXG4gICAgICAgIHBpY2s6IHBpY2ssXG4gICAgICAgIHBpY2tBbGw6IHBpY2tBbGwsXG4gICAgICAgIHBpY2tCeTogcGlja0J5LFxuICAgICAgICBwaXBlOiBwaXBlLFxuICAgICAgICBwaXBlSzogcGlwZUssXG4gICAgICAgIHBpcGVQOiBwaXBlUCxcbiAgICAgICAgcGx1Y2s6IHBsdWNrLFxuICAgICAgICBwcmVwZW5kOiBwcmVwZW5kLFxuICAgICAgICBwcm9kdWN0OiBwcm9kdWN0LFxuICAgICAgICBwcm9qZWN0OiBwcm9qZWN0LFxuICAgICAgICBwcm9wOiBwcm9wLFxuICAgICAgICBwcm9wRXE6IHByb3BFcSxcbiAgICAgICAgcHJvcElzOiBwcm9wSXMsXG4gICAgICAgIHByb3BPcjogcHJvcE9yLFxuICAgICAgICBwcm9wU2F0aXNmaWVzOiBwcm9wU2F0aXNmaWVzLFxuICAgICAgICBwcm9wczogcHJvcHMsXG4gICAgICAgIHJhbmdlOiByYW5nZSxcbiAgICAgICAgcmVkdWNlOiByZWR1Y2UsXG4gICAgICAgIHJlZHVjZVJpZ2h0OiByZWR1Y2VSaWdodCxcbiAgICAgICAgcmVkdWNlZDogcmVkdWNlZCxcbiAgICAgICAgcmVqZWN0OiByZWplY3QsXG4gICAgICAgIHJlbW92ZTogcmVtb3ZlLFxuICAgICAgICByZXBlYXQ6IHJlcGVhdCxcbiAgICAgICAgcmVwbGFjZTogcmVwbGFjZSxcbiAgICAgICAgcmV2ZXJzZTogcmV2ZXJzZSxcbiAgICAgICAgc2Nhbjogc2NhbixcbiAgICAgICAgc2V0OiBzZXQsXG4gICAgICAgIHNsaWNlOiBzbGljZSxcbiAgICAgICAgc29ydDogc29ydCxcbiAgICAgICAgc29ydEJ5OiBzb3J0QnksXG4gICAgICAgIHNwbGl0OiBzcGxpdCxcbiAgICAgICAgc3BsaXRFdmVyeTogc3BsaXRFdmVyeSxcbiAgICAgICAgc3VidHJhY3Q6IHN1YnRyYWN0LFxuICAgICAgICBzdW06IHN1bSxcbiAgICAgICAgdGFpbDogdGFpbCxcbiAgICAgICAgdGFrZTogdGFrZSxcbiAgICAgICAgdGFrZUxhc3Q6IHRha2VMYXN0LFxuICAgICAgICB0YWtlTGFzdFdoaWxlOiB0YWtlTGFzdFdoaWxlLFxuICAgICAgICB0YWtlV2hpbGU6IHRha2VXaGlsZSxcbiAgICAgICAgdGFwOiB0YXAsXG4gICAgICAgIHRlc3Q6IHRlc3QsXG4gICAgICAgIHRpbWVzOiB0aW1lcyxcbiAgICAgICAgdG9Mb3dlcjogdG9Mb3dlcixcbiAgICAgICAgdG9QYWlyczogdG9QYWlycyxcbiAgICAgICAgdG9QYWlyc0luOiB0b1BhaXJzSW4sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdG9VcHBlcjogdG9VcHBlcixcbiAgICAgICAgdHJhbnNkdWNlOiB0cmFuc2R1Y2UsXG4gICAgICAgIHRyaW06IHRyaW0sXG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIHVuYXBwbHk6IHVuYXBwbHksXG4gICAgICAgIHVuYXJ5OiB1bmFyeSxcbiAgICAgICAgdW5jdXJyeU46IHVuY3VycnlOLFxuICAgICAgICB1bmZvbGQ6IHVuZm9sZCxcbiAgICAgICAgdW5pb246IHVuaW9uLFxuICAgICAgICB1bmlvbldpdGg6IHVuaW9uV2l0aCxcbiAgICAgICAgdW5pcTogdW5pcSxcbiAgICAgICAgdW5pcUJ5OiB1bmlxQnksXG4gICAgICAgIHVuaXFXaXRoOiB1bmlxV2l0aCxcbiAgICAgICAgdW5uZXN0OiB1bm5lc3QsXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB1c2VXaXRoOiB1c2VXaXRoLFxuICAgICAgICB2YWx1ZXM6IHZhbHVlcyxcbiAgICAgICAgdmFsdWVzSW46IHZhbHVlc0luLFxuICAgICAgICB2aWV3OiB2aWV3LFxuICAgICAgICB3aGVyZTogd2hlcmUsXG4gICAgICAgIHdoZXJlRXE6IHdoZXJlRXEsXG4gICAgICAgIHdyYXA6IHdyYXAsXG4gICAgICAgIHhwcm9kOiB4cHJvZCxcbiAgICAgICAgemlwOiB6aXAsXG4gICAgICAgIHppcE9iajogemlwT2JqLFxuICAgICAgICB6aXBXaXRoOiB6aXBXaXRoXG4gICAgfTtcblxuICAvKiBURVNUX0VOVFJZX1BPSU5UICovXG5cbiAgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gUjtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoZnVuY3Rpb24oKSB7IHJldHVybiBSOyB9KTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLlIgPSBSO1xuICB9XG5cbn0uY2FsbCh0aGlzKSk7XG4iLCJ2YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgQ29uZmlnID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQ29uZmlnKCkge1xuICAgICAgICB9XG4gICAgICAgIENvbmZpZy5ib3JkZXJXaWR0aCA9IDQ7XG4gICAgICAgIENvbmZpZy5ib3JkZXJIZWlnaHQgPSA0O1xuICAgICAgICBDb25maWcudGlsZVNpemUgPSAzMDtcbiAgICAgICAgQ29uZmlnLm9mZnNldFggPSA0MDtcbiAgICAgICAgQ29uZmlnLm9mZnNldFkgPSAtMiAqIChDb25maWcudGlsZVNpemUgLSAxKTtcbiAgICAgICAgQ29uZmlnLmJvYXJkV2lkdGggPSAxMDtcbiAgICAgICAgQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyA9IENvbmZpZy5vZmZzZXRYICsgQ29uZmlnLmJvcmRlcldpZHRoICogMiArIENvbmZpZy5ib2FyZFdpZHRoICogQ29uZmlnLnRpbGVTaXplO1xuICAgICAgICBDb25maWcuYm9hcmRIZWlnaHQgPSAyMjtcbiAgICAgICAgQ29uZmlnLmJvYXJkSGVpZ2h0SW5QaXhlbHMgPSBDb25maWcub2Zmc2V0WSArIENvbmZpZy5ib3JkZXJXaWR0aCAqIDIgKyBDb25maWcuYm9hcmRIZWlnaHQgKiBDb25maWcudGlsZVNpemU7XG4gICAgICAgIENvbmZpZy5tb3ZlVGltZXJSYXRlID0gMC4xO1xuICAgICAgICBDb25maWcuYW5pbWF0aW9uVGltZSA9IDMwMDtcbiAgICAgICAgcmV0dXJuIENvbmZpZztcbiAgICB9KSgpO1xuICAgIFRldHJpcy5Db25maWcgPSBDb25maWc7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICAoZnVuY3Rpb24gKEJsb2NrU3RhdHVzKSB7XG4gICAgICAgIEJsb2NrU3RhdHVzW0Jsb2NrU3RhdHVzW1wiRW1wdHlcIl0gPSAwXSA9IFwiRW1wdHlcIjtcbiAgICAgICAgQmxvY2tTdGF0dXNbQmxvY2tTdGF0dXNbXCJUYWtlblwiXSA9IDFdID0gXCJUYWtlblwiO1xuICAgIH0pKFRldHJpcy5CbG9ja1N0YXR1cyB8fCAoVGV0cmlzLkJsb2NrU3RhdHVzID0ge30pKTtcbiAgICB2YXIgQmxvY2tTdGF0dXMgPSBUZXRyaXMuQmxvY2tTdGF0dXM7XG4gICAgKGZ1bmN0aW9uIChEaXJlY3Rpb24pIHtcbiAgICAgICAgRGlyZWN0aW9uW0RpcmVjdGlvbltcIkxlZnRcIl0gPSAtMV0gPSBcIkxlZnRcIjtcbiAgICAgICAgRGlyZWN0aW9uW0RpcmVjdGlvbltcIlJpZ2h0XCJdID0gMV0gPSBcIlJpZ2h0XCI7XG4gICAgICAgIERpcmVjdGlvbltEaXJlY3Rpb25bXCJVcFwiXSA9IDJdID0gXCJVcFwiO1xuICAgICAgICBEaXJlY3Rpb25bRGlyZWN0aW9uW1wiRG93blwiXSA9IDRdID0gXCJEb3duXCI7XG4gICAgfSkoVGV0cmlzLkRpcmVjdGlvbiB8fCAoVGV0cmlzLkRpcmVjdGlvbiA9IHt9KSk7XG4gICAgdmFyIERpcmVjdGlvbiA9IFRldHJpcy5EaXJlY3Rpb247XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNC0yMC5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2xpYi9raXdpLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2NvbmZpZy50c1wiIC8+XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGU7XG4gICAgZC5wcm90b3R5cGUgPSBuZXcgX18oKTtcbn07XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgTWVudVN0YXRlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKE1lbnVTdGF0ZSwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gTWVudVN0YXRlKCkge1xuICAgICAgICAgICAgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgTWVudVN0YXRlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nYW1lLmlucHV0Lm1vdXNlLmlzRG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZXMuc3dpdGNoU3RhdGUoJ21haW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWVudVN0YXRlLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNyZWF0ZS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJUZXRyaXMgY2xvbmVcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAyMDAsIFwiIzAwMFwiLCAzMCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJEZWZhdWx0IGNvbnRyb2xzIGZvciB0aGUgZ2FtZSBhcmU6XCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMjUwLCBcIiMwMDBcIiwgMjApKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiTW92ZSAtIGFycm93IGtleXNcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAyODAsIFwiIzAwMFwiLCAxNikpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJSb3RhdGUgY291bnRlcmNsb2Nrd2lzZSAtIHpcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAzMDAsIFwiIzAwMFwiLCAxNikpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJSb3RhdGUgY2xvY2t3aXNlIC0geFwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDMyMCwgXCIjMDAwXCIsIDE2KSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIlJvdGF0ZSBib3RoIHdheXMgLSB1cCBhcnJvd1wiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDM0MCwgXCIjMDAwXCIsIDE2KSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIlNvZnQgZHJvcCAtIGRvd24ga2V5XCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMzYwLCBcIiMwMDBcIiwgMTYpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiSGFyZCBkcm9wIC0gc3BhY2VcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAzODAsIFwiIzAwMFwiLCAxNikpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJIb2xkIC0gc2hpZnRcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCA0MDAsIFwiIzAwMFwiLCAxNikpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJPbiBtb2JpbGUgeW91IGNhbiBwbGF5XCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgNDQwLCBcIiMwMDBcIiwgMjApKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwid2l0aCBvbiBzY3JlZW4gYnV0dG9uc1wiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDQ2MCwgXCIjMDAwXCIsIDIwKSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIm9yIGJ5IGRyYWdnaW5nIG9uIHNjcmVlblwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDQ4MCwgXCIjMDAwXCIsIDIwKSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIkNsaWNrIG9uIHNjcmVlbiB0byBwbGF5XCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgNTEwLCBcIiMwMDBcIiwgMjUpKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0QWxsQ2hpbGRyZW4oKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZHJlbikgeyByZXR1cm4gY2hpbGRyZW4udGV4dEFsaWduID0gJ2NlbnRlcic7IH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTWVudVN0YXRlO1xuICAgIH0pKEtpd2kuU3RhdGUpO1xuICAgIFRldHJpcy5NZW51U3RhdGUgPSBNZW51U3RhdGU7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgUG9zaXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBQb3NpdGlvbih4LCB5KSB7XG4gICAgICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgfVxuICAgICAgICBQb3NpdGlvbi5wcm90b3R5cGUuaXNMb3dlciA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMueSA+IHBvc2l0aW9uLnk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBQb3NpdGlvbjtcbiAgICB9KSgpO1xuICAgIFRldHJpcy5Qb3NpdGlvbiA9IFBvc2l0aW9uO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2xpYi9raXdpLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2NvbmZpZy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwicG9zaXRpb24udHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIEJsb2NrID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQmxvY2soeCwgeSwgc3RhdGUsIHRleHR1cmUpIHtcbiAgICAgICAgICAgIHRoaXMuc2l6ZSA9IFRldHJpcy5Db25maWcudGlsZVNpemU7XG4gICAgICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgICAgIGlmICh0ZXh0dXJlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zcHJpdGUgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5TcHJpdGUoc3RhdGUsIHRleHR1cmUsIFRldHJpcy5Db25maWcub2Zmc2V0WCArIFRldHJpcy5Db25maWcuYm9yZGVyV2lkdGggKyB4ICogKHRoaXMuc2l6ZSAtIDEpLCBUZXRyaXMuQ29uZmlnLm9mZnNldFkgKyBUZXRyaXMuQ29uZmlnLmJvcmRlcldpZHRoICsgeSAqICh0aGlzLnNpemUgLSAxKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQmxvY2sucHJvdG90eXBlLmZhbGwgPSBmdW5jdGlvbiAoYW1vdW50T2ZUaWxlcykge1xuICAgICAgICAgICAgaWYgKGFtb3VudE9mVGlsZXMgPT09IHZvaWQgMCkgeyBhbW91bnRPZlRpbGVzID0gMTsgfVxuICAgICAgICAgICAgdGhpcy55ICs9IGFtb3VudE9mVGlsZXM7XG4gICAgICAgICAgICBpZiAodGhpcy5zcHJpdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwcml0ZS50cmFuc2Zvcm0ueSArPSBhbW91bnRPZlRpbGVzICogKHRoaXMuc2l6ZSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBCbG9jay5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgICAgICAgICB0aGlzLnggKz0gc2lkZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNwcml0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLnRyYW5zZm9ybS54ICs9IHNpZGUgKiAodGhpcy5zaXplIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEJsb2NrLnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgdmFyIHhEaWZmID0gcG9zaXRpb24ueCAtIHRoaXMueDtcbiAgICAgICAgICAgIHZhciB5RGlmZiA9IHBvc2l0aW9uLnkgLSB0aGlzLnk7XG4gICAgICAgICAgICB0aGlzLnggPSBwb3NpdGlvbi54O1xuICAgICAgICAgICAgdGhpcy55ID0gcG9zaXRpb24ueTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNwcml0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLnRyYW5zZm9ybS54ICs9IHhEaWZmICogKHRoaXMuc2l6ZSAtIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLnRyYW5zZm9ybS55ICs9IHlEaWZmICogKHRoaXMuc2l6ZSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBCbG9jay5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRldHJpcy5Qb3NpdGlvbih0aGlzLngsIHRoaXMueSk7XG4gICAgICAgIH07XG4gICAgICAgIEJsb2NrLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKGFuaW1hdGUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoYW5pbWF0ZSA9PT0gdm9pZCAwKSB7IGFuaW1hdGUgPSBmYWxzZTsgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc3ByaXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR3ZWVuID0gdGhpcy5zcHJpdGUuc3RhdGUuZ2FtZS50d2VlbnMuY3JlYXRlKHRoaXMuc3ByaXRlKTtcbiAgICAgICAgICAgICAgICAgICAgdHdlZW4udG8oeyBhbHBoYTogMCB9LCBUZXRyaXMuQ29uZmlnLmFuaW1hdGlvblRpbWUsIEtpd2kuQW5pbWF0aW9ucy5Ud2VlbnMuRWFzaW5nLkJvdW5jZS5JbiwgdHJ1ZSkub25Db21wbGV0ZShmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zcHJpdGUuZGVzdHJveSgpOyB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBCbG9jaztcbiAgICB9KSgpO1xuICAgIFRldHJpcy5CbG9jayA9IEJsb2NrO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9saWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9ibG9jay50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaGFwZShzdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vc3RhdHVzIGZvciByb3RhdGlvblxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUZXN0ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRQb3NpdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrcyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVPYmplY3QgPSBuZXcgS2l3aS5Hcm91cChzdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2FkZCBibG9jayBpbnRvIHRoZSBzaGFwZVxuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLmFkZEJsb2NrID0gZnVuY3Rpb24gKGJsb2NrQ29sb3IsIHgsIHksIGNlbnRlcikge1xuICAgICAgICAgICAgICAgIGlmIChjZW50ZXIgPT09IHZvaWQgMCkgeyBjZW50ZXIgPSBmYWxzZTsgfVxuICAgICAgICAgICAgICAgIHZhciBibG9jayA9IG5ldyBUZXRyaXMuQmxvY2soeCwgeSwgdGhpcy5zdGF0ZSwgdGhpcy5zdGF0ZS50ZXh0dXJlc1snYmxvY2stJyArIGJsb2NrQ29sb3JdKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5wdXNoKGJsb2NrKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVPYmplY3QuYWRkQ2hpbGQoYmxvY2suc3ByaXRlKTtcbiAgICAgICAgICAgICAgICBpZiAoY2VudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyID0gYmxvY2s7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5nZXRHYW1lT2JqZWN0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5nYW1lT2JqZWN0OyB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLmdldEJsb2NrcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuYmxvY2tzOyB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRCbG9ja3MoKS5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykgeyByZXR1cm4gYmxvY2suZGVzdHJveSgpOyB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL2dldCBibG9ja3MgcG9zaXRpb25cbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5nZXRQb3NpdGlvbnMgPSBmdW5jdGlvbiAoYmxvY2tzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrcyA9PT0gdm9pZCAwKSB7IGJsb2NrcyA9IHRoaXMuYmxvY2tzOyB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJsb2Nrcy5tYXAoZnVuY3Rpb24gKGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBibG9jay5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5mYWxsID0gZnVuY3Rpb24gKGFtb3VudE9mVGlsZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmIChhbW91bnRPZlRpbGVzID09PSB2b2lkIDApIHsgYW1vdW50T2ZUaWxlcyA9IDE7IH1cbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYmxvY2sgPT0gX3RoaXMuY2VudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBibG9jay5mYWxsKGFtb3VudE9mVGlsZXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyLmZhbGwoYW1vdW50T2ZUaWxlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLnNldEJ5UG9pbnRlclBvc2l0aW9uID0gZnVuY3Rpb24gKGRpc3RhbmNlRnJvbUNlbnRlcikge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2NrID09IF90aGlzLmNlbnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYmxvY2suc2V0UG9zaXRpb24obmV3IFRldHJpcy5Qb3NpdGlvbihibG9jay54ICsgZGlzdGFuY2VGcm9tQ2VudGVyLCBibG9jay55KSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jZW50ZXIuc2V0UG9zaXRpb24obmV3IFRldHJpcy5Qb3NpdGlvbih0aGlzLmNlbnRlci54ICsgZGlzdGFuY2VGcm9tQ2VudGVyLCB0aGlzLmNlbnRlci55KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbiAoc2lkZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2NrID09IF90aGlzLmNlbnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYmxvY2subW92ZShzaWRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmNlbnRlci5tb3ZlKHNpZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5nZXRSb3RhdGlvbnMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBTaGFwZS5yb3RhdGlvbnM7IH07XG4gICAgICAgICAgICBTaGFwZS5wcm90b3R5cGUuZ2V0TmV4dFJvdGF0aW9uID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBuZXh0UG9zaXRpb25zID0gW107XG4gICAgICAgICAgICAgICAgLy9pZiB3ZSBjaGVja2VkIGFsbCBwb3NzaWJpbGl0aWVzLCByZXR1cm4gbm90aGluZ1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRUZXN0ID09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGVzdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0UG9zaXRpb25zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcm90YXRpb25zID0gdGhpcy5nZXRSb3RhdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB2YXIgY2VudGVyWCA9IHRoaXMuY2VudGVyLng7XG4gICAgICAgICAgICAgICAgdmFyIGNlbnRlclkgPSB0aGlzLmNlbnRlci55O1xuICAgICAgICAgICAgICAgIHZhciB4TWFyZ2luID0gZGlyZWN0aW9uICogcm90YXRpb25zW3RoaXMuY3VycmVudFJvdGF0aW9uXVt0aGlzLmN1cnJlbnRUZXN0XVswXTtcbiAgICAgICAgICAgICAgICB2YXIgeU1hcmdpbiA9IGRpcmVjdGlvbiAqIHJvdGF0aW9uc1t0aGlzLmN1cnJlbnRSb3RhdGlvbl1bdGhpcy5jdXJyZW50VGVzdF1bMV07XG4gICAgICAgICAgICAgICAgLy9zZXQgY2VudGVyIHBvc2l0aW9ucywgc28gd2UgZG9uJ3QgbG9zZSBpdCBkdXJpbmcgcm90YXRpb25cbiAgICAgICAgICAgICAgICB2YXIgbmV4dENlbnRlciA9IG5ldyBUZXRyaXMuUG9zaXRpb24oY2VudGVyWCArIHhNYXJnaW4sIGNlbnRlclkgKyB5TWFyZ2luKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeERpZmYgPSBkaXJlY3Rpb24gKiAoYmxvY2sueCAtIGNlbnRlclgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgeURpZmYgPSBkaXJlY3Rpb24gKiAoYmxvY2sueSAtIGNlbnRlclkpO1xuICAgICAgICAgICAgICAgICAgICBuZXh0UG9zaXRpb25zLnB1c2gobmV3IFRldHJpcy5Qb3NpdGlvbihuZXh0Q2VudGVyLnggLSB5RGlmZiwgbmV4dENlbnRlci55ICsgeERpZmYpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRDZW50ZXIgPSBuZXh0Q2VudGVyO1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dFBvc2l0aW9ucyA9IG5leHRQb3NpdGlvbnM7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgLy9pbmNyZWF0ZSB0ZXN0IGFtb3VudFxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRlc3QrKztcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV4dFBvc2l0aW9ucztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBTaGFwZS5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgLy9pZiB3ZSB3YW50IHRvIHJhdGF0ZSB3aXRob3V0IGNoZWNraW5nXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLm5leHRDZW50ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXROZXh0Um90YXRpb24oMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyLnNldFBvc2l0aW9uKG5ldyBUZXRyaXMuUG9zaXRpb24odGhpcy5uZXh0Q2VudGVyLngsIHRoaXMubmV4dENlbnRlci55KSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2ssIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgYyBibG9jayBpcyBpbiBjZW50ZXIgcG9zaXRpb24sIGl0IGlzIGFscmVhZHkgc2V0XG4gICAgICAgICAgICAgICAgICAgIGlmIChibG9jayA9PSBfdGhpcy5jZW50ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLnNldFBvc2l0aW9uKG5ldyBUZXRyaXMuUG9zaXRpb24oX3RoaXMubmV4dFBvc2l0aW9uc1tpbmRleF0ueCwgX3RoaXMubmV4dFBvc2l0aW9uc1tpbmRleF0ueSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRlc3QgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uICs9IHRoaXMuZGlyZWN0aW9uO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRSb3RhdGlvbiA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFJvdGF0aW9uID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uID0gMztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9yb3RhdGlvbnMgZm9yIEogTCBUIFogUyBQaWVjZXNcbiAgICAgICAgICAgIFNoYXBlLnJvdGF0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICBbWzAsIDBdLCBbLTEsIDBdLCBbLTEsICsxXSwgWzAsIC0yXSwgWy0xLCAtMl1dLFxuICAgICAgICAgICAgICAgIFtbMCwgMF0sIFsrMSwgMF0sIFsrMSwgLTFdLCBbMCwgKzJdLCBbKzEsICsyXV0sXG4gICAgICAgICAgICAgICAgW1swLCAwXSwgWysxLCAwXSwgWysxLCArMV0sIFswLCAtMl0sIFsrMSwgLTJdXSxcbiAgICAgICAgICAgICAgICBbWzAsIDBdLCBbLTEsIDBdLCBbLTEsIC0xXSwgWzAsICsyXSwgWy0xLCArMl1dLFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHJldHVybiBTaGFwZTtcbiAgICAgICAgfSkoKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlID0gU2hhcGU7XG4gICAgfSkoU2hhcGVzID0gVGV0cmlzLlNoYXBlcyB8fCAoVGV0cmlzLlNoYXBlcyA9IHt9KSk7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNS0yMS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2xpYi9raXdpLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInNoYXBlLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBTaGFwZXM7XG4gICAgKGZ1bmN0aW9uIChTaGFwZXMpIHtcbiAgICAgICAgdmFyIFNoYXBlU3RhY2sgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gU2hhcGVTdGFjayhzdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vc2hhcGUgbmFtZXNcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgJ0knLFxuICAgICAgICAgICAgICAgICAgICAnSicsXG4gICAgICAgICAgICAgICAgICAgICdMJyxcbiAgICAgICAgICAgICAgICAgICAgJ08nLFxuICAgICAgICAgICAgICAgICAgICAnUycsXG4gICAgICAgICAgICAgICAgICAgICdUJyxcbiAgICAgICAgICAgICAgICAgICAgJ1onXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAvL3NoYXBlcyBhcnJheSB3YWl0aW5nIHRvIHNwYXduXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZVN0YWNrID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAYXV0aG9yIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNjI3NDMzOS9ob3ctY2FuLWktc2h1ZmZsZS1hbi1hcnJheS1pbi1qYXZhc2NyaXB0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIFNoYXBlU3RhY2suc2h1ZmZsZSA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gYXJyYXkubGVuZ3RoLCB0ZW1wLCBpbmRleDtcbiAgICAgICAgICAgICAgICAvLyBXaGlsZSB0aGVyZSBhcmUgZWxlbWVudHMgaW4gdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgd2hpbGUgKGNvdW50ZXIgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFBpY2sgYSByYW5kb20gaW5kZXhcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb3VudGVyKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gRGVjcmVhc2UgY291bnRlciBieSAxXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ZXItLTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQW5kIHN3YXAgdGhlIGxhc3QgZWxlbWVudCB3aXRoIGl0XG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSBhcnJheVtjb3VudGVyXTtcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlbY291bnRlcl0gPSBhcnJheVtpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGFycmF5W2luZGV4XSA9IHRlbXA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBTaGFwZVN0YWNrLnByb3RvdHlwZS5nZXROZXh0U2hhcGUgPSBmdW5jdGlvbiAocG9wKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvcCA9PT0gdm9pZCAwKSB7IHBvcCA9IGZhbHNlOyB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hhcGVTdGFjay5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wQXJyYXkgPSB0aGlzLnNoYXBlcy5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICAgICAgdGVtcEFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4KSB7IHJldHVybiB0ZW1wQXJyYXlbaW5kZXhdID0gJ1NoYXBlJyArIGVsZW1lbnQ7IH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXBlU3RhY2sgPSB0aGlzLnNoYXBlU3RhY2suY29uY2F0KFNoYXBlU3RhY2suc2h1ZmZsZSh0ZW1wQXJyYXkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvcCA/IHRoaXMuc2hhcGVTdGFjay5zaGlmdCgpIDogdGhpcy5zaGFwZVN0YWNrWzBdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlU3RhY2sucHJvdG90eXBlLmNyZWF0ZU5ld1NoYXBlID0gZnVuY3Rpb24gKGFkZFRvR2FtZSwgc2hhcGVOYW1lLCB4LCB5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGFkZFRvR2FtZSA9PT0gdm9pZCAwKSB7IGFkZFRvR2FtZSA9IGZhbHNlOyB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlTmFtZSA9PT0gdm9pZCAwKSB7IHNoYXBlTmFtZSA9ICcnOyB9XG4gICAgICAgICAgICAgICAgaWYgKHggPT09IHZvaWQgMCkgeyB4ID0gNDsgfVxuICAgICAgICAgICAgICAgIGlmICh5ID09PSB2b2lkIDApIHsgeSA9IDE7IH1cbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlTmFtZSA9IHRoaXMuZ2V0TmV4dFNoYXBlKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2hhcGUgPSBuZXcgU2hhcGVzW3NoYXBlTmFtZV0odGhpcy5zdGF0ZSwgeCwgeSk7XG4gICAgICAgICAgICAgICAgaWYgKGFkZFRvR2FtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmFkZENoaWxkKHNoYXBlLmdldEdhbWVPYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVTdGFjaztcbiAgICAgICAgfSkoKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlU3RhY2sgPSBTaGFwZVN0YWNrO1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9saWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJibG9jay50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgR2hvc3QgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBHaG9zdChzdGF0ZSwgcG9zaXRpb25zLCBsb3dlckJ5KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZU9iamVjdCA9IG5ldyBLaXdpLkdyb3VwKHN0YXRlKTtcbiAgICAgICAgICAgIHBvc2l0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBibG9jayA9IG5ldyBUZXRyaXMuQmxvY2socG9zaXRpb24ueCwgcG9zaXRpb24ueSArIGxvd2VyQnksIF90aGlzLnN0YXRlLCBfdGhpcy5zdGF0ZS50ZXh0dXJlc1snYmxvY2stZ2hvc3QnXSk7XG4gICAgICAgICAgICAgICAgX3RoaXMuYmxvY2tzLnB1c2goYmxvY2spO1xuICAgICAgICAgICAgICAgIF90aGlzLmdhbWVPYmplY3QuYWRkQ2hpbGQoYmxvY2suc3ByaXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIEdob3N0LnByb3RvdHlwZS5nZXRHYW1lT2JqZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2FtZU9iamVjdDtcbiAgICAgICAgfTtcbiAgICAgICAgR2hvc3QucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9ucywgbG93ZXJCeSkge1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2ssIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgYmxvY2suc2V0UG9zaXRpb24obmV3IFRldHJpcy5Qb3NpdGlvbihwb3NpdGlvbnNbaW5kZXhdLngsIHBvc2l0aW9uc1tpbmRleF0ueSArIGxvd2VyQnkpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gR2hvc3Q7XG4gICAgfSkoKTtcbiAgICBUZXRyaXMuR2hvc3QgPSBHaG9zdDtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9saWIvcmFtZGEuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic2hhcGVzL3NoYXBlLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJwb3NpdGlvbi50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vZW51bXMudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2NvbmZpZy50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgUiA9IHJlcXVpcmUoJ3JhbWRhJyk7XG4gICAgdmFyIEJvYXJkID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQm9hcmQoc3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodDtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGg7XG4gICAgICAgICAgICAvL2Jsb2NrcyBhcnJheSB0byBrZWVwIHRyYWNrIG9mIGJsb2NrcyBpbnNpZGUgZ2FtZVxuICAgICAgICAgICAgdGhpcy5ibG9ja3MgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaGlnaGVzdFBvc2l0aW9ucyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3NbaV0gPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy53aWR0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWdoZXN0UG9zaXRpb25zW2ldID0gbmV3IFRldHJpcy5Qb3NpdGlvbihpLCB0aGlzLmhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy9jaGVjayBpZiBnaXZlbiBwb3NpdGlvbnMgYXJlIGVtcHR5XG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5lbXB0eVBvc2l0aW9ucyA9IGZ1bmN0aW9uIChwb3NpdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gcG9zaXRpb25zLmZpbHRlcihmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9zaXRpb24ueCA8IDBcbiAgICAgICAgICAgICAgICAgICAgfHwgcG9zaXRpb24ueCA+IF90aGlzLndpZHRoIC0gMVxuICAgICAgICAgICAgICAgICAgICB8fCBwb3NpdGlvbi55ID4gX3RoaXMuaGVpZ2h0IC0gMVxuICAgICAgICAgICAgICAgICAgICB8fCBwb3NpdGlvbi55IDwgMFxuICAgICAgICAgICAgICAgICAgICB8fCBfdGhpcy5ibG9ja3NbcG9zaXRpb24ueV1bcG9zaXRpb24ueF0gIT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH0pLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgfTtcbiAgICAgICAgLy9jaGVjayBibG9ja3MgbmV4dCB0byBnaXZlbiBvbmVzIGFyZSBlbXB0eVxuICAgICAgICBCb2FyZC5wcm90b3R5cGUuZW1wdHlEaXJlY3Rpb24gPSBmdW5jdGlvbiAoYmxvY2tzLCBkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gYmxvY2tzLmZpbHRlcihmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGRpcmVjdGlvbiA9PT0gVGV0cmlzLkRpcmVjdGlvbi5Eb3duICYmIChibG9jay55ID09PSBfdGhpcy5oZWlnaHQgLSAxIHx8IF90aGlzLmJsb2Nrc1tibG9jay55ICsgMV1bYmxvY2sueF0gIT09IHVuZGVmaW5lZCkpXG4gICAgICAgICAgICAgICAgICAgIHx8IChkaXJlY3Rpb24gPT09IFRldHJpcy5EaXJlY3Rpb24uTGVmdCAmJiAoYmxvY2sueCA9PT0gMCB8fCBfdGhpcy5ibG9ja3NbYmxvY2sueV1bYmxvY2sueCAtIDFdICE9PSB1bmRlZmluZWQpKVxuICAgICAgICAgICAgICAgICAgICB8fCAoZGlyZWN0aW9uID09PSBUZXRyaXMuRGlyZWN0aW9uLlJpZ2h0ICYmIChibG9jay54ID09PSBfdGhpcy53aWR0aCAtIDEgfHwgX3RoaXMuYmxvY2tzW2Jsb2NrLnldW2Jsb2NrLnggKyAxXSAhPT0gdW5kZWZpbmVkKSk7XG4gICAgICAgICAgICB9KS5sZW5ndGggPT09IDA7XG4gICAgICAgIH07XG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5yZWZyZXNoSGlnaGVzdFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmhpZ2hlc3RQb3NpdGlvbnNbcG9zaXRpb24ueF0gPVxuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGVzdFBvc2l0aW9uc1twb3NpdGlvbi54XS5pc0xvd2VyKHBvc2l0aW9uKSA/IHBvc2l0aW9uIDogdGhpcy5oaWdoZXN0UG9zaXRpb25zW3Bvc2l0aW9uLnhdO1xuICAgICAgICB9O1xuICAgICAgICBCb2FyZC5wcm90b3R5cGUucmVmcmVzaEhpZ2hlc3RQb3NpdGlvbnMgPSBmdW5jdGlvbiAocG9zaXRpb25zKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHBvc2l0aW9ucyA9PT0gdm9pZCAwKSB7IHBvc2l0aW9ucyA9IFtdOyB9XG4gICAgICAgICAgICB0aGlzLmhpZ2hlc3RQb3NpdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaGlnaGVzdFBvc2l0aW9uLCBjb2x1bW4pIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5oaWdoZXN0UG9zaXRpb25zW2NvbHVtbl0ueSA9IF90aGlzLmhlaWdodDtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IHBvc2l0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKHBvc2l0aW9uKSB7IHJldHVybiBwb3NpdGlvbi54ID09IGNvbHVtbjsgfSkubWFwKGZ1bmN0aW9uIChwb3NpdGlvbikgeyByZXR1cm4gcG9zaXRpb24ueTsgfSlbMF07XG4gICAgICAgICAgICAgICAgZnJvbSA9IGZyb20gPyBmcm9tIDogMDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gZnJvbTsgaSA8IF90aGlzLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5ibG9ja3NbaV1bY29sdW1uXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaGlnaGVzdFBvc2l0aW9uc1tjb2x1bW5dLnkgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy9zZXQgc3RhdHVzIGZvciBibG9ja3NcbiAgICAgICAgQm9hcmQucHJvdG90eXBlLnNldEJsb2NrcyA9IGZ1bmN0aW9uIChibG9ja3MsIHN0YXR1cykge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IHZvaWQgMCkgeyBzdGF0dXMgPSBUZXRyaXMuQmxvY2tTdGF0dXMuVGFrZW47IH1cbiAgICAgICAgICAgIGJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgIF90aGlzLmJsb2Nrc1tibG9jay55XVtibG9jay54XSA9IHN0YXR1cyA9PT0gVGV0cmlzLkJsb2NrU3RhdHVzLlRha2VuID8gYmxvY2sgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gVGV0cmlzLkJsb2NrU3RhdHVzLlRha2VuKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hIaWdoZXN0UG9zaXRpb24oYmxvY2suZ2V0UG9zaXRpb24oKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgLy9jaGVjayBmb3Igcm93cyB0byBjbGVhciBhbmQgcmV0dXJuIGFtb3VudCBvZiBjbGVhcmVkIHJvd3NcbiAgICAgICAgQm9hcmQucHJvdG90eXBlLmNoZWNrUm93cyA9IGZ1bmN0aW9uIChibG9ja3MpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgcm93c1RvQ2xlYXIgPSB0aGlzLmdldFJvd3NUb0NsZWFyKGJsb2Nrcyk7XG4gICAgICAgICAgICBpZiAocm93c1RvQ2xlYXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJSb3dzKHJvd3NUb0NsZWFyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmdhbWUudGltZS5jbG9jay5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hZnRlciBjbGVhcmluZyB0aGUgcm93cywgbWFrZSBvdGhlciBibG9ja3MgZmFsbCBkb3duXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZhbGxCbG9ja3Mocm93c1RvQ2xlYXIpO1xuICAgICAgICAgICAgICAgICAgICAvL3JlZnJlc2ggaGlnaGVzdCBwb3NpdGlvbnMgYmVjYXVzZSBzb21lIHJvd3MgY2FuIGdldCBlbXB0eSBvciBzb21lIGdhcHMgY2FuIGhhcHBlblxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoSGlnaGVzdFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIFRldHJpcy5Db25maWcuYW5pbWF0aW9uVGltZSwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcm93c1RvQ2xlYXIubGVuZ3RoO1xuICAgICAgICB9O1xuICAgICAgICAvL2ZpbmQgZnVsbCByb3dzXG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5nZXRSb3dzVG9DbGVhciA9IGZ1bmN0aW9uIChibG9ja3MpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAvL25vIGR1cGxpY2F0ZXNcbiAgICAgICAgICAgIHZhciByb3dzVG9DbGVhciA9IFIudW5pcShibG9ja3NcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgIC8vb25seSBpZiBmdWxsIHJvdyAoYWxsIGJsb2NrcyBzZXQgYW5kIG5vbmUgb2YgdGhlbSBhcmUgdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHJldHVybiAoX3RoaXMuYmxvY2tzW2Jsb2NrLnldLmxlbmd0aCA9PT0gX3RoaXMud2lkdGggJiYgIVIuY29udGFpbnModW5kZWZpbmVkLCBfdGhpcy5ibG9ja3NbYmxvY2sueV0pKTtcbiAgICAgICAgICAgICAgICAvL29ubHkgcmV0dXJuIHJvd3NcbiAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAoYmxvY2spIHsgcmV0dXJuIGJsb2NrLnk7IH0pKTtcbiAgICAgICAgICAgIC8vcmV2ZXJzZSBzb3J0XG4gICAgICAgICAgICByZXR1cm4gUi5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIgLSBhO1xuICAgICAgICAgICAgfSwgcm93c1RvQ2xlYXIpO1xuICAgICAgICB9O1xuICAgICAgICBCb2FyZC5wcm90b3R5cGUuY2xlYXJSb3dzID0gZnVuY3Rpb24gKHJvd051bWJlcnMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByb3dOdW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKHJvd051bWJlcikge1xuICAgICAgICAgICAgICAgIC8vZGVzdHJveSBhbGwgYmxvY2tzIGluIHJvd1xuICAgICAgICAgICAgICAgIF90aGlzLmJsb2Nrc1tyb3dOdW1iZXJdLmZvckVhY2goZnVuY3Rpb24gKGJsb2NrKSB7IHJldHVybiBibG9jay5kZXN0cm95KHRydWUpOyB9KTtcbiAgICAgICAgICAgICAgICAvL3NldCBhbGwgcm93IGVtcHR5XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0QmxvY2tzKF90aGlzLmJsb2Nrc1tyb3dOdW1iZXJdLCBUZXRyaXMuQmxvY2tTdGF0dXMuRW1wdHkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5mYWxsQmxvY2tzID0gZnVuY3Rpb24gKHJvd3NUb0ZhbGwpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByb3dzVG9GYWxsLmZvckVhY2goZnVuY3Rpb24gKGZyb21Sb3csIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvd2VyQnkgPSBpbmRleCArIDE7XG4gICAgICAgICAgICAgICAgLy90aWxsIHdoYXQgcm93IHRvIGNsZWFyXG4gICAgICAgICAgICAgICAgdmFyIHRvUm93ID0gcm93c1RvRmFsbFtsb3dlckJ5XSA/IHJvd3NUb0ZhbGxbbG93ZXJCeV0gOiAwO1xuICAgICAgICAgICAgICAgIC8vZmxhdHRlbiBhcnJheXMgaW50byBvbmUgdHlwZXNjcmlwdCBjb21waWxhdG9yIGlzIHNjcmV3aW5nIGluIHRoaXMgcGxhY2UuLlxuICAgICAgICAgICAgICAgIHZhciBibG9ja3NUb0ZhbGwgPSBSLmZsYXR0ZW4oXG4gICAgICAgICAgICAgICAgLy9jaGVjayBmcm9tIGJvdHRvbSB0byB0b3BcbiAgICAgICAgICAgICAgICBSLnJldmVyc2UoXG4gICAgICAgICAgICAgICAgLy9nZXQgYWxsIHJvd3MgYmV0d2VlbiBoaWdoZXN0IGFuZCBsb3dlc3RcbiAgICAgICAgICAgICAgICBfdGhpcy5ibG9ja3MuZmlsdGVyKGZ1bmN0aW9uIChibG9ja3MsIHJvdykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93IDw9IGZyb21Sb3cgJiYgcm93ID49IHRvUm93O1xuICAgICAgICAgICAgICAgIH0pKSkuZmlsdGVyKGZ1bmN0aW9uIChibG9jaykgeyByZXR1cm4gYmxvY2sgIT09IHVuZGVmaW5lZDsgfSk7XG4gICAgICAgICAgICAgICAgLy9maXJzdCBnZXQgYWxsIHJvd3Mgd2hpY2ggbmVlZCB0byBiZSBjaGVja2VkLCByZXZlcnNlIHRoZW0gKHNvIHdlIHdvdWxkbnQgb3ZlcndyaXRlIGJsb2NrcyBpbiBib2FyZCksIHRoZW4gZ2V0IGFsbCBibG9ja3MgaW4gdGhlbSBhbmQgZG8gbWFrZSB0aGVtIGdvIGRvd25cbiAgICAgICAgICAgICAgICBibG9ja3NUb0ZhbGwuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0QmxvY2tzKFtibG9ja10sIFRldHJpcy5CbG9ja1N0YXR1cy5FbXB0eSk7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLnNldFBvc2l0aW9uKG5ldyBUZXRyaXMuUG9zaXRpb24oYmxvY2sueCwgYmxvY2sueSArIGxvd2VyQnkpKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0QmxvY2tzKFtibG9ja10sIFRldHJpcy5CbG9ja1N0YXR1cy5UYWtlbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy9yZXR1cm4gbnVtYmVyIG9mIHJvd3MgdG8gZmFsbFxuICAgICAgICBCb2FyZC5wcm90b3R5cGUuZmluZERpc3RhbmNlVG9GYWxsID0gZnVuY3Rpb24gKHBvc2l0aW9ucykge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEhpZ2hlc3RQb3NpdGlvbnMocG9zaXRpb25zKTtcbiAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbnMucmVkdWNlKGZ1bmN0aW9uIChyb3dzVG9GYWxsLCBwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IE1hdGguc3FydChNYXRoLnBvdyhfdGhpcy5oaWdoZXN0UG9zaXRpb25zW3Bvc2l0aW9uLnhdLnkgLSBwb3NpdGlvbi55LCAyKSkgLSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiBkaXN0YW5jZSA8IHJvd3NUb0ZhbGwgPyBkaXN0YW5jZSA6IHJvd3NUb0ZhbGw7XG4gICAgICAgICAgICB9LCB0aGlzLmhlaWdodCk7XG4gICAgICAgIH07XG4gICAgICAgIC8vZmluZCBob3cgbXVjaCBjZW50ZXIgcG9zaXRpb24gY2FuIG1vdmUgKHVzZWQgd2l0aCBwb2ludGVyIHRvIGNoZWNrIGZvciB3YWxscylcbiAgICAgICAgQm9hcmQucHJvdG90eXBlLmZpbmRWYWxpZFBvc2l0aW9uID0gZnVuY3Rpb24gKGRpc3RhbmNlRnJvbUNlbnRlciwgcG9zaXRpb25zKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKGRpc3RhbmNlRnJvbUNlbnRlciA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9ucy5yZWR1Y2UoZnVuY3Rpb24gKHByZXZpb3VzRWxlbWVudCwgY3VycmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3UG9zaXRpb24gPSBjdXJyZW50RWxlbWVudC54ICsgZGlzdGFuY2VGcm9tQ2VudGVyO1xuICAgICAgICAgICAgICAgIHZhciBuZXdEaXN0YW5jZUZyb21DZW50ZXIgPSBkaXN0YW5jZUZyb21DZW50ZXI7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1Bvc2l0aW9uIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdEaXN0YW5jZUZyb21DZW50ZXIgPSBkaXN0YW5jZUZyb21DZW50ZXIgLSBuZXdQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5ld1Bvc2l0aW9uID4gOCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhuZXdQb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuZXdQb3NpdGlvbiA+IF90aGlzLndpZHRoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdEaXN0YW5jZUZyb21DZW50ZXIgPSBkaXN0YW5jZUZyb21DZW50ZXIgLSAobmV3UG9zaXRpb24gLSAoX3RoaXMud2lkdGggLSAxKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmFicyhuZXdEaXN0YW5jZUZyb21DZW50ZXIpIDwgTWF0aC5hYnMocHJldmlvdXNFbGVtZW50KSA/IG5ld0Rpc3RhbmNlRnJvbUNlbnRlciA6IHByZXZpb3VzRWxlbWVudDtcbiAgICAgICAgICAgIH0sIGRpc3RhbmNlRnJvbUNlbnRlcik7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBCb2FyZDtcbiAgICB9KSgpO1xuICAgIFRldHJpcy5Cb2FyZCA9IEJvYXJkO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDctMDUuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJsaWIva2l3aS5kLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBTY29yaW5nTWFuYWdlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFNjb3JpbmdNYW5hZ2VyKGxldmVsKSB7XG4gICAgICAgICAgICBpZiAobGV2ZWwgPT09IHZvaWQgMCkgeyBsZXZlbCA9IDE7IH1cbiAgICAgICAgICAgIHRoaXMuc2NvcmUgPSAwO1xuICAgICAgICAgICAgdGhpcy5sZXZlbCA9IDE7XG4gICAgICAgICAgICB0aGlzLnJvd3NDbGVhcmVkID0gMDtcbiAgICAgICAgICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcbiAgICAgICAgfVxuICAgICAgICBTY29yaW5nTWFuYWdlci5wcm90b3R5cGUuY2hlY2tMZXZlbCA9IGZ1bmN0aW9uIChyb3dzQ2xlYXJlZCkge1xuICAgICAgICAgICAgdGhpcy5yb3dzQ2xlYXJlZCArPSByb3dzQ2xlYXJlZDtcbiAgICAgICAgICAgIGlmICh0aGlzLnJvd3NDbGVhcmVkID4gdGhpcy5sZXZlbCAqIDEwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sZXZlbCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBTY29yaW5nTWFuYWdlci5wcm90b3R5cGUuZ2V0SW5mbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc2NvcmU6IHRoaXMuc2NvcmUsXG4gICAgICAgICAgICAgICAgbGV2ZWw6IHRoaXMubGV2ZWwsXG4gICAgICAgICAgICAgICAgbGluZXM6IHRoaXMucm93c0NsZWFyZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIFNjb3JpbmdNYW5hZ2VyLnByb3RvdHlwZS5nZXRGYWxsaW5nRGVsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbGV2ZWwgPSB0aGlzLmxldmVsIDwgMTAgPyB0aGlzLmxldmVsIDogMTA7XG4gICAgICAgICAgICByZXR1cm4gKDExIC0gbGV2ZWwpICogMC4wNTtcbiAgICAgICAgfTtcbiAgICAgICAgU2NvcmluZ01hbmFnZXIucHJvdG90eXBlLmFkZFJvd3NDbGVhcmVkID0gZnVuY3Rpb24gKHJvd3NDbGVhcmVkKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHJvd3NDbGVhcmVkKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlICs9IDQwICogdGhpcy5sZXZlbDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlICs9IDEwMCAqIHRoaXMubGV2ZWw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29yZSArPSAzMDAgKiB0aGlzLmxldmVsO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NvcmUgKz0gMTIwMCAqIHRoaXMubGV2ZWw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2hlY2tMZXZlbChyb3dzQ2xlYXJlZCk7XG4gICAgICAgIH07XG4gICAgICAgIFNjb3JpbmdNYW5hZ2VyLnByb3RvdHlwZS5hZGRTb2Z0RHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcmUrKztcbiAgICAgICAgfTtcbiAgICAgICAgU2NvcmluZ01hbmFnZXIucHJvdG90eXBlLmFkZEhhcmREcm9wID0gZnVuY3Rpb24gKGFtb3VudE9mUm93cykge1xuICAgICAgICAgICAgdGhpcy5zY29yZSArPSAyICogYW1vdW50T2ZSb3dzO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gU2NvcmluZ01hbmFnZXI7XG4gICAgfSkoKTtcbiAgICBUZXRyaXMuU2NvcmluZ01hbmFnZXIgPSBTY29yaW5nTWFuYWdlcjtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA3LTA1LlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiZ2FtZS1vYmplY3RzL3NoYXBlcy9zaGFwZS50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibGliL2tpd2kuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiY29uZmlnLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzY29yaW5nLW1hbmFnZXIudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIEh1ZCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEh1ZChzdGF0ZSwgc2NvcmluZ01hbmFnZXIsIGxldmVsLCBzY29yZSwgbGluZXMpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgICAgIHRoaXMubGV2ZWxPYmplY3QgPSBsZXZlbDtcbiAgICAgICAgICAgIHRoaXMuc2NvcmVPYmplY3QgPSBzY29yZTtcbiAgICAgICAgICAgIHRoaXMubGluZXNPYmplY3QgPSBsaW5lcztcbiAgICAgICAgICAgIHRoaXMuc2NvcmluZ01hbmFnZXIgPSBzY29yaW5nTWFuYWdlcjtcbiAgICAgICAgfVxuICAgICAgICBIdWQucHJvdG90eXBlLnVwZGF0ZVNjb3JlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGluZm8gPSB0aGlzLnNjb3JpbmdNYW5hZ2VyLmdldEluZm8oKTtcbiAgICAgICAgICAgIHRoaXMuc2NvcmVPYmplY3QudGV4dCA9IGluZm8uc2NvcmUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMubGV2ZWxPYmplY3QudGV4dCA9IGluZm8ubGV2ZWwudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMubGluZXNPYmplY3QudGV4dCA9IGluZm8ubGluZXMudG9TdHJpbmcoKTtcbiAgICAgICAgfTtcbiAgICAgICAgSHVkLnNldFVwU3ByaXRlID0gZnVuY3Rpb24gKHNoYXBlLCBzaGFwZU5hbWUsIG1hcmdpblgsIG1hcmdpblkpIHtcbiAgICAgICAgICAgIHZhciBnYW1lT2JqZWN0ID0gc2hhcGUuZ2V0R2FtZU9iamVjdCgpO1xuICAgICAgICAgICAgaWYgKHNoYXBlTmFtZSA9PSAnU2hhcGVJJykge1xuICAgICAgICAgICAgICAgIHNoYXBlLnJvdGF0ZSgpLnJvdGF0ZSgpO1xuICAgICAgICAgICAgICAgIG1hcmdpblggLT0gMjA7XG4gICAgICAgICAgICAgICAgbWFyZ2luWSAtPSAxNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzaGFwZU5hbWUgPT0gJ1NoYXBlTycpIHtcbiAgICAgICAgICAgICAgICBtYXJnaW5YIC09IDEwO1xuICAgICAgICAgICAgICAgIG1hcmdpblkgKz0gNDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdhbWVPYmplY3QueSA9IG1hcmdpblk7XG4gICAgICAgICAgICBnYW1lT2JqZWN0LnggPSBtYXJnaW5YO1xuICAgICAgICAgICAgZ2FtZU9iamVjdC5zY2FsZSA9IDAuNztcbiAgICAgICAgICAgIGdhbWVPYmplY3QuZ2V0QWxsQ2hpbGRyZW4oKS5mb3JFYWNoKGZ1bmN0aW9uIChzcHJpdGUpIHtcbiAgICAgICAgICAgICAgICBzcHJpdGUuYWxwaGEgPSAwO1xuICAgICAgICAgICAgICAgIHZhciB0d2VlbiA9IHNwcml0ZS5zdGF0ZS5nYW1lLnR3ZWVucy5jcmVhdGUoc3ByaXRlKTtcbiAgICAgICAgICAgICAgICB0d2Vlbi50byh7IGFscGhhOiAxIH0sIFRldHJpcy5Db25maWcuYW5pbWF0aW9uVGltZSwgS2l3aS5BbmltYXRpb25zLlR3ZWVucy5FYXNpbmcuU2ludXNvaWRhbC5JbiwgdHJ1ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBnYW1lT2JqZWN0O1xuICAgICAgICB9O1xuICAgICAgICBIdWQucHJvdG90eXBlLnNldE5leHRTaGFwZSA9IGZ1bmN0aW9uIChzaGFwZU5hbWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5leHRTaGFwZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dFNoYXBlLmdldEdhbWVPYmplY3QoKS5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5leHRTaGFwZSA9IG5ldyBUZXRyaXMuU2hhcGVzW3NoYXBlTmFtZV0odGhpcy5zdGF0ZSwgMCwgMCk7XG4gICAgICAgICAgICBpZiAoc2hhcGVOYW1lID09ICdTaGFwZUknKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0U2hhcGUucm90YXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0U2hhcGUucm90YXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmFkZENoaWxkKEh1ZC5zZXRVcFNwcml0ZSh0aGlzLm5leHRTaGFwZSwgc2hhcGVOYW1lLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAtIDYsIDI4NSkpO1xuICAgICAgICB9O1xuICAgICAgICBIdWQucHJvdG90eXBlLnNldEhlbGRTaGFwZSA9IGZ1bmN0aW9uIChzaGFwZU5hbWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhlbGRTaGFwZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGVsZFNoYXBlLmdldEdhbWVPYmplY3QoKS5kZXN0cm95KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmhlbGRTaGFwZSA9IG5ldyBUZXRyaXMuU2hhcGVzW3NoYXBlTmFtZV0odGhpcy5zdGF0ZSwgMCwgMCk7XG4gICAgICAgICAgICBpZiAoc2hhcGVOYW1lID09ICdTaGFwZUknKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWxkU2hhcGUucm90YXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWxkU2hhcGUucm90YXRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmFkZENoaWxkKEh1ZC5zZXRVcFNwcml0ZSh0aGlzLmhlbGRTaGFwZSwgc2hhcGVOYW1lLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAtIDYsIDQzNSkpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSHVkO1xuICAgIH0pKCk7XG4gICAgVGV0cmlzLkh1ZCA9IEh1ZDtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA0LTIwLlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vbGliL2tpd2kuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vZ2FtZS1vYmplY3RzL3NoYXBlcy9zaGFwZS50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vZ2FtZS1vYmplY3RzL3NoYXBlcy9zaGFwZS1zdGFjay50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vZ2FtZS1vYmplY3RzL2dob3N0LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9nYW1lLW9iamVjdHMvYm9hcmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2VudW1zLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9jb25maWcudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2h1ZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vc2NvcmluZy1tYW5hZ2VyLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBNYWluU3RhdGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoTWFpblN0YXRlLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBNYWluU3RhdGUoKSB7XG4gICAgICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHRoaXMuaG9sZEtleUlzRG93biA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5jYW5Ib2xkID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vTW92aW5nIHRvIGxlZnQgYW5kIHJpZ2h0XG4gICAgICAgICAgICB0aGlzLm1vdmVLZXlJc0Rvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlS2V5SXNEb3duID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnJvdGF0aW9uRGlyZWN0aW9uID0gMDtcbiAgICAgICAgICAgIC8vZHJvcHBpbmdcbiAgICAgICAgICAgIHRoaXMuZHJvcHBpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMubGFzdE1vdXNlUG9zaXRpb24gPSAtMTtcbiAgICAgICAgICAgIHRoaXMudXNlc1NjcmVlbkNvbnRyb2xzID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnNTdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICAvL2Jsb2NrIGNvbG9ycyBmb3Igc3ByaXRlIGxvYWRpbmdcbiAgICAgICAgICAgIHRoaXMuYmxvY2tzID0gW1xuICAgICAgICAgICAgICAgICdibHVlJyxcbiAgICAgICAgICAgICAgICAnY3lhbicsXG4gICAgICAgICAgICAgICAgJ2dyZWVuJyxcbiAgICAgICAgICAgICAgICAnb3JhbmdlJyxcbiAgICAgICAgICAgICAgICAncHVycGxlJyxcbiAgICAgICAgICAgICAgICAncmVkJyxcbiAgICAgICAgICAgICAgICAneWVsbG93J1xuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLnByZWxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5wcmVsb2FkLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmFkZEltYWdlKCdib2FyZCcsICdhc3NldHMvaW1nL2JvYXJkLnBuZycpO1xuICAgICAgICAgICAgdGhpcy5hZGRJbWFnZSgnYm9yZGVycycsICdhc3NldHMvaW1nL2JvcmRlcnMucG5nJyk7XG4gICAgICAgICAgICB0aGlzLmFkZEltYWdlKCdodWRCb3JkZXJzJywgJ2Fzc2V0cy9pbWcvaHVkLWJvcmRlcnMucG5nJyk7XG4gICAgICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uIChjb2xvcikgeyByZXR1cm4gX3RoaXMuYWRkSW1hZ2UoJ2Jsb2NrLScgKyBjb2xvciwgJ2Fzc2V0cy9pbWcvYmxvY2stJyArIGNvbG9yICsgJy5wbmcnKTsgfSk7XG4gICAgICAgICAgICB0aGlzLmFkZEltYWdlKCdibG9jay1naG9zdCcsICdhc3NldHMvaW1nL2Jsb2NrLWdob3N0LnBuZycpO1xuICAgICAgICAgICAgdGhpcy5hZGRTcHJpdGVTaGVldCgnY29udHJvbEFycm93JywgJ2Fzc2V0cy9pbWcvY29udHJvbC1hcnJvdy5wbmcnLCA1MSwgNzMpO1xuICAgICAgICAgICAgdGhpcy5hZGRTcHJpdGVTaGVldCgnY29udHJvbEJ1dHRvbicsICdhc3NldHMvaW1nL2NvbnRyb2wtYnV0dG9uLnBuZycsIDEwMCwgMTAwKTtcbiAgICAgICAgfTtcbiAgICAgICAgTWFpblN0YXRlLnByb3RvdHlwZS5tb3ZlQ29udHJvbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5ib2FyZFNwcml0ZS5pbnB1dC53aXRoaW5Cb3VuZHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZXNTY3JlZW5Db250cm9scyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIHBvaW50ZXJQb3NpdGlvbiA9IE1hdGgudHJ1bmMoKHRoaXMuZ2FtZS5pbnB1dC54IC0gVGV0cmlzLkNvbmZpZy5vZmZzZXRYIC0gVGV0cmlzLkNvbmZpZy5ib3JkZXJXaWR0aCkgLyAoVGV0cmlzLkNvbmZpZy50aWxlU2l6ZSAtIDEpKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5sYXN0TW91c2VQb3NpdGlvbiAhPT0gcG9pbnRlclBvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZUZyb21DZW50ZXIgPSBNYXRoLnJvdW5kKHBvaW50ZXJQb3NpdGlvbiAtIHRoaXMuY3VycmVudFNoYXBlLmNlbnRlci54KSAtIDE7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdwcDogJyArIHBvaW50ZXJQb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTaGFwZS5jdXJyZW50Um90YXRpb24gPT0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2VGcm9tQ2VudGVyKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RmYzogJyArIGRpc3RhbmNlRnJvbUNlbnRlcik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGVja2VkQ2VudGVyUG9zaXRpb24gPSB0aGlzLmJvYXJkLmZpbmRWYWxpZFBvc2l0aW9uKGRpc3RhbmNlRnJvbUNlbnRlciwgdGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCkpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2NQOiAnICsgY2hlY2tlZENlbnRlclBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0TW91c2VQb3NpdGlvbiA9IHBvaW50ZXJQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U2hhcGUuc2V0QnlQb2ludGVyUG9zaXRpb24oY2hlY2tlZENlbnRlclBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5naG9zdC5zZXRQb3NpdGlvbih0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSwgdGhpcy5ib2FyZC5maW5kRGlzdGFuY2VUb0ZhbGwodGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCkpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXNlc1NjcmVlbkNvbnRyb2xzID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbGVmdCA9IHRoaXMubGVmdEtleS5pc0Rvd24gfHwgdGhpcy5sZWZ0S2V5U2NyZWVuLmlzRG93bjtcbiAgICAgICAgICAgIHZhciByaWdodCA9IHRoaXMucmlnaHRLZXkuaXNEb3duIHx8IHRoaXMucmlnaHRLZXlTY3JlZW4uaXNEb3duO1xuICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IHJpZ2h0ID8gVGV0cmlzLkRpcmVjdGlvbi5SaWdodCA6IFRldHJpcy5EaXJlY3Rpb24uTGVmdDtcbiAgICAgICAgICAgIGlmICgobGVmdCB8fCByaWdodCkgJiYgIXRoaXMubW92ZUtleUlzRG93biAmJiB0aGlzLmJvYXJkLmVtcHR5RGlyZWN0aW9uKHRoaXMuY3VycmVudFNoYXBlLmdldEJsb2NrcygpLCBkaXJlY3Rpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlS2V5SXNEb3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTaGFwZS5tb3ZlKGRpcmVjdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5naG9zdC5zZXRQb3NpdGlvbih0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSwgdGhpcy5ib2FyZC5maW5kRGlzdGFuY2VUb0ZhbGwodGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCkpKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVUaW1lci5zdGFydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLnJvdGF0ZSA9IGZ1bmN0aW9uIChkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIHZhciBwb3NpdGlvbnMgPSB0aGlzLmN1cnJlbnRTaGFwZS5nZXROZXh0Um90YXRpb24oZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIHZhciByb3RhdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB3aGlsZSAocG9zaXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ib2FyZC5lbXB0eVBvc2l0aW9ucyhwb3NpdGlvbnMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvdGF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTaGFwZS5yb3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5naG9zdC5zZXRQb3NpdGlvbih0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSwgdGhpcy5ib2FyZC5maW5kRGlzdGFuY2VUb0ZhbGwodGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCkpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyb3RhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwb3NpdGlvbnMgPSB0aGlzLmN1cnJlbnRTaGFwZS5nZXROZXh0Um90YXRpb24oZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByb3RhdGVkO1xuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLmFmdGVyU2hhcGVMYW5kZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnNTdGFydGVkID0gZmFsc2U7XG4gICAgICAgICAgICAvL2NyZWF0ZSBlbXB0eSBzaGFwZVxuICAgICAgICAgICAgdGhpcy5jcmVhdGVOZXdTaGFwZSgpO1xuICAgICAgICAgICAgLy9pZiB3ZSBjYW4gY3JlYXRlIHNoYXBlIGFkZCBpdCBpbnRvIHRoZSBnYW1lXG4gICAgICAgICAgICBpZiAodGhpcy5ib2FyZC5lbXB0eVBvc2l0aW9ucyh0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSkpIHtcbiAgICAgICAgICAgICAgICAvL2FsbG93IHRvIGhvbGQgc2hhcGUgYWdhaW5cbiAgICAgICAgICAgICAgICB0aGlzLmNhbkhvbGQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5jdXJyZW50U2hhcGUuZ2V0R2FtZU9iamVjdCgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmh1ZC5zZXROZXh0U2hhcGUodGhpcy5zaGFwZVN0YWNrLmdldE5leHRTaGFwZSgpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdob3N0LnNldFBvc2l0aW9uKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpLCB0aGlzLmJvYXJkLmZpbmREaXN0YW5jZVRvRmFsbCh0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZXMuc3dpdGNoU3RhdGUoJ2dhbWVPdmVyJywgbnVsbCwgbnVsbCwgdGhpcy5zY29yaW5nTWFuYWdlci5nZXRJbmZvKCkpO1xuICAgICAgICB9O1xuICAgICAgICAvL2Ryb3AgZG93biBldmVudFxuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLmZhbGxEb3duID0gZnVuY3Rpb24gKGFtb3VudE9mVGlsZXMsIGZvcmNlQ2hlY2spIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoYW1vdW50T2ZUaWxlcyA9PT0gdm9pZCAwKSB7IGFtb3VudE9mVGlsZXMgPSAxOyB9XG4gICAgICAgICAgICBpZiAoZm9yY2VDaGVjayA9PT0gdm9pZCAwKSB7IGZvcmNlQ2hlY2sgPSBmYWxzZTsgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uc1N0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3RyeSB0byBmYWxsIGRvd25cbiAgICAgICAgICAgIC8vYW1vdW50IG9mIFRpbGVzIHNwZWNpZmllZCBtdXN0IGJlIGVtcHR5LCBiZWNhdXNlIGhlcmUgSSBkb24ndCBjaGVjayB0aWxlcyBiZWxvd1xuICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmQuZW1wdHlEaXJlY3Rpb24odGhpcy5jdXJyZW50U2hhcGUuZ2V0QmxvY2tzKCksIFRldHJpcy5EaXJlY3Rpb24uRG93bikpIHtcbiAgICAgICAgICAgICAgICAvL2lmIHNvZnQgZHJvcCBpcyBiZWluZyBkb25lLCBhZGQgc2NvcmVcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mYWxsVGltZXIuZGVsYXkgPT09IDAuMDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29yaW5nTWFuYWdlci5hZGRTb2Z0RHJvcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTaGFwZS5mYWxsKGFtb3VudE9mVGlsZXMpO1xuICAgICAgICAgICAgICAgIGlmICghZm9yY2VDaGVjaykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9pZiBzaGFwZSBjYW4ndCBmYWxsIGRvd24sIHNldCBibG9ja3MgaW50byBib2FyZCBhbmQgY3JlYXRlIG5ldyBzaGFwZSB1bmxlc3MgaXQgaXMgZ2dcbiAgICAgICAgICAgIC8vc2V0IGJsb2NrcyBhcyB1c2VkLCBzaW5jZSB3ZSBhcmUgY3JlYXRpbmcgbmV3IHNoYXBlXG4gICAgICAgICAgICB0aGlzLmJvYXJkLnNldEJsb2Nrcyh0aGlzLmN1cnJlbnRTaGFwZS5nZXRCbG9ja3MoKSwgVGV0cmlzLkJsb2NrU3RhdHVzLlRha2VuKTtcbiAgICAgICAgICAgIC8vLy90cnkgdG8gY2xlYXIgdGhlIHJvd3MgaW4gd2hpY2ggYmxvY2tzIGV4aXN0XG4gICAgICAgICAgICB2YXIgcm93c0NsZWFyZWQgPSB0aGlzLmJvYXJkLmNoZWNrUm93cyh0aGlzLmN1cnJlbnRTaGFwZS5nZXRCbG9ja3MoKSk7XG4gICAgICAgICAgICB0aGlzLnNjb3JpbmdNYW5hZ2VyLmFkZFJvd3NDbGVhcmVkKHJvd3NDbGVhcmVkKTtcbiAgICAgICAgICAgIGlmIChyb3dzQ2xlYXJlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1N0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS50aW1lLmNsb2NrLnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5hZnRlclNoYXBlTGFuZGVkKCk7XG4gICAgICAgICAgICAgICAgfSwgVGV0cmlzLkNvbmZpZy5hbmltYXRpb25UaW1lLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYWZ0ZXJTaGFwZUxhbmRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLnJvdGF0aW9uQ29udHJvbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL3JvdGF0aW9uIGNvbnRyb2xzXG4gICAgICAgICAgICBpZiAodGhpcy5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlS2V5LmlzRG93biB8fCB0aGlzLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2VTY3JlZW4uaXNEb3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9IFRldHJpcy5EaXJlY3Rpb24uTGVmdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucm90YXRlQ2xvY2t3aXNlS2V5LmlzRG93biB8fCB0aGlzLnJvdGF0ZUNsb2Nrd2lzZVNjcmVlbi5pc0Rvd24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvdGF0aW9uRGlyZWN0aW9uID0gVGV0cmlzLkRpcmVjdGlvbi5SaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucm90YXRlQm90aEtleS5pc0Rvd24gfHwgdGhpcy5yb3RhdGVCb3RoU2NyZWVuLmlzRG93biB8fCB0aGlzLmJvYXJkU3ByaXRlLmlucHV0LmlzRG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMucm90YXRpb25EaXJlY3Rpb24gPSBUZXRyaXMuRGlyZWN0aW9uLlVwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucm90YXRpb25EaXJlY3Rpb24gIT09IDAgJiYgIXRoaXMucm90YXRlS2V5SXNEb3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGVLZXlJc0Rvd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vdHJ5IHRvIHJvdGF0ZSBib3RoIHRvIHJpZ2h0IGFuZCBsZWZ0XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm90YXRpb25EaXJlY3Rpb24gPT0gVGV0cmlzLkRpcmVjdGlvbi5VcCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucm90YXRlKFRldHJpcy5EaXJlY3Rpb24uUmlnaHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvdGF0ZShUZXRyaXMuRGlyZWN0aW9uLkxlZnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvdGF0ZSh0aGlzLnJvdGF0aW9uRGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3Jlc2V0IHJvdGF0aW9uIGNvbnRyb2xzXG4gICAgICAgICAgICBpZiAoKHRoaXMucm90YXRpb25EaXJlY3Rpb24gPT0gVGV0cmlzLkRpcmVjdGlvbi5SaWdodCAmJiAodGhpcy5yb3RhdGVDbG9ja3dpc2VLZXkuaXNVcCAmJiB0aGlzLnJvdGF0ZUNsb2Nrd2lzZVNjcmVlbi5pc1VwKSlcbiAgICAgICAgICAgICAgICB8fCAodGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9PSBUZXRyaXMuRGlyZWN0aW9uLkxlZnQgJiYgKHRoaXMucm90YXRlQ291bnRlckNsb2Nrd2lzZUtleS5pc1VwICYmIHRoaXMucm90YXRlQ291bnRlckNsb2Nrd2lzZVNjcmVlbi5pc1VwKSlcbiAgICAgICAgICAgICAgICB8fCAodGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9PSBUZXRyaXMuRGlyZWN0aW9uLlVwICYmICh0aGlzLnJvdGF0ZUJvdGhLZXkuaXNVcCAmJiB0aGlzLnJvdGF0ZUJvdGhTY3JlZW4uaXNVcCAmJiB0aGlzLmJvYXJkU3ByaXRlLmlucHV0LmlzVXApKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucm90YXRlS2V5SXNEb3duID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE1haW5TdGF0ZS5wcm90b3R5cGUuZHJvcERvd25Db250cm9scyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICgodGhpcy5oYXJkRHJvcEtleS5pc0Rvd24gfHwgdGhpcy5oYXJkRHJvcFNjcmVlbi5pc0Rvd24pICYmICF0aGlzLmRyb3BwaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcm9wcGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIGFtb3VudE9mUm93cyA9IHRoaXMuYm9hcmQuZmluZERpc3RhbmNlVG9GYWxsKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZhbGxEb3duKGFtb3VudE9mUm93cywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zY29yaW5nTWFuYWdlci5hZGRIYXJkRHJvcChhbW91bnRPZlJvd3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGFyZERyb3BLZXkuaXNVcCAmJiB0aGlzLmhhcmREcm9wU2NyZWVuLmlzVXAgJiYgdGhpcy5kcm9wcGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuZHJvcHBpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWFpblN0YXRlLnByb3RvdHlwZS5mYWxsVGltZXJDb250cm9scyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZmFsbFRpbWVyLmRlbGF5ID0gdGhpcy5zY29yaW5nTWFuYWdlci5nZXRGYWxsaW5nRGVsYXkoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNvZnREcm9wS2V5LmlzRG93biB8fCB0aGlzLnNvZnREcm9wU2NyZWVuLmlzRG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMuZmFsbFRpbWVyLmRlbGF5ID0gMC4wMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWFpblN0YXRlLnByb3RvdHlwZS5ob2xkQ29udHJvbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoKHRoaXMuaG9sZEtleS5pc0Rvd24gfHwgdGhpcy5ob2xkU3ByaXRlLmlucHV0LmlzRG93bikgJiYgIXRoaXMuaG9sZEtleUlzRG93biAmJiB0aGlzLmNhbkhvbGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhvbGRLZXlJc0Rvd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBoZWxkU2hhcGVOYW1lID0gdGhpcy5oZWxkU2hhcGUgPyB0aGlzLmhlbGRTaGFwZSA6ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMuaGVsZFNoYXBlID0gdGhpcy5jdXJyZW50U2hhcGUubmFtZTtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTaGFwZS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVOZXdTaGFwZSh0cnVlLCBoZWxkU2hhcGVOYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAoIWhlbGRTaGFwZU5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5odWQuc2V0TmV4dFNoYXBlKHRoaXMuc2hhcGVTdGFjay5nZXROZXh0U2hhcGUoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaHVkLnNldEhlbGRTaGFwZSh0aGlzLmhlbGRTaGFwZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5naG9zdC5zZXRQb3NpdGlvbih0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSwgdGhpcy5ib2FyZC5maW5kRGlzdGFuY2VUb0ZhbGwodGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCkpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbkhvbGQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmhvbGRLZXkuaXNVcCAmJiB0aGlzLmhvbGRTcHJpdGUuaW5wdXQuaXNVcCAmJiB0aGlzLmhvbGRLZXlJc0Rvd24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhvbGRLZXlJc0Rvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWFpblN0YXRlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnVwZGF0ZS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uc1N0YXJ0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1vdmVDb250cm9scygpO1xuICAgICAgICAgICAgdGhpcy5yb3RhdGlvbkNvbnRyb2xzKCk7XG4gICAgICAgICAgICB0aGlzLmRyb3BEb3duQ29udHJvbHMoKTtcbiAgICAgICAgICAgIHRoaXMuZmFsbFRpbWVyQ29udHJvbHMoKTtcbiAgICAgICAgICAgIHRoaXMuaG9sZENvbnRyb2xzKCk7XG4gICAgICAgICAgICAvL2tlZXAgZmFsbGluZyBkb3duXG4gICAgICAgICAgICB0aGlzLmZhbGxUaW1lci5zdGFydCgpO1xuICAgICAgICAgICAgdGhpcy5odWQudXBkYXRlU2NvcmUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgTWFpblN0YXRlLnByb3RvdHlwZS5jcmVhdGVOZXdTaGFwZSA9IGZ1bmN0aW9uIChhZGRUb0dhbWUsIHNoYXBlTmFtZSwgeCwgeSwgZGVidWcpIHtcbiAgICAgICAgICAgIGlmIChhZGRUb0dhbWUgPT09IHZvaWQgMCkgeyBhZGRUb0dhbWUgPSBmYWxzZTsgfVxuICAgICAgICAgICAgaWYgKHNoYXBlTmFtZSA9PT0gdm9pZCAwKSB7IHNoYXBlTmFtZSA9ICcnOyB9XG4gICAgICAgICAgICBpZiAoeCA9PT0gdm9pZCAwKSB7IHggPSA0OyB9XG4gICAgICAgICAgICBpZiAoeSA9PT0gdm9pZCAwKSB7IHkgPSAxOyB9XG4gICAgICAgICAgICBpZiAoZGVidWcgPT09IHZvaWQgMCkgeyBkZWJ1ZyA9IGZhbHNlOyB9XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTaGFwZSA9IHRoaXMuc2hhcGVTdGFjay5jcmVhdGVOZXdTaGFwZShhZGRUb0dhbWUsIHNoYXBlTmFtZSwgeCwgeSk7XG4gICAgICAgICAgICAvL2Fsd2F5cyByZWZyZXNoIGJvYXJkLCBiZWNhdXNlIHNvbWV0aW1lcyBidWcgY2FuIG9jY3VyLiBNb3N0IGxpa2VseSBiZWNhdXNlIG9mIHNldFRpbWVvdXRzLiBJIGRvbid0IGxpa2UgJ2VtLiA6KFxuICAgICAgICAgICAgdGhpcy5ib2FyZC5yZWZyZXNoSGlnaGVzdFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgaWYgKGRlYnVnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZC5zZXRCbG9ja3ModGhpcy5jdXJyZW50U2hhcGUuZ2V0QmxvY2tzKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNyZWF0ZS5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgLy9jb250cm9sc1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVCb3RoU2NyZWVuID0gbmV3IEtpd2kuUGx1Z2lucy5HYW1lT2JqZWN0cy5Ub3VjaEJ1dHRvbih0aGlzLCB0aGlzLnRleHR1cmVzWydjb250cm9sQXJyb3cnXSwgOTUsIFRldHJpcy5Db25maWcuYm9hcmRIZWlnaHRJblBpeGVscyAtIDMwKTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQm90aFNjcmVlbi5yb3RQb2ludFggPSB0aGlzLnJvdGF0ZUJvdGhTY3JlZW4ud2lkdGggKiAwLjU7XG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUJvdGhTY3JlZW4ucm90UG9pbnRZID0gdGhpcy5yb3RhdGVCb3RoU2NyZWVuLmhlaWdodCAqIDAuNTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQm90aFNjcmVlbi5yb3RhdGlvbiA9IE1hdGguUEkgLyAyO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLnJvdGF0ZUJvdGhTY3JlZW4pO1xuICAgICAgICAgICAgdGhpcy5sZWZ0S2V5U2NyZWVuID0gbmV3IEtpd2kuUGx1Z2lucy5HYW1lT2JqZWN0cy5Ub3VjaEJ1dHRvbih0aGlzLCB0aGlzLnRleHR1cmVzWydjb250cm9sQXJyb3cnXSwgMzAsIFRldHJpcy5Db25maWcuYm9hcmRIZWlnaHRJblBpeGVscyArIDM1KTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5sZWZ0S2V5U2NyZWVuKTtcbiAgICAgICAgICAgIHRoaXMucmlnaHRLZXlTY3JlZW4gPSBuZXcgS2l3aS5QbHVnaW5zLkdhbWVPYmplY3RzLlRvdWNoQnV0dG9uKHRoaXMsIHRoaXMudGV4dHVyZXNbJ2NvbnRyb2xBcnJvdyddLCAxNjAsIFRldHJpcy5Db25maWcuYm9hcmRIZWlnaHRJblBpeGVscyArIDM1KTtcbiAgICAgICAgICAgIHRoaXMucmlnaHRLZXlTY3JlZW4ucm90UG9pbnRYID0gdGhpcy5yaWdodEtleVNjcmVlbi53aWR0aCAqIDAuNTtcbiAgICAgICAgICAgIHRoaXMucmlnaHRLZXlTY3JlZW4ucm90UG9pbnRZID0gdGhpcy5yaWdodEtleVNjcmVlbi5oZWlnaHQgKiAwLjU7XG4gICAgICAgICAgICB0aGlzLnJpZ2h0S2V5U2NyZWVuLnJvdGF0aW9uID0gTWF0aC5QSTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5yaWdodEtleVNjcmVlbik7XG4gICAgICAgICAgICB0aGlzLnNvZnREcm9wU2NyZWVuID0gbmV3IEtpd2kuUGx1Z2lucy5HYW1lT2JqZWN0cy5Ub3VjaEJ1dHRvbih0aGlzLCB0aGlzLnRleHR1cmVzWydjb250cm9sQXJyb3cnXSwgOTUsIFRldHJpcy5Db25maWcuYm9hcmRIZWlnaHRJblBpeGVscyArIDEwMCk7XG4gICAgICAgICAgICB0aGlzLnNvZnREcm9wU2NyZWVuLnJvdFBvaW50WCA9IHRoaXMuc29mdERyb3BTY3JlZW4ud2lkdGggKiAwLjU7XG4gICAgICAgICAgICB0aGlzLnNvZnREcm9wU2NyZWVuLnJvdFBvaW50WSA9IHRoaXMuc29mdERyb3BTY3JlZW4uaGVpZ2h0ICogMC41O1xuICAgICAgICAgICAgdGhpcy5zb2Z0RHJvcFNjcmVlbi5yb3RhdGlvbiA9IC1NYXRoLlBJIC8gMjtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5zb2Z0RHJvcFNjcmVlbik7XG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUNsb2Nrd2lzZVNjcmVlbiA9IG5ldyBLaXdpLlBsdWdpbnMuR2FtZU9iamVjdHMuVG91Y2hCdXR0b24odGhpcywgdGhpcy50ZXh0dXJlc1snY29udHJvbEJ1dHRvbiddLCAyMTAsIFRldHJpcy5Db25maWcuYm9hcmRIZWlnaHRJblBpeGVscyAtIDMwKTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQ2xvY2t3aXNlU2NyZWVuLnNjYWxlWCA9IDAuNjtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQ2xvY2t3aXNlU2NyZWVuLnNjYWxlWSA9IDAuNjtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5yb3RhdGVDbG9ja3dpc2VTY3JlZW4pO1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlU2NyZWVuID0gbmV3IEtpd2kuUGx1Z2lucy5HYW1lT2JqZWN0cy5Ub3VjaEJ1dHRvbih0aGlzLCB0aGlzLnRleHR1cmVzWydjb250cm9sQnV0dG9uJ10sIDI4MCwgVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodEluUGl4ZWxzIC0gMzApO1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlU2NyZWVuLnNjYWxlWCA9IDAuNjtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQ291bnRlckNsb2Nrd2lzZVNjcmVlbi5zY2FsZVkgPSAwLjY7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKHRoaXMucm90YXRlQ291bnRlckNsb2Nrd2lzZVNjcmVlbik7XG4gICAgICAgICAgICB0aGlzLmhhcmREcm9wU2NyZWVuID0gbmV3IEtpd2kuUGx1Z2lucy5HYW1lT2JqZWN0cy5Ub3VjaEJ1dHRvbih0aGlzLCB0aGlzLnRleHR1cmVzWydjb250cm9sQnV0dG9uJ10sIDMzMCwgNDYwKTtcbiAgICAgICAgICAgIHRoaXMuaGFyZERyb3BTY3JlZW4uc2NhbGVYID0gMC42O1xuICAgICAgICAgICAgdGhpcy5oYXJkRHJvcFNjcmVlbi5zY2FsZVkgPSAwLjY7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKHRoaXMuaGFyZERyb3BTY3JlZW4pO1xuICAgICAgICAgICAgdGhpcy5sZWZ0S2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShLaXdpLklucHV0LktleWNvZGVzLkxFRlQpO1xuICAgICAgICAgICAgdGhpcy5yaWdodEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoS2l3aS5JbnB1dC5LZXljb2Rlcy5SSUdIVCk7XG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUJvdGhLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KEtpd2kuSW5wdXQuS2V5Y29kZXMuVVApO1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVDbG9ja3dpc2VLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KEtpd2kuSW5wdXQuS2V5Y29kZXMuWik7XG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2VLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KEtpd2kuSW5wdXQuS2V5Y29kZXMuWCk7XG4gICAgICAgICAgICB0aGlzLnNvZnREcm9wS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShLaXdpLklucHV0LktleWNvZGVzLkRPV04pO1xuICAgICAgICAgICAgdGhpcy5oYXJkRHJvcEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoS2l3aS5JbnB1dC5LZXljb2Rlcy5TUEFDRUJBUik7XG4gICAgICAgICAgICB0aGlzLmhvbGRLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KEtpd2kuSW5wdXQuS2V5Y29kZXMuU0hJRlQpO1xuICAgICAgICAgICAgLy9ib2FyZCBzcHJpdGVzXG4gICAgICAgICAgICAvLyBBZGQgc2NvcmUgdGV4dCB0byB0aGUgc3RhdGVcbiAgICAgICAgICAgIHZhciBzY29yZVRleHQgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJTY29yZVwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscywgMCwgXCIjMDAwXCIsIDI0KTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoc2NvcmVUZXh0KTtcbiAgICAgICAgICAgIHZhciBzY29yZSA9IG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIjBcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMsIDI1LCBcIiMwMDBcIiwgMjQpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChzY29yZSk7XG4gICAgICAgICAgICB2YXIgbGV2ZWxUZXh0ID0gbmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiTGV2ZWxcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMsIDYwLCBcIiMwMDBcIiwgMjQpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChsZXZlbFRleHQpO1xuICAgICAgICAgICAgdmFyIGxldmVsID0gbmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiMFwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscywgODUsIFwiIzAwMFwiLCAyNCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKGxldmVsKTtcbiAgICAgICAgICAgIHZhciBsaW5lc1RleHQgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJMaW5lc1wiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscywgMTEwLCBcIiMwMDBcIiwgMjQpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChsaW5lc1RleHQpO1xuICAgICAgICAgICAgdmFyIGxpbmVzID0gbmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiMFwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscywgMTM1LCBcIiMwMDBcIiwgMjQpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChsaW5lcyk7XG4gICAgICAgICAgICB0aGlzLmJvYXJkU3ByaXRlID0gbmV3IEtpd2kuR2FtZU9iamVjdHMuU3ByaXRlKHRoaXMsIHRoaXMudGV4dHVyZXMuYm9hcmQsIFRldHJpcy5Db25maWcub2Zmc2V0WCArIFRldHJpcy5Db25maWcuYm9yZGVyV2lkdGgsIFRldHJpcy5Db25maWcuYm9yZGVySGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuYm9hcmRTcHJpdGUuaW5wdXQuZW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKHRoaXMuYm9hcmRTcHJpdGUpO1xuICAgICAgICAgICAgdmFyIGJvcmRlcnMgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5TdGF0aWNJbWFnZSh0aGlzLCB0aGlzLnRleHR1cmVzLmJvcmRlcnMsIFRldHJpcy5Db25maWcub2Zmc2V0WCwgMCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKGJvcmRlcnMpO1xuICAgICAgICAgICAgdmFyIG5leHRTaGFwZVRleHQgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJOZXh0XCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzLCAxNzAsIFwiIzAwMFwiLCAyNCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5leHRTaGFwZVRleHQpO1xuICAgICAgICAgICAgdmFyIG5leHRTaGFwZUJvcmRlcnMgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5TdGF0aWNJbWFnZSh0aGlzLCB0aGlzLnRleHR1cmVzLmh1ZEJvcmRlcnMsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzICsgMjAsIDIzNSk7XG4gICAgICAgICAgICBuZXh0U2hhcGVCb3JkZXJzLnNjYWxlWCA9IDIuNTtcbiAgICAgICAgICAgIG5leHRTaGFwZUJvcmRlcnMuc2NhbGVZID0gMy41O1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXh0U2hhcGVCb3JkZXJzKTtcbiAgICAgICAgICAgIHZhciBoZWxkU2hhcGVUZXh0ID0gbmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiSG9sZFwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscywgMzIwLCBcIiMwMDBcIiwgMjQpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChoZWxkU2hhcGVUZXh0KTtcbiAgICAgICAgICAgIHRoaXMuaG9sZFNwcml0ZSA9IG5ldyBLaXdpLkdhbWVPYmplY3RzLlNwcml0ZSh0aGlzLCB0aGlzLnRleHR1cmVzLmh1ZEJvcmRlcnMsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzICsgMjAsIDM4NSk7XG4gICAgICAgICAgICB0aGlzLmhvbGRTcHJpdGUuc2NhbGVYID0gMi41O1xuICAgICAgICAgICAgdGhpcy5ob2xkU3ByaXRlLnNjYWxlWSA9IDMuNTtcbiAgICAgICAgICAgIHRoaXMuaG9sZFNwcml0ZS5pbnB1dC5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5ob2xkU3ByaXRlKTtcbiAgICAgICAgICAgIC8vbW92ZSB0aW1lciBmb3IgbGltaXRpbmcgbW92ZSBhbW91bnRcbiAgICAgICAgICAgIHRoaXMubW92ZVRpbWVyID0gdGhpcy5nYW1lLnRpbWUuY2xvY2suY3JlYXRlVGltZXIoJ21vdmUnLCBUZXRyaXMuQ29uZmlnLm1vdmVUaW1lclJhdGUsIDApO1xuICAgICAgICAgICAgdGhpcy5tb3ZlVGltZXIuY3JlYXRlVGltZXJFdmVudChLaXdpLlRpbWUuVGltZXJFdmVudC5USU1FUl9TVE9QLCBmdW5jdGlvbiAoKSB7IF90aGlzLm1vdmVLZXlJc0Rvd24gPSBmYWxzZTsgfSwgdGhpcyk7XG4gICAgICAgICAgICAvL2FkZCBkcm9wIHRpbWVyXG4gICAgICAgICAgICB0aGlzLmZhbGxUaW1lciA9IHRoaXMuZ2FtZS50aW1lLmNsb2NrLmNyZWF0ZVRpbWVyKCdmYWxsJywgMC41LCAwKTtcbiAgICAgICAgICAgIHRoaXMuZmFsbFRpbWVyLmNyZWF0ZVRpbWVyRXZlbnQoS2l3aS5UaW1lLlRpbWVyRXZlbnQuVElNRVJfU1RPUCwgdGhpcy5mYWxsRG93biwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmJvYXJkID0gbmV3IFRldHJpcy5Cb2FyZCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuc2hhcGVTdGFjayA9IG5ldyBUZXRyaXMuU2hhcGVzLlNoYXBlU3RhY2sodGhpcyk7XG4gICAgICAgICAgICB0aGlzLnNjb3JpbmdNYW5hZ2VyID0gbmV3IFRldHJpcy5TY29yaW5nTWFuYWdlcigxKTtcbiAgICAgICAgICAgIHRoaXMuaHVkID0gbmV3IFRldHJpcy5IdWQodGhpcywgdGhpcy5zY29yaW5nTWFuYWdlciwgbGV2ZWwsIHNjb3JlLCBsaW5lcyk7XG4gICAgICAgICAgICAvL2Ryb3AgdGhlIGZpcnN0IHNoYXBlXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZU5ld1NoYXBlKHRydWUsICdTaGFwZUknKTtcbiAgICAgICAgICAgIHRoaXMuaHVkLnNldE5leHRTaGFwZSh0aGlzLnNoYXBlU3RhY2suZ2V0TmV4dFNoYXBlKCkpO1xuICAgICAgICAgICAgLy9zZXQgaXRzIGdob3N0XG4gICAgICAgICAgICB0aGlzLmdob3N0ID0gbmV3IFRldHJpcy5HaG9zdCh0aGlzLCB0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSwgdGhpcy5ib2FyZC5maW5kRGlzdGFuY2VUb0ZhbGwodGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCkpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGRCZWZvcmUodGhpcy5naG9zdC5nZXRHYW1lT2JqZWN0KCksIGJvcmRlcnMpO1xuICAgICAgICAgICAgdGhpcy5mYWxsVGltZXIuc3RhcnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE1haW5TdGF0ZTtcbiAgICB9KShLaXdpLlN0YXRlKTtcbiAgICBUZXRyaXMuTWFpblN0YXRlID0gTWFpblN0YXRlO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDQtMjAuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9saWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9jb25maWcudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIEdhbWVPdmVyU3RhdGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoR2FtZU92ZXJTdGF0ZSwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gR2FtZU92ZXJTdGF0ZSgpIHtcbiAgICAgICAgICAgIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIEdhbWVPdmVyU3RhdGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdhbWUuaW5wdXQubW91c2UuaXNEb3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLnN0YXRlcy5zd2l0Y2hTdGF0ZSgnbWFpbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBHYW1lT3ZlclN0YXRlLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoc2NvcmUsIGxldmVsLCBsaW5lcykge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jcmVhdGUuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiR2FtZSBPdmVyIVwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDEwMCwgXCIjMDAwXCIsIDMwKSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIlNjb3JlXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMTUwLCBcIiMwMDBcIiwgMjQpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIHNjb3JlLnRvU3RyaW5nKCksIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMTc1LCBcIiMwMDBcIiwgMjQpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiTGluZXNcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAyMDAsIFwiIzAwMFwiLCAyNCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgbGluZXMudG9TdHJpbmcoKSwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAyMjUsIFwiIzAwMFwiLCAyNCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJMZXZlbFwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDI1MCwgXCIjMDAwXCIsIDI0KSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBsZXZlbC50b1N0cmluZygpLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDI3NSwgXCIjMDAwXCIsIDI0KSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCAnUGxheSBhZ2FpbicsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMzUwLCBcIiMwMDBcIiwgMjQpKTtcbiAgICAgICAgICAgIHRoaXMuZ2V0QWxsQ2hpbGRyZW4oKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZHJlbikgeyByZXR1cm4gY2hpbGRyZW4udGV4dEFsaWduID0gJ2NlbnRlcic7IH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gR2FtZU92ZXJTdGF0ZTtcbiAgICB9KShLaXdpLlN0YXRlKTtcbiAgICBUZXRyaXMuR2FtZU92ZXJTdGF0ZSA9IEdhbWVPdmVyU3RhdGU7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwibGliL2tpd2kuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic3RhdGVzL21lbnUudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInN0YXRlcy9tYWluLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzdGF0ZXMvZ2FtZS1vdmVyLnRzXCIgLz5cbi8qKlxuKiBUaGUgY29yZSBUZW1wbGF0ZUdhbWUgZ2FtZSBmaWxlLlxuKlxuKiBUaGlzIGZpbGUgaXMgb25seSB1c2VkIHRvIGluaXRhbGlzZSAoc3RhcnQtdXApIHRoZSBtYWluIEtpd2kgR2FtZVxuKiBhbmQgYWRkIGFsbCBvZiB0aGUgcmVsZXZhbnQgc3RhdGVzIHRvIHRoYXQgR2FtZS5cbipcbiovXG4vL0luaXRpYWxpc2UgdGhlIEtpd2kgR2FtZS5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBnYW1lT3B0aW9ucyA9IHtcbiAgICAgICAgcmVuZGVyZXI6IEtpd2kuUkVOREVSRVJfQ0FOVkFTLFxuICAgICAgICB3aWR0aDogNDMwLFxuICAgICAgICBoZWlnaHQ6IDgwMCxcbiAgICAgICAgcGx1Z2luczogWydUb3VjaEJ1dHRvbiddXG4gICAgfTtcbiAgICB2YXIgZ2FtZSA9IG5ldyBLaXdpLkdhbWUoJ2NvbnRlbnQnLCAnVGV0cmlzJywgbnVsbCwgZ2FtZU9wdGlvbnMpO1xuICAgIHZhciBtZW51U3RhdGUgPSBuZXcgVGV0cmlzLk1lbnVTdGF0ZSgnbWVudScpO1xuICAgIHZhciBtYWluU3RhdGUgPSBuZXcgVGV0cmlzLk1haW5TdGF0ZSgnbWFpbicpO1xuICAgIHZhciBnYW1lT3ZlclN0YXRlID0gbmV3IFRldHJpcy5HYW1lT3ZlclN0YXRlKCdnYW1lT3ZlcicpO1xuICAgIGdhbWUuc3RhdGVzLmFkZFN0YXRlKG1lbnVTdGF0ZSk7XG4gICAgZ2FtZS5zdGF0ZXMuYWRkU3RhdGUobWFpblN0YXRlKTtcbiAgICBnYW1lLnN0YXRlcy5hZGRTdGF0ZShnYW1lT3ZlclN0YXRlKTtcbiAgICBnYW1lLnN0YXRlcy5zd2l0Y2hTdGF0ZSgnbWVudScpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzaGFwZS50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZURvdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoU2hhcGVEb3QsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaGFwZURvdChzdGF0ZSwgeCwgeSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrQ29sb3IgPSAncmVkJztcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSAnU2hhcGVEb3QnO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5LCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTaGFwZURvdDtcbiAgICAgICAgfSkoU2hhcGVzLlNoYXBlKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlRG90ID0gU2hhcGVEb3Q7XG4gICAgfSkoU2hhcGVzID0gVGV0cmlzLlNoYXBlcyB8fCAoVGV0cmlzLlNoYXBlcyA9IHt9KSk7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNS0yMS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInNoYXBlLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBTaGFwZXM7XG4gICAgKGZ1bmN0aW9uIChTaGFwZXMpIHtcbiAgICAgICAgdmFyIFNoYXBlSSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoU2hhcGVJLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gU2hhcGVJKHN0YXRlLCB4LCB5KSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgc3RhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tDb2xvciA9ICdjeWFuJztcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSAnU2hhcGVJJztcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCAtIDEsIHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDEsIHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4ICsgMiwgeSk7XG4gICAgICAgICAgICAgICAgLy9pbnZpc2libGUgY2VudGVyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDZW50ZXIoeCArIDAuNSwgeSArIDAuNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL3JldHVybiBzcGVjaWZpYyByb3RhdGlvbnMgZm9yIHRoaXMgc2hhcGVcbiAgICAgICAgICAgIFNoYXBlSS5wcm90b3R5cGUuZ2V0Um90YXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBTaGFwZUkucm90YXRpb25zO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlSS5wcm90b3R5cGUuYWRkQ2VudGVyID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNlbnRlciA9IG5ldyBUZXRyaXMuQmxvY2soeCwgeSwgdGhpcy5zdGF0ZSwgbnVsbCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2hhcGVJLnJvdGF0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICBbWzAsIDBdLCBbLTIsIDBdLCBbKzEsIDBdLCBbLTIsIC0xXSwgWysxLCArMl1dLFxuICAgICAgICAgICAgICAgIFtbMCwgMF0sIFstMSwgMF0sIFsrMiwgMF0sIFstMSwgKzJdLCBbKzIsIC0xXV0sXG4gICAgICAgICAgICAgICAgW1swLCAwXSwgWysyLCAwXSwgWy0xLCAwXSwgWysyLCArMV0sIFstMSwgLTJdXSxcbiAgICAgICAgICAgICAgICBbWzAsIDBdLCBbKzEsIDBdLCBbLTIsIDBdLCBbKzEsIC0yXSwgWy0yLCArMV1dLFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHJldHVybiBTaGFwZUk7XG4gICAgICAgIH0pKFNoYXBlcy5TaGFwZSk7XG4gICAgICAgIFNoYXBlcy5TaGFwZUkgPSBTaGFwZUk7XG4gICAgfSkoU2hhcGVzID0gVGV0cmlzLlNoYXBlcyB8fCAoVGV0cmlzLlNoYXBlcyA9IHt9KSk7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNS0yMS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInNoYXBlLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBTaGFwZXM7XG4gICAgKGZ1bmN0aW9uIChTaGFwZXMpIHtcbiAgICAgICAgdmFyIFNoYXBlSiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoU2hhcGVKLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gU2hhcGVKKHN0YXRlLCB4LCB5KSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgc3RhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tDb2xvciA9ICdibHVlJztcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSAnU2hhcGVKJztcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCAtIDEsIHkgLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCAtIDEsIHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDEsIHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFNoYXBlSjtcbiAgICAgICAgfSkoU2hhcGVzLlNoYXBlKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlSiA9IFNoYXBlSjtcbiAgICB9KShTaGFwZXMgPSBUZXRyaXMuU2hhcGVzIHx8IChUZXRyaXMuU2hhcGVzID0ge30pKTtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA1LTIxLlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic2hhcGUudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIFNoYXBlcztcbiAgICAoZnVuY3Rpb24gKFNoYXBlcykge1xuICAgICAgICB2YXIgU2hhcGVMID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgICAgIF9fZXh0ZW5kcyhTaGFwZUwsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaGFwZUwoc3RhdGUsIHgsIHkpIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja0NvbG9yID0gJ29yYW5nZSc7XG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gJ1NoYXBlTCc7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggLSAxLCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggKyAxLCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDEsIHkgLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTaGFwZUw7XG4gICAgICAgIH0pKFNoYXBlcy5TaGFwZSk7XG4gICAgICAgIFNoYXBlcy5TaGFwZUwgPSBTaGFwZUw7XG4gICAgfSkoU2hhcGVzID0gVGV0cmlzLlNoYXBlcyB8fCAoVGV0cmlzLlNoYXBlcyA9IHt9KSk7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNS0yMS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInNoYXBlLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBTaGFwZXM7XG4gICAgKGZ1bmN0aW9uIChTaGFwZXMpIHtcbiAgICAgICAgdmFyIFNoYXBlTyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoU2hhcGVPLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gU2hhcGVPKHN0YXRlLCB4LCB5KSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgc3RhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tDb2xvciA9ICd5ZWxsb3cnO1xuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9ICdTaGFwZU8nO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5IC0gMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHgsIHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4ICsgMSwgeSAtIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4ICsgMSwgeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDZW50ZXIoeCAtIDAuNSwgeSAtIDAuNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL05vIG5lZWQgdG8gZG8gYW55dGhpbmdcbiAgICAgICAgICAgIFNoYXBlTy5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfTtcbiAgICAgICAgICAgIC8vTm8gbmVlZCB0byBkbyBhbnl0aGluZ1xuICAgICAgICAgICAgU2hhcGVPLnByb3RvdHlwZS5nZXROZXh0Um90YXRpb24gPSBmdW5jdGlvbiAoZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gdm9pZCAwKSB7IGRpcmVjdGlvbiA9IDA7IH1cbiAgICAgICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2hhcGVPLnByb3RvdHlwZS5hZGRDZW50ZXIgPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyID0gbmV3IFRldHJpcy5CbG9jayh4LCB5LCB0aGlzLnN0YXRlLCBudWxsKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVPO1xuICAgICAgICB9KShTaGFwZXMuU2hhcGUpO1xuICAgICAgICBTaGFwZXMuU2hhcGVPID0gU2hhcGVPO1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzaGFwZS50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZVMgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNoYXBlUywgX3N1cGVyKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFNoYXBlUyhzdGF0ZSwgeCwgeSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrQ29sb3IgPSAnZ3JlZW4nO1xuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9ICdTaGFwZVMnO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4IC0gMSwgeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHgsIHksIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5IC0gMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggKyAxLCB5IC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVTO1xuICAgICAgICB9KShTaGFwZXMuU2hhcGUpO1xuICAgICAgICBTaGFwZXMuU2hhcGVTID0gU2hhcGVTO1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzaGFwZS50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZVQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNoYXBlVCwgX3N1cGVyKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFNoYXBlVChzdGF0ZSwgeCwgeSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrQ29sb3IgPSAncHVycGxlJztcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSAnU2hhcGVUJztcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCAtIDEsIHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSAtIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4ICsgMSwgeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVUO1xuICAgICAgICB9KShTaGFwZXMuU2hhcGUpO1xuICAgICAgICBTaGFwZXMuU2hhcGVUID0gU2hhcGVUO1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzaGFwZS50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZVogPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNoYXBlWiwgX3N1cGVyKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFNoYXBlWihzdGF0ZSwgeCwgeSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrQ29sb3IgPSAncmVkJztcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSAnU2hhcGVaJztcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCAtIDEsIHkgLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSAtIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDEsIHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFNoYXBlWjtcbiAgICAgICAgfSkoU2hhcGVzLlNoYXBlKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlWiA9IFNoYXBlWjtcbiAgICB9KShTaGFwZXMgPSBUZXRyaXMuU2hhcGVzIHx8IChUZXRyaXMuU2hhcGVzID0ge30pKTtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbiJdfQ==
