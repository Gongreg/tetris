(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function(){"use strict";var n={"@@functional/placeholder":!0},t=function(n,t){switch(n){case 0:return function(){return t.apply(this,arguments)};case 1:return function(n){return t.apply(this,arguments)};case 2:return function(n,r){return t.apply(this,arguments)};case 3:return function(n,r,e){return t.apply(this,arguments)};case 4:return function(n,r,e,u){return t.apply(this,arguments)};case 5:return function(n,r,e,u,i){return t.apply(this,arguments)};case 6:return function(n,r,e,u,i,o){return t.apply(this,arguments)};case 7:return function(n,r,e,u,i,o,c){return t.apply(this,arguments)};case 8:return function(n,r,e,u,i,o,c,a){return t.apply(this,arguments)};case 9:return function(n,r,e,u,i,o,c,a,f){return t.apply(this,arguments)};case 10:return function(n,r,e,u,i,o,c,a,f,s){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}},r=function(n){return new RegExp(n.source,(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.sticky?"y":"")+(n.unicode?"u":""))},e=function(n){return function(){return!n.apply(this,arguments)}},u=function(n,t){n=n||[],t=t||[];var r,e=n.length,u=t.length,i=[];for(r=0;e>r;)i[i.length]=n[r],r+=1;for(r=0;u>r;)i[i.length]=t[r],r+=1;return i},i=function(n,t,r){for(var e=0,u=r.length;u>e;){if(n(t,r[e]))return!0;e+=1}return!1},o=function(n){return function t(r){return 0===arguments.length?t:null!=r&&r["@@functional/placeholder"]===!0?t:n.apply(this,arguments)}},c=function(n){return function t(r,e){var u=arguments.length;return 0===u?t:1===u&&null!=r&&r["@@functional/placeholder"]===!0?t:1===u?o(function(t){return n(r,t)}):2===u&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0?t:2===u&&null!=r&&r["@@functional/placeholder"]===!0?o(function(t){return n(t,e)}):2===u&&null!=e&&e["@@functional/placeholder"]===!0?o(function(t){return n(r,t)}):n(r,e)}},a=function(n){return function t(r,e,u){var i=arguments.length;return 0===i?t:1===i&&null!=r&&r["@@functional/placeholder"]===!0?t:1===i?c(function(t,e){return n(r,t,e)}):2===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0?t:2===i&&null!=r&&r["@@functional/placeholder"]===!0?c(function(t,r){return n(t,e,r)}):2===i&&null!=e&&e["@@functional/placeholder"]===!0?c(function(t,e){return n(r,t,e)}):2===i?o(function(t){return n(r,e,t)}):3===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0&&null!=u&&u["@@functional/placeholder"]===!0?t:3===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=e&&e["@@functional/placeholder"]===!0?c(function(t,r){return n(t,r,u)}):3===i&&null!=r&&r["@@functional/placeholder"]===!0&&null!=u&&u["@@functional/placeholder"]===!0?c(function(t,r){return n(t,e,r)}):3===i&&null!=e&&e["@@functional/placeholder"]===!0&&null!=u&&u["@@functional/placeholder"]===!0?c(function(t,e){return n(r,t,e)}):3===i&&null!=r&&r["@@functional/placeholder"]===!0?o(function(t){return n(t,e,u)}):3===i&&null!=e&&e["@@functional/placeholder"]===!0?o(function(t){return n(r,t,u)}):3===i&&null!=u&&u["@@functional/placeholder"]===!0?o(function(t){return n(r,e,t)}):n(r,e,u)}},f=function cu(n,r,e){return function(){for(var u=[],i=0,o=n,c=0;c<r.length||i<arguments.length;){var a;c<r.length&&(null==r[c]||r[c]["@@functional/placeholder"]!==!0||i>=arguments.length)?a=r[c]:(a=arguments[i],i+=1),u[c]=a,(null==a||a["@@functional/placeholder"]!==!0)&&(o-=1),c+=1}return 0>=o?e.apply(this,u):t(o,cu(n,u,e))}},s=function(n,t){for(var r=0,e=t.length,u=[];e>r;)n(t[r])&&(u[u.length]=t[r]),r+=1;return u},l=function(n){return{"@@transducer/value":n,"@@transducer/reduced":!0}},p=function(n){return function(t){return s(function(n){return"function"==typeof t[n]},n(t))}},h=function(n,t){return Object.prototype.hasOwnProperty.call(t,n)},g=function(n){return n},d=Array.isArray||function(n){return null!=n&&n.length>=0&&"[object Array]"===Object.prototype.toString.call(n)},y=Number.isInteger||function(n){return n<<0===n},m=function(n){return"[object Number]"===Object.prototype.toString.call(n)},v=function(n){return"[object String]"===Object.prototype.toString.call(n)},w=function(n){return"function"==typeof n["@@transducer/step"]},x=function(n,t){for(var r=0,e=t.length,u=Array(e);e>r;)u[r]=n(t[r]),r+=1;return u},b=function(n,t){return function(){return t.call(this,n.apply(this,arguments))}},j=function(n,t){return function(){var r=this;return n.apply(r,arguments).then(function(n){return t.call(r,n)})}},O=function(n){return'"'+n.replace(/"/g,'\\"')+'"'},S=function(n){return n&&n["@@transducer/reduced"]?n:{"@@transducer/value":n,"@@transducer/reduced":!0}},E=function au(n,t,r){switch(arguments.length){case 1:return au(n,0,n.length);case 2:return au(n,t,n.length);default:for(var e=[],u=0,i=Math.max(0,Math.min(n.length,r)-t);i>u;)e[u]=n[t+u],u+=1;return e}},A=function(){var n=function(n){return(10>n?"0":"")+n};return"function"==typeof Date.prototype.toISOString?function(n){return n.toISOString()}:function(t){return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),I=function(){function n(n,t){this.xf=t,this.pred=n,this.lastValue=void 0,this.seenFirstValue=!1}return n.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},n.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){var r=!1;return this.seenFirstValue?this.pred(this.lastValue,t)&&(r=!0):this.seenFirstValue=!0,this.lastValue=t,r?n:this.xf["@@transducer/step"](n,t)},c(function(t,r){return new n(t,r)})}(),k={init:function(){return this.xf["@@transducer/init"]()},result:function(n){return this.xf["@@transducer/result"](n)}},N=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.f(t)?this.xf["@@transducer/step"](n,t):n},c(function(t,r){return new n(t,r)})}(),C=function(){function n(n,t){this.xf=t,this.f=n,this.found=!1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.found||(n=this.xf["@@transducer/step"](n,void 0)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.found=!0,n=S(this.xf["@@transducer/step"](n,t))),n},c(function(t,r){return new n(t,r)})}(),M=function(){function n(n,t){this.xf=t,this.f=n,this.idx=-1,this.found=!1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.found||(n=this.xf["@@transducer/step"](n,-1)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.idx+=1,this.f(t)&&(this.found=!0,n=S(this.xf["@@transducer/step"](n,this.idx))),n},c(function(t,r){return new n(t,r)})}(),P=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](n,this.last))},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.last=t),n},c(function(t,r){return new n(t,r)})}(),T=function(){function n(n,t){this.xf=t,this.f=n,this.idx=-1,this.lastIdx=-1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](n,this.lastIdx))},n.prototype["@@transducer/step"]=function(n,t){return this.idx+=1,this.f(t)&&(this.lastIdx=this.idx),n},c(function(t,r){return new n(t,r)})}(),q=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.xf["@@transducer/step"](n,this.f(t))},c(function(t,r){return new n(t,r)})}(),W=function(){function n(n,t){this.xf=t,this.n=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return 0===this.n?S(n):(this.n-=1,this.xf["@@transducer/step"](n,t))},c(function(t,r){return new n(t,r)})}(),R=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.f(t)?this.xf["@@transducer/step"](n,t):S(n)},c(function(t,r){return new n(t,r)})}(),B=function(){function n(n){this.f=n}return n.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},n.prototype["@@transducer/result"]=function(n){return n},n.prototype["@@transducer/step"]=function(n,t){return this.f(n,t)},function(t){return new n(t)}}(),L=c(function(n,t){return n+t}),U=a(function(n,t,r){if(t>=r.length||t<-r.length)return r;var e=0>t?r.length:0,i=e+t,o=u(r);return o[i]=n(r[i]),o}),F=o(function(n){return function(){return n}}),D=c(function(n,t){for(var r=0,e=t.length-(n-1),u=new Array(e>=0?e:0);e>r;)u[r]=E(t,r,r+n),r+=1;return u}),V=c(function(n,t){return u(t,[n])}),z=c(function(n,t){return n.apply(this,t)}),_=a(function(n,t,r){var e={};for(var u in r)e[u]=r[u];return e[n]=t,e}),K=a(function fu(n,t,r){switch(n.length){case 0:return r;case 1:return _(n[0],t,r);default:return _(n[0],fu(E(n,1),t,Object(r[n[0]])),r)}}),$=c(function(n,r){return t(n.length,function(){return n.apply(r,arguments)})}),H=c(function(n,t){return function(){return n.apply(this,arguments)&&t.apply(this,arguments)}}),X=o(function(n){return function(t,r){return n(t,r)?-1:n(r,t)?1:0}}),Y=o(e),Z=o(function(n){return function(){for(var t=0;t<n.length;){if(n[t][0].apply(this,arguments))return n[t][1].apply(this,arguments);t+=1}}}),G=a(i),J=c(function(n,t){for(var r={},e=t.length,u=0;e>u;){var i=n(t[u]);r[i]=(h(i,r)?r[i]:0)+1,u+=1}return r}),Q=c(function(n,t){var r={};return r[n]=t,r}),nn=c(function(n,r){return 1===n?o(r):t(n,f(n,[],r))}),tn=L(-1),rn=c(function(n,t){return null==t?n:t}),en=a(function(n,t,r){for(var e=[],u=0,i=t.length,o=G(n);i>u;)o(t[u],r)||o(t[u],e)||(e[e.length]=t[u]),u+=1;return e}),un=c(function(n,t){var r={};for(var e in t)e!==n&&(r[e]=t[e]);return r}),on=c(function su(n,t){switch(n.length){case 0:return t;case 1:return un(n[0],t);default:var r=n[0],e=E(n,1);return null==t[r]?t:_(r,su(e,t[r]),t)}}),cn=c(function(n,t){return n/t}),an=c(function(n,t){for(var r=t.length-1;r>=0&&n(t[r]);)r-=1;return E(t,0,r+1)}),fn=c(function(n,t){return function(){return n.apply(this,arguments)||t.apply(this,arguments)}}),sn=o(function(n){if(null!=n&&"function"==typeof n.empty)return n.empty();if(null!=n&&null!=typeof n.constructor&&"function"==typeof n.constructor.empty)return n.constructor.empty();switch(Object.prototype.toString.call(n)){case"[object Array]":return[];case"[object Object]":return{};case"[object String]":return""}}),ln=c(function lu(n,t){var r,e,u,i={};for(e in t)r=n[e],u=typeof r,i[e]="function"===u?r(t[e]):"object"===u?lu(n[e],t[e]):t[e];return i}),pn=o(function(n){for(var t=0,r=n.length,e={};r>t;)d(n[t])&&n[t].length&&(e[n[t][0]]=n[t][1]),t+=1;return e}),hn=c(function(n,t){return n>t}),gn=c(function(n,t){return n>=t}),dn=c(h),yn=c(function(n,t){return n in t}),mn=c(function(n,t){return n===t?0!==n||1/n===1/t:n!==n&&t!==t}),vn=o(g),wn=a(function(n,t,r){return nn(Math.max(n.length,t.length,r.length),function(){return n.apply(this,arguments)?t.apply(this,arguments):r.apply(this,arguments)})}),xn=L(1),bn=a(function(n,t,r){n=n<r.length&&n>=0?n:r.length;var e=E(r);return e.splice(n,0,t),e}),jn=a(function(n,t,r){return n=n<r.length&&n>=0?n:r.length,u(u(E(r,0,n),t),E(r,n))}),On=c(function(n,t){return null!=t&&t.constructor===n||t instanceof n}),Sn=o(function(n){return d(n)?!0:n?"object"!=typeof n?!1:n instanceof String?!1:1===n.nodeType?!!n.length:0===n.length?!0:n.length>0?n.hasOwnProperty(0)&&n.hasOwnProperty(n.length-1):!1:!1}),En=o(function(n){return 0===Object(n).length}),An=o(function(n){return null==n}),In=function(){var n=!{toString:null}.propertyIsEnumerable("toString"),t=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],r=function(n,t){for(var r=0;r<n.length;){if(n[r]===t)return!0;r+=1}return!1};return o("function"==typeof Object.keys?function(n){return Object(n)!==n?[]:Object.keys(n)}:function(e){if(Object(e)!==e)return[];var u,i,o=[];for(u in e)h(u,e)&&(o[o.length]=u);if(n)for(i=t.length-1;i>=0;)u=t[i],h(u,e)&&!r(o,u)&&(o[o.length]=u),i-=1;return o})}(),kn=o(function(n){var t,r=[];for(t in n)r[r.length]=t;return r}),Nn=o(function(n){return null!=n&&On(Number,n.length)?n.length:NaN}),Cn=c(function(n,t){return t>n}),Mn=c(function(n,t){return t>=n}),Pn=a(function(n,t,r){for(var e=0,u=r.length,i=[],o=[t];u>e;)o=n(o[0],r[e]),i[e]=o[1],e+=1;return[o[0],i]}),Tn=a(function(n,t,r){for(var e=r.length-1,u=[],i=[t];e>=0;)i=n(i[0],r[e]),u[e]=i[1],e-=1;return[i[0],u]}),qn=c(function(n,t){return t.match(n)||[]}),Wn=c(function(n,t){return y(n)?!y(t)||1>t?NaN:(n%t+t)%t:NaN}),Rn=c(function(n,t){return t>n?t:n}),Bn=a(function(n,t,r){return n(r)>n(t)?r:t}),Ln=c(function(n,t){for(var r={},e=In(n),u=0;u<e.length;)r[e[u]]=n[e[u]],u+=1;for(e=In(t),u=0;u<e.length;)r[e[u]]=t[e[u]],u+=1;return r}),Un=c(function(n,t){return n>t?t:n}),Fn=a(function(n,t,r){return n(r)<n(t)?r:t}),Dn=c(function(n,t){return n%t}),Vn=c(function(n,t){return n*t}),zn=c(function(n,t){switch(n){case 0:return function(){return t.call(this)};case 1:return function(n){return t.call(this,n)};case 2:return function(n,r){return t.call(this,n,r)};case 3:return function(n,r,e){return t.call(this,n,r,e)};case 4:return function(n,r,e,u){return t.call(this,n,r,e,u)};case 5:return function(n,r,e,u,i){return t.call(this,n,r,e,u,i)};case 6:return function(n,r,e,u,i,o){return t.call(this,n,r,e,u,i,o)};case 7:return function(n,r,e,u,i,o,c){return t.call(this,n,r,e,u,i,o,c)};case 8:return function(n,r,e,u,i,o,c,a){return t.call(this,n,r,e,u,i,o,c,a)};case 9:return function(n,r,e,u,i,o,c,a,f){return t.call(this,n,r,e,u,i,o,c,a,f)};case 10:return function(n,r,e,u,i,o,c,a,f,s){return t.call(this,n,r,e,u,i,o,c,a,f,s)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),_n=o(function(n){return-n}),Kn=o(function(n){return!n}),$n=c(function(n,t){var r=0>n?t.length+n:n;return v(t)?t.charAt(r):t[r]}),Hn=o(function(n){return function(){return $n(n,arguments)}}),Xn=c(function(n,t){return t.charAt(0>n?t.length+n:n)}),Yn=c(function(n,t){return t.charCodeAt(0>n?t.length+n:n)}),Zn=o(function(n){return[n]}),Gn=o(function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments))}}),Jn=function(){var n=function(t){return{value:t,map:function(r){return n(r(t))}}};return a(function(t,r,e){return t(function(t){return n(r(t))})(e).value})}(),Qn=c(function(n,t){if(null!=t){for(var r=t,e=0,u=n.length;u>e&&null!=r;e+=1)r=r[n[e]];return r}}),nt=c(function(n,t){for(var r={},e=0;e<n.length;)n[e]in t&&(r[n[e]]=t[n[e]]),e+=1;return r}),tt=c(function(n,t){for(var r={},e=0,u=n.length;u>e;){var i=n[e];r[i]=t[i],e+=1}return r}),rt=c(function(n,t){var r={};for(var e in t)n(t[e],e,t)&&(r[e]=t[e]);return r}),et=c(function(n,t){return u([n],t)}),ut=c(function(n,t){return t[n]}),it=a(function(n,t,r){return null!=r&&h(t,r)?r[t]:n}),ot=a(function(n,t,r){return n(r[t])}),ct=c(function(n,t){for(var r=n.length,e=[],u=0;r>u;)e[u]=t[n[u]],u+=1;return e}),at=c(function(n,t){if(!m(n)||!m(t))throw new TypeError("Both arguments to range must be numbers");for(var r=[],e=n;t>e;)r.push(e),e+=1;return r}),ft=a(function(n,t,r){for(var e=r.length-1;e>=0;)t=n(t,r[e]),e-=1;return t}),st=o(S),lt=a(function(n,t,r){return u(E(r,0,Math.min(n,r.length)),E(r,Math.min(r.length,n+t)))}),pt=a(function(n,t,r){return r.replace(n,t)}),ht=o(function(n){return E(n).reverse()}),gt=a(function(n,t,r){for(var e=0,u=r.length,i=[t];u>e;)t=n(t,r[e]),i[e+1]=t,e+=1;return i}),dt=a(function(n,t,r){return Jn(n,F(t),r)}),yt=c(function(n,t){return E(t).sort(n)}),mt=c(function(n,t){return E(t).sort(function(t,r){var e=n(t),u=n(r);return u>e?-1:e>u?1:0})}),vt=c(function(n,t){return n-t}),wt=c(function(n,t){for(var r=t.length-1;r>=0&&n(t[r]);)r-=1;return E(t,r+1,1/0)}),xt=c(function(n,t){return n(t),t}),bt=c(function(n,t){return r(n).test(t)}),jt=c(function(n,t){for(var r=Number(t),e=new Array(r),u=0;r>u;)e[u]=n(u),u+=1;return e}),Ot=o(function(n){var t=[];for(var r in n)h(r,n)&&(t[t.length]=[r,n[r]]);return t}),St=o(function(n){var t=[];for(var r in n)t[t.length]=[r,n[r]];return t}),Et=function(){var n="	\n\f\r   ᠎             　\u2028\u2029\ufeff",t="​",r="function"==typeof String.prototype.trim;return o(r&&!n.trim()&&t.trim()?function(n){return n.trim()}:function(t){var r=new RegExp("^["+n+"]["+n+"]*"),e=new RegExp("["+n+"]["+n+"]*$");return t.replace(r,"").replace(e,"")})}(),At=o(function(n){return null===n?"Null":void 0===n?"Undefined":Object.prototype.toString.call(n).slice(8,-1)}),It=o(function(n){return function(){return n(E(arguments))}}),kt=o(function(n){return zn(1,n)}),Nt=c(function(n,t){return nn(n,function(){for(var r,e=1,u=t,i=0;n>=e&&"function"==typeof u;)r=e===n?arguments.length:i+u.length,u=u.apply(this,E(arguments,i,r)),e+=1,i=r;return u})}),Ct=c(function(n,t){for(var r=n(t),e=[];r&&r.length;)e[e.length]=r[0],r=n(r[1]);return e}),Mt=c(function(n,t){for(var r,e=0,u=t.length,o=[];u>e;)r=t[e],i(n,r,o)||(o[o.length]=r),e+=1;return o}),Pt=a(function(n,t,r){return U(F(t),n,r)}),Tt=o(function(n){for(var t=In(n),r=t.length,e=[],u=0;r>u;)e[u]=n[t[u]],u+=1;return e}),qt=o(function(n){var t,r=[];for(t in n)r[r.length]=n[t];return r}),Wt=function(){var n=function(n){return{value:n,map:function(){return this}}};return c(function(t,r){return t(n)(r).value})}(),Rt=c(function(n,t){for(var r in n)if(h(r,n)&&!n[r](t[r]))return!1;return!0}),Bt=c(function(n,t){return nn(n.length,function(){return t.apply(this,u([n],arguments))})}),Lt=c(function(n,t){for(var r,e=0,u=n.length,i=t.length,o=[];u>e;){for(r=0;i>r;)o[o.length]=[n[e],t[r]],r+=1;e+=1}return o}),Ut=c(function(n,t){for(var r=[],e=0,u=Math.min(n.length,t.length);u>e;)r[e]=[n[e],t[e]],e+=1;return r}),Ft=c(function(n,t){for(var r=0,e=n.length,u={};e>r;)u[n[r]]=t[r],r+=1;return u}),Dt=a(function(n,t,r){for(var e=[],u=0,i=Math.min(t.length,r.length);i>u;)e[u]=n(t[u],r[u]),u+=1;return e}),Vt=F(!1),zt=F(!0),_t=function(n,t){return function(){var r=arguments.length;if(0===r)return t();var e=arguments[r-1];return d(e)||"function"!=typeof e[n]?t.apply(this,arguments):e[n].apply(e,E(arguments,0,r-1))}},Kt=function pu(n,t,e){var u=function(r){for(var u=t.length,i=0;u>i;){if(n===t[i])return e[i];i+=1}t[i+1]=n,e[i+1]=r;for(var o in n)r[o]=pu(n[o],t,e);return r};switch(At(n)){case"Object":return u({});case"Array":return u([]);case"Date":return new Date(n);case"RegExp":return r(n);default:return n}},$t=function(n){return function(r){var e=E(arguments,1);return t(Math.max(0,r.length-e.length),function(){return r.apply(this,n(e,arguments))})}},Ht=function(n,t,r){return function(){var e=arguments.length;if(0===e)return r();var u=arguments[e-1];if(!d(u)){var i=E(arguments,0,e-1);if("function"==typeof u[n])return u[n].apply(u,i);if(w(u)){var o=t.apply(null,i);return o(u)}}return r.apply(this,arguments)}},Xt=function hu(n,t,r,e){var u=At(n);if(u!==At(t))return!1;if("Boolean"===u||"Number"===u||"String"===u)return"object"==typeof n?"object"==typeof t&&mn(n.valueOf(),t.valueOf()):mn(n,t);if(mn(n,t))return!0;if("RegExp"===u)return n.source===t.source&&n.global===t.global&&n.ignoreCase===t.ignoreCase&&n.multiline===t.multiline&&n.sticky===t.sticky&&n.unicode===t.unicode;if(Object(n)===n){if("Date"===u&&n.getTime()!==t.getTime())return!1;var i=In(n);if(i.length!==In(t).length)return!1;for(var o=r.length-1;o>=0;){if(r[o]===n)return e[o]===t;o-=1}for(r[r.length]=n,e[e.length]=t,o=i.length-1;o>=0;){var c=i[o];if(!h(c,t)||!hu(t[c],n[c],r,e))return!1;o-=1}return r.pop(),e.pop(),!0}return!1},Yt=function(n,t){return null!=t&&!d(t)&&"function"==typeof t[n]},Zt=function(n){return function t(r){for(var e,u,i,o=[],c=0,a=r.length;a>c;){if(Sn(r[c]))for(e=n?t(r[c]):r[c],u=0,i=e.length;i>u;)o[o.length]=e[u],u+=1;else o[o.length]=r[c];c+=1}return o}},Gt=function(){function n(n,t,r){for(var e=0,u=r.length;u>e;){if(t=n["@@transducer/step"](t,r[e]),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}e+=1}return n["@@transducer/result"](t)}function t(n,t,r){for(var e=r.next();!e.done;){if(t=n["@@transducer/step"](t,e.value),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}e=r.next()}return n["@@transducer/result"](t)}function r(n,t,r){return n["@@transducer/result"](r.reduce($(n["@@transducer/step"],n),t))}var e="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(u,i,o){if("function"==typeof u&&(u=B(u)),Sn(o))return n(u,i,o);if("function"==typeof o.reduce)return r(u,i,o);if(null!=o[e])return t(u,i,o[e]());if("function"==typeof o.next)return t(u,i,o);throw new TypeError("reduce: list must be array or iterable")}}(),Jt=function(){var n={"@@transducer/init":Array,"@@transducer/step":function(n,t){return u(n,[t])},"@@transducer/result":g},t={"@@transducer/init":String,"@@transducer/step":function(n,t){return n+t},"@@transducer/result":g},r={"@@transducer/init":Object,"@@transducer/step":function(n,t){return Ln(n,Sn(t)?Q(t[0],t[1]):t)},"@@transducer/result":g};return function(e){if(w(e))return e;if(Sn(e))return n;if("string"==typeof e)return t;if("object"==typeof e)return r;throw new Error("Cannot create transformer for "+e)}}(),Qt=function(){function n(n,t){this.xf=t,this.f=n,this.all=!0}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.all&&(n=this.xf["@@transducer/step"](n,!0)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)||(this.all=!1,n=S(this.xf["@@transducer/step"](n,!1))),n},c(function(t,r){return new n(t,r)})}(),nr=function(){function n(n,t){this.xf=t,this.f=n,this.any=!1}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){return this.any||(n=this.xf["@@transducer/step"](n,!1)),this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){return this.f(t)&&(this.any=!0,n=S(this.xf["@@transducer/step"](n,!0))),n},c(function(t,r){return new n(t,r)})}(),tr=function(){function n(n,t){this.xf=t,this.n=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){return this.n>0?(this.n-=1,n):this.xf["@@transducer/step"](n,t)},c(function(t,r){return new n(t,r)})}(),rr=function(){function n(n,t){this.xf=t,this.f=n}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=k.result,n.prototype["@@transducer/step"]=function(n,t){if(this.f){if(this.f(t))return n;this.f=null}return this.xf["@@transducer/step"](n,t)},c(function(t,r){return new n(t,r)})}(),er=function(){function n(n,t){this.xf=t,this.f=n,this.inputs={}}return n.prototype["@@transducer/init"]=k.init,n.prototype["@@transducer/result"]=function(n){var t;for(t in this.inputs)if(h(t,this.inputs)&&(n=this.xf["@@transducer/step"](n,this.inputs[t]),n["@@transducer/reduced"])){n=n["@@transducer/value"];break}return this.xf["@@transducer/result"](n)},n.prototype["@@transducer/step"]=function(n,t){var r=this.f(t);return this.inputs[r]=this.inputs[r]||[r,[]],this.inputs[r][1]=V(t,this.inputs[r][1]),n},c(function(t,r){return new n(t,r)})}(),ur=o(function(n){return nn(n.length,function(){var t=0,r=arguments[0],e=arguments[arguments.length-1],i=E(arguments);return i[0]=function(){var n=r.apply(this,u(arguments,[t,e]));return t+=1,n},n.apply(this,i)})}),ir=c(Ht("all",Qt,function(n,t){for(var r=0;r<t.length;){if(!n(t[r]))return!1;r+=1}return!0})),or=c(function(n,t){return Yt("and",n)?n.and(t):n&&t}),cr=c(Ht("any",nr,function(n,t){for(var r=0;r<t.length;){if(n(t[r]))return!0;r+=1}return!1})),ar=o(function(n){return zn(2,n)}),fr=o(function(n){return Kt(n,[],[])}),sr=c(function(n,t){if(d(t))return u(n,t);if(Yt("concat",n))return n.concat(t);throw new TypeError("can't concat "+typeof n)}),lr=o(function(n){return nn(n.length,n)}),pr=c(Ht("dropWhile",rr,function(n,t){for(var r=0,e=t.length;e>r&&n(t[r]);)r+=1;return E(t,r)})),hr=c(function(n,t){return Yt("equals",n)?n.equals(t):Yt("equals",t)?t.equals(n):Xt(n,t,[],[])}),gr=c(Ht("filter",N,s)),dr=c(Ht("find",C,function(n,t){for(var r=0,e=t.length;e>r;){if(n(t[r]))return t[r];r+=1}})),yr=c(Ht("findIndex",M,function(n,t){for(var r=0,e=t.length;e>r;){if(n(t[r]))return r;r+=1}return-1})),mr=c(Ht("findLast",P,function(n,t){for(var r=t.length-1;r>=0;){if(n(t[r]))return t[r];r-=1}})),vr=c(Ht("findLastIndex",T,function(n,t){for(var r=t.length-1;r>=0;){if(n(t[r]))return r;r-=1}return-1})),wr=o(Zt(!0)),xr=o(function(n){return lr(function(t,r){var e=E(arguments);return e[0]=r,e[1]=t,n.apply(this,e)})}),br=c(_t("forEach",function(n,t){for(var r=t.length,e=0;r>e;)n(t[e]),e+=1;return t})),jr=o(p(In)),Or=o(p(kn)),Sr=c(Ht("groupBy",er,function(n,t){return Gt(function(t,r){var e=n(r);return t[e]=V(r,t[e]||(t[e]=[])),t},{},t)})),Er=$n(0),Ar=a(function(n,t,r){for(var e=[],u=0;u<t.length;)i(n,t[u],r)&&(e[e.length]=t[u]),u+=1;return Mt(n,e)}),Ir=c(_t("intersperse",function(n,t){for(var r=[],e=0,u=t.length;u>e;)e===u-1?r.push(t[e]):r.push(t[e],n),e+=1;return r})),kr=a(function(n,t,r){return w(n)?Gt(t(n),n["@@transducer/init"](),r):Gt(t(Jt(n)),n,r)}),Nr=o(function(n){for(var t=In(n),r=t.length,e=0,u={};r>e;){var i=t[e],o=n[i],c=h(o,u)?u[o]:u[o]=[];c[c.length]=i,e+=1}return u}),Cr=o(function(n){for(var t=In(n),r=t.length,e=0,u={};r>e;){var i=t[e];u[n[i]]=i,e+=1}return u}),Mr=$n(-1),Pr=c(function(n,t){if(Yt("lastIndexOf",t))return t.lastIndexOf(n);for(var r=t.length-1;r>=0;){if(hr(t[r],n))return r;r-=1}return-1}),Tr=c(Ht("map",q,x)),qr=c(function(n,t){return Gt(function(r,e){return r[e]=n(t[e]),r},{},In(t))}),Wr=c(function(n,t){return Gt(function(r,e){return r[e]=n(t[e],e,t),r},{},In(t))}),Rr=c(e(Ht("any",nr,cr))),Br=c(function(n,t){return Yt("or",n)?n.or(t):n||t}),Lr=lr($t(u)),Ur=lr($t(xr(u))),Fr=c(function(n,t){return Gt(function(t,r){var e=t[n(r)?0:1];return e[e.length]=r,t},[[],[]],t)}),Dr=a(function(n,t,r){return hr(Qn(n,r),t)}),Vr=c(function(n,t){return Tr(ut(n),t)}),zr=a(function(n,t,r){return ot(hr(t),n,r)}),_r=a(function(n,t,r){return ot(On(n),t,r)}),Kr=a(Gt),$r=c(function(n,t){return gr(e(n),t)}),Hr=c(function(n,t){return jt(F(n),t)}),Xr=a(_t("slice",function(n,t,r){return Array.prototype.slice.call(r,n,t)})),Yr=c(function(n,t){if(0>=n)throw new Error("First argument to splitEvery must be a positive integer");for(var r=[],e=0;e<t.length;)r.push(Xr(e,e+=n,t));return r}),Zr=Kr(L,0),Gr=_t("tail",Xr(1,1/0)),Jr=c(Ht("take",W,function(n,t){return Xr(0,0>n?1/0:n,t)})),Qr=c(Ht("takeWhile",R,function(n,t){for(var r=0,e=t.length;e>r&&n(t[r]);)r+=1;return E(t,0,r)})),ne=nn(4,function(n,t,r,e){return Gt(n("function"==typeof t?B(t):t),r,e)}),te=a(function(n,t,r){return Mt(n,u(t,r))}),re=Mt(hr),ee=o(Zt(!1)),ue=lr(function(n){var r=E(arguments,1),e=r.length;return lr(t(e,function(){for(var t=[],u=0;e>u;)t[u]=r[u](arguments[u]),u+=1;return n.apply(this,t.concat(E(arguments,e)))}))}),ie=c(function(n,t){return Rt(qr(hr,n),t)}),oe=function(){var n=function(n){return{"@@transducer/init":k.init,"@@transducer/result":function(t){return n["@@transducer/result"](t)},"@@transducer/step":function(t,r){var e=n["@@transducer/step"](t,r);return e["@@transducer/reduced"]?l(e):e}}};return function(t){var r=n(t);return{"@@transducer/init":k.init,"@@transducer/result":function(n){return r["@@transducer/result"](n)},"@@transducer/step":function(n,t){return Sn(t)?Gt(r,n,t):Gt(r,n,[t])}}}}(),ce=function(n,t,r){for(var e=r;e<n.length;){if(hr(n[e],t))return e;e+=1}return-1},ae=function(n){return function(r){var e=function(){var t=arguments;return n(function(n){return n.apply(null,t)},r)};return arguments.length>1?e.apply(null,E(arguments,1)):t(Math.max.apply(Math,Vr("length",r)),e)}},fe=c(function(n,t){return Tr(n,oe(t))}),se=o(ae(ir)),le=o(ae(cr)),pe=c(function(n,t){return Yt("ap",n)?n.ap(t):Gt(function(n,r){return u(n,Tr(r,t))},[],n)}),he=lr(function(n){return n.apply(this,E(arguments,1))}),ge=c(Ht("chain",fe,function(n,t){return ee(Tr(n,t))})),de=a(function(n,t,r){function e(t,r){return pe(Tr(V,n(r)),t)}return Gt(e,t([]),r)}),ye=c(function(n,t){if(n>10)throw new Error("Constructor with greater than ten arguments");return 0===n?function(){return new t}:lr(zn(n,function(n,r,e,u,i,o,c,a,f,s){switch(arguments.length){case 1:return new t(n);case 2:return new t(n,r);case 3:return new t(n,r,e);case 4:return new t(n,r,e,u);case 5:return new t(n,r,e,u,i);case 6:return new t(n,r,e,u,i,o);case 7:return new t(n,r,e,u,i,o,c);case 8:return new t(n,r,e,u,i,o,c,a);case 9:return new t(n,r,e,u,i,o,c,a,f);case 10:return new t(n,r,e,u,i,o,c,a,f,s)}}))}),me=nn(3,function(n){var t=E(arguments,1);return nn(Math.max.apply(Math,Vr("length",t)),function(){var r=arguments,e=this;return n.apply(e,x(function(n){return n.apply(e,r)},t))})}),ve=c(Ht("drop",tr,function(n,t){return Xr(Math.max(0,n),1/0,t)})),we=c(function(n,t){return Jr(n<t.length?t.length-n:0,t)}),xe=c(Ht("dropRepeatsWith",I,function(n,t){var r=[],e=1,u=t.length;if(0!==u)for(r[0]=t[0];u>e;)n(Mr(r),t[e])||(r[r.length]=t[e]),e+=1;return r})),be=a(function(n,t,r){return hr(t[n],r[n])}),je=c(function(n,t){return Yt("indexOf",t)?t.indexOf(n):ce(t,n,0)}),Oe=Xr(0,-1),Se=o(function(n){for(var t=n.length,r=0;t>r;){if(ce(n,n[r],r+1)>=0)return!1;r+=1}return!0}),Ee=c(function(n,t){return function(r){return function(e){return Tr(function(n){return t(n,e)},r(n(e)))}}}),Ae=o(function(n){return Ee($n(n),Pt(n))}),Ie=o(function(n){return Ee(ut(n),_(n))}),ke=c(function(n,t){var r=nn(n,t);return nn(n,function(){return Gt(pe,Tr(r,arguments[0]),E(arguments,1))})}),Ne=o(function(n){return Zr(n)/n.length}),Ce=o(function(n){var t=n.length;if(0===t)return NaN;var r=2-t%2,e=(t-r)/2;return Ne(E(n).sort(function(n,t){return t>n?-1:n>t?1:0}).slice(e,e+r))}),Me=o(function(n){return Kr(Ln,{},n)}),Pe=function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return nn(arguments[0].length,Kr(b,arguments[0],Gr(arguments)))},Te=function(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return nn(arguments[0].length,Kr(j,arguments[0],Gr(arguments)))},qe=Kr(Vn,1),We=ue(x,tt,vn),Re=c(function(n,t){return ve(n>=0?t.length-n:0,t)}),Be=function(n,t){return ce(t,n,0)>=0},Le=function gu(n,t){var r=function(r){var e=t.concat([n]);return Be(r,e)?"<Circular>":gu(r,e)},e=function(n,t){return x(function(t){return O(t)+": "+r(n[t])},t.slice().sort())};switch(Object.prototype.toString.call(n)){case"[object Arguments]":return"(function() { return arguments; }("+x(r,n).join(", ")+"))";case"[object Array]":return"["+x(r,n).concat(e(n,$r(bt(/^\d+$/),In(n)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof n?"new Boolean("+r(n.valueOf())+")":n.toString();case"[object Date]":return"new Date("+O(A(n))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof n?"new Number("+r(n.valueOf())+")":1/n===-(1/0)?"-0":n.toString(10);case"[object String]":return"object"==typeof n?"new String("+r(n.valueOf())+")":O(n);case"[object Undefined]":return"undefined";default:return"function"==typeof n.constructor&&"Object"!==n.constructor.name&&"function"==typeof n.toString&&"[object Object]"!==n.toString()?n.toString():"{"+e(n,In(n)).join(", ")+"}"}},Ue=de(vn),Fe=function(){if(0===arguments.length)throw new Error("compose requires at least one argument");return Pe.apply(this,ht(arguments))},De=function(){return 0===arguments.length?vn:Fe.apply(this,Tr(ge,arguments))},Ve=function(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return Te.apply(this,ht(arguments))},ze=o(function(n){return ye(n.length,n);
}),_e=c(Be),Ke=c(function(n,t){for(var r=[],e=0,u=n.length;u>e;)Be(n[e],t)||Be(n[e],r)||(r[r.length]=n[e]),e+=1;return r}),$e=o(Ht("dropRepeats",I(hr),xe(hr))),He=c(function(n,t){return re(s(xr(Be)(n),t))}),Xe=o(function(n){return ke(n.length,n)}),Ye=c(function(n,t){var r={};for(var e in t)Be(e,n)||(r[e]=t[e]);return r}),Ze=function(){return De.apply(this,ht(arguments))},Ge=o(function(n){return Le(n,[])}),Je=c(Fe(re,u)),Qe=c(function(n,t){for(var r,e,u=0,i=[],o=[];u<t.length;)e=t[u],r=n(e),Be(r,i)||(o.push(e),i.push(r)),u+=1;return o}),nu=c(function(n,t){return nn(n+1,function(){var r=arguments[n];if(null!=r&&On(Function,r[t]))return r[t].apply(r,E(arguments,0,n));throw new TypeError(Ge(r)+' does not have a method named "'+t+'"')})}),tu=nu(1,"join"),ru=o(function(n){var t={};return function(){var r=Ge(arguments);return h(r,t)||(t[r]=n.apply(this,arguments)),t[r]}}),eu=nu(1,"split"),uu=nu(0,"toLowerCase"),iu=nu(0,"toUpperCase"),ou={F:Vt,T:zt,__:n,add:L,addIndex:ur,adjust:U,all:ir,allPass:se,always:F,and:or,any:cr,anyPass:le,ap:pe,aperture:D,append:V,apply:z,assoc:_,assocPath:K,binary:ar,bind:$,both:H,call:he,chain:ge,clone:fr,commute:Ue,commuteMap:de,comparator:X,complement:Y,compose:Fe,composeK:De,composeP:Ve,concat:sr,cond:Z,construct:ze,constructN:ye,contains:_e,containsWith:G,converge:me,countBy:J,createMapEntry:Q,curry:lr,curryN:nn,dec:tn,defaultTo:rn,difference:Ke,differenceWith:en,dissoc:un,dissocPath:on,divide:cn,drop:ve,dropLast:we,dropLastWhile:an,dropRepeats:$e,dropRepeatsWith:xe,dropWhile:pr,either:fn,empty:sn,eqProps:be,equals:hr,evolve:ln,filter:gr,find:dr,findIndex:yr,findLast:mr,findLastIndex:vr,flatten:wr,flip:xr,forEach:br,fromPairs:pn,functions:jr,functionsIn:Or,groupBy:Sr,gt:hn,gte:gn,has:dn,hasIn:yn,head:Er,identical:mn,identity:vn,ifElse:wn,inc:xn,indexOf:je,init:Oe,insert:bn,insertAll:jn,intersection:He,intersectionWith:Ar,intersperse:Ir,into:kr,invert:Nr,invertObj:Cr,invoker:nu,is:On,isArrayLike:Sn,isEmpty:En,isNil:An,isSet:Se,join:tu,keys:In,keysIn:kn,last:Mr,lastIndexOf:Pr,length:Nn,lens:Ee,lensIndex:Ae,lensProp:Ie,lift:Xe,liftN:ke,lt:Cn,lte:Mn,map:Tr,mapAccum:Pn,mapAccumRight:Tn,mapObj:qr,mapObjIndexed:Wr,match:qn,mathMod:Wn,max:Rn,maxBy:Bn,mean:Ne,median:Ce,memoize:ru,merge:Ln,mergeAll:Me,min:Un,minBy:Fn,modulo:Dn,multiply:Vn,nAry:zn,negate:_n,none:Rr,not:Kn,nth:$n,nthArg:Hn,nthChar:Xn,nthCharCode:Yn,of:Zn,omit:Ye,once:Gn,or:Br,over:Jn,partial:Lr,partialRight:Ur,partition:Fr,path:Qn,pathEq:Dr,pick:nt,pickAll:tt,pickBy:rt,pipe:Pe,pipeK:Ze,pipeP:Te,pluck:Vr,prepend:et,product:qe,project:We,prop:ut,propEq:zr,propIs:_r,propOr:it,propSatisfies:ot,props:ct,range:at,reduce:Kr,reduceRight:ft,reduced:st,reject:$r,remove:lt,repeat:Hr,replace:pt,reverse:ht,scan:gt,set:dt,slice:Xr,sort:yt,sortBy:mt,split:eu,splitEvery:Yr,subtract:vt,sum:Zr,tail:Gr,take:Jr,takeLast:Re,takeLastWhile:wt,takeWhile:Qr,tap:xt,test:bt,times:jt,toLower:uu,toPairs:Ot,toPairsIn:St,toString:Ge,toUpper:iu,transduce:ne,trim:Et,type:At,unapply:It,unary:kt,uncurryN:Nt,unfold:Ct,union:Je,unionWith:te,uniq:re,uniqBy:Qe,uniqWith:Mt,unnest:ee,update:Pt,useWith:ue,values:Tt,valuesIn:qt,view:Wt,where:Rt,whereEq:ie,wrap:Bt,xprod:Lt,zip:Ut,zipObj:Ft,zipWith:Dt};"object"==typeof exports?module.exports=ou:"function"==typeof define&&define.amd?define(function(){return ou}):this.R=ou}).call(this);

},{}],2:[function(require,module,exports){
var Tetris;!function(t){var i=function(){function t(){}return t.borderWidth=4,t.borderHeight=4,t.tileSize=30,t.offsetX=40,t.offsetY=-2*(t.tileSize-1),t.boardWidth=10,t.boardWidthInPixels=t.offsetX+2*t.borderWidth+t.boardWidth*t.tileSize,t.boardHeight=22,t.boardHeightInPixels=t.offsetY+2*t.borderWidth+t.boardHeight*t.tileSize,t.moveTimerRate=.1,t.animationTime=300,t}();t.Config=i}(Tetris||(Tetris={}));var Tetris;!function(t){!function(t){t[t.Empty=0]="Empty",t[t.Taken=1]="Taken"}(t.BlockStatus||(t.BlockStatus={}));t.BlockStatus;!function(t){t[t.Left=-1]="Left",t[t.Right=1]="Right",t[t.Up=2]="Up",t[t.Down=4]="Down"}(t.Direction||(t.Direction={}));t.Direction}(Tetris||(Tetris={}));var __extends=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o]);e.prototype=i.prototype,t.prototype=new e},Tetris;!function(t){var i=function(i){function e(){i.apply(this,arguments)}return __extends(e,i),e.prototype.update=function(){(this.game.input.mouse.isDown||this.startKey.isDown)&&this.game.states.switchState("main")},e.prototype.create=function(){i.prototype.create.call(this),this.addChild(new Kiwi.GameObjects.TextField(this,"Tetris clone",t.Config.boardWidthInPixels/2,200,"#000",30)),this.addChild(new Kiwi.GameObjects.TextField(this,"Default controls for the game are:",t.Config.boardWidthInPixels/2,250,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"Move - arrow keys",t.Config.boardWidthInPixels/2,280,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Rotate counterclockwise - z",t.Config.boardWidthInPixels/2,300,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Rotate clockwise - x",t.Config.boardWidthInPixels/2,320,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Rotate both ways - up arrow",t.Config.boardWidthInPixels/2,340,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Soft drop - down key",t.Config.boardWidthInPixels/2,360,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Hard drop - space",t.Config.boardWidthInPixels/2,380,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"Hold - shift",t.Config.boardWidthInPixels/2,400,"#000",16)),this.addChild(new Kiwi.GameObjects.TextField(this,"On mobile you can play",t.Config.boardWidthInPixels/2,440,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"with on screen buttons",t.Config.boardWidthInPixels/2,460,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"or by dragging on screen",t.Config.boardWidthInPixels/2,480,"#000",20)),this.addChild(new Kiwi.GameObjects.TextField(this,"Click on screen to play",t.Config.boardWidthInPixels/2,510,"#000",25)),this.getAllChildren().forEach(function(t){return t.textAlign="center"}),this.startKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.SPACEBAR)},e}(Kiwi.State);t.MenuState=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function t(t,i){this.x=t,this.y=i}return t.prototype.isLower=function(t){return this.y>t.y},t}();t.Position=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function i(i,e,o,s){this.size=t.Config.tileSize,this.x=i,this.y=e,s&&(this.sprite=new Kiwi.GameObjects.Sprite(o,s,t.Config.offsetX+t.Config.borderWidth+i*(this.size-1),t.Config.offsetY+t.Config.borderWidth+e*(this.size-1)))}return i.prototype.fall=function(t){void 0===t&&(t=1),this.y+=t,this.sprite&&(this.sprite.transform.y+=t*(this.size-1))},i.prototype.move=function(t){this.x+=t,this.sprite&&(this.sprite.transform.x+=t*(this.size-1))},i.prototype.setPosition=function(t){var i=t.x-this.x,e=t.y-this.y;this.x=t.x,this.y=t.y,this.sprite&&(this.sprite.transform.x+=i*(this.size-1),this.sprite.transform.y+=e*(this.size-1))},i.prototype.getPosition=function(){return new t.Position(this.x,this.y)},i.prototype.destroy=function(i){var e=this;if(void 0===i&&(i=!1),this.sprite)if(i){var o=this.sprite.state.game.tweens.create(this.sprite);o.to({alpha:0},t.Config.animationTime,Kiwi.Animations.Tweens.Easing.Bounce.In,!0).onComplete(function(){return e.sprite.destroy()},this)}else this.sprite.destroy()},i}();t.Block=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(i){var e=function(){function i(t){this.currentRotation=0,this.currentTest=0,this.nextPositions=[],this.blocks=[],this.state=t,this.gameObject=new Kiwi.Group(t)}return i.prototype.addBlock=function(i,e,o,s){void 0===s&&(s=!1);var n=new t.Block(e,o,this.state,this.state.textures["block-"+i]);this.blocks.push(n),this.gameObject.addChild(n.sprite),s&&(this.center=n)},i.prototype.getGameObject=function(){return this.gameObject},i.prototype.getBlocks=function(){return this.blocks},i.prototype.destroy=function(){this.getBlocks().forEach(function(t){return t.destroy()})},i.prototype.getPositions=function(t){return void 0===t&&(t=this.blocks),t.map(function(t){return t.getPosition()})},i.prototype.fall=function(t){var i=this;return void 0===t&&(t=1),this.blocks.forEach(function(e){return e==i.center?!0:void e.fall(t)}),this.center.fall(t),this},i.prototype.setByPointerPosition=function(i){var e=this;return this.blocks.forEach(function(o){return o==e.center?!0:void o.setPosition(new t.Position(o.x+i,o.y))}),this.center.setPosition(new t.Position(this.center.x+i,this.center.y)),this},i.prototype.move=function(t){var i=this;return this.blocks.forEach(function(e){return e==i.center?!0:void e.move(t)}),this.center.move(t),this},i.prototype.getRotations=function(){return i.rotations},i.prototype.getNextRotation=function(i){var e=[];if(5==this.currentTest)return this.currentTest=0,e;var o=this.getRotations(),s=this.center.x,n=this.center.y,r=i*o[this.currentRotation][this.currentTest][0],h=i*o[this.currentRotation][this.currentTest][1],a=new t.Position(s+r,n+h);return this.blocks.forEach(function(o){var r=i*(o.x-s),h=i*(o.y-n);e.push(new t.Position(a.x-h,a.y+r))}),this.nextCenter=a,this.nextPositions=e,this.direction=i,this.currentTest++,e},i.prototype.rotate=function(){var i=this;return this.nextCenter||this.getNextRotation(1),this.center.setPosition(new t.Position(this.nextCenter.x,this.nextCenter.y)),this.blocks.forEach(function(e,o){return e==i.center?!0:void e.setPosition(new t.Position(i.nextPositions[o].x,i.nextPositions[o].y))}),this.currentTest=0,this.currentRotation+=this.direction,4==this.currentRotation&&(this.currentRotation=0),-1==this.currentRotation&&(this.currentRotation=3),this},i.rotations=[[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]]],i}();i.Shape=e}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(){function i(t){this.shapes=["I","J","L","O","S","T","Z"],this.shapeStack=[],this.state=t}return i.shuffle=function(t){for(var i,e,o=t.length;o>0;)e=Math.floor(Math.random()*o),o--,i=t[o],t[o]=t[e],t[e]=i;return t},i.prototype.getNextShape=function(t){if(void 0===t&&(t=!1),this.shapeStack.length<2){var e=this.shapes.slice(0);e.forEach(function(t,i){return e[i]="Shape"+t}),this.shapeStack=this.shapeStack.concat(i.shuffle(e))}return t?this.shapeStack.shift():this.shapeStack[0]},i.prototype.createNewShape=function(i,e,o,s){void 0===i&&(i=!1),void 0===e&&(e=""),void 0===o&&(o=4),void 0===s&&(s=1),0==e.length&&(e=this.getNextShape(!0));var n=new t[e](this.state,o,s);return i&&this.state.addChild(n.getGameObject()),n},i}();t.ShapeStack=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function i(i,e,o){var s=this;this.blocks=[],this.state=i,this.gameObject=new Kiwi.Group(i),e.forEach(function(i){var e=new t.Block(i.x,i.y+o,s.state,s.state.textures["block-ghost"]);s.blocks.push(e),s.gameObject.addChild(e.sprite)})}return i.prototype.getGameObject=function(){return this.gameObject},i.prototype.setPosition=function(i,e){this.blocks.forEach(function(o,s){o.setPosition(new t.Position(i[s].x,i[s].y+e))})},i}();t.Ghost=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=require("ramda"),e=function(){function e(i){this.height=t.Config.boardHeight,this.width=t.Config.boardWidth,this.blocks=[],this.highestPositions=[],this.state=i;for(var e=0;e<this.height;e++)this.blocks[e]=[];for(var e=0;e<this.width;e++)this.highestPositions[e]=new t.Position(e,this.height)}return e.prototype.emptyPositions=function(t){var i=this;return 0===t.filter(function(t){return t.x<0||t.x>i.width-1||t.y>i.height-1||t.y<0||void 0!==i.blocks[t.y][t.x]}).length},e.prototype.emptyDirection=function(i,e){var o=this;return 0===i.filter(function(i){return e===t.Direction.Down&&(i.y===o.height-1||void 0!==o.blocks[i.y+1][i.x])||e===t.Direction.Left&&(0===i.x||void 0!==o.blocks[i.y][i.x-1])||e===t.Direction.Right&&(i.x===o.width-1||void 0!==o.blocks[i.y][i.x+1])}).length},e.prototype.refreshHighestPosition=function(t){this.highestPositions[t.x]=this.highestPositions[t.x].isLower(t)?t:this.highestPositions[t.x]},e.prototype.refreshHighestPositions=function(t){var i=this;void 0===t&&(t=[]),this.highestPositions.forEach(function(e,o){i.highestPositions[o].y=i.height;var s=t.filter(function(t){return t.x==o}).map(function(t){return t.y})[0];s=s?s:0;for(var n=s;n<i.height;n++)if(i.blocks[n][o]){i.highestPositions[o].y=n;break}})},e.prototype.setBlocks=function(i,e){var o=this;return void 0===e&&(e=t.BlockStatus.Taken),i.forEach(function(i){o.blocks[i.y][i.x]=e===t.BlockStatus.Taken?i:void 0,e===t.BlockStatus.Taken&&o.refreshHighestPosition(i.getPosition())}),this},e.prototype.checkRows=function(i){var e=this,o=this.getRowsToClear(i);return o.length>0&&(this.clearRows(o),this.state.game.time.clock.setTimeout(function(){e.fallBlocks(o),e.refreshHighestPositions()},t.Config.animationTime,this)),o.length},e.prototype.getRowsToClear=function(t){var e=this,o=i.uniq(t.filter(function(t){return e.blocks[t.y].length===e.width&&!i.contains(void 0,e.blocks[t.y])}).map(function(t){return t.y}));return i.sort(function(t,i){return i-t},o)},e.prototype.clearRows=function(i){var e=this;i.forEach(function(i){e.blocks[i].forEach(function(t){return t.destroy(!0)}),e.setBlocks(e.blocks[i],t.BlockStatus.Empty)})},e.prototype.fallBlocks=function(e){var o=this;e.forEach(function(s,n){var r=n+1,h=e[r]?e[r]:0,a=i.flatten(i.reverse(o.blocks.filter(function(t,i){return s>=i&&i>=h}))).filter(function(t){return void 0!==t});a.forEach(function(i){o.setBlocks([i],t.BlockStatus.Empty),i.setPosition(new t.Position(i.x,i.y+r)),o.setBlocks([i],t.BlockStatus.Taken)})})},e.prototype.findDistanceToFall=function(t){var i=this;return this.refreshHighestPositions(t),t.reduce(function(t,e){var o=Math.sqrt(Math.pow(i.highestPositions[e.x].y-e.y,2))-1;return t>o?o:t},this.height)},e.prototype.findValidPosition=function(t,i){var e=this;return 0===t?0:i.reduce(function(i,o){var s=o.x+t,n=t;return 0>s&&(n=t-s),s>e.width-1&&(n=t-(s-(e.width-1))),Math.abs(n)<Math.abs(i)?n:i},t)},e}();t.Board=e}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function t(t){void 0===t&&(t=1),this.score=0,this.level=1,this.rowsCleared=0,this.level=t}return t.prototype.checkLevel=function(t){this.rowsCleared+=t,this.rowsCleared>10*this.level&&this.level++},t.prototype.getInfo=function(){return{score:this.score,level:this.level,lines:this.rowsCleared}},t.prototype.getFallingDelay=function(){var t=this.level<10?this.level:10;return.05*(11-t)},t.prototype.addRowsCleared=function(t){switch(t){case 1:this.score+=40*this.level;break;case 2:this.score+=100*this.level;break;case 3:this.score+=300*this.level;break;case 4:this.score+=1200*this.level;break;default:return}this.checkLevel(t)},t.prototype.addSoftDrop=function(){this.score++},t.prototype.addHardDrop=function(t){this.score+=2*t},t}();t.ScoringManager=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(){function i(t,i,e,o,s){this.state=t,this.levelObject=e,this.scoreObject=o,this.linesObject=s,this.scoringManager=i}return i.prototype.updateScore=function(){var t=this.scoringManager.getInfo();this.scoreObject.text=t.score.toString(),this.levelObject.text=t.level.toString(),this.linesObject.text=t.lines.toString()},i.setUpSprite=function(i,e,o,s){var n=i.getGameObject();return"ShapeI"==e&&(i.rotate().rotate(),o-=20,s-=15),"ShapeO"==e&&(o-=10,s+=4),n.y=s,n.x=o,n.scale=.7,n.getAllChildren().forEach(function(i){i.alpha=0;var e=i.state.game.tweens.create(i);e.to({alpha:1},t.Config.animationTime,Kiwi.Animations.Tweens.Easing.Sinusoidal.In,!0)}),n},i.prototype.setNextShape=function(e){this.nextShape&&this.nextShape.getGameObject().destroy(),this.nextShape=new t.Shapes[e](this.state,0,0),"ShapeI"==e&&(this.nextShape.rotate(),this.nextShape.rotate()),this.state.addChild(i.setUpSprite(this.nextShape,e,t.Config.boardWidthInPixels-6,285))},i.prototype.setHeldShape=function(e){this.heldShape&&this.heldShape.getGameObject().destroy(),this.heldShape=new t.Shapes[e](this.state,0,0),"ShapeI"==e&&(this.heldShape.rotate(),this.heldShape.rotate()),this.state.addChild(i.setUpSprite(this.heldShape,e,t.Config.boardWidthInPixels-6,435))},i}();t.Hud=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(i){function e(){i.apply(this,arguments),this.holdKeyIsDown=!1,this.canHold=!0,this.moveKeyIsDown=!1,this.rotateKeyIsDown=!1,this.rotationDirection=0,this.dropping=!1,this.animationsStarted=!1,this.blocks=["blue","cyan","green","orange","purple","red","yellow"]}return __extends(e,i),e.prototype.preload=function(){var t=this;i.prototype.preload.call(this),this.addImage("board","assets/img/board.png"),this.addImage("borders","assets/img/borders.png"),this.addImage("hudBorders","assets/img/hud-borders.png"),this.blocks.forEach(function(i){return t.addImage("block-"+i,"assets/img/block-"+i+".png")}),this.addImage("block-ghost","assets/img/block-ghost.png"),this.addSpriteSheet("controlArrow","assets/img/control-arrow.png",51,73),this.addSpriteSheet("controlButton","assets/img/control-button.png",100,100)},e.prototype.moveControls=function(){if(this.boardSprite.input.withinBounds){var i=Math.trunc((this.game.input.x-t.Config.offsetX-t.Config.borderWidth)/(t.Config.tileSize-1)),e=Math.trunc(i-this.currentShape.center.x);("ShapeI"==this.currentShape.name||"ShapeO"==this.currentShape.name)&&(e=Math.round(i-this.currentShape.center.x)-1),"ShapeI"==this.currentShape.name&&3==this.currentShape.currentRotation&&e++,3==this.currentShape.currentRotation&&9==i&&e++;var o=this.board.findValidPosition(e,this.currentShape.getPositions());return this.currentShape.setByPointerPosition(o),void this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions()))}var s=this.leftKey.isDown||this.leftKeyScreen.isDown,n=this.rightKey.isDown||this.rightKeyScreen.isDown,r=n?t.Direction.Right:t.Direction.Left;(s||n)&&!this.moveKeyIsDown&&this.board.emptyDirection(this.currentShape.getBlocks(),r)&&(this.moveKeyIsDown=!0,this.currentShape.move(r),this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions())),this.moveTimer.start())},e.prototype.rotate=function(t){for(var i=this.currentShape.getNextRotation(t),e=!1;i.length>0;){if(this.board.emptyPositions(i)){e=!0,this.currentShape.rotate(),this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions()));break}if(e)break;i=this.currentShape.getNextRotation(t)}return e},e.prototype.afterShapeLanded=function(){return this.animationsStarted=!1,this.createNewShape(),this.board.emptyPositions(this.currentShape.getPositions())?(this.canHold=!0,this.addChild(this.currentShape.getGameObject()),this.hud.setNextShape(this.shapeStack.getNextShape()),void this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions()))):void this.game.states.switchState("gameOver",null,null,this.scoringManager.getInfo())},e.prototype.fallDown=function(i,e){var o=this;if(void 0===i&&(i=1),void 0===e&&(e=!1),!this.animationsStarted&&(!this.board.emptyDirection(this.currentShape.getBlocks(),t.Direction.Down)||(.01===this.fallTimer.delay&&this.scoringManager.addSoftDrop(),this.currentShape.fall(i),e))){this.board.setBlocks(this.currentShape.getBlocks(),t.BlockStatus.Taken);var s=this.board.checkRows(this.currentShape.getBlocks());this.scoringManager.addRowsCleared(s),s?(this.animationsStarted=!0,this.game.time.clock.setTimeout(function(){o.afterShapeLanded()},t.Config.animationTime,this)):this.afterShapeLanded()}},e.prototype.rotationControls=function(){this.rotateCounterClockwiseKey.isDown||this.rotateCounterClockwiseScreen.isDown?this.rotationDirection=t.Direction.Left:this.rotateClockwiseKey.isDown||this.rotateClockwiseScreen.isDown?this.rotationDirection=t.Direction.Right:(this.rotateBothKey.isDown||this.rotateBothScreen.isDown||this.boardSprite.input.isDown)&&(this.rotationDirection=t.Direction.Up),0===this.rotationDirection||this.rotateKeyIsDown||(this.rotateKeyIsDown=!0,this.rotationDirection==t.Direction.Up?this.rotate(t.Direction.Right)||this.rotate(t.Direction.Left):this.rotate(this.rotationDirection)),(this.rotationDirection==t.Direction.Right&&this.rotateClockwiseKey.isUp&&this.rotateClockwiseScreen.isUp||this.rotationDirection==t.Direction.Left&&this.rotateCounterClockwiseKey.isUp&&this.rotateCounterClockwiseScreen.isUp||this.rotationDirection==t.Direction.Up&&this.rotateBothKey.isUp&&this.rotateBothScreen.isUp&&this.boardSprite.input.isUp)&&(this.rotateKeyIsDown=!1,this.rotationDirection=0)},e.prototype.dropDownControls=function(){if((this.hardDropKey.isDown||this.hardDropScreen.isDown)&&!this.dropping){this.dropping=!0;var t=this.board.findDistanceToFall(this.currentShape.getPositions());this.fallDown(t,!0),this.scoringManager.addHardDrop(t)}this.hardDropKey.isUp&&this.hardDropScreen.isUp&&this.dropping&&(this.dropping=!1)},e.prototype.fallTimerControls=function(){this.fallTimer.delay=this.scoringManager.getFallingDelay(),(this.softDropKey.isDown||this.softDropScreen.isDown)&&(this.fallTimer.delay=.01)},e.prototype.holdControls=function(){if((this.holdKey.isDown||this.holdSprite.input.isDown)&&!this.holdKeyIsDown&&this.canHold){this.holdKeyIsDown=!0;var t=this.heldShape?this.heldShape:"";this.heldShape=this.currentShape.name,this.currentShape.destroy(),this.createNewShape(!0,t),t||this.hud.setNextShape(this.shapeStack.getNextShape()),this.hud.setHeldShape(this.heldShape),this.ghost.setPosition(this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions())),this.canHold=!1}this.holdKey.isUp&&this.holdSprite.input.isUp&&this.holdKeyIsDown&&(this.holdKeyIsDown=!1)},e.prototype.update=function(){i.prototype.update.call(this),this.animationsStarted||(this.moveControls(),this.rotationControls(),this.dropDownControls(),this.fallTimerControls(),this.holdControls(),this.fallTimer.start(),this.hud.updateScore())},e.prototype.createNewShape=function(t,i,e,o,s){void 0===t&&(t=!1),void 0===i&&(i=""),void 0===e&&(e=4),void 0===o&&(o=1),void 0===s&&(s=!1),this.currentShape=this.shapeStack.createNewShape(t,i,e,o),this.board.refreshHighestPositions(),s&&this.board.setBlocks(this.currentShape.getBlocks())},e.prototype.create=function(){var e=this;i.prototype.create.call(this),this.rotateBothScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,95,t.Config.boardHeightInPixels-30),this.rotateBothScreen.rotPointX=.5*this.rotateBothScreen.width,this.rotateBothScreen.rotPointY=.5*this.rotateBothScreen.height,this.rotateBothScreen.rotation=Math.PI/2,this.addChild(this.rotateBothScreen),this.leftKeyScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,30,t.Config.boardHeightInPixels+35),this.addChild(this.leftKeyScreen),this.rightKeyScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,160,t.Config.boardHeightInPixels+35),this.rightKeyScreen.rotPointX=.5*this.rightKeyScreen.width,this.rightKeyScreen.rotPointY=.5*this.rightKeyScreen.height,this.rightKeyScreen.rotation=Math.PI,this.addChild(this.rightKeyScreen),this.softDropScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlArrow,95,t.Config.boardHeightInPixels+100),this.softDropScreen.rotPointX=.5*this.softDropScreen.width,this.softDropScreen.rotPointY=.5*this.softDropScreen.height,this.softDropScreen.rotation=-Math.PI/2,this.addChild(this.softDropScreen),this.rotateClockwiseScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlButton,210,t.Config.boardHeightInPixels-30),this.rotateClockwiseScreen.scaleX=.6,this.rotateClockwiseScreen.scaleY=.6,this.addChild(this.rotateClockwiseScreen),this.rotateCounterClockwiseScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlButton,280,t.Config.boardHeightInPixels-30),this.rotateCounterClockwiseScreen.scaleX=.6,this.rotateCounterClockwiseScreen.scaleY=.6,this.addChild(this.rotateCounterClockwiseScreen),this.hardDropScreen=new Kiwi.Plugins.GameObjects.TouchButton(this,this.textures.controlButton,330,460),this.hardDropScreen.scaleX=.6,this.hardDropScreen.scaleY=.6,this.addChild(this.hardDropScreen),this.leftKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.LEFT),this.rightKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.RIGHT),this.rotateBothKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.UP),this.rotateClockwiseKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.Z),this.rotateCounterClockwiseKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.X),this.softDropKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.DOWN),this.hardDropKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.SPACEBAR),this.holdKey=this.game.input.keyboard.addKey(Kiwi.Input.Keycodes.SHIFT);var o=new Kiwi.GameObjects.TextField(this,"Score",t.Config.boardWidthInPixels,0,"#000",24);this.addChild(o);var s=new Kiwi.GameObjects.TextField(this,"0",t.Config.boardWidthInPixels,25,"#000",24);this.addChild(s);var n=new Kiwi.GameObjects.TextField(this,"Level",t.Config.boardWidthInPixels,60,"#000",24);this.addChild(n);var r=new Kiwi.GameObjects.TextField(this,"0",t.Config.boardWidthInPixels,85,"#000",24);this.addChild(r);var h=new Kiwi.GameObjects.TextField(this,"Lines",t.Config.boardWidthInPixels,110,"#000",24);this.addChild(h);var a=new Kiwi.GameObjects.TextField(this,"0",t.Config.boardWidthInPixels,135,"#000",24);this.addChild(a),this.boardSprite=new Kiwi.GameObjects.Sprite(this,this.textures.board,t.Config.offsetX+t.Config.borderWidth,t.Config.borderHeight),this.boardSprite.input.enabled=!0,this.addChild(this.boardSprite);var c=new Kiwi.GameObjects.StaticImage(this,this.textures.borders,t.Config.offsetX,0);this.addChild(c);var d=new Kiwi.GameObjects.TextField(this,"Next",t.Config.boardWidthInPixels,170,"#000",24);this.addChild(d);var l=new Kiwi.GameObjects.StaticImage(this,this.textures.hudBorders,t.Config.boardWidthInPixels+20,235);l.scaleX=2.5,l.scaleY=3.5,this.addChild(l);var p=new Kiwi.GameObjects.TextField(this,"Hold",t.Config.boardWidthInPixels,320,"#000",24);this.addChild(p),this.holdSprite=new Kiwi.GameObjects.Sprite(this,this.textures.hudBorders,t.Config.boardWidthInPixels+20,385),this.holdSprite.scaleX=2.5,this.holdSprite.scaleY=3.5,this.holdSprite.input.enabled=!0,this.addChild(this.holdSprite),this.moveTimer=this.game.time.clock.createTimer("move",t.Config.moveTimerRate,0),this.moveTimer.createTimerEvent(Kiwi.Time.TimerEvent.TIMER_STOP,function(){e.moveKeyIsDown=!1},this),this.fallTimer=this.game.time.clock.createTimer("fall",.5,0),this.fallTimer.createTimerEvent(Kiwi.Time.TimerEvent.TIMER_STOP,this.fallDown,this),this.board=new t.Board(this),this.shapeStack=new t.Shapes.ShapeStack(this),this.scoringManager=new t.ScoringManager(1),this.hud=new t.Hud(this,this.scoringManager,r,s,a),this.createNewShape(!0),this.hud.setNextShape(this.shapeStack.getNextShape()),this.ghost=new t.Ghost(this,this.currentShape.getPositions(),this.board.findDistanceToFall(this.currentShape.getPositions())),this.addChildBefore(this.ghost.getGameObject(),c),this.fallTimer.start()},e}(Kiwi.State);t.MainState=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i=function(i){function e(){i.apply(this,arguments)}return __extends(e,i),e.prototype.update=function(){this.game.input.mouse.isDown&&this.game.states.switchState("main")},e.prototype.create=function(e,o,s){i.prototype.create.call(this),this.addChild(new Kiwi.GameObjects.TextField(this,"Game Over!",t.Config.boardWidthInPixels/2,100,"#000",30)),this.addChild(new Kiwi.GameObjects.TextField(this,"Score",t.Config.boardWidthInPixels/2,150,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,e.toString(),t.Config.boardWidthInPixels/2,175,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,"Lines",t.Config.boardWidthInPixels/2,200,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,s.toString(),t.Config.boardWidthInPixels/2,225,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,"Level",t.Config.boardWidthInPixels/2,250,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,o.toString(),t.Config.boardWidthInPixels/2,275,"#000",24)),this.addChild(new Kiwi.GameObjects.TextField(this,"Play again",t.Config.boardWidthInPixels/2,350,"#000",24)),this.getAllChildren().forEach(function(t){return t.textAlign="center"})},e}(Kiwi.State);t.GameOverState=i}(Tetris||(Tetris={}));var Tetris;!function(t){var i={renderer:Kiwi.RENDERER_CANVAS,width:430,height:800,plugins:["TouchButton"]},e=new Kiwi.Game("content","Tetris",null,i),o=new t.MenuState("menu"),s=new t.MainState("main"),n=new t.GameOverState("gameOver");e.states.addState(o),e.states.addState(s),e.states.addState(n),e.states.switchState("menu")}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="red",this.name="ShapeDot",this.addBlock(this.blockColor,e,o,!0)}return __extends(i,t),i}(t.Shape);t.ShapeDot=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(i){var e=function(i){function e(t,e,o){i.call(this,t),this.blockColor="cyan",this.name="ShapeI",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o),this.addBlock(this.blockColor,e+1,o),this.addBlock(this.blockColor,e+2,o),this.addCenter(e+.5,o+.5)}return __extends(e,i),e.prototype.getRotations=function(){return e.rotations},e.prototype.addCenter=function(i,e){this.center=new t.Block(i,e,this.state,null)},e.rotations=[[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]]],e}(i.Shape);i.ShapeI=e}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="blue",this.name="ShapeJ",this.addBlock(this.blockColor,e-1,o-1),this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e+1,o)}return __extends(i,t),i}(t.Shape);t.ShapeJ=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="orange",this.name="ShapeL",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e+1,o),this.addBlock(this.blockColor,e+1,o-1)}return __extends(i,t),i}(t.Shape);t.ShapeL=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(i){var e=function(i){function e(t,e,o){i.call(this,t),this.blockColor="yellow",this.name="ShapeO",this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e,o),this.addBlock(this.blockColor,e+1,o-1),this.addBlock(this.blockColor,e+1,o),this.addCenter(e-.5,o-.5)}return __extends(e,i),e.prototype.rotate=function(){return this},e.prototype.getNextRotation=function(t){return void 0===t&&(t=0),[]},e.prototype.addCenter=function(i,e){this.center=new t.Block(i,e,this.state,null)},e}(i.Shape);i.ShapeO=e}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="green",this.name="ShapeS",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e+1,o-1)}return __extends(i,t),i}(t.Shape);t.ShapeS=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="purple",this.name="ShapeT",this.addBlock(this.blockColor,e-1,o),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e+1,o)}return __extends(i,t),i}(t.Shape);t.ShapeT=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));var Tetris;!function(t){var i;!function(t){var i=function(t){function i(i,e,o){t.call(this,i),this.blockColor="red",this.name="ShapeZ",this.addBlock(this.blockColor,e-1,o-1),this.addBlock(this.blockColor,e,o-1),this.addBlock(this.blockColor,e,o,!0),this.addBlock(this.blockColor,e+1,o)}return __extends(i,t),i}(t.Shape);t.ShapeZ=i}(i=t.Shapes||(t.Shapes={}))}(Tetris||(Tetris={}));

},{"ramda":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjOlxcVXNlcnNcXEd5dGlzXFxEZXNrdG9wXFxUZXRyaXNcXG5vZGVfbW9kdWxlc1xccmFtZGFcXGRpc3RcXHJhbWRhLmpzIiwiYzpcXFVzZXJzXFxHeXRpc1xcRGVza3RvcFxcVGV0cmlzXFxzcmNcXHR5cGVzY3JpcHQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Q0NLRSxXQUVBLFlBMEJFLElBQUksSUFBTyw0QkFBNEIsR0FHbkMsRUFBUyxTQUFnQixFQUFHLEdBRTVCLE9BQVEsR0FDUixJQUFLLEdBQ0QsTUFBTyxZQUNILE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxHQUNiLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEdBQ2pCLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksR0FDckIsTUFBTyxHQUFHLE1BQU0sS0FBTSxXQUU5QixLQUFLLEdBQ0QsTUFBTyxVQUFVLEVBQUksRUFBSSxFQUFJLEdBQ3pCLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksRUFBSSxFQUFJLEdBQzdCLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksRUFBSSxFQUFJLEVBQUksR0FDakMsTUFBTyxHQUFHLE1BQU0sS0FBTSxXQUU5QixLQUFLLEdBQ0QsTUFBTyxVQUFVLEVBQUksRUFBSSxFQUFJLEVBQUksRUFBSSxFQUFJLEdBQ3JDLE1BQU8sR0FBRyxNQUFNLEtBQU0sV0FFOUIsS0FBSyxHQUNELE1BQU8sVUFBVSxFQUFJLEVBQUksRUFBSSxFQUFJLEVBQUksRUFBSSxFQUFJLEdBQ3pDLE1BQU8sR0FB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T0FBUyxHQUNqQixFQUFTLEVBQU8sU0FBVyxFQUFPLGFBQ3RDLFNBQVcsV0FLZCxJQUFJLFNBQ0osU0FBVyxHQUNQLEdBQUksSUFDSixTQUFXLEdBQ1AsR0FBSSxHQUFTLFNBQVcsR0FFcEIsUUFBUyxHQUFPLEVBQU8sRUFBRyxHQUN0QixFQUFPLEtBQUssS0FBTSxHQUNsQixLQUFLLFdBQWEsU0FDbEIsS0FBSyxLQUFPLFNBQ1osS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFJLEVBQUcsR0FDdEMsS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFHLEdBQUcsR0FDckMsS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFHLEVBQUksR0FDdEMsS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFJLEVBQUcsR0FFMUMsTUFWQSxXQUFVLEVBQVEsR0FVWCxHQUNSLEVBQU8sTUFDVixHQUFPLE9BQVMsR0FDakIsRUFBUyxFQUFPLFNBQVcsRUFBTyxhQUN0QyxTQUFXLFdBS2QsSUFBSSxTQUNKLFNBQVcsR0FDUCxHQUFJLElBQ0osU0FBVyxHQUNQLEdBQUksR0FBUyxTQUFXLEdBRXBCLFFBQVMsR0FBTyxFQUFPLEVBQUcsR0FDdEIsRUFBTyxLQUFLLEtBQU0sR0FDbEIsS0FBSyxXQUFhLE1BQ2xCLEtBQUssS0FBTyxTQUNaLEtBQUssU0FBUyxLQUFLLFdBQVksRUFBSSxFQUFHLEVBQUksR0FDMUMsS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFHLEVBQUksR0FDdEMsS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFHLEdBQUcsR0FDckMsS0FBSyxTQUFTLEtBQUssV0FBWSxFQUFJLEVBQUcsR0FFMUMsTUFWQSxXQUFVLEVBQVEsR0FVWCxHQUNSLEVBQU8sTUFDVixHQUFPLE9BQVMsR0FDakIsRUFBUyxFQUFPLFNBQVcsRUFBTyxhQUN0QyxTQUFXIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vICBSYW1kYSB2MC4xNy4xXG4vLyAgaHR0cHM6Ly9naXRodWIuY29tL3JhbWRhL3JhbWRhXG4vLyAgKGMpIDIwMTMtMjAxNSBTY290dCBTYXV5ZXQsIE1pY2hhZWwgSHVybGV5LCBhbmQgRGF2aWQgQ2hhbWJlcnNcbi8vICBSYW1kYSBtYXkgYmUgZnJlZWx5IGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS5cblxuOyhmdW5jdGlvbigpIHtcblxuICAndXNlIHN0cmljdCc7XG5cbiAgLyoqXG4gICAgICogQSBzcGVjaWFsIHBsYWNlaG9sZGVyIHZhbHVlIHVzZWQgdG8gc3BlY2lmeSBcImdhcHNcIiB3aXRoaW4gY3VycmllZCBmdW5jdGlvbnMsXG4gICAgICogYWxsb3dpbmcgcGFydGlhbCBhcHBsaWNhdGlvbiBvZiBhbnkgY29tYmluYXRpb24gb2YgYXJndW1lbnRzLFxuICAgICAqIHJlZ2FyZGxlc3Mgb2YgdGhlaXIgcG9zaXRpb25zLlxuICAgICAqXG4gICAgICogSWYgYGdgIGlzIGEgY3VycmllZCB0ZXJuYXJ5IGZ1bmN0aW9uIGFuZCBgX2AgaXMgYFIuX19gLCB0aGUgZm9sbG93aW5nIGFyZSBlcXVpdmFsZW50OlxuICAgICAqXG4gICAgICogICAtIGBnKDEsIDIsIDMpYFxuICAgICAqICAgLSBgZyhfLCAyLCAzKSgxKWBcbiAgICAgKiAgIC0gYGcoXywgXywgMykoMSkoMilgXG4gICAgICogICAtIGBnKF8sIF8sIDMpKDEsIDIpYFxuICAgICAqICAgLSBgZyhfLCAyLCBfKSgxLCAzKWBcbiAgICAgKiAgIC0gYGcoXywgMikoMSkoMylgXG4gICAgICogICAtIGBnKF8sIDIpKDEsIDMpYFxuICAgICAqICAgLSBgZyhfLCAyKShfLCAzKSgxKWBcbiAgICAgKlxuICAgICAqIEBjb25zdGFudFxuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGdyZWV0ID0gUi5yZXBsYWNlKCd7bmFtZX0nLCBSLl9fLCAnSGVsbG8sIHtuYW1lfSEnKTtcbiAgICAgKiAgICAgIGdyZWV0KCdBbGljZScpOyAvLz0+ICdIZWxsbywgQWxpY2UhJ1xuICAgICAqL1xuICAgIHZhciBfXyA9IHsgJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlcic6IHRydWUgfTtcblxuICAgIC8vIGpzaGludCB1bnVzZWQ6dmFyc1xuICAgIHZhciBfYXJpdHkgPSBmdW5jdGlvbiBfYXJpdHkobiwgZm4pIHtcbiAgICAgICAgLy8ganNoaW50IHVudXNlZDp2YXJzXG4gICAgICAgIHN3aXRjaCAobikge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYTAsIGExLCBhMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYTAsIGExLCBhMiwgYTMsIGE0LCBhNSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYsIGE3LCBhOCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYsIGE3LCBhOCwgYTkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IHRvIF9hcml0eSBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIGludGVnZXIgbm8gZ3JlYXRlciB0aGFuIHRlbicpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBfY2xvbmVSZWdFeHAgPSBmdW5jdGlvbiBfY2xvbmVSZWdFeHAocGF0dGVybikge1xuICAgICAgICByZXR1cm4gbmV3IFJlZ0V4cChwYXR0ZXJuLnNvdXJjZSwgKHBhdHRlcm4uZ2xvYmFsID8gJ2cnIDogJycpICsgKHBhdHRlcm4uaWdub3JlQ2FzZSA/ICdpJyA6ICcnKSArIChwYXR0ZXJuLm11bHRpbGluZSA/ICdtJyA6ICcnKSArIChwYXR0ZXJuLnN0aWNreSA/ICd5JyA6ICcnKSArIChwYXR0ZXJuLnVuaWNvZGUgPyAndScgOiAnJykpO1xuICAgIH07XG5cbiAgICB2YXIgX2NvbXBsZW1lbnQgPSBmdW5jdGlvbiBfY29tcGxlbWVudChmKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gIWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUHJpdmF0ZSBgY29uY2F0YCBmdW5jdGlvbiB0byBtZXJnZSB0d28gYXJyYXktbGlrZSBvYmplY3RzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fEFyZ3VtZW50c30gW3NldDE9W11dIEFuIGFycmF5LWxpa2Ugb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl8QXJndW1lbnRzfSBbc2V0Mj1bXV0gQW4gYXJyYXktbGlrZSBvYmplY3QuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3LCBtZXJnZWQgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgX2NvbmNhdChbNCwgNSwgNl0sIFsxLCAyLCAzXSk7IC8vPT4gWzQsIDUsIDYsIDEsIDIsIDNdXG4gICAgICovXG4gICAgdmFyIF9jb25jYXQgPSBmdW5jdGlvbiBfY29uY2F0KHNldDEsIHNldDIpIHtcbiAgICAgICAgc2V0MSA9IHNldDEgfHwgW107XG4gICAgICAgIHNldDIgPSBzZXQyIHx8IFtdO1xuICAgICAgICB2YXIgaWR4O1xuICAgICAgICB2YXIgbGVuMSA9IHNldDEubGVuZ3RoO1xuICAgICAgICB2YXIgbGVuMiA9IHNldDIubGVuZ3RoO1xuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4xKSB7XG4gICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBzZXQxW2lkeF07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuMikge1xuICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gc2V0MltpZHhdO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgdmFyIF9jb250YWluc1dpdGggPSBmdW5jdGlvbiBfY29udGFpbnNXaXRoKHByZWQsIHgsIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAocHJlZCh4LCBsaXN0W2lkeF0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE9wdGltaXplZCBpbnRlcm5hbCB0d28tYXJpdHkgY3VycnkgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBjdXJyeS5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gVGhlIGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgdmFyIF9jdXJyeTEgPSBmdW5jdGlvbiBfY3VycnkxKGZuKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmMShhKSB7XG4gICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYSAhPSBudWxsICYmIGFbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogT3B0aW1pemVkIGludGVybmFsIHR3by1hcml0eSBjdXJyeSBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGN1cnJ5LlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBUaGUgY3VycmllZCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICB2YXIgX2N1cnJ5MiA9IGZ1bmN0aW9uIF9jdXJyeTIoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIGYyKGEsIGIpIHtcbiAgICAgICAgICAgIHZhciBuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChuID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYyO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAxICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmMjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIChiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMiAmJiBhICE9IG51bGwgJiYgYVsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUgJiYgYiAhPSBudWxsICYmIGJbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYyO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAyICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIChhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMiAmJiBiICE9IG51bGwgJiYgYlsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2N1cnJ5MShmdW5jdGlvbiAoYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogT3B0aW1pemVkIGludGVybmFsIHRocmVlLWFyaXR5IGN1cnJ5IGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY3VycnkuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IFRoZSBjdXJyaWVkIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIHZhciBfY3VycnkzID0gZnVuY3Rpb24gX2N1cnJ5Myhmbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gZjMoYSwgYiwgYykge1xuICAgICAgICAgICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKG4gPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZjM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDEgJiYgYSAhPSBudWxsICYmIGFbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGYzO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gKGIsIGMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAyICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSAmJiBiICE9IG51bGwgJiYgYlsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZjM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDIgJiYgYSAhPSBudWxsICYmIGFbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gKGEsIGMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAyICYmIGIgIT0gbnVsbCAmJiBiWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIChiLCBjKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiLCBjKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMikge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiLCBjKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMyAmJiBhICE9IG51bGwgJiYgYVsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUgJiYgYiAhPSBudWxsICYmIGJbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlICYmIGMgIT0gbnVsbCAmJiBjWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmMztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMyAmJiBhICE9IG51bGwgJiYgYVsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUgJiYgYiAhPSBudWxsICYmIGJbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAzICYmIGEgIT0gbnVsbCAmJiBhWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSAmJiBjICE9IG51bGwgJiYgY1snQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiAoYSwgYykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYiwgYyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDMgJiYgYiAhPSBudWxsICYmIGJbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlICYmIGMgIT0gbnVsbCAmJiBjWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIChiLCBjKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiLCBjKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobiA9PT0gMyAmJiBhICE9IG51bGwgJiYgYVsnQEBmdW5jdGlvbmFsL3BsYWNlaG9sZGVyJ10gPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX2N1cnJ5MShmdW5jdGlvbiAoYSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm4oYSwgYiwgYyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG4gPT09IDMgJiYgYiAhPSBudWxsICYmIGJbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuID09PSAzICYmIGMgIT0gbnVsbCAmJiBjWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmbihhLCBiLCBjKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKGEsIGIsIGMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbnRlcm5hbCBjdXJyeU4gZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBsZW5ndGggVGhlIGFyaXR5IG9mIHRoZSBjdXJyaWVkIGZ1bmN0aW9uLlxuICAgICAqIEByZXR1cm4ge2FycmF5fSBBbiBhcnJheSBvZiBhcmd1bWVudHMgcmVjZWl2ZWQgdGh1cyBmYXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGN1cnJ5LlxuICAgICAqL1xuICAgIHZhciBfY3VycnlOID0gZnVuY3Rpb24gX2N1cnJ5TihsZW5ndGgsIHJlY2VpdmVkLCBmbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNvbWJpbmVkID0gW107XG4gICAgICAgICAgICB2YXIgYXJnc0lkeCA9IDA7XG4gICAgICAgICAgICB2YXIgbGVmdCA9IGxlbmd0aDtcbiAgICAgICAgICAgIHZhciBjb21iaW5lZElkeCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoY29tYmluZWRJZHggPCByZWNlaXZlZC5sZW5ndGggfHwgYXJnc0lkeCA8IGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmIChjb21iaW5lZElkeCA8IHJlY2VpdmVkLmxlbmd0aCAmJiAocmVjZWl2ZWRbY29tYmluZWRJZHhdID09IG51bGwgfHwgcmVjZWl2ZWRbY29tYmluZWRJZHhdWydAQGZ1bmN0aW9uYWwvcGxhY2Vob2xkZXInXSAhPT0gdHJ1ZSB8fCBhcmdzSWR4ID49IGFyZ3VtZW50cy5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlY2VpdmVkW2NvbWJpbmVkSWR4XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBhcmd1bWVudHNbYXJnc0lkeF07XG4gICAgICAgICAgICAgICAgICAgIGFyZ3NJZHggKz0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29tYmluZWRbY29tYmluZWRJZHhdID0gcmVzdWx0O1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT0gbnVsbCB8fCByZXN1bHRbJ0BAZnVuY3Rpb25hbC9wbGFjZWhvbGRlciddICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxlZnQgLT0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29tYmluZWRJZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBsZWZ0IDw9IDAgPyBmbi5hcHBseSh0aGlzLCBjb21iaW5lZCkgOiBfYXJpdHkobGVmdCwgX2N1cnJ5TihsZW5ndGgsIGNvbWJpbmVkLCBmbikpO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgX2ZpbHRlciA9IGZ1bmN0aW9uIF9maWx0ZXIoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoLCByZXN1bHQgPSBbXTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGZuKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBsaXN0W2lkeF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICB2YXIgX2ZvcmNlUmVkdWNlZCA9IGZ1bmN0aW9uIF9mb3JjZVJlZHVjZWQoeCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci92YWx1ZSc6IHgsXG4gICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL3JlZHVjZWQnOiB0cnVlXG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIHN0cmF0ZWd5IGZvciBleHRyYWN0aW5nIGZ1bmN0aW9uIG5hbWVzIGZyb20gYW4gb2JqZWN0XG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCB0YWtlcyBhbiBvYmplY3QgYW5kIHJldHVybnMgYW4gYXJyYXkgb2YgZnVuY3Rpb24gbmFtZXMuXG4gICAgICovXG4gICAgdmFyIF9mdW5jdGlvbnNXaXRoID0gZnVuY3Rpb24gX2Z1bmN0aW9uc1dpdGgoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBfZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIG9ialtrZXldID09PSAnZnVuY3Rpb24nO1xuICAgICAgICAgICAgfSwgZm4ob2JqKSk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBfaGFzID0gZnVuY3Rpb24gX2hhcyhwcm9wLCBvYmopIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApO1xuICAgIH07XG5cbiAgICB2YXIgX2lkZW50aXR5ID0gZnVuY3Rpb24gX2lkZW50aXR5KHgpIHtcbiAgICAgICAgcmV0dXJuIHg7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRlc3RzIHdoZXRoZXIgb3Igbm90IGFuIG9iamVjdCBpcyBhbiBhcnJheS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWwgVGhlIG9iamVjdCB0byB0ZXN0LlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBgdmFsYCBpcyBhbiBhcnJheSwgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgX2lzQXJyYXkoW10pOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIF9pc0FycmF5KG51bGwpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBfaXNBcnJheSh7fSk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIF9pc0FycmF5KHZhbCkge1xuICAgICAgICByZXR1cm4gdmFsICE9IG51bGwgJiYgdmFsLmxlbmd0aCA+PSAwICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBBcnJheV0nO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmUgaWYgdGhlIHBhc3NlZCBhcmd1bWVudCBpcyBhbiBpbnRlZ2VyLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IG5cbiAgICAgKiBAY2F0ZWdvcnkgVHlwZVxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICovXG4gICAgdmFyIF9pc0ludGVnZXIgPSBOdW1iZXIuaXNJbnRlZ2VyIHx8IGZ1bmN0aW9uIF9pc0ludGVnZXIobikge1xuICAgICAgICByZXR1cm4gbiA8PCAwID09PSBuO1xuICAgIH07XG5cbiAgICB2YXIgX2lzTnVtYmVyID0gZnVuY3Rpb24gX2lzTnVtYmVyKHgpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4KSA9PT0gJ1tvYmplY3QgTnVtYmVyXSc7XG4gICAgfTtcblxuICAgIHZhciBfaXNTdHJpbmcgPSBmdW5jdGlvbiBfaXNTdHJpbmcoeCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpID09PSAnW29iamVjdCBTdHJpbmddJztcbiAgICB9O1xuXG4gICAgdmFyIF9pc1RyYW5zZm9ybWVyID0gZnVuY3Rpb24gX2lzVHJhbnNmb3JtZXIob2JqKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2Ygb2JqWydAQHRyYW5zZHVjZXIvc3RlcCddID09PSAnZnVuY3Rpb24nO1xuICAgIH07XG5cbiAgICB2YXIgX21hcCA9IGZ1bmN0aW9uIF9tYXAoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoLCByZXN1bHQgPSBBcnJheShsZW4pO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICByZXN1bHRbaWR4XSA9IGZuKGxpc3RbaWR4XSk7XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICB2YXIgX3BpcGUgPSBmdW5jdGlvbiBfcGlwZShmLCBnKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZy5jYWxsKHRoaXMsIGYuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHZhciBfcGlwZVAgPSBmdW5jdGlvbiBfcGlwZVAoZiwgZykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gZi5hcHBseShjdHgsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBnLmNhbGwoY3R4LCB4KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgX3F1b3RlID0gZnVuY3Rpb24gX3F1b3RlKHMpIHtcbiAgICAgICAgcmV0dXJuICdcIicgKyBzLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKSArICdcIic7XG4gICAgfTtcblxuICAgIHZhciBfcmVkdWNlZCA9IGZ1bmN0aW9uIF9yZWR1Y2VkKHgpIHtcbiAgICAgICAgcmV0dXJuIHggJiYgeFsnQEB0cmFuc2R1Y2VyL3JlZHVjZWQnXSA/IHggOiB7XG4gICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL3ZhbHVlJzogeCxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvcmVkdWNlZCc6IHRydWVcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQW4gb3B0aW1pemVkLCBwcml2YXRlIGFycmF5IGBzbGljZWAgaW1wbGVtZW50YXRpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJndW1lbnRzfEFycmF5fSBhcmdzIFRoZSBhcnJheSBvciBhcmd1bWVudHMgb2JqZWN0IHRvIGNvbnNpZGVyLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbZnJvbT0wXSBUaGUgYXJyYXkgaW5kZXggdG8gc2xpY2UgZnJvbSwgaW5jbHVzaXZlLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbdG89YXJncy5sZW5ndGhdIFRoZSBhcnJheSBpbmRleCB0byBzbGljZSB0bywgZXhjbHVzaXZlLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldywgc2xpY2VkIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIF9zbGljZShbMSwgMiwgMywgNCwgNV0sIDEsIDMpOyAvLz0+IFsyLCAzXVxuICAgICAqXG4gICAgICogICAgICB2YXIgZmlyc3RUaHJlZUFyZ3MgPSBmdW5jdGlvbihhLCBiLCBjLCBkKSB7XG4gICAgICogICAgICAgIHJldHVybiBfc2xpY2UoYXJndW1lbnRzLCAwLCAzKTtcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICBmaXJzdFRocmVlQXJncygxLCAyLCAzLCA0KTsgLy89PiBbMSwgMiwgM11cbiAgICAgKi9cbiAgICB2YXIgX3NsaWNlID0gZnVuY3Rpb24gX3NsaWNlKGFyZ3MsIGZyb20sIHRvKSB7XG4gICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gX3NsaWNlKGFyZ3MsIDAsIGFyZ3MubGVuZ3RoKTtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIF9zbGljZShhcmdzLCBmcm9tLCBhcmdzLmxlbmd0aCk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgICAgICB2YXIgbGVuID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oYXJncy5sZW5ndGgsIHRvKSAtIGZyb20pO1xuICAgICAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgICAgIGxpc3RbaWR4XSA9IGFyZ3NbZnJvbSArIGlkeF07XG4gICAgICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbGlzdDtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQb2x5ZmlsbCBmcm9tIDxodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9EYXRlL3RvSVNPU3RyaW5nPi5cbiAgICAgKi9cbiAgICB2YXIgX3RvSVNPU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFkID0gZnVuY3Rpb24gcGFkKG4pIHtcbiAgICAgICAgICAgIHJldHVybiAobiA8IDEwID8gJzAnIDogJycpICsgbjtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBEYXRlLnByb3RvdHlwZS50b0lTT1N0cmluZyA9PT0gJ2Z1bmN0aW9uJyA/IGZ1bmN0aW9uIF90b0lTT1N0cmluZyhkKSB7XG4gICAgICAgICAgICByZXR1cm4gZC50b0lTT1N0cmluZygpO1xuICAgICAgICB9IDogZnVuY3Rpb24gX3RvSVNPU3RyaW5nKGQpIHtcbiAgICAgICAgICAgIHJldHVybiBkLmdldFVUQ0Z1bGxZZWFyKCkgKyAnLScgKyBwYWQoZC5nZXRVVENNb250aCgpICsgMSkgKyAnLScgKyBwYWQoZC5nZXRVVENEYXRlKCkpICsgJ1QnICsgcGFkKGQuZ2V0VVRDSG91cnMoKSkgKyAnOicgKyBwYWQoZC5nZXRVVENNaW51dGVzKCkpICsgJzonICsgcGFkKGQuZ2V0VVRDU2Vjb25kcygpKSArICcuJyArIChkLmdldFVUQ01pbGxpc2Vjb25kcygpIC8gMTAwMCkudG9GaXhlZCgzKS5zbGljZSgyLCA1KSArICdaJztcbiAgICAgICAgfTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hkcm9wUmVwZWF0c1dpdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhEcm9wUmVwZWF0c1dpdGgocHJlZCwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMucHJlZCA9IHByZWQ7XG4gICAgICAgICAgICB0aGlzLmxhc3RWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHRoaXMuc2VlbkZpcnN0VmFsdWUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBYRHJvcFJlcGVhdHNXaXRoLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvaW5pdCddKCk7XG4gICAgICAgIH07XG4gICAgICAgIFhEcm9wUmVwZWF0c1dpdGgucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIFhEcm9wUmVwZWF0c1dpdGgucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBzYW1lQXNMYXN0ID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoIXRoaXMuc2VlbkZpcnN0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlZW5GaXJzdFZhbHVlID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5wcmVkKHRoaXMubGFzdFZhbHVlLCBpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICBzYW1lQXNMYXN0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGFzdFZhbHVlID0gaW5wdXQ7XG4gICAgICAgICAgICByZXR1cm4gc2FtZUFzTGFzdCA/IHJlc3VsdCA6IHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCBpbnB1dCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94ZHJvcFJlcGVhdHNXaXRoKHByZWQsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhEcm9wUmVwZWF0c1dpdGgocHJlZCwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hmQmFzZSA9IHtcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9pbml0J10oKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVzdWx0OiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIF94ZmlsdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYRmlsdGVyKGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICB9XG4gICAgICAgIFhGaWx0ZXIucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYRmlsdGVyLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gX3hmQmFzZS5yZXN1bHQ7XG4gICAgICAgIFhGaWx0ZXIucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmYoaW5wdXQpID8gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIGlucHV0KSA6IHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3hmaWx0ZXIoZiwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWEZpbHRlcihmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeGZpbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhGaW5kKGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICAgICAgdGhpcy5mb3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIFhGaW5kLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWEZpbmQucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuZm91bmQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdm9pZCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ocmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgWEZpbmQucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmYoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gX3JlZHVjZWQodGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIGlucHV0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGZpbmQoZiwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWEZpbmQoZiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hmaW5kSW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhGaW5kSW5kZXgoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgICAgICB0aGlzLmlkeCA9IC0xO1xuICAgICAgICAgICAgdGhpcy5mb3VuZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIFhGaW5kSW5kZXgucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYRmluZEluZGV4LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmZvdW5kKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ocmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgICAgWEZpbmRJbmRleC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgdGhpcy5pZHggKz0gMTtcbiAgICAgICAgICAgIGlmICh0aGlzLmYoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gX3JlZHVjZWQodGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIHRoaXMuaWR4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGZpbmRJbmRleChmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRmluZEluZGV4KGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94ZmluZExhc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhGaW5kTGFzdChmLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5mID0gZjtcbiAgICAgICAgfVxuICAgICAgICBYRmluZExhc3QucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYRmluZExhc3QucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHRoaXMueGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10ocmVzdWx0LCB0aGlzLmxhc3QpKTtcbiAgICAgICAgfTtcbiAgICAgICAgWEZpbmRMYXN0LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5mKGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdCA9IGlucHV0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3hmaW5kTGFzdChmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRmluZExhc3QoZiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hmaW5kTGFzdEluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYRmluZExhc3RJbmRleChmLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5mID0gZjtcbiAgICAgICAgICAgIHRoaXMuaWR4ID0gLTE7XG4gICAgICAgICAgICB0aGlzLmxhc3RJZHggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBYRmluZExhc3RJbmRleC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhGaW5kTGFzdEluZGV4LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSh0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdGhpcy5sYXN0SWR4KSk7XG4gICAgICAgIH07XG4gICAgICAgIFhGaW5kTGFzdEluZGV4LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICB0aGlzLmlkeCArPSAxO1xuICAgICAgICAgICAgaWYgKHRoaXMuZihpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RJZHggPSB0aGlzLmlkeDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94ZmluZExhc3RJbmRleChmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYRmluZExhc3RJbmRleChmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeG1hcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWE1hcChmLCB4Zikge1xuICAgICAgICAgICAgdGhpcy54ZiA9IHhmO1xuICAgICAgICAgICAgdGhpcy5mID0gZjtcbiAgICAgICAgfVxuICAgICAgICBYTWFwLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWE1hcC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IF94ZkJhc2UucmVzdWx0O1xuICAgICAgICBYTWFwLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIHRoaXMuZihpbnB1dCkpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeG1hcChmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYTWFwKGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94dGFrZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWFRha2UobiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMubiA9IG47XG4gICAgICAgIH1cbiAgICAgICAgWFRha2UucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYVGFrZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IF94ZkJhc2UucmVzdWx0O1xuICAgICAgICBYVGFrZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubiA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfcmVkdWNlZChyZXN1bHQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm4gLT0gMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIGlucHV0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3h0YWtlKG4sIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhUYWtlKG4sIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94dGFrZVdoaWxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYVGFrZVdoaWxlKGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICB9XG4gICAgICAgIFhUYWtlV2hpbGUucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gX3hmQmFzZS5pbml0O1xuICAgICAgICBYVGFrZVdoaWxlLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gX3hmQmFzZS5yZXN1bHQ7XG4gICAgICAgIFhUYWtlV2hpbGUucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmYoaW5wdXQpID8gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIGlucHV0KSA6IF9yZWR1Y2VkKHJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94dGFrZVdoaWxlKGYsIHhmKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFhUYWtlV2hpbGUoZiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3h3cmFwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYV3JhcChmbikge1xuICAgICAgICAgICAgdGhpcy5mID0gZm47XG4gICAgICAgIH1cbiAgICAgICAgWFdyYXAucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvaW5pdCddID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpbml0IG5vdCBpbXBsZW1lbnRlZCBvbiBYV3JhcCcpO1xuICAgICAgICB9O1xuICAgICAgICBYV3JhcC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IGZ1bmN0aW9uIChhY2MpIHtcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgIH07XG4gICAgICAgIFhXcmFwLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChhY2MsIHgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmYoYWNjLCB4KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF94d3JhcChmbikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYV3JhcChmbik7XG4gICAgICAgIH07XG4gICAgfSgpO1xuXG4gICAgLyoqXG4gICAgICogQWRkcyB0d28gbnVtYmVycy4gRXF1aXZhbGVudCB0byBgYSArIGJgIGJ1dCBjdXJyaWVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBhXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGJcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICogQHNlZSBSLnN1YnRyYWN0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5hZGQoMiwgMyk7ICAgICAgIC8vPT4gIDVcbiAgICAgKiAgICAgIFIuYWRkKDcpKDEwKTsgICAgICAvLz0+IDE3XG4gICAgICovXG4gICAgdmFyIGFkZCA9IF9jdXJyeTIoZnVuY3Rpb24gYWRkKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgKyBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhIGZ1bmN0aW9uIHRvIHRoZSB2YWx1ZSBhdCB0aGUgZ2l2ZW4gaW5kZXggb2YgYW4gYXJyYXksXG4gICAgICogcmV0dXJuaW5nIGEgbmV3IGNvcHkgb2YgdGhlIGFycmF5IHdpdGggdGhlIGVsZW1lbnQgYXQgdGhlIGdpdmVuXG4gICAgICogaW5kZXggcmVwbGFjZWQgd2l0aCB0aGUgcmVzdWx0IG9mIHRoZSBmdW5jdGlvbiBhcHBsaWNhdGlvbi5cbiAgICAgKiBAc2VlIFIudXBkYXRlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IGEpIC0+IE51bWJlciAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGFwcGx5LlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpZHggVGhlIGluZGV4LlxuICAgICAqIEBwYXJhbSB7QXJyYXl8QXJndW1lbnRzfSBsaXN0IEFuIGFycmF5LWxpa2Ugb2JqZWN0IHdob3NlIHZhbHVlXG4gICAgICogICAgICAgIGF0IHRoZSBzdXBwbGllZCBpbmRleCB3aWxsIGJlIHJlcGxhY2VkLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIGNvcHkgb2YgdGhlIHN1cHBsaWVkIGFycmF5LWxpa2Ugb2JqZWN0IHdpdGhcbiAgICAgKiAgICAgICAgIHRoZSBlbGVtZW50IGF0IGluZGV4IGBpZHhgIHJlcGxhY2VkIHdpdGggdGhlIHZhbHVlXG4gICAgICogICAgICAgICByZXR1cm5lZCBieSBhcHBseWluZyBgZm5gIHRvIHRoZSBleGlzdGluZyBlbGVtZW50LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuYWRqdXN0KFIuYWRkKDEwKSwgMSwgWzAsIDEsIDJdKTsgICAgIC8vPT4gWzAsIDExLCAyXVxuICAgICAqICAgICAgUi5hZGp1c3QoUi5hZGQoMTApKSgxKShbMCwgMSwgMl0pOyAgICAgLy89PiBbMCwgMTEsIDJdXG4gICAgICovXG4gICAgdmFyIGFkanVzdCA9IF9jdXJyeTMoZnVuY3Rpb24gYWRqdXN0KGZuLCBpZHgsIGxpc3QpIHtcbiAgICAgICAgaWYgKGlkeCA+PSBsaXN0Lmxlbmd0aCB8fCBpZHggPCAtbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBsaXN0O1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdGFydCA9IGlkeCA8IDAgPyBsaXN0Lmxlbmd0aCA6IDA7XG4gICAgICAgIHZhciBfaWR4ID0gc3RhcnQgKyBpZHg7XG4gICAgICAgIHZhciBfbGlzdCA9IF9jb25jYXQobGlzdCk7XG4gICAgICAgIF9saXN0W19pZHhdID0gZm4obGlzdFtfaWR4XSk7XG4gICAgICAgIHJldHVybiBfbGlzdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGFsd2F5cyByZXR1cm5zIHRoZSBnaXZlbiB2YWx1ZS4gTm90ZSB0aGF0IGZvclxuICAgICAqIG5vbi1wcmltaXRpdmVzIHRoZSB2YWx1ZSByZXR1cm5lZCBpcyBhIHJlZmVyZW5jZSB0byB0aGUgb3JpZ2luYWwgdmFsdWUuXG4gICAgICpcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGtub3duIGFzIGBjb25zdGAsIGBjb25zdGFudGAsIG9yIGBLYCAoZm9yIEsgY29tYmluYXRvcilcbiAgICAgKiBpbiBvdGhlciBsYW5ndWFnZXMgYW5kIGxpYnJhcmllcy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIGEgLT4gKCogLT4gYSlcbiAgICAgKiBAcGFyYW0geyp9IHZhbCBUaGUgdmFsdWUgdG8gd3JhcCBpbiBhIGZ1bmN0aW9uXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgRnVuY3Rpb24gOjogKiAtPiB2YWwuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHQgPSBSLmFsd2F5cygnVGVlJyk7XG4gICAgICogICAgICB0KCk7IC8vPT4gJ1RlZSdcbiAgICAgKi9cbiAgICB2YXIgYWx3YXlzID0gX2N1cnJ5MShmdW5jdGlvbiBhbHdheXModmFsKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0LCBjb21wb3NlZCBvZiBuLXR1cGxlcyBvZiBjb25zZWN1dGl2ZSBlbGVtZW50c1xuICAgICAqIElmIGBuYCBpcyBncmVhdGVyIHRoYW4gdGhlIGxlbmd0aCBvZiB0aGUgbGlzdCwgYW4gZW1wdHkgbGlzdCBpcyByZXR1cm5lZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFthXSAtPiBbW2FdXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuIFRoZSBzaXplIG9mIHRoZSB0dXBsZXMgdG8gY3JlYXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBzcGxpdCBpbnRvIGBuYC10dXBsZXNcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIG5ldyBsaXN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuYXBlcnR1cmUoMiwgWzEsIDIsIDMsIDQsIDVdKTsgLy89PiBbWzEsIDJdLCBbMiwgM10sIFszLCA0XSwgWzQsIDVdXVxuICAgICAqICAgICAgUi5hcGVydHVyZSgzLCBbMSwgMiwgMywgNCwgNV0pOyAvLz0+IFtbMSwgMiwgM10sIFsyLCAzLCA0XSwgWzMsIDQsIDVdXVxuICAgICAqICAgICAgUi5hcGVydHVyZSg3LCBbMSwgMiwgMywgNCwgNV0pOyAvLz0+IFtdXG4gICAgICovXG4gICAgdmFyIGFwZXJ0dXJlID0gX2N1cnJ5MihmdW5jdGlvbiBhcGVydHVyZShuLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB2YXIgbGltaXQgPSBsaXN0Lmxlbmd0aCAtIChuIC0gMSk7XG4gICAgICAgIHZhciBhY2MgPSBuZXcgQXJyYXkobGltaXQgPj0gMCA/IGxpbWl0IDogMCk7XG4gICAgICAgIHdoaWxlIChpZHggPCBsaW1pdCkge1xuICAgICAgICAgICAgYWNjW2lkeF0gPSBfc2xpY2UobGlzdCwgaWR4LCBpZHggKyBuKTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29udGFpbmluZyB0aGUgY29udGVudHMgb2YgdGhlIGdpdmVuIGxpc3QsIGZvbGxvd2VkIGJ5IHRoZSBnaXZlblxuICAgICAqIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGEgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7Kn0gZWwgVGhlIGVsZW1lbnQgdG8gYWRkIHRvIHRoZSBlbmQgb2YgdGhlIG5ldyBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3Qgd2hvc2UgY29udGVudHMgd2lsbCBiZSBhZGRlZCB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBvdXRwdXRcbiAgICAgKiAgICAgICAgbGlzdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgbGlzdCBjb250YWluaW5nIHRoZSBjb250ZW50cyBvZiB0aGUgb2xkIGxpc3QgZm9sbG93ZWQgYnkgYGVsYC5cbiAgICAgKiBAc2VlIFIucHJlcGVuZFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuYXBwZW5kKCd0ZXN0cycsIFsnd3JpdGUnLCAnbW9yZSddKTsgLy89PiBbJ3dyaXRlJywgJ21vcmUnLCAndGVzdHMnXVxuICAgICAqICAgICAgUi5hcHBlbmQoJ3Rlc3RzJywgW10pOyAvLz0+IFsndGVzdHMnXVxuICAgICAqICAgICAgUi5hcHBlbmQoWyd0ZXN0cyddLCBbJ3dyaXRlJywgJ21vcmUnXSk7IC8vPT4gWyd3cml0ZScsICdtb3JlJywgWyd0ZXN0cyddXVxuICAgICAqL1xuICAgIHZhciBhcHBlbmQgPSBfY3VycnkyKGZ1bmN0aW9uIGFwcGVuZChlbCwgbGlzdCkge1xuICAgICAgICByZXR1cm4gX2NvbmNhdChsaXN0LCBbZWxdKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgZnVuY3Rpb24gYGZuYCB0byB0aGUgYXJndW1lbnQgbGlzdCBgYXJnc2AuIFRoaXMgaXMgdXNlZnVsIGZvclxuICAgICAqIGNyZWF0aW5nIGEgZml4ZWQtYXJpdHkgZnVuY3Rpb24gZnJvbSBhIHZhcmlhZGljIGZ1bmN0aW9uLiBgZm5gIHNob3VsZFxuICAgICAqIGJlIGEgYm91bmQgZnVuY3Rpb24gaWYgY29udGV4dCBpcyBzaWduaWZpY2FudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICgqLi4uIC0+IGEpIC0+IFsqXSAtPiBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcmdzXG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIuY2FsbCwgUi51bmFwcGx5XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG51bXMgPSBbMSwgMiwgMywgLTk5LCA0MiwgNiwgN107XG4gICAgICogICAgICBSLmFwcGx5KE1hdGgubWF4LCBudW1zKTsgLy89PiA0MlxuICAgICAqL1xuICAgIHZhciBhcHBseSA9IF9jdXJyeTIoZnVuY3Rpb24gYXBwbHkoZm4sIGFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogTWFrZXMgYSBzaGFsbG93IGNsb25lIG9mIGFuIG9iamVjdCwgc2V0dGluZyBvciBvdmVycmlkaW5nIHRoZSBzcGVjaWZpZWRcbiAgICAgKiBwcm9wZXJ0eSB3aXRoIHRoZSBnaXZlbiB2YWx1ZS4gIE5vdGUgdGhhdCB0aGlzIGNvcGllcyBhbmQgZmxhdHRlbnNcbiAgICAgKiBwcm90b3R5cGUgcHJvcGVydGllcyBvbnRvIHRoZSBuZXcgb2JqZWN0IGFzIHdlbGwuICBBbGwgbm9uLXByaW1pdGl2ZVxuICAgICAqIHByb3BlcnRpZXMgYXJlIGNvcGllZCBieSByZWZlcmVuY2UuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgU3RyaW5nIC0+IGEgLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wIHRoZSBwcm9wZXJ0eSBuYW1lIHRvIHNldFxuICAgICAqIEBwYXJhbSB7Kn0gdmFsIHRoZSBuZXcgdmFsdWVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIHRoZSBvYmplY3QgdG8gY2xvbmVcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGEgbmV3IG9iamVjdCBzaW1pbGFyIHRvIHRoZSBvcmlnaW5hbCBleGNlcHQgZm9yIHRoZSBzcGVjaWZpZWQgcHJvcGVydHkuXG4gICAgICogQHNlZSBSLmRpc3NvY1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuYXNzb2MoJ2MnLCAzLCB7YTogMSwgYjogMn0pOyAvLz0+IHthOiAxLCBiOiAyLCBjOiAzfVxuICAgICAqL1xuICAgIHZhciBhc3NvYyA9IF9jdXJyeTMoZnVuY3Rpb24gYXNzb2MocHJvcCwgdmFsLCBvYmopIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBwIGluIG9iaikge1xuICAgICAgICAgICAgcmVzdWx0W3BdID0gb2JqW3BdO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdFtwcm9wXSA9IHZhbDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIE1ha2VzIGEgc2hhbGxvdyBjbG9uZSBvZiBhbiBvYmplY3QsIHNldHRpbmcgb3Igb3ZlcnJpZGluZyB0aGUgbm9kZXNcbiAgICAgKiByZXF1aXJlZCB0byBjcmVhdGUgdGhlIGdpdmVuIHBhdGgsIGFuZCBwbGFjaW5nIHRoZSBzcGVjaWZpYyB2YWx1ZSBhdCB0aGVcbiAgICAgKiB0YWlsIGVuZCBvZiB0aGF0IHBhdGguICBOb3RlIHRoYXQgdGhpcyBjb3BpZXMgYW5kIGZsYXR0ZW5zIHByb3RvdHlwZVxuICAgICAqIHByb3BlcnRpZXMgb250byB0aGUgbmV3IG9iamVjdCBhcyB3ZWxsLiAgQWxsIG5vbi1wcmltaXRpdmUgcHJvcGVydGllc1xuICAgICAqIGFyZSBjb3BpZWQgYnkgcmVmZXJlbmNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIFtTdHJpbmddIC0+IGEgLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhdGggdGhlIHBhdGggdG8gc2V0XG4gICAgICogQHBhcmFtIHsqfSB2YWwgdGhlIG5ldyB2YWx1ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogdGhlIG9iamVjdCB0byBjbG9uZVxuICAgICAqIEByZXR1cm4ge09iamVjdH0gYSBuZXcgb2JqZWN0IHNpbWlsYXIgdG8gdGhlIG9yaWdpbmFsIGV4Y2VwdCBhbG9uZyB0aGUgc3BlY2lmaWVkIHBhdGguXG4gICAgICogQHNlZSBSLmRpc3NvY1BhdGhcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmFzc29jUGF0aChbJ2EnLCAnYicsICdjJ10sIDQyLCB7YToge2I6IHtjOiAwfX19KTsgLy89PiB7YToge2I6IHtjOiA0Mn19fVxuICAgICAqL1xuICAgIHZhciBhc3NvY1BhdGggPSBfY3VycnkzKGZ1bmN0aW9uIGFzc29jUGF0aChwYXRoLCB2YWwsIG9iaikge1xuICAgICAgICBzd2l0Y2ggKHBhdGgubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHJldHVybiBhc3NvYyhwYXRoWzBdLCB2YWwsIG9iaik7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gYXNzb2MocGF0aFswXSwgYXNzb2NQYXRoKF9zbGljZShwYXRoLCAxKSwgdmFsLCBPYmplY3Qob2JqW3BhdGhbMF1dKSksIG9iaik7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGlzIGJvdW5kIHRvIGEgY29udGV4dC5cbiAgICAgKiBOb3RlOiBgUi5iaW5kYCBkb2VzIG5vdCBwcm92aWRlIHRoZSBhZGRpdGlvbmFsIGFyZ3VtZW50LWJpbmRpbmcgY2FwYWJpbGl0aWVzIG9mXG4gICAgICogW0Z1bmN0aW9uLnByb3RvdHlwZS5iaW5kXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9GdW5jdGlvbi9iaW5kKS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNlZSBSLnBhcnRpYWxcbiAgICAgKiBAc2lnICgqIC0+ICopIC0+IHsqfSAtPiAoKiAtPiAqKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBiaW5kIHRvIGNvbnRleHRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdGhpc09iaiBUaGUgY29udGV4dCB0byBiaW5kIGBmbmAgdG9cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBmdW5jdGlvbiB0aGF0IHdpbGwgZXhlY3V0ZSBpbiB0aGUgY29udGV4dCBvZiBgdGhpc09iamAuXG4gICAgICovXG4gICAgdmFyIGJpbmQgPSBfY3VycnkyKGZ1bmN0aW9uIGJpbmQoZm4sIHRoaXNPYmopIHtcbiAgICAgICAgcmV0dXJuIF9hcml0eShmbi5sZW5ndGgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzT2JqLCBhcmd1bWVudHMpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gd3JhcHBpbmcgY2FsbHMgdG8gdGhlIHR3byBmdW5jdGlvbnMgaW4gYW4gYCYmYCBvcGVyYXRpb24sIHJldHVybmluZyB0aGUgcmVzdWx0IG9mIHRoZSBmaXJzdFxuICAgICAqIGZ1bmN0aW9uIGlmIGl0IGlzIGZhbHNlLXkgYW5kIHRoZSByZXN1bHQgb2YgdGhlIHNlY29uZCBmdW5jdGlvbiBvdGhlcndpc2UuICBOb3RlIHRoYXQgdGhpcyBpc1xuICAgICAqIHNob3J0LWNpcmN1aXRlZCwgbWVhbmluZyB0aGF0IHRoZSBzZWNvbmQgZnVuY3Rpb24gd2lsbCBub3QgYmUgaW52b2tlZCBpZiB0aGUgZmlyc3QgcmV0dXJucyBhIGZhbHNlLXlcbiAgICAgKiB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnICgqLi4uIC0+IEJvb2xlYW4pIC0+ICgqLi4uIC0+IEJvb2xlYW4pIC0+ICgqLi4uIC0+IEJvb2xlYW4pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZiBhIHByZWRpY2F0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGcgYW5vdGhlciBwcmVkaWNhdGVcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gYSBmdW5jdGlvbiB0aGF0IGFwcGxpZXMgaXRzIGFyZ3VtZW50cyB0byBgZmAgYW5kIGBnYCBhbmQgYCYmYHMgdGhlaXIgb3V0cHV0cyB0b2dldGhlci5cbiAgICAgKiBAc2VlIFIuYW5kXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGd0MTAgPSBmdW5jdGlvbih4KSB7IHJldHVybiB4ID4gMTA7IH07XG4gICAgICogICAgICB2YXIgZXZlbiA9IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHggJSAyID09PSAwIH07XG4gICAgICogICAgICB2YXIgZiA9IFIuYm90aChndDEwLCBldmVuKTtcbiAgICAgKiAgICAgIGYoMTAwKTsgLy89PiB0cnVlXG4gICAgICogICAgICBmKDEwMSk7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgYm90aCA9IF9jdXJyeTIoZnVuY3Rpb24gYm90aChmLCBnKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfYm90aCgpIHtcbiAgICAgICAgICAgIHJldHVybiBmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgJiYgZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogTWFrZXMgYSBjb21wYXJhdG9yIGZ1bmN0aW9uIG91dCBvZiBhIGZ1bmN0aW9uIHRoYXQgcmVwb3J0cyB3aGV0aGVyIHRoZSBmaXJzdCBlbGVtZW50IGlzIGxlc3MgdGhhbiB0aGUgc2Vjb25kLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKGEsIGIgLT4gQm9vbGVhbikgLT4gKGEsIGIgLT4gTnVtYmVyKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgQSBwcmVkaWNhdGUgZnVuY3Rpb24gb2YgYXJpdHkgdHdvLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIEZ1bmN0aW9uIDo6IGEgLT4gYiAtPiBJbnQgdGhhdCByZXR1cm5zIGAtMWAgaWYgYSA8IGIsIGAxYCBpZiBiIDwgYSwgb3RoZXJ3aXNlIGAwYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgY21wID0gUi5jb21wYXJhdG9yKGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGEuYWdlIDwgYi5hZ2U7XG4gICAgICogICAgICB9KTtcbiAgICAgKiAgICAgIHZhciBwZW9wbGUgPSBbXG4gICAgICogICAgICAgIC8vIC4uLlxuICAgICAqICAgICAgXTtcbiAgICAgKiAgICAgIFIuc29ydChjbXAsIHBlb3BsZSk7XG4gICAgICovXG4gICAgdmFyIGNvbXBhcmF0b3IgPSBfY3VycnkxKGZ1bmN0aW9uIGNvbXBhcmF0b3IocHJlZCkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgIHJldHVybiBwcmVkKGEsIGIpID8gLTEgOiBwcmVkKGIsIGEpID8gMSA6IDA7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyBhIGZ1bmN0aW9uIGBmYCBhbmQgcmV0dXJucyBhIGZ1bmN0aW9uIGBnYCBzdWNoIHRoYXQ6XG4gICAgICpcbiAgICAgKiAgIC0gYXBwbHlpbmcgYGdgIHRvIHplcm8gb3IgbW9yZSBhcmd1bWVudHMgd2lsbCBnaXZlIF9fdHJ1ZV9fIGlmIGFwcGx5aW5nXG4gICAgICogICAgIHRoZSBzYW1lIGFyZ3VtZW50cyB0byBgZmAgZ2l2ZXMgYSBsb2dpY2FsIF9fZmFsc2VfXyB2YWx1ZTsgYW5kXG4gICAgICpcbiAgICAgKiAgIC0gYXBwbHlpbmcgYGdgIHRvIHplcm8gb3IgbW9yZSBhcmd1bWVudHMgd2lsbCBnaXZlIF9fZmFsc2VfXyBpZiBhcHBseWluZ1xuICAgICAqICAgICB0aGUgc2FtZSBhcmd1bWVudHMgdG8gYGZgIGdpdmVzIGEgbG9naWNhbCBfX3RydWVfXyB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnICgqLi4uIC0+ICopIC0+ICgqLi4uIC0+IEJvb2xlYW4pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBzZWUgUi5ub3RcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaXNFdmVuID0gZnVuY3Rpb24obikgeyByZXR1cm4gbiAlIDIgPT09IDA7IH07XG4gICAgICogICAgICB2YXIgaXNPZGQgPSBSLmNvbXBsZW1lbnQoaXNFdmVuKTtcbiAgICAgKiAgICAgIGlzT2RkKDIxKTsgLy89PiB0cnVlXG4gICAgICogICAgICBpc09kZCg0Mik7IC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgY29tcGxlbWVudCA9IF9jdXJyeTEoX2NvbXBsZW1lbnQpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uLCBgZm5gLCB3aGljaCBlbmNhcHN1bGF0ZXMgaWYvZWxzZS1pZi9lbHNlIGxvZ2ljLlxuICAgICAqIGBSLmNvbmRgIHRha2VzIGEgbGlzdCBvZiBbcHJlZGljYXRlLCB0cmFuc2Zvcm1dIHBhaXJzLiBBbGwgb2YgdGhlXG4gICAgICogYXJndW1lbnRzIHRvIGBmbmAgYXJlIGFwcGxpZWQgdG8gZWFjaCBvZiB0aGUgcHJlZGljYXRlcyBpbiB0dXJuXG4gICAgICogdW50aWwgb25lIHJldHVybnMgYSBcInRydXRoeVwiIHZhbHVlLCBhdCB3aGljaCBwb2ludCBgZm5gIHJldHVybnMgdGhlXG4gICAgICogcmVzdWx0IG9mIGFwcGx5aW5nIGl0cyBhcmd1bWVudHMgdG8gdGhlIGNvcnJlc3BvbmRpbmcgdHJhbnNmb3JtZXIuXG4gICAgICogSWYgbm9uZSBvZiB0aGUgcHJlZGljYXRlcyBtYXRjaGVzLCBgZm5gIHJldHVybnMgdW5kZWZpbmVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgW1soKi4uLiAtPiBCb29sZWFuKSwoKi4uLiAtPiAqKV1dIC0+ICgqLi4uIC0+ICopXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFpcnNcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZm4gPSBSLmNvbmQoW1xuICAgICAqICAgICAgICBbUi5lcXVhbHMoMCksICAgUi5hbHdheXMoJ3dhdGVyIGZyZWV6ZXMgYXQgMMKwQycpXSxcbiAgICAgKiAgICAgICAgW1IuZXF1YWxzKDEwMCksIFIuYWx3YXlzKCd3YXRlciBib2lscyBhdCAxMDDCsEMnKV0sXG4gICAgICogICAgICAgIFtSLlQsICAgICAgICAgICBmdW5jdGlvbih0ZW1wKSB7IHJldHVybiAnbm90aGluZyBzcGVjaWFsIGhhcHBlbnMgYXQgJyArIHRlbXAgKyAnwrBDJzsgfV1cbiAgICAgKiAgICAgIF0pO1xuICAgICAqICAgICAgZm4oMCk7IC8vPT4gJ3dhdGVyIGZyZWV6ZXMgYXQgMMKwQydcbiAgICAgKiAgICAgIGZuKDUwKTsgLy89PiAnbm90aGluZyBzcGVjaWFsIGhhcHBlbnMgYXQgNTDCsEMnXG4gICAgICogICAgICBmbigxMDApOyAvLz0+ICd3YXRlciBib2lscyBhdCAxMDDCsEMnXG4gICAgICovXG4gICAgdmFyIGNvbmQgPSBfY3VycnkxKGZ1bmN0aW9uIGNvbmQocGFpcnMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICAgICAgd2hpbGUgKGlkeCA8IHBhaXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmIChwYWlyc1tpZHhdWzBdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhaXJzW2lkeF1bMV0uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHhgIGlzIGZvdW5kIGluIHRoZSBgbGlzdGAsIHVzaW5nIGBwcmVkYCBhcyBhblxuICAgICAqIGVxdWFsaXR5IHByZWRpY2F0ZSBmb3IgYHhgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSwgYSAtPiBCb29sZWFuKSAtPiBhIC0+IFthXSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSB1c2VkIHRvIHRlc3Qgd2hldGhlciB0d28gaXRlbXMgYXJlIGVxdWFsLlxuICAgICAqIEBwYXJhbSB7Kn0geCBUaGUgaXRlbSB0byBmaW5kXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpdGVyYXRlIG92ZXJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgYHhgIGlzIGluIGBsaXN0YCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB4cyA9IFt7eDogMTJ9LCB7eDogMTF9LCB7eDogMTB9XTtcbiAgICAgKiAgICAgIFIuY29udGFpbnNXaXRoKGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEueCA9PT0gYi54OyB9LCB7eDogMTB9LCB4cyk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5jb250YWluc1dpdGgoZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYS54ID09PSBiLng7IH0sIHt4OiAxfSwgeHMpOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGNvbnRhaW5zV2l0aCA9IF9jdXJyeTMoX2NvbnRhaW5zV2l0aCk7XG5cbiAgICAvKipcbiAgICAgKiBDb3VudHMgdGhlIGVsZW1lbnRzIG9mIGEgbGlzdCBhY2NvcmRpbmcgdG8gaG93IG1hbnkgbWF0Y2ggZWFjaCB2YWx1ZVxuICAgICAqIG9mIGEga2V5IGdlbmVyYXRlZCBieSB0aGUgc3VwcGxpZWQgZnVuY3Rpb24uIFJldHVybnMgYW4gb2JqZWN0XG4gICAgICogbWFwcGluZyB0aGUga2V5cyBwcm9kdWNlZCBieSBgZm5gIHRvIHRoZSBudW1iZXIgb2Ygb2NjdXJyZW5jZXMgaW5cbiAgICAgKiB0aGUgbGlzdC4gTm90ZSB0aGF0IGFsbCBrZXlzIGFyZSBjb2VyY2VkIHRvIHN0cmluZ3MgYmVjYXVzZSBvZiBob3dcbiAgICAgKiBKYXZhU2NyaXB0IG9iamVjdHMgd29yay5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIChhIC0+IFN0cmluZykgLT4gW2FdIC0+IHsqfVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB1c2VkIHRvIG1hcCB2YWx1ZXMgdG8ga2V5cy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIGNvdW50IGVsZW1lbnRzIGZyb20uXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBBbiBvYmplY3QgbWFwcGluZyBrZXlzIHRvIG51bWJlciBvZiBvY2N1cnJlbmNlcyBpbiB0aGUgbGlzdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbnVtYmVycyA9IFsxLjAsIDEuMSwgMS4yLCAyLjAsIDMuMCwgMi4yXTtcbiAgICAgKiAgICAgIHZhciBsZXR0ZXJzID0gUi5zcGxpdCgnJywgJ2FiY0FCQ2FhYUJCYycpO1xuICAgICAqICAgICAgUi5jb3VudEJ5KE1hdGguZmxvb3IpKG51bWJlcnMpOyAgICAvLz0+IHsnMSc6IDMsICcyJzogMiwgJzMnOiAxfVxuICAgICAqICAgICAgUi5jb3VudEJ5KFIudG9Mb3dlcikobGV0dGVycyk7ICAgLy89PiB7J2EnOiA1LCAnYic6IDQsICdjJzogM31cbiAgICAgKi9cbiAgICB2YXIgY291bnRCeSA9IF9jdXJyeTIoZnVuY3Rpb24gY291bnRCeShmbiwgbGlzdCkge1xuICAgICAgICB2YXIgY291bnRzID0ge307XG4gICAgICAgIHZhciBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBmbihsaXN0W2lkeF0pO1xuICAgICAgICAgICAgY291bnRzW2tleV0gPSAoX2hhcyhrZXksIGNvdW50cykgPyBjb3VudHNba2V5XSA6IDApICsgMTtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb3VudHM7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIG9iamVjdCBjb250YWluaW5nIGEgc2luZ2xlIGtleTp2YWx1ZSBwYWlyLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIFN0cmluZyAtPiBhIC0+IHtTdHJpbmc6YX1cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5XG4gICAgICogQHBhcmFtIHsqfSB2YWxcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG1hdGNoUGhyYXNlcyA9IFIuY29tcG9zZShcbiAgICAgKiAgICAgICAgUi5jcmVhdGVNYXBFbnRyeSgnbXVzdCcpLFxuICAgICAqICAgICAgICBSLm1hcChSLmNyZWF0ZU1hcEVudHJ5KCdtYXRjaF9waHJhc2UnKSlcbiAgICAgKiAgICAgICk7XG4gICAgICogICAgICBtYXRjaFBocmFzZXMoWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiB7bXVzdDogW3ttYXRjaF9waHJhc2U6ICdmb28nfSwge21hdGNoX3BocmFzZTogJ2Jhcid9LCB7bWF0Y2hfcGhyYXNlOiAnYmF6J31dfVxuICAgICAqL1xuICAgIHZhciBjcmVhdGVNYXBFbnRyeSA9IF9jdXJyeTIoZnVuY3Rpb24gY3JlYXRlTWFwRW50cnkoa2V5LCB2YWwpIHtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICBvYmpba2V5XSA9IHZhbDtcbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBjdXJyaWVkIGVxdWl2YWxlbnQgb2YgdGhlIHByb3ZpZGVkIGZ1bmN0aW9uLCB3aXRoIHRoZVxuICAgICAqIHNwZWNpZmllZCBhcml0eS4gVGhlIGN1cnJpZWQgZnVuY3Rpb24gaGFzIHR3byB1bnVzdWFsIGNhcGFiaWxpdGllcy5cbiAgICAgKiBGaXJzdCwgaXRzIGFyZ3VtZW50cyBuZWVkbid0IGJlIHByb3ZpZGVkIG9uZSBhdCBhIHRpbWUuIElmIGBnYCBpc1xuICAgICAqIGBSLmN1cnJ5TigzLCBmKWAsIHRoZSBmb2xsb3dpbmcgYXJlIGVxdWl2YWxlbnQ6XG4gICAgICpcbiAgICAgKiAgIC0gYGcoMSkoMikoMylgXG4gICAgICogICAtIGBnKDEpKDIsIDMpYFxuICAgICAqICAgLSBgZygxLCAyKSgzKWBcbiAgICAgKiAgIC0gYGcoMSwgMiwgMylgXG4gICAgICpcbiAgICAgKiBTZWNvbmRseSwgdGhlIHNwZWNpYWwgcGxhY2Vob2xkZXIgdmFsdWUgYFIuX19gIG1heSBiZSB1c2VkIHRvIHNwZWNpZnlcbiAgICAgKiBcImdhcHNcIiwgYWxsb3dpbmcgcGFydGlhbCBhcHBsaWNhdGlvbiBvZiBhbnkgY29tYmluYXRpb24gb2YgYXJndW1lbnRzLFxuICAgICAqIHJlZ2FyZGxlc3Mgb2YgdGhlaXIgcG9zaXRpb25zLiBJZiBgZ2AgaXMgYXMgYWJvdmUgYW5kIGBfYCBpcyBgUi5fX2AsXG4gICAgICogdGhlIGZvbGxvd2luZyBhcmUgZXF1aXZhbGVudDpcbiAgICAgKlxuICAgICAqICAgLSBgZygxLCAyLCAzKWBcbiAgICAgKiAgIC0gYGcoXywgMiwgMykoMSlgXG4gICAgICogICAtIGBnKF8sIF8sIDMpKDEpKDIpYFxuICAgICAqICAgLSBgZyhfLCBfLCAzKSgxLCAyKWBcbiAgICAgKiAgIC0gYGcoXywgMikoMSkoMylgXG4gICAgICogICAtIGBnKF8sIDIpKDEsIDMpYFxuICAgICAqICAgLSBgZyhfLCAyKShfLCAzKSgxKWBcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIE51bWJlciAtPiAoKiAtPiBhKSAtPiAoKiAtPiBhKVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBsZW5ndGggVGhlIGFyaXR5IGZvciB0aGUgcmV0dXJuZWQgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGN1cnJ5LlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldywgY3VycmllZCBmdW5jdGlvbi5cbiAgICAgKiBAc2VlIFIuY3VycnlcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYWRkRm91ck51bWJlcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIFIuc3VtKFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwLCA0KSk7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICB2YXIgY3VycmllZEFkZEZvdXJOdW1iZXJzID0gUi5jdXJyeU4oNCwgYWRkRm91ck51bWJlcnMpO1xuICAgICAqICAgICAgdmFyIGYgPSBjdXJyaWVkQWRkRm91ck51bWJlcnMoMSwgMik7XG4gICAgICogICAgICB2YXIgZyA9IGYoMyk7XG4gICAgICogICAgICBnKDQpOyAvLz0+IDEwXG4gICAgICovXG4gICAgdmFyIGN1cnJ5TiA9IF9jdXJyeTIoZnVuY3Rpb24gY3VycnlOKGxlbmd0aCwgZm4pIHtcbiAgICAgICAgaWYgKGxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIF9jdXJyeTEoZm4pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfYXJpdHkobGVuZ3RoLCBfY3VycnlOKGxlbmd0aCwgW10sIGZuKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBEZWNyZW1lbnRzIGl0cyBhcmd1bWVudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAgICogQHJldHVybiB7TnVtYmVyfVxuICAgICAqIEBzZWUgUi5pbmNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmRlYyg0Mik7IC8vPT4gNDFcbiAgICAgKi9cbiAgICB2YXIgZGVjID0gYWRkKC0xKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHNlY29uZCBhcmd1bWVudCBpZiBpdCBpcyBub3QgbnVsbCBvciB1bmRlZmluZWQuIElmIGl0IGlzIG51bGxcbiAgICAgKiBvciB1bmRlZmluZWQsIHRoZSBmaXJzdCAoZGVmYXVsdCkgYXJndW1lbnQgaXMgcmV0dXJuZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExvZ2ljXG4gICAgICogQHNpZyBhIC0+IGIgLT4gYSB8IGJcbiAgICAgKiBAcGFyYW0ge2F9IHZhbCBUaGUgZGVmYXVsdCB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge2J9IHZhbCBUaGUgdmFsdWUgdG8gcmV0dXJuIGlmIGl0IGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgICAqIEByZXR1cm4geyp9IFRoZSB0aGUgc2Vjb25kIHZhbHVlIG9yIHRoZSBkZWZhdWx0IHZhbHVlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGRlZmF1bHRUbzQyID0gZGVmYXVsdFRvKDQyKTtcbiAgICAgKlxuICAgICAqICAgICAgZGVmYXVsdFRvNDIobnVsbCk7ICAvLz0+IDQyXG4gICAgICogICAgICBkZWZhdWx0VG80Mih1bmRlZmluZWQpOyAgLy89PiA0MlxuICAgICAqICAgICAgZGVmYXVsdFRvNDIoJ1JhbWRhJyk7ICAvLz0+ICdSYW1kYSdcbiAgICAgKi9cbiAgICB2YXIgZGVmYXVsdFRvID0gX2N1cnJ5MihmdW5jdGlvbiBkZWZhdWx0VG8oZCwgdikge1xuICAgICAgICByZXR1cm4gdiA9PSBudWxsID8gZCA6IHY7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBGaW5kcyB0aGUgc2V0IChpLmUuIG5vIGR1cGxpY2F0ZXMpIG9mIGFsbCBlbGVtZW50cyBpbiB0aGUgZmlyc3QgbGlzdCBub3QgY29udGFpbmVkIGluIHRoZSBzZWNvbmQgbGlzdC5cbiAgICAgKiBEdXBsaWNhdGlvbiBpcyBkZXRlcm1pbmVkIGFjY29yZGluZyB0byB0aGUgdmFsdWUgcmV0dXJuZWQgYnkgYXBwbHlpbmcgdGhlIHN1cHBsaWVkIHByZWRpY2F0ZSB0byB0d28gbGlzdFxuICAgICAqIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgKGEsYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgQSBwcmVkaWNhdGUgdXNlZCB0byB0ZXN0IHdoZXRoZXIgdHdvIGl0ZW1zIGFyZSBlcXVhbC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MSBUaGUgZmlyc3QgbGlzdC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MiBUaGUgc2Vjb25kIGxpc3QuXG4gICAgICogQHNlZSBSLmRpZmZlcmVuY2VcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGVsZW1lbnRzIGluIGBsaXN0MWAgdGhhdCBhcmUgbm90IGluIGBsaXN0MmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgZnVuY3Rpb24gY21wKHgsIHkpIHsgcmV0dXJuIHguYSA9PT0geS5hOyB9XG4gICAgICogICAgICB2YXIgbDEgPSBbe2E6IDF9LCB7YTogMn0sIHthOiAzfV07XG4gICAgICogICAgICB2YXIgbDIgPSBbe2E6IDN9LCB7YTogNH1dO1xuICAgICAqICAgICAgUi5kaWZmZXJlbmNlV2l0aChjbXAsIGwxLCBsMik7IC8vPT4gW3thOiAxfSwge2E6IDJ9XVxuICAgICAqL1xuICAgIHZhciBkaWZmZXJlbmNlV2l0aCA9IF9jdXJyeTMoZnVuY3Rpb24gZGlmZmVyZW5jZVdpdGgocHJlZCwgZmlyc3QsIHNlY29uZCkge1xuICAgICAgICB2YXIgb3V0ID0gW107XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB2YXIgZmlyc3RMZW4gPSBmaXJzdC5sZW5ndGg7XG4gICAgICAgIHZhciBjb250YWluc1ByZWQgPSBjb250YWluc1dpdGgocHJlZCk7XG4gICAgICAgIHdoaWxlIChpZHggPCBmaXJzdExlbikge1xuICAgICAgICAgICAgaWYgKCFjb250YWluc1ByZWQoZmlyc3RbaWR4XSwgc2Vjb25kKSAmJiAhY29udGFpbnNQcmVkKGZpcnN0W2lkeF0sIG91dCkpIHtcbiAgICAgICAgICAgICAgICBvdXRbb3V0Lmxlbmd0aF0gPSBmaXJzdFtpZHhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHRoYXQgZG9lcyBub3QgY29udGFpbiBhIGBwcm9wYCBwcm9wZXJ0eS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBTdHJpbmcgLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wIHRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byBkaXNzb2NpYXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiB0aGUgb2JqZWN0IHRvIGNsb25lXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBhIG5ldyBvYmplY3Qgc2ltaWxhciB0byB0aGUgb3JpZ2luYWwgYnV0IHdpdGhvdXQgdGhlIHNwZWNpZmllZCBwcm9wZXJ0eVxuICAgICAqIEBzZWUgUi5hc3NvY1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZGlzc29jKCdiJywge2E6IDEsIGI6IDIsIGM6IDN9KTsgLy89PiB7YTogMSwgYzogM31cbiAgICAgKi9cbiAgICB2YXIgZGlzc29jID0gX2N1cnJ5MihmdW5jdGlvbiBkaXNzb2MocHJvcCwgb2JqKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgcCBpbiBvYmopIHtcbiAgICAgICAgICAgIGlmIChwICE9PSBwcm9wKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W3BdID0gb2JqW3BdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBNYWtlcyBhIHNoYWxsb3cgY2xvbmUgb2YgYW4gb2JqZWN0LCBvbWl0dGluZyB0aGUgcHJvcGVydHkgYXQgdGhlXG4gICAgICogZ2l2ZW4gcGF0aC4gTm90ZSB0aGF0IHRoaXMgY29waWVzIGFuZCBmbGF0dGVucyBwcm90b3R5cGUgcHJvcGVydGllc1xuICAgICAqIG9udG8gdGhlIG5ldyBvYmplY3QgYXMgd2VsbC4gIEFsbCBub24tcHJpbWl0aXZlIHByb3BlcnRpZXMgYXJlIGNvcGllZFxuICAgICAqIGJ5IHJlZmVyZW5jZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBbU3RyaW5nXSAtPiB7azogdn0gLT4ge2s6IHZ9XG4gICAgICogQHBhcmFtIHtBcnJheX0gcGF0aCB0aGUgcGF0aCB0byBzZXRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIHRoZSBvYmplY3QgdG8gY2xvbmVcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IGEgbmV3IG9iamVjdCB3aXRob3V0IHRoZSBwcm9wZXJ0eSBhdCBwYXRoXG4gICAgICogQHNlZSBSLmFzc29jUGF0aFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZGlzc29jUGF0aChbJ2EnLCAnYicsICdjJ10sIHthOiB7Yjoge2M6IDQyfX19KTsgLy89PiB7YToge2I6IHt9fX1cbiAgICAgKi9cbiAgICB2YXIgZGlzc29jUGF0aCA9IF9jdXJyeTIoZnVuY3Rpb24gZGlzc29jUGF0aChwYXRoLCBvYmopIHtcbiAgICAgICAgc3dpdGNoIChwYXRoLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gZGlzc29jKHBhdGhbMF0sIG9iaik7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB2YXIgaGVhZCA9IHBhdGhbMF07XG4gICAgICAgICAgICB2YXIgdGFpbCA9IF9zbGljZShwYXRoLCAxKTtcbiAgICAgICAgICAgIHJldHVybiBvYmpbaGVhZF0gPT0gbnVsbCA/IG9iaiA6IGFzc29jKGhlYWQsIGRpc3NvY1BhdGgodGFpbCwgb2JqW2hlYWRdKSwgb2JqKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogRGl2aWRlcyB0d28gbnVtYmVycy4gRXF1aXZhbGVudCB0byBgYSAvIGJgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBhIFRoZSBmaXJzdCB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYiBUaGUgc2Vjb25kIHZhbHVlLlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIHJlc3VsdCBvZiBgYSAvIGJgLlxuICAgICAqIEBzZWUgUi5tdWx0aXBseVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZGl2aWRlKDcxLCAxMDApOyAvLz0+IDAuNzFcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGhhbGYgPSBSLmRpdmlkZShSLl9fLCAyKTtcbiAgICAgKiAgICAgIGhhbGYoNDIpOyAvLz0+IDIxXG4gICAgICpcbiAgICAgKiAgICAgIHZhciByZWNpcHJvY2FsID0gUi5kaXZpZGUoMSk7XG4gICAgICogICAgICByZWNpcHJvY2FsKDQpOyAgIC8vPT4gMC4yNVxuICAgICAqL1xuICAgIHZhciBkaXZpZGUgPSBfY3VycnkyKGZ1bmN0aW9uIGRpdmlkZShhLCBiKSB7XG4gICAgICAgIHJldHVybiBhIC8gYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIGFsbCBidXQgbGFzdCB0aGVgbmAgZWxlbWVudHMgb2YgYSBnaXZlbiBsaXN0LFxuICAgICAqIHBhc3NpbmcgZWFjaCB2YWx1ZSBmcm9tIHRoZSByaWdodCB0byB0aGUgc3VwcGxpZWQgcHJlZGljYXRlIGZ1bmN0aW9uLCBza2lwcGluZ1xuICAgICAqIGVsZW1lbnRzIHdoaWxlIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gcmV0dXJucyBgdHJ1ZWAuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb25cbiAgICAgKiBpcyBwYXNzZWQgb25lIGFyZ3VtZW50OiAodmFsdWUpKi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgYXJyYXkuXG4gICAgICogQHNlZSBSLnRha2VMYXN0V2hpbGVcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbHRlVGhyZWUgPSBmdW5jdGlvbih4KSB7XG4gICAgICogICAgICAgIHJldHVybiB4IDw9IDM7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBSLmRyb3BMYXN0V2hpbGUobHRlVGhyZWUsIFsxLCAyLCAzLCA0LCAzLCAyLCAxXSk7IC8vPT4gWzEsIDJdXG4gICAgICovXG4gICAgdmFyIGRyb3BMYXN0V2hpbGUgPSBfY3VycnkyKGZ1bmN0aW9uIGRyb3BMYXN0V2hpbGUocHJlZCwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICB3aGlsZSAoaWR4ID49IDAgJiYgcHJlZChsaXN0W2lkeF0pKSB7XG4gICAgICAgICAgICBpZHggLT0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3NsaWNlKGxpc3QsIDAsIGlkeCArIDEpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB3cmFwcGluZyBjYWxscyB0byB0aGUgdHdvIGZ1bmN0aW9ucyBpbiBhbiBgfHxgIG9wZXJhdGlvbiwgcmV0dXJuaW5nIHRoZSByZXN1bHQgb2YgdGhlIGZpcnN0XG4gICAgICogZnVuY3Rpb24gaWYgaXQgaXMgdHJ1dGgteSBhbmQgdGhlIHJlc3VsdCBvZiB0aGUgc2Vjb25kIGZ1bmN0aW9uIG90aGVyd2lzZS4gIE5vdGUgdGhhdCB0aGlzIGlzXG4gICAgICogc2hvcnQtY2lyY3VpdGVkLCBtZWFuaW5nIHRoYXQgdGhlIHNlY29uZCBmdW5jdGlvbiB3aWxsIG5vdCBiZSBpbnZva2VkIGlmIHRoZSBmaXJzdCByZXR1cm5zIGEgdHJ1dGgteVxuICAgICAqIHZhbHVlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgKCouLi4gLT4gQm9vbGVhbikgLT4gKCouLi4gLT4gQm9vbGVhbikgLT4gKCouLi4gLT4gQm9vbGVhbilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmIGEgcHJlZGljYXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZyBhbm90aGVyIHByZWRpY2F0ZVxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBhIGZ1bmN0aW9uIHRoYXQgYXBwbGllcyBpdHMgYXJndW1lbnRzIHRvIGBmYCBhbmQgYGdgIGFuZCBgfHxgcyB0aGVpciBvdXRwdXRzIHRvZ2V0aGVyLlxuICAgICAqIEBzZWUgUi5vclxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBndDEwID0gZnVuY3Rpb24oeCkgeyByZXR1cm4geCA+IDEwOyB9O1xuICAgICAqICAgICAgdmFyIGV2ZW4gPSBmdW5jdGlvbih4KSB7IHJldHVybiB4ICUgMiA9PT0gMCB9O1xuICAgICAqICAgICAgdmFyIGYgPSBSLmVpdGhlcihndDEwLCBldmVuKTtcbiAgICAgKiAgICAgIGYoMTAxKTsgLy89PiB0cnVlXG4gICAgICogICAgICBmKDgpOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgZWl0aGVyID0gX2N1cnJ5MihmdW5jdGlvbiBlaXRoZXIoZiwgZykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX2VpdGhlcigpIHtcbiAgICAgICAgICAgIHJldHVybiBmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZW1wdHkgdmFsdWUgb2YgaXRzIGFyZ3VtZW50J3MgdHlwZS4gUmFtZGEgZGVmaW5lcyB0aGUgZW1wdHlcbiAgICAgKiB2YWx1ZSBvZiBBcnJheSAoYFtdYCksIE9iamVjdCAoYHt9YCksIGFuZCBTdHJpbmcgKGAnJ2ApLiBPdGhlciB0eXBlcyBhcmVcbiAgICAgKiBzdXBwb3J0ZWQgaWYgdGhleSBkZWZpbmUgYDxUeXBlPi5lbXB0eWAgYW5kL29yIGA8VHlwZT4ucHJvdG90eXBlLmVtcHR5YC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIGEgLT4gYVxuICAgICAqIEBwYXJhbSB7Kn0geFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5lbXB0eShKdXN0KDQyKSk7ICAgICAgLy89PiBOb3RoaW5nKClcbiAgICAgKiAgICAgIFIuZW1wdHkoWzEsIDIsIDNdKTsgICAgIC8vPT4gW11cbiAgICAgKiAgICAgIFIuZW1wdHkoJ3VuaWNvcm5zJyk7ICAgIC8vPT4gJydcbiAgICAgKiAgICAgIFIuZW1wdHkoe3g6IDEsIHk6IDJ9KTsgIC8vPT4ge31cbiAgICAgKi9cbiAgICB2YXIgZW1wdHkgPSBfY3VycnkxKGZ1bmN0aW9uIGVtcHR5KHgpIHtcbiAgICAgICAgaWYgKHggIT0gbnVsbCAmJiB0eXBlb2YgeC5lbXB0eSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHguZW1wdHkoKTtcbiAgICAgICAgfSBlbHNlIGlmICh4ICE9IG51bGwgJiYgdHlwZW9mIHguY29uc3RydWN0b3IgIT0gbnVsbCAmJiB0eXBlb2YgeC5jb25zdHJ1Y3Rvci5lbXB0eSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgcmV0dXJuIHguY29uc3RydWN0b3IuZW1wdHkoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN3aXRjaCAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpKSB7XG4gICAgICAgICAgICBjYXNlICdbb2JqZWN0IEFycmF5XSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY2FzZSAnW29iamVjdCBPYmplY3RdJzpcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgICAgICBjYXNlICdbb2JqZWN0IFN0cmluZ10nOlxuICAgICAgICAgICAgICAgIHJldHVybiAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBvYmplY3QgYnkgcmVjdXJzaXZlbHkgZXZvbHZpbmcgYSBzaGFsbG93IGNvcHkgb2YgYG9iamVjdGAsIGFjY29yZGluZyB0byB0aGVcbiAgICAgKiBgdHJhbnNmb3JtYXRpb25gIGZ1bmN0aW9ucy4gQWxsIG5vbi1wcmltaXRpdmUgcHJvcGVydGllcyBhcmUgY29waWVkIGJ5IHJlZmVyZW5jZS5cbiAgICAgKlxuICAgICAqIEEgYHRyYW5mb3JtYXRpb25gIGZ1bmN0aW9uIHdpbGwgbm90IGJlIGludm9rZWQgaWYgaXRzIGNvcnJlc3BvbmRpbmcga2V5IGRvZXMgbm90IGV4aXN0IGluXG4gICAgICogdGhlIGV2b2x2ZWQgb2JqZWN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHtrOiAodiAtPiB2KX0gLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0cmFuc2Zvcm1hdGlvbnMgVGhlIG9iamVjdCBzcGVjaWZ5aW5nIHRyYW5zZm9ybWF0aW9uIGZ1bmN0aW9ucyB0byBhcHBseVxuICAgICAqICAgICAgICB0byB0aGUgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBiZSB0cmFuc2Zvcm1lZC5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IFRoZSB0cmFuc2Zvcm1lZCBvYmplY3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRvbWF0byAgPSB7Zmlyc3ROYW1lOiAnICBUb21hdG8gJywgZGF0YToge2VsYXBzZWQ6IDEwMCwgcmVtYWluaW5nOiAxNDAwfSwgaWQ6MTIzfTtcbiAgICAgKiAgICAgIHZhciB0cmFuc2Zvcm1hdGlvbnMgPSB7XG4gICAgICogICAgICAgIGZpcnN0TmFtZTogUi50cmltLFxuICAgICAqICAgICAgICBsYXN0TmFtZTogUi50cmltLCAvLyBXaWxsIG5vdCBnZXQgaW52b2tlZC5cbiAgICAgKiAgICAgICAgZGF0YToge2VsYXBzZWQ6IFIuYWRkKDEpLCByZW1haW5pbmc6IFIuYWRkKC0xKX1cbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICBSLmV2b2x2ZSh0cmFuc2Zvcm1hdGlvbnMsIHRvbWF0byk7IC8vPT4ge2ZpcnN0TmFtZTogJ1RvbWF0bycsIGRhdGE6IHtlbGFwc2VkOiAxMDEsIHJlbWFpbmluZzogMTM5OX0sIGlkOjEyM31cbiAgICAgKi9cbiAgICB2YXIgZXZvbHZlID0gX2N1cnJ5MihmdW5jdGlvbiBldm9sdmUodHJhbnNmb3JtYXRpb25zLCBvYmplY3QpIHtcbiAgICAgICAgdmFyIHRyYW5zZm9ybWF0aW9uLCBrZXksIHR5cGUsIHJlc3VsdCA9IHt9O1xuICAgICAgICBmb3IgKGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICAgIHRyYW5zZm9ybWF0aW9uID0gdHJhbnNmb3JtYXRpb25zW2tleV07XG4gICAgICAgICAgICB0eXBlID0gdHlwZW9mIHRyYW5zZm9ybWF0aW9uO1xuICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB0eXBlID09PSAnZnVuY3Rpb24nID8gdHJhbnNmb3JtYXRpb24ob2JqZWN0W2tleV0pIDogdHlwZSA9PT0gJ29iamVjdCcgPyBldm9sdmUodHJhbnNmb3JtYXRpb25zW2tleV0sIG9iamVjdFtrZXldKSA6IG9iamVjdFtrZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IG9iamVjdCBvdXQgb2YgYSBsaXN0IGtleS12YWx1ZSBwYWlycy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW1trLHZdXSAtPiB7azogdn1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYWlycyBBbiBhcnJheSBvZiB0d28tZWxlbWVudCBhcnJheXMgdGhhdCB3aWxsIGJlIHRoZSBrZXlzIGFuZCB2YWx1ZXMgb2YgdGhlIG91dHB1dCBvYmplY3QuXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgb2JqZWN0IG1hZGUgYnkgcGFpcmluZyB1cCBga2V5c2AgYW5kIGB2YWx1ZXNgLlxuICAgICAqIEBzZWUgUi50b1BhaXJzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5mcm9tUGFpcnMoW1snYScsIDFdLCBbJ2InLCAyXSwgIFsnYycsIDNdXSk7IC8vPT4ge2E6IDEsIGI6IDIsIGM6IDN9XG4gICAgICovXG4gICAgdmFyIGZyb21QYWlycyA9IF9jdXJyeTEoZnVuY3Rpb24gZnJvbVBhaXJzKHBhaXJzKSB7XG4gICAgICAgIHZhciBpZHggPSAwLCBsZW4gPSBwYWlycy5sZW5ndGgsIG91dCA9IHt9O1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoX2lzQXJyYXkocGFpcnNbaWR4XSkgJiYgcGFpcnNbaWR4XS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBvdXRbcGFpcnNbaWR4XVswXV0gPSBwYWlyc1tpZHhdWzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpcyBncmVhdGVyIHRoYW4gdGhlIHNlY29uZDtcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBhID0+IGEgLT4gYSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHsqfSBhXG4gICAgICogQHBhcmFtIHsqfSBiXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiBAc2VlIFIubHRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmd0KDIsIDEpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuZ3QoMiwgMik7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuZ3QoMiwgMyk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuZ3QoJ2EnLCAneicpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmd0KCd6JywgJ2EnKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGd0ID0gX2N1cnJ5MihmdW5jdGlvbiBndChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhID4gYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHNlY29uZDtcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBhID0+IGEgLT4gYSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQHNlZSBSLmx0ZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZ3RlKDIsIDEpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuZ3RlKDIsIDIpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuZ3RlKDIsIDMpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmd0ZSgnYScsICd6Jyk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuZ3RlKCd6JywgJ2EnKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGd0ZSA9IF9jdXJyeTIoZnVuY3Rpb24gZ3RlKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgPj0gYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBvciBub3QgYW4gb2JqZWN0IGhhcyBhbiBvd24gcHJvcGVydHkgd2l0aFxuICAgICAqIHRoZSBzcGVjaWZpZWQgbmFtZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHMgLT4ge3M6IHh9IC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcCBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgdG8gY2hlY2sgZm9yLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBXaGV0aGVyIHRoZSBwcm9wZXJ0eSBleGlzdHMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGhhc05hbWUgPSBSLmhhcygnbmFtZScpO1xuICAgICAqICAgICAgaGFzTmFtZSh7bmFtZTogJ2FsaWNlJ30pOyAgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgaGFzTmFtZSh7bmFtZTogJ2JvYid9KTsgICAgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgaGFzTmFtZSh7fSk7ICAgICAgICAgICAgICAgIC8vPT4gZmFsc2VcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHBvaW50ID0ge3g6IDAsIHk6IDB9O1xuICAgICAqICAgICAgdmFyIHBvaW50SGFzID0gUi5oYXMoUi5fXywgcG9pbnQpO1xuICAgICAqICAgICAgcG9pbnRIYXMoJ3gnKTsgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgcG9pbnRIYXMoJ3knKTsgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgcG9pbnRIYXMoJ3onKTsgIC8vPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgaGFzID0gX2N1cnJ5MihfaGFzKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBvciBub3QgYW4gb2JqZWN0IG9yIGl0cyBwcm90b3R5cGUgY2hhaW4gaGFzXG4gICAgICogYSBwcm9wZXJ0eSB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHMgLT4ge3M6IHh9IC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcCBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgdG8gY2hlY2sgZm9yLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBXaGV0aGVyIHRoZSBwcm9wZXJ0eSBleGlzdHMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgZnVuY3Rpb24gUmVjdGFuZ2xlKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgKiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAqICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgKiAgICAgIH1cbiAgICAgKiAgICAgIFJlY3RhbmdsZS5wcm90b3R5cGUuYXJlYSA9IGZ1bmN0aW9uKCkge1xuICAgICAqICAgICAgICByZXR1cm4gdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0O1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHNxdWFyZSA9IG5ldyBSZWN0YW5nbGUoMiwgMik7XG4gICAgICogICAgICBSLmhhc0luKCd3aWR0aCcsIHNxdWFyZSk7ICAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaGFzSW4oJ2FyZWEnLCBzcXVhcmUpOyAgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGhhc0luID0gX2N1cnJ5MihmdW5jdGlvbiBoYXNJbihwcm9wLCBvYmopIHtcbiAgICAgICAgcmV0dXJuIHByb3AgaW4gb2JqO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGl0cyBhcmd1bWVudHMgYXJlIGlkZW50aWNhbCwgZmFsc2Ugb3RoZXJ3aXNlLiBWYWx1ZXMgYXJlXG4gICAgICogaWRlbnRpY2FsIGlmIHRoZXkgcmVmZXJlbmNlIHRoZSBzYW1lIG1lbW9yeS4gYE5hTmAgaXMgaWRlbnRpY2FsIHRvIGBOYU5gO1xuICAgICAqIGAwYCBhbmQgYC0wYCBhcmUgbm90IGlkZW50aWNhbC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIGEgLT4gYSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHsqfSBhXG4gICAgICogQHBhcmFtIHsqfSBiXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbyA9IHt9O1xuICAgICAqICAgICAgUi5pZGVudGljYWwobywgbyk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pZGVudGljYWwoMSwgMSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pZGVudGljYWwoMSwgJzEnKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pZGVudGljYWwoW10sIFtdKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pZGVudGljYWwoMCwgLTApOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlkZW50aWNhbChOYU4sIE5hTik7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIC8vIFNhbWVWYWx1ZSBhbGdvcml0aG1cbiAgICAvLyBTdGVwcyAxLTUsIDctMTBcbiAgICAvLyBTdGVwcyA2LmItNi5lOiArMCAhPSAtMFxuICAgIC8vIFN0ZXAgNi5hOiBOYU4gPT0gTmFOXG4gICAgdmFyIGlkZW50aWNhbCA9IF9jdXJyeTIoZnVuY3Rpb24gaWRlbnRpY2FsKGEsIGIpIHtcbiAgICAgICAgLy8gU2FtZVZhbHVlIGFsZ29yaXRobVxuICAgICAgICBpZiAoYSA9PT0gYikge1xuICAgICAgICAgICAgLy8gU3RlcHMgMS01LCA3LTEwXG4gICAgICAgICAgICAvLyBTdGVwcyA2LmItNi5lOiArMCAhPSAtMFxuICAgICAgICAgICAgcmV0dXJuIGEgIT09IDAgfHwgMSAvIGEgPT09IDEgLyBiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gU3RlcCA2LmE6IE5hTiA9PSBOYU5cbiAgICAgICAgICAgIHJldHVybiBhICE9PSBhICYmIGIgIT09IGI7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEEgZnVuY3Rpb24gdGhhdCBkb2VzIG5vdGhpbmcgYnV0IHJldHVybiB0aGUgcGFyYW1ldGVyIHN1cHBsaWVkIHRvIGl0LiBHb29kIGFzIGEgZGVmYXVsdFxuICAgICAqIG9yIHBsYWNlaG9sZGVyIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgYSAtPiBhXG4gICAgICogQHBhcmFtIHsqfSB4IFRoZSB2YWx1ZSB0byByZXR1cm4uXG4gICAgICogQHJldHVybiB7Kn0gVGhlIGlucHV0IHZhbHVlLCBgeGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pZGVudGl0eSgxKTsgLy89PiAxXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgKiAgICAgIFIuaWRlbnRpdHkob2JqKSA9PT0gb2JqOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgaWRlbnRpdHkgPSBfY3VycnkxKF9pZGVudGl0eSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCB3aWxsIHByb2Nlc3MgZWl0aGVyIHRoZSBgb25UcnVlYCBvciB0aGUgYG9uRmFsc2VgIGZ1bmN0aW9uIGRlcGVuZGluZ1xuICAgICAqIHVwb24gdGhlIHJlc3VsdCBvZiB0aGUgYGNvbmRpdGlvbmAgcHJlZGljYXRlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgKCouLi4gLT4gQm9vbGVhbikgLT4gKCouLi4gLT4gKikgLT4gKCouLi4gLT4gKikgLT4gKCouLi4gLT4gKilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb25kaXRpb24gQSBwcmVkaWNhdGUgZnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvblRydWUgQSBmdW5jdGlvbiB0byBpbnZva2Ugd2hlbiB0aGUgYGNvbmRpdGlvbmAgZXZhbHVhdGVzIHRvIGEgdHJ1dGh5IHZhbHVlLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRmFsc2UgQSBmdW5jdGlvbiB0byBpbnZva2Ugd2hlbiB0aGUgYGNvbmRpdGlvbmAgZXZhbHVhdGVzIHRvIGEgZmFsc3kgdmFsdWUuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgbmV3IHVuYXJ5IGZ1bmN0aW9uIHRoYXQgd2lsbCBwcm9jZXNzIGVpdGhlciB0aGUgYG9uVHJ1ZWAgb3IgdGhlIGBvbkZhbHNlYFxuICAgICAqICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBkZXBlbmRpbmcgdXBvbiB0aGUgcmVzdWx0IG9mIHRoZSBgY29uZGl0aW9uYCBwcmVkaWNhdGUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gRmxhdHRlbiBhbGwgYXJyYXlzIGluIHRoZSBsaXN0IGJ1dCBsZWF2ZSBvdGhlciB2YWx1ZXMgYWxvbmUuXG4gICAgICogICAgICB2YXIgZmxhdHRlbkFycmF5cyA9IFIubWFwKFIuaWZFbHNlKEFycmF5LmlzQXJyYXksIFIuZmxhdHRlbiwgUi5pZGVudGl0eSkpO1xuICAgICAqXG4gICAgICogICAgICBmbGF0dGVuQXJyYXlzKFtbMF0sIFtbMTBdLCBbOF1dLCAxMjM0LCB7fV0pOyAvLz0+IFtbMF0sIFsxMCwgOF0sIDEyMzQsIHt9XVxuICAgICAqICAgICAgZmxhdHRlbkFycmF5cyhbW1sxMF0sIDEyM10sIFs4LCBbMTBdXSwgXCJoZWxsb1wiXSk7IC8vPT4gW1sxMCwgMTIzXSwgWzgsIDEwXSwgXCJoZWxsb1wiXVxuICAgICAqL1xuICAgIHZhciBpZkVsc2UgPSBfY3VycnkzKGZ1bmN0aW9uIGlmRWxzZShjb25kaXRpb24sIG9uVHJ1ZSwgb25GYWxzZSkge1xuICAgICAgICByZXR1cm4gY3VycnlOKE1hdGgubWF4KGNvbmRpdGlvbi5sZW5ndGgsIG9uVHJ1ZS5sZW5ndGgsIG9uRmFsc2UubGVuZ3RoKSwgZnVuY3Rpb24gX2lmRWxzZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBjb25kaXRpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKSA/IG9uVHJ1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpIDogb25GYWxzZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEluY3JlbWVudHMgaXRzIGFyZ3VtZW50LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBOdW1iZXIgLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG5cbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICogQHNlZSBSLmRlY1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuaW5jKDQyKTsgLy89PiA0M1xuICAgICAqL1xuICAgIHZhciBpbmMgPSBhZGQoMSk7XG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnRzIHRoZSBzdXBwbGllZCBlbGVtZW50IGludG8gdGhlIGxpc3QsIGF0IGluZGV4IGBpbmRleGAuICBfTm90ZVxuICAgICAqIHRoYXQgdGhpcyBpcyBub3QgZGVzdHJ1Y3RpdmVfOiBpdCByZXR1cm5zIGEgY29weSBvZiB0aGUgbGlzdCB3aXRoIHRoZSBjaGFuZ2VzLlxuICAgICAqIDxzbWFsbD5ObyBsaXN0cyBoYXZlIGJlZW4gaGFybWVkIGluIHRoZSBhcHBsaWNhdGlvbiBvZiB0aGlzIGZ1bmN0aW9uLjwvc21hbGw+XG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBhIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXggVGhlIHBvc2l0aW9uIHRvIGluc2VydCB0aGUgZWxlbWVudFxuICAgICAqIEBwYXJhbSB7Kn0gZWx0IFRoZSBlbGVtZW50IHRvIGluc2VydCBpbnRvIHRoZSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaW5zZXJ0IGludG9cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgQXJyYXkgd2l0aCBgZWx0YCBpbnNlcnRlZCBhdCBgaW5kZXhgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuaW5zZXJ0KDIsICd4JywgWzEsMiwzLDRdKTsgLy89PiBbMSwyLCd4JywzLDRdXG4gICAgICovXG4gICAgdmFyIGluc2VydCA9IF9jdXJyeTMoZnVuY3Rpb24gaW5zZXJ0KGlkeCwgZWx0LCBsaXN0KSB7XG4gICAgICAgIGlkeCA9IGlkeCA8IGxpc3QubGVuZ3RoICYmIGlkeCA+PSAwID8gaWR4IDogbGlzdC5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSBfc2xpY2UobGlzdCk7XG4gICAgICAgIHJlc3VsdC5zcGxpY2UoaWR4LCAwLCBlbHQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0cyB0aGUgc3ViLWxpc3QgaW50byB0aGUgbGlzdCwgYXQgaW5kZXggYGluZGV4YC4gIF9Ob3RlICB0aGF0IHRoaXNcbiAgICAgKiBpcyBub3QgZGVzdHJ1Y3RpdmVfOiBpdCByZXR1cm5zIGEgY29weSBvZiB0aGUgbGlzdCB3aXRoIHRoZSBjaGFuZ2VzLlxuICAgICAqIDxzbWFsbD5ObyBsaXN0cyBoYXZlIGJlZW4gaGFybWVkIGluIHRoZSBhcHBsaWNhdGlvbiBvZiB0aGlzIGZ1bmN0aW9uLjwvc21hbGw+XG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBbYV0gLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCBUaGUgcG9zaXRpb24gdG8gaW5zZXJ0IHRoZSBzdWItbGlzdFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGVsdHMgVGhlIHN1Yi1saXN0IHRvIGluc2VydCBpbnRvIHRoZSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaW5zZXJ0IHRoZSBzdWItbGlzdCBpbnRvXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IEFycmF5IHdpdGggYGVsdHNgIGluc2VydGVkIHN0YXJ0aW5nIGF0IGBpbmRleGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pbnNlcnRBbGwoMiwgWyd4JywneScsJ3onXSwgWzEsMiwzLDRdKTsgLy89PiBbMSwyLCd4JywneScsJ3onLDMsNF1cbiAgICAgKi9cbiAgICB2YXIgaW5zZXJ0QWxsID0gX2N1cnJ5MyhmdW5jdGlvbiBpbnNlcnRBbGwoaWR4LCBlbHRzLCBsaXN0KSB7XG4gICAgICAgIGlkeCA9IGlkeCA8IGxpc3QubGVuZ3RoICYmIGlkeCA+PSAwID8gaWR4IDogbGlzdC5sZW5ndGg7XG4gICAgICAgIHJldHVybiBfY29uY2F0KF9jb25jYXQoX3NsaWNlKGxpc3QsIDAsIGlkeCksIGVsdHMpLCBfc2xpY2UobGlzdCwgaWR4KSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBTZWUgaWYgYW4gb2JqZWN0IChgdmFsYCkgaXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHN1cHBsaWVkIGNvbnN0cnVjdG9yLlxuICAgICAqIFRoaXMgZnVuY3Rpb24gd2lsbCBjaGVjayB1cCB0aGUgaW5oZXJpdGFuY2UgY2hhaW4sIGlmIGFueS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgVHlwZVxuICAgICAqIEBzaWcgKCogLT4geyp9KSAtPiBhIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY3RvciBBIGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHsqfSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuaXMoT2JqZWN0LCB7fSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pcyhOdW1iZXIsIDEpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaXMoT2JqZWN0LCAxKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pcyhTdHJpbmcsICdzJyk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pcyhTdHJpbmcsIG5ldyBTdHJpbmcoJycpKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzKE9iamVjdCwgbmV3IFN0cmluZygnJykpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaXMoT2JqZWN0LCAncycpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlzKE51bWJlciwge30pOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGlzID0gX2N1cnJ5MihmdW5jdGlvbiBpcyhDdG9yLCB2YWwpIHtcbiAgICAgICAgcmV0dXJuIHZhbCAhPSBudWxsICYmIHZhbC5jb25zdHJ1Y3RvciA9PT0gQ3RvciB8fCB2YWwgaW5zdGFuY2VvZiBDdG9yO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGVzdHMgd2hldGhlciBvciBub3QgYW4gb2JqZWN0IGlzIHNpbWlsYXIgdG8gYW4gYXJyYXkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFR5cGVcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKiAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHsqfSB4IFRoZSBvYmplY3QgdG8gdGVzdC5cbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgYHhgIGhhcyBhIG51bWVyaWMgbGVuZ3RoIHByb3BlcnR5IGFuZCBleHRyZW1lIGluZGljZXMgZGVmaW5lZDsgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pc0FycmF5TGlrZShbXSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pc0FycmF5TGlrZSh0cnVlKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pc0FycmF5TGlrZSh7fSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuaXNBcnJheUxpa2Uoe2xlbmd0aDogMTB9KTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pc0FycmF5TGlrZSh7MDogJ3plcm8nLCA5OiAnbmluZScsIGxlbmd0aDogMTB9KTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGlzQXJyYXlMaWtlID0gX2N1cnJ5MShmdW5jdGlvbiBpc0FycmF5TGlrZSh4KSB7XG4gICAgICAgIGlmIChfaXNBcnJheSh4KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF4KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB4ICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh4IGluc3RhbmNlb2YgU3RyaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHgubm9kZVR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybiAhIXgubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIGlmICh4Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHgubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHguaGFzT3duUHJvcGVydHkoMCkgJiYgeC5oYXNPd25Qcm9wZXJ0eSh4Lmxlbmd0aCAtIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJlcG9ydHMgd2hldGhlciB0aGUgbGlzdCBoYXMgemVybyBlbGVtZW50cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnIFthXSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdFxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pc0VtcHR5KFsxLCAyLCAzXSk7ICAgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5pc0VtcHR5KFtdKTsgICAgICAgICAgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzRW1wdHkoJycpOyAgICAgICAgICAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaXNFbXB0eShudWxsKTsgICAgICAgIC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuaXNFbXB0eShSLmtleXMoe30pKTsgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pc0VtcHR5KHt9KTsgICAgICAgICAgLy89PiBmYWxzZSAoe30gZG9lcyBub3QgaGF2ZSBhIGxlbmd0aCBwcm9wZXJ0eSlcbiAgICAgKiAgICAgIFIuaXNFbXB0eSh7bGVuZ3RoOiAwfSk7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBpc0VtcHR5ID0gX2N1cnJ5MShmdW5jdGlvbiBpc0VtcHR5KGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdChsaXN0KS5sZW5ndGggPT09IDA7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgdGhlIGlucHV0IHZhbHVlIGlzIGBudWxsYCBvciBgdW5kZWZpbmVkYC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgVHlwZVxuICAgICAqIEBzaWcgKiAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHsqfSB4IFRoZSB2YWx1ZSB0byB0ZXN0LlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBgeGAgaXMgYHVuZGVmaW5lZGAgb3IgYG51bGxgLCBvdGhlcndpc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmlzTmlsKG51bGwpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuaXNOaWwodW5kZWZpbmVkKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmlzTmlsKDApOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmlzTmlsKFtdKTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBpc05pbCA9IF9jdXJyeTEoZnVuY3Rpb24gaXNOaWwoeCkge1xuICAgICAgICByZXR1cm4geCA9PSBudWxsO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxpc3QgY29udGFpbmluZyB0aGUgbmFtZXMgb2YgYWxsIHRoZSBlbnVtZXJhYmxlIG93blxuICAgICAqIHByb3BlcnRpZXMgb2YgdGhlIHN1cHBsaWVkIG9iamVjdC5cbiAgICAgKiBOb3RlIHRoYXQgdGhlIG9yZGVyIG9mIHRoZSBvdXRwdXQgYXJyYXkgaXMgbm90IGd1YXJhbnRlZWQgdG8gYmVcbiAgICAgKiBjb25zaXN0ZW50IGFjcm9zcyBkaWZmZXJlbnQgSlMgcGxhdGZvcm1zLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHtrOiB2fSAtPiBba11cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gZXh0cmFjdCBwcm9wZXJ0aWVzIGZyb21cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2YgdGhlIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIua2V5cyh7YTogMSwgYjogMiwgYzogM30pOyAvLz0+IFsnYScsICdiJywgJ2MnXVxuICAgICAqL1xuICAgIC8vIGNvdmVyIElFIDwgOSBrZXlzIGlzc3Vlc1xuICAgIHZhciBrZXlzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBjb3ZlciBJRSA8IDkga2V5cyBpc3N1ZXNcbiAgICAgICAgdmFyIGhhc0VudW1CdWcgPSAheyB0b1N0cmluZzogbnVsbCB9LnByb3BlcnR5SXNFbnVtZXJhYmxlKCd0b1N0cmluZycpO1xuICAgICAgICB2YXIgbm9uRW51bWVyYWJsZVByb3BzID0gW1xuICAgICAgICAgICAgJ2NvbnN0cnVjdG9yJyxcbiAgICAgICAgICAgICd2YWx1ZU9mJyxcbiAgICAgICAgICAgICdpc1Byb3RvdHlwZU9mJyxcbiAgICAgICAgICAgICd0b1N0cmluZycsXG4gICAgICAgICAgICAncHJvcGVydHlJc0VudW1lcmFibGUnLFxuICAgICAgICAgICAgJ2hhc093blByb3BlcnR5JyxcbiAgICAgICAgICAgICd0b0xvY2FsZVN0cmluZydcbiAgICAgICAgXTtcbiAgICAgICAgdmFyIGNvbnRhaW5zID0gZnVuY3Rpb24gY29udGFpbnMobGlzdCwgaXRlbSkge1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoaWR4IDwgbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAobGlzdFtpZHhdID09PSBpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBPYmplY3Qua2V5cyA9PT0gJ2Z1bmN0aW9uJyA/IF9jdXJyeTEoZnVuY3Rpb24ga2V5cyhvYmopIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qob2JqKSAhPT0gb2JqID8gW10gOiBPYmplY3Qua2V5cyhvYmopO1xuICAgICAgICB9KSA6IF9jdXJyeTEoZnVuY3Rpb24ga2V5cyhvYmopIHtcbiAgICAgICAgICAgIGlmIChPYmplY3Qob2JqKSAhPT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHByb3AsIGtzID0gW10sIG5JZHg7XG4gICAgICAgICAgICBmb3IgKHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICAgICAgaWYgKF9oYXMocHJvcCwgb2JqKSkge1xuICAgICAgICAgICAgICAgICAgICBrc1trcy5sZW5ndGhdID0gcHJvcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzRW51bUJ1Zykge1xuICAgICAgICAgICAgICAgIG5JZHggPSBub25FbnVtZXJhYmxlUHJvcHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICB3aGlsZSAobklkeCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3AgPSBub25FbnVtZXJhYmxlUHJvcHNbbklkeF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChfaGFzKHByb3AsIG9iaikgJiYgIWNvbnRhaW5zKGtzLCBwcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAga3Nba3MubGVuZ3RoXSA9IHByb3A7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbklkeCAtPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBrcztcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxpc3QgY29udGFpbmluZyB0aGUgbmFtZXMgb2YgYWxsIHRoZVxuICAgICAqIHByb3BlcnRpZXMgb2YgdGhlIHN1cHBsaWVkIG9iamVjdCwgaW5jbHVkaW5nIHByb3RvdHlwZSBwcm9wZXJ0aWVzLlxuICAgICAqIE5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgdGhlIG91dHB1dCBhcnJheSBpcyBub3QgZ3VhcmFudGVlZCB0byBiZVxuICAgICAqIGNvbnNpc3RlbnQgYWNyb3NzIGRpZmZlcmVudCBKUyBwbGF0Zm9ybXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge2s6IHZ9IC0+IFtrXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBleHRyYWN0IHByb3BlcnRpZXMgZnJvbVxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiB0aGUgb2JqZWN0J3Mgb3duIGFuZCBwcm90b3R5cGUgcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgRiA9IGZ1bmN0aW9uKCkgeyB0aGlzLnggPSAnWCc7IH07XG4gICAgICogICAgICBGLnByb3RvdHlwZS55ID0gJ1knO1xuICAgICAqICAgICAgdmFyIGYgPSBuZXcgRigpO1xuICAgICAqICAgICAgUi5rZXlzSW4oZik7IC8vPT4gWyd4JywgJ3knXVxuICAgICAqL1xuICAgIHZhciBrZXlzSW4gPSBfY3VycnkxKGZ1bmN0aW9uIGtleXNJbihvYmopIHtcbiAgICAgICAgdmFyIHByb3AsIGtzID0gW107XG4gICAgICAgIGZvciAocHJvcCBpbiBvYmopIHtcbiAgICAgICAgICAgIGtzW2tzLmxlbmd0aF0gPSBwcm9wO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrcztcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUgYXJyYXkgYnkgcmV0dXJuaW5nIGBsaXN0Lmxlbmd0aGAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIGxlbmd0aCBvZiB0aGUgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5sZW5ndGgoW10pOyAvLz0+IDBcbiAgICAgKiAgICAgIFIubGVuZ3RoKFsxLCAyLCAzXSk7IC8vPT4gM1xuICAgICAqL1xuICAgIHZhciBsZW5ndGggPSBfY3VycnkxKGZ1bmN0aW9uIGxlbmd0aChsaXN0KSB7XG4gICAgICAgIHJldHVybiBsaXN0ICE9IG51bGwgJiYgaXMoTnVtYmVyLCBsaXN0Lmxlbmd0aCkgPyBsaXN0Lmxlbmd0aCA6IE5hTjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpcyBsZXNzIHRoYW4gdGhlIHNlY29uZDtcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBhID0+IGEgLT4gYSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHsqfSBhXG4gICAgICogQHBhcmFtIHsqfSBiXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICAgKiBAc2VlIFIuZ3RcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmx0KDIsIDEpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmx0KDIsIDIpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmx0KDIsIDMpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIubHQoJ2EnLCAneicpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIubHQoJ3onLCAnYScpOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGx0ID0gX2N1cnJ5MihmdW5jdGlvbiBsdChhLCBiKSB7XG4gICAgICAgIHJldHVybiBhIDwgYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBmaXJzdCBhcmd1bWVudCBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIHNlY29uZDtcbiAgICAgKiBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBhID0+IGEgLT4gYSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQHNlZSBSLmd0ZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubHRlKDIsIDEpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmx0ZSgyLCAyKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmx0ZSgyLCAzKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLmx0ZSgnYScsICd6Jyk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5sdGUoJ3onLCAnYScpOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGx0ZSA9IF9jdXJyeTIoZnVuY3Rpb24gbHRlKGEsIGIpIHtcbiAgICAgICAgcmV0dXJuIGEgPD0gYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBtYXBBY2N1bSBmdW5jdGlvbiBiZWhhdmVzIGxpa2UgYSBjb21iaW5hdGlvbiBvZiBtYXAgYW5kIHJlZHVjZTsgaXQgYXBwbGllcyBhXG4gICAgICogZnVuY3Rpb24gdG8gZWFjaCBlbGVtZW50IG9mIGEgbGlzdCwgcGFzc2luZyBhbiBhY2N1bXVsYXRpbmcgcGFyYW1ldGVyIGZyb20gbGVmdCB0b1xuICAgICAqIHJpZ2h0LCBhbmQgcmV0dXJuaW5nIGEgZmluYWwgdmFsdWUgb2YgdGhpcyBhY2N1bXVsYXRvciB0b2dldGhlciB3aXRoIHRoZSBuZXcgbGlzdC5cbiAgICAgKlxuICAgICAqIFRoZSBpdGVyYXRvciBmdW5jdGlvbiByZWNlaXZlcyB0d28gYXJndW1lbnRzLCAqYWNjKiBhbmQgKnZhbHVlKiwgYW5kIHNob3VsZCByZXR1cm5cbiAgICAgKiBhIHR1cGxlICpbYWNjLCB2YWx1ZV0qLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYWNjIC0+IHggLT4gKGFjYywgeSkpIC0+IGFjYyAtPiBbeF0gLT4gKGFjYywgW3ldKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgb24gZXZlcnkgZWxlbWVudCBvZiB0aGUgaW5wdXQgYGxpc3RgLlxuICAgICAqIEBwYXJhbSB7Kn0gYWNjIFRoZSBhY2N1bXVsYXRvciB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgZmluYWwsIGFjY3VtdWxhdGVkIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBkaWdpdHMgPSBbJzEnLCAnMicsICczJywgJzQnXTtcbiAgICAgKiAgICAgIHZhciBhcHBlbmQgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgICogICAgICAgIHJldHVybiBbYSArIGIsIGEgKyBiXTtcbiAgICAgKiAgICAgIH1cbiAgICAgKlxuICAgICAqICAgICAgUi5tYXBBY2N1bShhcHBlbmQsIDAsIGRpZ2l0cyk7IC8vPT4gWycwMTIzNCcsIFsnMDEnLCAnMDEyJywgJzAxMjMnLCAnMDEyMzQnXV1cbiAgICAgKi9cbiAgICB2YXIgbWFwQWNjdW0gPSBfY3VycnkzKGZ1bmN0aW9uIG1hcEFjY3VtKGZuLCBhY2MsIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoLCByZXN1bHQgPSBbXSwgdHVwbGUgPSBbYWNjXTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgdHVwbGUgPSBmbih0dXBsZVswXSwgbGlzdFtpZHhdKTtcbiAgICAgICAgICAgIHJlc3VsdFtpZHhdID0gdHVwbGVbMV07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgdHVwbGVbMF0sXG4gICAgICAgICAgICByZXN1bHRcbiAgICAgICAgXTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBtYXBBY2N1bVJpZ2h0IGZ1bmN0aW9uIGJlaGF2ZXMgbGlrZSBhIGNvbWJpbmF0aW9uIG9mIG1hcCBhbmQgcmVkdWNlOyBpdCBhcHBsaWVzIGFcbiAgICAgKiBmdW5jdGlvbiB0byBlYWNoIGVsZW1lbnQgb2YgYSBsaXN0LCBwYXNzaW5nIGFuIGFjY3VtdWxhdGluZyBwYXJhbWV0ZXIgZnJvbSByaWdodFxuICAgICAqIHRvIGxlZnQsIGFuZCByZXR1cm5pbmcgYSBmaW5hbCB2YWx1ZSBvZiB0aGlzIGFjY3VtdWxhdG9yIHRvZ2V0aGVyIHdpdGggdGhlIG5ldyBsaXN0LlxuICAgICAqXG4gICAgICogU2ltaWxhciB0byBgbWFwQWNjdW1gLCBleGNlcHQgbW92ZXMgdGhyb3VnaCB0aGUgaW5wdXQgbGlzdCBmcm9tIHRoZSByaWdodCB0byB0aGVcbiAgICAgKiBsZWZ0LlxuICAgICAqXG4gICAgICogVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uIHJlY2VpdmVzIHR3byBhcmd1bWVudHMsICphY2MqIGFuZCAqdmFsdWUqLCBhbmQgc2hvdWxkIHJldHVyblxuICAgICAqIGEgdHVwbGUgKlthY2MsIHZhbHVlXSouXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhY2MgLT4geCAtPiAoYWNjLCB5KSkgLT4gYWNjIC0+IFt4XSAtPiAoYWNjLCBbeV0pXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBvbiBldmVyeSBlbGVtZW50IG9mIHRoZSBpbnB1dCBgbGlzdGAuXG4gICAgICogQHBhcmFtIHsqfSBhY2MgVGhlIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBmaW5hbCwgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGRpZ2l0cyA9IFsnMScsICcyJywgJzMnLCAnNCddO1xuICAgICAqICAgICAgdmFyIGFwcGVuZCA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIFthICsgYiwgYSArIGJdO1xuICAgICAqICAgICAgfVxuICAgICAqXG4gICAgICogICAgICBSLm1hcEFjY3VtUmlnaHQoYXBwZW5kLCAwLCBkaWdpdHMpOyAvLz0+IFsnMDQzMjEnLCBbJzA0MzIxJywgJzA0MzInLCAnMDQzJywgJzA0J11dXG4gICAgICovXG4gICAgdmFyIG1hcEFjY3VtUmlnaHQgPSBfY3VycnkzKGZ1bmN0aW9uIG1hcEFjY3VtUmlnaHQoZm4sIGFjYywgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gbGlzdC5sZW5ndGggLSAxLCByZXN1bHQgPSBbXSwgdHVwbGUgPSBbYWNjXTtcbiAgICAgICAgd2hpbGUgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICB0dXBsZSA9IGZuKHR1cGxlWzBdLCBsaXN0W2lkeF0pO1xuICAgICAgICAgICAgcmVzdWx0W2lkeF0gPSB0dXBsZVsxXTtcbiAgICAgICAgICAgIGlkeCAtPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB0dXBsZVswXSxcbiAgICAgICAgICAgIHJlc3VsdFxuICAgICAgICBdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGVzdHMgYSByZWd1bGFyIGV4cHJlc3Npb24gYWdhaW5zdCBhIFN0cmluZy4gTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb25cbiAgICAgKiB3aWxsIHJldHVybiBhbiBlbXB0eSBhcnJheSB3aGVuIHRoZXJlIGFyZSBubyBtYXRjaGVzLiBUaGlzIGRpZmZlcnNcbiAgICAgKiBmcm9tIFtgU3RyaW5nLnByb3RvdHlwZS5tYXRjaGBdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL1N0cmluZy9tYXRjaClcbiAgICAgKiB3aGljaCByZXR1cm5zIGBudWxsYCB3aGVuIHRoZXJlIGFyZSBubyBtYXRjaGVzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBzZWUgUi50ZXN0XG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBzaWcgUmVnRXhwIC0+IFN0cmluZyAtPiBbU3RyaW5nIHwgVW5kZWZpbmVkXVxuICAgICAqIEBwYXJhbSB7UmVnRXhwfSByeCBBIHJlZ3VsYXIgZXhwcmVzc2lvbi5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBzdHJpbmcgdG8gbWF0Y2ggYWdhaW5zdFxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBvZiBtYXRjaGVzIG9yIGVtcHR5IGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubWF0Y2goLyhbYS16XWEpL2csICdiYW5hbmFzJyk7IC8vPT4gWydiYScsICduYScsICduYSddXG4gICAgICogICAgICBSLm1hdGNoKC9hLywgJ2InKTsgLy89PiBbXVxuICAgICAqICAgICAgUi5tYXRjaCgvYS8sIG51bGwpOyAvLz0+IFR5cGVFcnJvcjogbnVsbCBkb2VzIG5vdCBoYXZlIGEgbWV0aG9kIG5hbWVkIFwibWF0Y2hcIlxuICAgICAqL1xuICAgIHZhciBtYXRjaCA9IF9jdXJyeTIoZnVuY3Rpb24gbWF0Y2gocngsIHN0cikge1xuICAgICAgICByZXR1cm4gc3RyLm1hdGNoKHJ4KSB8fCBbXTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIG1hdGhNb2QgYmVoYXZlcyBsaWtlIHRoZSBtb2R1bG8gb3BlcmF0b3Igc2hvdWxkIG1hdGhlbWF0aWNhbGx5LCB1bmxpa2UgdGhlIGAlYFxuICAgICAqIG9wZXJhdG9yIChhbmQgYnkgZXh0ZW5zaW9uLCBSLm1vZHVsbykuIFNvIHdoaWxlIFwiLTE3ICUgNVwiIGlzIC0yLFxuICAgICAqIG1hdGhNb2QoLTE3LCA1KSBpcyAzLiBtYXRoTW9kIHJlcXVpcmVzIEludGVnZXIgYXJndW1lbnRzLCBhbmQgcmV0dXJucyBOYU5cbiAgICAgKiB3aGVuIHRoZSBtb2R1bHVzIGlzIHplcm8gb3IgbmVnYXRpdmUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXIgLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG0gVGhlIGRpdmlkZW5kLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBwIHRoZSBtb2R1bHVzLlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIHJlc3VsdCBvZiBgYiBtb2QgYWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tYXRoTW9kKC0xNywgNSk7ICAvLz0+IDNcbiAgICAgKiAgICAgIFIubWF0aE1vZCgxNywgNSk7ICAgLy89PiAyXG4gICAgICogICAgICBSLm1hdGhNb2QoMTcsIC01KTsgIC8vPT4gTmFOXG4gICAgICogICAgICBSLm1hdGhNb2QoMTcsIDApOyAgIC8vPT4gTmFOXG4gICAgICogICAgICBSLm1hdGhNb2QoMTcuMiwgNSk7IC8vPT4gTmFOXG4gICAgICogICAgICBSLm1hdGhNb2QoMTcsIDUuMyk7IC8vPT4gTmFOXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBjbG9jayA9IFIubWF0aE1vZChSLl9fLCAxMik7XG4gICAgICogICAgICBjbG9jaygxNSk7IC8vPT4gM1xuICAgICAqICAgICAgY2xvY2soMjQpOyAvLz0+IDBcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHNldmVudGVlbk1vZCA9IFIubWF0aE1vZCgxNyk7XG4gICAgICogICAgICBzZXZlbnRlZW5Nb2QoMyk7ICAvLz0+IDJcbiAgICAgKiAgICAgIHNldmVudGVlbk1vZCg0KTsgIC8vPT4gMVxuICAgICAqICAgICAgc2V2ZW50ZWVuTW9kKDEwKTsgLy89PiA3XG4gICAgICovXG4gICAgdmFyIG1hdGhNb2QgPSBfY3VycnkyKGZ1bmN0aW9uIG1hdGhNb2QobSwgcCkge1xuICAgICAgICBpZiAoIV9pc0ludGVnZXIobSkpIHtcbiAgICAgICAgICAgIHJldHVybiBOYU47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFfaXNJbnRlZ2VyKHApIHx8IHAgPCAxKSB7XG4gICAgICAgICAgICByZXR1cm4gTmFOO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAobSAlIHAgKyBwKSAlIHA7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBsYXJnZXIgb2YgaXRzIHR3byBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBPcmQgYSA9PiBhIC0+IGEgLT4gYVxuICAgICAqIEBwYXJhbSB7Kn0gYVxuICAgICAqIEBwYXJhbSB7Kn0gYlxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLm1heEJ5LCBSLm1pblxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubWF4KDc4OSwgMTIzKTsgLy89PiA3ODlcbiAgICAgKiAgICAgIFIubWF4KCdhJywgJ2InKTsgLy89PiAnYidcbiAgICAgKi9cbiAgICB2YXIgbWF4ID0gX2N1cnJ5MihmdW5jdGlvbiBtYXgoYSwgYikge1xuICAgICAgICByZXR1cm4gYiA+IGEgPyBiIDogYTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRha2VzIGEgZnVuY3Rpb24gYW5kIHR3byB2YWx1ZXMsIGFuZCByZXR1cm5zIHdoaWNoZXZlciB2YWx1ZSBwcm9kdWNlc1xuICAgICAqIHRoZSBsYXJnZXIgcmVzdWx0IHdoZW4gcGFzc2VkIHRvIHRoZSBwcm92aWRlZCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBiID0+IChhIC0+IGIpIC0+IGEgLT4gYSAtPiBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZlxuICAgICAqIEBwYXJhbSB7Kn0gYVxuICAgICAqIEBwYXJhbSB7Kn0gYlxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLm1heCwgUi5taW5CeVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubWF4QnkoZnVuY3Rpb24obikgeyByZXR1cm4gbiAqIG47IH0sIC0zLCAyKTsgLy89PiAtM1xuICAgICAqL1xuICAgIHZhciBtYXhCeSA9IF9jdXJyeTMoZnVuY3Rpb24gbWF4QnkoZiwgYSwgYikge1xuICAgICAgICByZXR1cm4gZihiKSA+IGYoYSkgPyBiIDogYTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBvYmplY3Qgd2l0aCB0aGUgb3duIHByb3BlcnRpZXMgb2YgYGFgXG4gICAgICogbWVyZ2VkIHdpdGggdGhlIG93biBwcm9wZXJ0aWVzIG9mIG9iamVjdCBgYmAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge2s6IHZ9IC0+IHtrOiB2fSAtPiB7azogdn1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBiXG4gICAgICogQHJldHVybiB7T2JqZWN0fVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubWVyZ2UoeyAnbmFtZSc6ICdmcmVkJywgJ2FnZSc6IDEwIH0sIHsgJ2FnZSc6IDQwIH0pO1xuICAgICAqICAgICAgLy89PiB7ICduYW1lJzogJ2ZyZWQnLCAnYWdlJzogNDAgfVxuICAgICAqXG4gICAgICogICAgICB2YXIgcmVzZXRUb0RlZmF1bHQgPSBSLm1lcmdlKFIuX18sIHt4OiAwfSk7XG4gICAgICogICAgICByZXNldFRvRGVmYXVsdCh7eDogNSwgeTogMn0pOyAvLz0+IHt4OiAwLCB5OiAyfVxuICAgICAqL1xuICAgIHZhciBtZXJnZSA9IF9jdXJyeTIoZnVuY3Rpb24gbWVyZ2UoYSwgYikge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHZhciBrcyA9IGtleXMoYSk7XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwga3MubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXN1bHRba3NbaWR4XV0gPSBhW2tzW2lkeF1dO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAga3MgPSBrZXlzKGIpO1xuICAgICAgICBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwga3MubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXN1bHRba3NbaWR4XV0gPSBiW2tzW2lkeF1dO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHNtYWxsZXIgb2YgaXRzIHR3byBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBPcmQgYSA9PiBhIC0+IGEgLT4gYVxuICAgICAqIEBwYXJhbSB7Kn0gYVxuICAgICAqIEBwYXJhbSB7Kn0gYlxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLm1pbkJ5LCBSLm1heFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubWluKDc4OSwgMTIzKTsgLy89PiAxMjNcbiAgICAgKiAgICAgIFIubWluKCdhJywgJ2InKTsgLy89PiAnYSdcbiAgICAgKi9cbiAgICB2YXIgbWluID0gX2N1cnJ5MihmdW5jdGlvbiBtaW4oYSwgYikge1xuICAgICAgICByZXR1cm4gYiA8IGEgPyBiIDogYTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRha2VzIGEgZnVuY3Rpb24gYW5kIHR3byB2YWx1ZXMsIGFuZCByZXR1cm5zIHdoaWNoZXZlciB2YWx1ZSBwcm9kdWNlc1xuICAgICAqIHRoZSBzbWFsbGVyIHJlc3VsdCB3aGVuIHBhc3NlZCB0byB0aGUgcHJvdmlkZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBPcmQgYiA9PiAoYSAtPiBiKSAtPiBhIC0+IGEgLT4gYVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZcbiAgICAgKiBAcGFyYW0geyp9IGFcbiAgICAgKiBAcGFyYW0geyp9IGJcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBzZWUgUi5taW4sIFIubWF4QnlcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm1pbkJ5KGZ1bmN0aW9uKG4pIHsgcmV0dXJuIG4gKiBuOyB9LCAtMywgMik7IC8vPT4gMlxuICAgICAqL1xuICAgIHZhciBtaW5CeSA9IF9jdXJyeTMoZnVuY3Rpb24gbWluQnkoZiwgYSwgYikge1xuICAgICAgICByZXR1cm4gZihiKSA8IGYoYSkgPyBiIDogYTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIERpdmlkZXMgdGhlIHNlY29uZCBwYXJhbWV0ZXIgYnkgdGhlIGZpcnN0IGFuZCByZXR1cm5zIHRoZSByZW1haW5kZXIuXG4gICAgICogTm90ZSB0aGF0IHRoaXMgZnVuY3Rpb25zIHByZXNlcnZlcyB0aGUgSmF2YVNjcmlwdC1zdHlsZSBiZWhhdmlvciBmb3JcbiAgICAgKiBtb2R1bG8uIEZvciBtYXRoZW1hdGljYWwgbW9kdWxvIHNlZSBgbWF0aE1vZGBcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYSBUaGUgdmFsdWUgdG8gdGhlIGRpdmlkZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYiBUaGUgcHNldWRvLW1vZHVsdXNcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSByZXN1bHQgb2YgYGIgJSBhYC5cbiAgICAgKiBAc2VlIFIubWF0aE1vZFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubW9kdWxvKDE3LCAzKTsgLy89PiAyXG4gICAgICogICAgICAvLyBKUyBiZWhhdmlvcjpcbiAgICAgKiAgICAgIFIubW9kdWxvKC0xNywgMyk7IC8vPT4gLTJcbiAgICAgKiAgICAgIFIubW9kdWxvKDE3LCAtMyk7IC8vPT4gMlxuICAgICAqXG4gICAgICogICAgICB2YXIgaXNPZGQgPSBSLm1vZHVsbyhSLl9fLCAyKTtcbiAgICAgKiAgICAgIGlzT2RkKDQyKTsgLy89PiAwXG4gICAgICogICAgICBpc09kZCgyMSk7IC8vPT4gMVxuICAgICAqL1xuICAgIHZhciBtb2R1bG8gPSBfY3VycnkyKGZ1bmN0aW9uIG1vZHVsbyhhLCBiKSB7XG4gICAgICAgIHJldHVybiBhICUgYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIE11bHRpcGxpZXMgdHdvIG51bWJlcnMuIEVxdWl2YWxlbnQgdG8gYGEgKiBiYCBidXQgY3VycmllZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYSBUaGUgZmlyc3QgdmFsdWUuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGIgVGhlIHNlY29uZCB2YWx1ZS5cbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSByZXN1bHQgb2YgYGEgKiBiYC5cbiAgICAgKiBAc2VlIFIuZGl2aWRlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGRvdWJsZSA9IFIubXVsdGlwbHkoMik7XG4gICAgICogICAgICB2YXIgdHJpcGxlID0gUi5tdWx0aXBseSgzKTtcbiAgICAgKiAgICAgIGRvdWJsZSgzKTsgICAgICAgLy89PiAgNlxuICAgICAqICAgICAgdHJpcGxlKDQpOyAgICAgICAvLz0+IDEyXG4gICAgICogICAgICBSLm11bHRpcGx5KDIsIDUpOyAgLy89PiAxMFxuICAgICAqL1xuICAgIHZhciBtdWx0aXBseSA9IF9jdXJyeTIoZnVuY3Rpb24gbXVsdGlwbHkoYSwgYikge1xuICAgICAgICByZXR1cm4gYSAqIGI7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcyBhIGZ1bmN0aW9uIG9mIGFueSBhcml0eSAoaW5jbHVkaW5nIG51bGxhcnkpIGluIGEgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIGV4YWN0bHkgYG5gXG4gICAgICogcGFyYW1ldGVycy4gQW55IGV4dHJhbmVvdXMgcGFyYW1ldGVycyB3aWxsIG5vdCBiZSBwYXNzZWQgdG8gdGhlIHN1cHBsaWVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgTnVtYmVyIC0+ICgqIC0+IGEpIC0+ICgqIC0+IGEpXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG4gVGhlIGRlc2lyZWQgYXJpdHkgb2YgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcgZnVuY3Rpb24gd3JhcHBpbmcgYGZuYC4gVGhlIG5ldyBmdW5jdGlvbiBpcyBndWFyYW50ZWVkIHRvIGJlIG9mXG4gICAgICogICAgICAgICBhcml0eSBgbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRha2VzVHdvQXJncyA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIFthLCBiXTtcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICB0YWtlc1R3b0FyZ3MubGVuZ3RoOyAvLz0+IDJcbiAgICAgKiAgICAgIHRha2VzVHdvQXJncygxLCAyKTsgLy89PiBbMSwgMl1cbiAgICAgKlxuICAgICAqICAgICAgdmFyIHRha2VzT25lQXJnID0gUi5uQXJ5KDEsIHRha2VzVHdvQXJncyk7XG4gICAgICogICAgICB0YWtlc09uZUFyZy5sZW5ndGg7IC8vPT4gMVxuICAgICAqICAgICAgLy8gT25seSBgbmAgYXJndW1lbnRzIGFyZSBwYXNzZWQgdG8gdGhlIHdyYXBwZWQgZnVuY3Rpb25cbiAgICAgKiAgICAgIHRha2VzT25lQXJnKDEsIDIpOyAvLz0+IFsxLCB1bmRlZmluZWRdXG4gICAgICovXG4gICAgdmFyIG5BcnkgPSBfY3VycnkyKGZ1bmN0aW9uIG5BcnkobiwgZm4pIHtcbiAgICAgICAgc3dpdGNoIChuKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgYTApO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgYTAsIGExLCBhMik7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgYTAsIGExLCBhMiwgYTMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEsIGEyLCBhMywgYTQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgYTAsIGExLCBhMiwgYTMsIGE0LCBhNSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcsIGE4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYsIGE3LCBhOCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhMCwgYTEsIGEyLCBhMywgYTQsIGE1LCBhNiwgYTcsIGE4LCBhOSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2LCBhNywgYTgsIGE5KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IHRvIG5BcnkgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBpbnRlZ2VyIG5vIGdyZWF0ZXIgdGhhbiB0ZW4nKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogTmVnYXRlcyBpdHMgYXJndW1lbnQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEByZXR1cm4ge051bWJlcn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm5lZ2F0ZSg0Mik7IC8vPT4gLTQyXG4gICAgICovXG4gICAgdmFyIG5lZ2F0ZSA9IF9jdXJyeTEoZnVuY3Rpb24gbmVnYXRlKG4pIHtcbiAgICAgICAgcmV0dXJuIC1uO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGAhYCBvZiBpdHMgYXJndW1lbnQuIEl0IHdpbGwgcmV0dXJuIGB0cnVlYCB3aGVuXG4gICAgICogcGFzc2VkIGZhbHNlLXkgdmFsdWUsIGFuZCBgZmFsc2VgIHdoZW4gcGFzc2VkIGEgdHJ1dGgteSBvbmUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExvZ2ljXG4gICAgICogQHNpZyAqIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0geyp9IGEgYW55IHZhbHVlXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gdGhlIGxvZ2ljYWwgaW52ZXJzZSBvZiBwYXNzZWQgYXJndW1lbnQuXG4gICAgICogQHNlZSBSLmNvbXBsZW1lbnRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm5vdCh0cnVlKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5ub3QoZmFsc2UpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIubm90KDApOyA9PiB0cnVlXG4gICAgICogICAgICBSLm5vdCgxKTsgPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgbm90ID0gX2N1cnJ5MShmdW5jdGlvbiBub3QoYSkge1xuICAgICAgICByZXR1cm4gIWE7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBudGggZWxlbWVudCBvZiB0aGUgZ2l2ZW4gbGlzdCBvciBzdHJpbmcuXG4gICAgICogSWYgbiBpcyBuZWdhdGl2ZSB0aGUgZWxlbWVudCBhdCBpbmRleCBsZW5ndGggKyBuIGlzIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBOdW1iZXIgLT4gW2FdIC0+IGEgfCBVbmRlZmluZWRcbiAgICAgKiBAc2lnIE51bWJlciAtPiBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldFxuICAgICAqIEBwYXJhbSB7Kn0gbGlzdFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGxpc3QgPSBbJ2ZvbycsICdiYXInLCAnYmF6JywgJ3F1dXgnXTtcbiAgICAgKiAgICAgIFIubnRoKDEsIGxpc3QpOyAvLz0+ICdiYXInXG4gICAgICogICAgICBSLm50aCgtMSwgbGlzdCk7IC8vPT4gJ3F1dXgnXG4gICAgICogICAgICBSLm50aCgtOTksIGxpc3QpOyAvLz0+IHVuZGVmaW5lZFxuICAgICAqXG4gICAgICogICAgICBSLm50aCgnYWJjJywgMik7IC8vPT4gJ2MnXG4gICAgICogICAgICBSLm50aCgnYWJjJywgMyk7IC8vPT4gJydcbiAgICAgKi9cbiAgICB2YXIgbnRoID0gX2N1cnJ5MihmdW5jdGlvbiBudGgob2Zmc2V0LCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSBvZmZzZXQgPCAwID8gbGlzdC5sZW5ndGggKyBvZmZzZXQgOiBvZmZzZXQ7XG4gICAgICAgIHJldHVybiBfaXNTdHJpbmcobGlzdCkgPyBsaXN0LmNoYXJBdChpZHgpIDogbGlzdFtpZHhdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgaXRzIG50aCBhcmd1bWVudC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIE51bWJlciAtPiAqLi4uIC0+ICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubnRoQXJnKDEpKCdhJywgJ2InLCAnYycpOyAvLz0+ICdiJ1xuICAgICAqICAgICAgUi5udGhBcmcoLTEpKCdhJywgJ2InLCAnYycpOyAvLz0+ICdjJ1xuICAgICAqL1xuICAgIHZhciBudGhBcmcgPSBfY3VycnkxKGZ1bmN0aW9uIG50aEFyZyhuKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbnRoKG4sIGFyZ3VtZW50cyk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBudGggY2hhcmFjdGVyIG9mIHRoZSBnaXZlbiBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBzaWcgTnVtYmVyIC0+IFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9XG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgdjAuMTYuMFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubnRoQ2hhcigyLCAnUmFtZGEnKTsgLy89PiAnbSdcbiAgICAgKiAgICAgIFIubnRoQ2hhcigtMiwgJ1JhbWRhJyk7IC8vPT4gJ2QnXG4gICAgICovXG4gICAgdmFyIG50aENoYXIgPSBfY3VycnkyKGZ1bmN0aW9uIG50aENoYXIobiwgc3RyKSB7XG4gICAgICAgIHJldHVybiBzdHIuY2hhckF0KG4gPCAwID8gc3RyLmxlbmd0aCArIG4gOiBuKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGNoYXJhY3RlciBjb2RlIG9mIHRoZSBudGggY2hhcmFjdGVyIG9mIHRoZSBnaXZlbiBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBzaWcgTnVtYmVyIC0+IFN0cmluZyAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICogQGRlcHJlY2F0ZWQgc2luY2UgdjAuMTYuMFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubnRoQ2hhckNvZGUoMiwgJ1JhbWRhJyk7IC8vPT4gJ20nLmNoYXJDb2RlQXQoMClcbiAgICAgKiAgICAgIFIubnRoQ2hhckNvZGUoLTIsICdSYW1kYScpOyAvLz0+ICdkJy5jaGFyQ29kZUF0KDApXG4gICAgICovXG4gICAgdmFyIG50aENoYXJDb2RlID0gX2N1cnJ5MihmdW5jdGlvbiBudGhDaGFyQ29kZShuLCBzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KG4gPCAwID8gc3RyLmxlbmd0aCArIG4gOiBuKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzaW5nbGV0b24gYXJyYXkgY29udGFpbmluZyB0aGUgdmFsdWUgcHJvdmlkZWQuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoaXMgYG9mYCBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgRVM2IGBvZmA7IFNlZVxuICAgICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L29mXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyBhIC0+IFthXVxuICAgICAqIEBwYXJhbSB7Kn0geCBhbnkgdmFsdWVcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgd3JhcHBpbmcgYHhgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIub2YobnVsbCk7IC8vPT4gW251bGxdXG4gICAgICogICAgICBSLm9mKFs0Ml0pOyAvLz0+IFtbNDJdXVxuICAgICAqL1xuICAgIHZhciBvZiA9IF9jdXJyeTEoZnVuY3Rpb24gb2YoeCkge1xuICAgICAgICByZXR1cm4gW3hdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQWNjZXB0cyBhIGZ1bmN0aW9uIGBmbmAgYW5kIHJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGd1YXJkcyBpbnZvY2F0aW9uIG9mIGBmbmAgc3VjaCB0aGF0XG4gICAgICogYGZuYCBjYW4gb25seSBldmVyIGJlIGNhbGxlZCBvbmNlLCBubyBtYXR0ZXIgaG93IG1hbnkgdGltZXMgdGhlIHJldHVybmVkIGZ1bmN0aW9uIGlzXG4gICAgICogaW52b2tlZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIChhLi4uIC0+IGIpIC0+IChhLi4uIC0+IGIpXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIHdyYXAgaW4gYSBjYWxsLW9ubHktb25jZSB3cmFwcGVyLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBUaGUgd3JhcHBlZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYWRkT25lT25jZSA9IFIub25jZShmdW5jdGlvbih4KXsgcmV0dXJuIHggKyAxOyB9KTtcbiAgICAgKiAgICAgIGFkZE9uZU9uY2UoMTApOyAvLz0+IDExXG4gICAgICogICAgICBhZGRPbmVPbmNlKGFkZE9uZU9uY2UoNTApKTsgLy89PiAxMVxuICAgICAqL1xuICAgIHZhciBvbmNlID0gX2N1cnJ5MShmdW5jdGlvbiBvbmNlKGZuKSB7XG4gICAgICAgIHZhciBjYWxsZWQgPSBmYWxzZSwgcmVzdWx0O1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGNhbGxlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYWxsZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmVzdWx0ID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXN1bHQgb2YgXCJzZXR0aW5nXCIgdGhlIHBvcnRpb24gb2YgdGhlIGdpdmVuIGRhdGEgc3RydWN0dXJlXG4gICAgICogZm9jdXNlZCBieSB0aGUgZ2l2ZW4gbGVucyB0byB0aGUgZ2l2ZW4gdmFsdWUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEB0eXBlZGVmIExlbnMgcyBhID0gRnVuY3RvciBmID0+IChhIC0+IGYgYSkgLT4gcyAtPiBmIHNcbiAgICAgKiBAc2lnIExlbnMgcyBhIC0+IChhIC0+IGEpIC0+IHMgLT4gc1xuICAgICAqIEBwYXJhbSB7TGVuc30gbGVuc1xuICAgICAqIEBwYXJhbSB7Kn0gdlxuICAgICAqIEBwYXJhbSB7Kn0geFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLnByb3AsIFIubGVuc0luZGV4LCBSLmxlbnNQcm9wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGhlYWRMZW5zID0gUi5sZW5zSW5kZXgoMCk7XG4gICAgICpcbiAgICAgKiAgICAgIFIub3ZlcihoZWFkTGVucywgUi50b1VwcGVyLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnRk9PJywgJ2JhcicsICdiYXonXVxuICAgICAqL1xuICAgIHZhciBvdmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgSWRlbnRpdHkgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogeCxcbiAgICAgICAgICAgICAgICBtYXA6IGZ1bmN0aW9uIChmKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBJZGVudGl0eShmKHgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MyhmdW5jdGlvbiBvdmVyKGxlbnMsIGYsIHgpIHtcbiAgICAgICAgICAgIHJldHVybiBsZW5zKGZ1bmN0aW9uICh5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIElkZW50aXR5KGYoeSkpO1xuICAgICAgICAgICAgfSkoeCkudmFsdWU7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlIHRoZSB2YWx1ZSBhdCBhIGdpdmVuIHBhdGguXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgW1N0cmluZ10gLT4ge2s6IHZ9IC0+IHYgfCBVbmRlZmluZWRcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYXRoIFRoZSBwYXRoIHRvIHVzZS5cbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgZGF0YSBhdCBgcGF0aGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5wYXRoKFsnYScsICdiJ10sIHthOiB7YjogMn19KTsgLy89PiAyXG4gICAgICogICAgICBSLnBhdGgoWydhJywgJ2InXSwge2M6IHtiOiAyfX0pOyAvLz0+IHVuZGVmaW5lZFxuICAgICAqL1xuICAgIHZhciBwYXRoID0gX2N1cnJ5MihmdW5jdGlvbiBwYXRoKHBhdGhzLCBvYmopIHtcbiAgICAgICAgaWYgKG9iaiA9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gb2JqO1xuICAgICAgICAgICAgZm9yICh2YXIgaWR4ID0gMCwgbGVuID0gcGF0aHMubGVuZ3RoOyBpZHggPCBsZW4gJiYgdmFsICE9IG51bGw7IGlkeCArPSAxKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gdmFsW3BhdGhzW2lkeF1dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbDtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHBhcnRpYWwgY29weSBvZiBhbiBvYmplY3QgY29udGFpbmluZyBvbmx5IHRoZSBrZXlzIHNwZWNpZmllZC4gIElmIHRoZSBrZXkgZG9lcyBub3QgZXhpc3QsIHRoZVxuICAgICAqIHByb3BlcnR5IGlzIGlnbm9yZWQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgW2tdIC0+IHtrOiB2fSAtPiB7azogdn1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBuYW1lcyBhbiBhcnJheSBvZiBTdHJpbmcgcHJvcGVydHkgbmFtZXMgdG8gY29weSBvbnRvIGEgbmV3IG9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBjb3B5IGZyb21cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEEgbmV3IG9iamVjdCB3aXRoIG9ubHkgcHJvcGVydGllcyBmcm9tIGBuYW1lc2Agb24gaXQuXG4gICAgICogQHNlZSBSLm9taXRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnBpY2soWydhJywgJ2QnXSwge2E6IDEsIGI6IDIsIGM6IDMsIGQ6IDR9KTsgLy89PiB7YTogMSwgZDogNH1cbiAgICAgKiAgICAgIFIucGljayhbJ2EnLCAnZScsICdmJ10sIHthOiAxLCBiOiAyLCBjOiAzLCBkOiA0fSk7IC8vPT4ge2E6IDF9XG4gICAgICovXG4gICAgdmFyIHBpY2sgPSBfY3VycnkyKGZ1bmN0aW9uIHBpY2sobmFtZXMsIG9iaikge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbmFtZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAobmFtZXNbaWR4XSBpbiBvYmopIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbbmFtZXNbaWR4XV0gPSBvYmpbbmFtZXNbaWR4XV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogU2ltaWxhciB0byBgcGlja2AgZXhjZXB0IHRoYXQgdGhpcyBvbmUgaW5jbHVkZXMgYSBga2V5OiB1bmRlZmluZWRgIHBhaXIgZm9yIHByb3BlcnRpZXMgdGhhdCBkb24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyBba10gLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IG5hbWVzIGFuIGFycmF5IG9mIFN0cmluZyBwcm9wZXJ0eSBuYW1lcyB0byBjb3B5IG9udG8gYSBuZXcgb2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGNvcHkgZnJvbVxuICAgICAqIEByZXR1cm4ge09iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggb25seSBwcm9wZXJ0aWVzIGZyb20gYG5hbWVzYCBvbiBpdC5cbiAgICAgKiBAc2VlIFIucGlja1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucGlja0FsbChbJ2EnLCAnZCddLCB7YTogMSwgYjogMiwgYzogMywgZDogNH0pOyAvLz0+IHthOiAxLCBkOiA0fVxuICAgICAqICAgICAgUi5waWNrQWxsKFsnYScsICdlJywgJ2YnXSwge2E6IDEsIGI6IDIsIGM6IDMsIGQ6IDR9KTsgLy89PiB7YTogMSwgZTogdW5kZWZpbmVkLCBmOiB1bmRlZmluZWR9XG4gICAgICovXG4gICAgdmFyIHBpY2tBbGwgPSBfY3VycnkyKGZ1bmN0aW9uIHBpY2tBbGwobmFtZXMsIG9iaikge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB2YXIgbGVuID0gbmFtZXMubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IG5hbWVzW2lkeF07XG4gICAgICAgICAgICByZXN1bHRbbmFtZV0gPSBvYmpbbmFtZV07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHBhcnRpYWwgY29weSBvZiBhbiBvYmplY3QgY29udGFpbmluZyBvbmx5IHRoZSBrZXlzIHRoYXRcbiAgICAgKiBzYXRpc2Z5IHRoZSBzdXBwbGllZCBwcmVkaWNhdGUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgKHYsIGsgLT4gQm9vbGVhbikgLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgQSBwcmVkaWNhdGUgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgb3Igbm90IGEga2V5XG4gICAgICogICAgICAgIHNob3VsZCBiZSBpbmNsdWRlZCBvbiB0aGUgb3V0cHV0IG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gY29weSBmcm9tXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBBIG5ldyBvYmplY3Qgd2l0aCBvbmx5IHByb3BlcnRpZXMgdGhhdCBzYXRpc2Z5IGBwcmVkYFxuICAgICAqICAgICAgICAgb24gaXQuXG4gICAgICogQHNlZSBSLnBpY2tcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaXNVcHBlckNhc2UgPSBmdW5jdGlvbih2YWwsIGtleSkgeyByZXR1cm4ga2V5LnRvVXBwZXJDYXNlKCkgPT09IGtleTsgfVxuICAgICAqICAgICAgUi5waWNrQnkoaXNVcHBlckNhc2UsIHthOiAxLCBiOiAyLCBBOiAzLCBCOiA0fSk7IC8vPT4ge0E6IDMsIEI6IDR9XG4gICAgICovXG4gICAgdmFyIHBpY2tCeSA9IF9jdXJyeTIoZnVuY3Rpb24gcGlja0J5KHRlc3QsIG9iaikge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICBpZiAodGVzdChvYmpbcHJvcF0sIHByb3AsIG9iaikpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbcHJvcF0gPSBvYmpbcHJvcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCB3aXRoIHRoZSBnaXZlbiBlbGVtZW50IGF0IHRoZSBmcm9udCwgZm9sbG93ZWQgYnkgdGhlIGNvbnRlbnRzIG9mIHRoZVxuICAgICAqIGxpc3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGEgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7Kn0gZWwgVGhlIGl0ZW0gdG8gYWRkIHRvIHRoZSBoZWFkIG9mIHRoZSBvdXRwdXQgbGlzdC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBhZGQgdG8gdGhlIHRhaWwgb2YgdGhlIG91dHB1dCBsaXN0LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5ldyBhcnJheS5cbiAgICAgKiBAc2VlIFIuYXBwZW5kXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5wcmVwZW5kKCdmZWUnLCBbJ2ZpJywgJ2ZvJywgJ2Z1bSddKTsgLy89PiBbJ2ZlZScsICdmaScsICdmbycsICdmdW0nXVxuICAgICAqL1xuICAgIHZhciBwcmVwZW5kID0gX2N1cnJ5MihmdW5jdGlvbiBwcmVwZW5kKGVsLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBfY29uY2F0KFtlbF0sIGxpc3QpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2hlbiBzdXBwbGllZCBhbiBvYmplY3QgcmV0dXJucyB0aGUgaW5kaWNhdGVkIHByb3BlcnR5IG9mIHRoYXQgb2JqZWN0LCBpZiBpdCBleGlzdHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgcyAtPiB7czogYX0gLT4gYSB8IFVuZGVmaW5lZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwIFRoZSBwcm9wZXJ0eSBuYW1lXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIHF1ZXJ5XG4gICAgICogQHJldHVybiB7Kn0gVGhlIHZhbHVlIGF0IGBvYmoucGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5wcm9wKCd4Jywge3g6IDEwMH0pOyAvLz0+IDEwMFxuICAgICAqICAgICAgUi5wcm9wKCd4Jywge30pOyAvLz0+IHVuZGVmaW5lZFxuICAgICAqL1xuICAgIHZhciBwcm9wID0gX2N1cnJ5MihmdW5jdGlvbiBwcm9wKHAsIG9iaikge1xuICAgICAgICByZXR1cm4gb2JqW3BdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogSWYgdGhlIGdpdmVuLCBub24tbnVsbCBvYmplY3QgaGFzIGFuIG93biBwcm9wZXJ0eSB3aXRoIHRoZSBzcGVjaWZpZWQgbmFtZSxcbiAgICAgKiByZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGF0IHByb3BlcnR5LlxuICAgICAqIE90aGVyd2lzZSByZXR1cm5zIHRoZSBwcm92aWRlZCBkZWZhdWx0IHZhbHVlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIGEgLT4gU3RyaW5nIC0+IE9iamVjdCAtPiBhXG4gICAgICogQHBhcmFtIHsqfSB2YWwgVGhlIGRlZmF1bHQgdmFsdWUuXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHAgVGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHRvIHJldHVybi5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHJldHVybiB7Kn0gVGhlIHZhbHVlIG9mIGdpdmVuIHByb3BlcnR5IG9mIHRoZSBzdXBwbGllZCBvYmplY3Qgb3IgdGhlIGRlZmF1bHQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGFsaWNlID0ge1xuICAgICAqICAgICAgICBuYW1lOiAnQUxJQ0UnLFxuICAgICAqICAgICAgICBhZ2U6IDEwMVxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHZhciBmYXZvcml0ZSA9IFIucHJvcCgnZmF2b3JpdGVMaWJyYXJ5Jyk7XG4gICAgICogICAgICB2YXIgZmF2b3JpdGVXaXRoRGVmYXVsdCA9IFIucHJvcE9yKCdSYW1kYScsICdmYXZvcml0ZUxpYnJhcnknKTtcbiAgICAgKlxuICAgICAqICAgICAgZmF2b3JpdGUoYWxpY2UpOyAgLy89PiB1bmRlZmluZWRcbiAgICAgKiAgICAgIGZhdm9yaXRlV2l0aERlZmF1bHQoYWxpY2UpOyAgLy89PiAnUmFtZGEnXG4gICAgICovXG4gICAgdmFyIHByb3BPciA9IF9jdXJyeTMoZnVuY3Rpb24gcHJvcE9yKHZhbCwgcCwgb2JqKSB7XG4gICAgICAgIHJldHVybiBvYmogIT0gbnVsbCAmJiBfaGFzKHAsIG9iaikgPyBvYmpbcF0gOiB2YWw7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgc3BlY2lmaWVkIG9iamVjdCBwcm9wZXJ0eSBzYXRpc2ZpZXMgdGhlIGdpdmVuXG4gICAgICogcHJlZGljYXRlOyBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFN0cmluZyAtPiB7U3RyaW5nOiBhfSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAgICogQHBhcmFtIHsqfSBvYmpcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBzZWUgUi5wcm9wRXFcbiAgICAgKiBAc2VlIFIucHJvcElzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5wcm9wU2F0aXNmaWVzKHggPT4geCA+IDAsICd4Jywge3g6IDEsIHk6IDJ9KTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIHByb3BTYXRpc2ZpZXMgPSBfY3VycnkzKGZ1bmN0aW9uIHByb3BTYXRpc2ZpZXMocHJlZCwgbmFtZSwgb2JqKSB7XG4gICAgICAgIHJldHVybiBwcmVkKG9ialtuYW1lXSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBY3RzIGFzIG11bHRpcGxlIGBwcm9wYDogYXJyYXkgb2Yga2V5cyBpbiwgYXJyYXkgb2YgdmFsdWVzIG91dC4gUHJlc2VydmVzIG9yZGVyLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIFtrXSAtPiB7azogdn0gLT4gW3ZdXG4gICAgICogQHBhcmFtIHtBcnJheX0gcHMgVGhlIHByb3BlcnR5IG5hbWVzIHRvIGZldGNoXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIHF1ZXJ5XG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBjb3JyZXNwb25kaW5nIHZhbHVlcyBvciBwYXJ0aWFsbHkgYXBwbGllZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnByb3BzKFsneCcsICd5J10sIHt4OiAxLCB5OiAyfSk7IC8vPT4gWzEsIDJdXG4gICAgICogICAgICBSLnByb3BzKFsnYycsICdhJywgJ2InXSwge2I6IDIsIGE6IDF9KTsgLy89PiBbdW5kZWZpbmVkLCAxLCAyXVxuICAgICAqXG4gICAgICogICAgICB2YXIgZnVsbE5hbWUgPSBSLmNvbXBvc2UoUi5qb2luKCcgJyksIFIucHJvcHMoWydmaXJzdCcsICdsYXN0J10pKTtcbiAgICAgKiAgICAgIGZ1bGxOYW1lKHtsYXN0OiAnQnVsbGV0LVRvb3RoJywgYWdlOiAzMywgZmlyc3Q6ICdUb255J30pOyAvLz0+ICdUb255IEJ1bGxldC1Ub290aCdcbiAgICAgKi9cbiAgICB2YXIgcHJvcHMgPSBfY3VycnkyKGZ1bmN0aW9uIHByb3BzKHBzLCBvYmopIHtcbiAgICAgICAgdmFyIGxlbiA9IHBzLmxlbmd0aDtcbiAgICAgICAgdmFyIG91dCA9IFtdO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgb3V0W2lkeF0gPSBvYmpbcHNbaWR4XV07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxpc3Qgb2YgbnVtYmVycyBmcm9tIGBmcm9tYCAoaW5jbHVzaXZlKSB0byBgdG9gXG4gICAgICogKGV4Y2x1c2l2ZSkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXIgLT4gW051bWJlcl1cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZnJvbSBUaGUgZmlyc3QgbnVtYmVyIGluIHRoZSBsaXN0LlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB0byBPbmUgbW9yZSB0aGFuIHRoZSBsYXN0IG51bWJlciBpbiB0aGUgbGlzdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3Qgb2YgbnVtYmVycyBpbiB0dGhlIHNldCBgW2EsIGIpYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnJhbmdlKDEsIDUpOyAgICAvLz0+IFsxLCAyLCAzLCA0XVxuICAgICAqICAgICAgUi5yYW5nZSg1MCwgNTMpOyAgLy89PiBbNTAsIDUxLCA1Ml1cbiAgICAgKi9cbiAgICB2YXIgcmFuZ2UgPSBfY3VycnkyKGZ1bmN0aW9uIHJhbmdlKGZyb20sIHRvKSB7XG4gICAgICAgIGlmICghKF9pc051bWJlcihmcm9tKSAmJiBfaXNOdW1iZXIodG8pKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQm90aCBhcmd1bWVudHMgdG8gcmFuZ2UgbXVzdCBiZSBudW1iZXJzJyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgbiA9IGZyb207XG4gICAgICAgIHdoaWxlIChuIDwgdG8pIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKG4pO1xuICAgICAgICAgICAgbiArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgc2luZ2xlIGl0ZW0gYnkgaXRlcmF0aW5nIHRocm91Z2ggdGhlIGxpc3QsIHN1Y2Nlc3NpdmVseSBjYWxsaW5nIHRoZSBpdGVyYXRvclxuICAgICAqIGZ1bmN0aW9uIGFuZCBwYXNzaW5nIGl0IGFuIGFjY3VtdWxhdG9yIHZhbHVlIGFuZCB0aGUgY3VycmVudCB2YWx1ZSBmcm9tIHRoZSBhcnJheSwgYW5kXG4gICAgICogdGhlbiBwYXNzaW5nIHRoZSByZXN1bHQgdG8gdGhlIG5leHQgY2FsbC5cbiAgICAgKlxuICAgICAqIFNpbWlsYXIgdG8gYHJlZHVjZWAsIGV4Y2VwdCBtb3ZlcyB0aHJvdWdoIHRoZSBpbnB1dCBsaXN0IGZyb20gdGhlIHJpZ2h0IHRvIHRoZSBsZWZ0LlxuICAgICAqXG4gICAgICogVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uIHJlY2VpdmVzIHR3byB2YWx1ZXM6ICooYWNjLCB2YWx1ZSkqXG4gICAgICpcbiAgICAgKiBOb3RlOiBgUi5yZWR1Y2VSaWdodGAgZG9lcyBub3Qgc2tpcCBkZWxldGVkIG9yIHVuYXNzaWduZWQgaW5kaWNlcyAoc3BhcnNlIGFycmF5cyksIHVubGlrZVxuICAgICAqIHRoZSBuYXRpdmUgYEFycmF5LnByb3RvdHlwZS5yZWR1Y2VgIG1ldGhvZC4gRm9yIG1vcmUgZGV0YWlscyBvbiB0aGlzIGJlaGF2aW9yLCBzZWU6XG4gICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvcmVkdWNlUmlnaHQjRGVzY3JpcHRpb25cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEsYiAtPiBhKSAtPiBhIC0+IFtiXSAtPiBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uLiBSZWNlaXZlcyB0d28gdmFsdWVzLCB0aGUgYWNjdW11bGF0b3IgYW5kIHRoZVxuICAgICAqICAgICAgICBjdXJyZW50IGVsZW1lbnQgZnJvbSB0aGUgYXJyYXkuXG4gICAgICogQHBhcmFtIHsqfSBhY2MgVGhlIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBmaW5hbCwgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHBhaXJzID0gWyBbJ2EnLCAxXSwgWydiJywgMl0sIFsnYycsIDNdIF07XG4gICAgICogICAgICB2YXIgZmxhdHRlblBhaXJzID0gZnVuY3Rpb24oYWNjLCBwYWlyKSB7XG4gICAgICogICAgICAgIHJldHVybiBhY2MuY29uY2F0KHBhaXIpO1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgUi5yZWR1Y2VSaWdodChmbGF0dGVuUGFpcnMsIFtdLCBwYWlycyk7IC8vPT4gWyAnYycsIDMsICdiJywgMiwgJ2EnLCAxIF1cbiAgICAgKi9cbiAgICB2YXIgcmVkdWNlUmlnaHQgPSBfY3VycnkzKGZ1bmN0aW9uIHJlZHVjZVJpZ2h0KGZuLCBhY2MsIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgd2hpbGUgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICBhY2MgPSBmbihhY2MsIGxpc3RbaWR4XSk7XG4gICAgICAgICAgICBpZHggLT0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHZhbHVlIHdyYXBwZWQgdG8gaW5kaWNhdGUgdGhhdCBpdCBpcyB0aGUgZmluYWwgdmFsdWUgb2YgdGhlXG4gICAgICogcmVkdWNlIGFuZCB0cmFuc2R1Y2UgZnVuY3Rpb25zLiAgVGhlIHJldHVybmVkIHZhbHVlXG4gICAgICogc2hvdWxkIGJlIGNvbnNpZGVyZWQgYSBibGFjayBib3g6IHRoZSBpbnRlcm5hbCBzdHJ1Y3R1cmUgaXMgbm90XG4gICAgICogZ3VhcmFudGVlZCB0byBiZSBzdGFibGUuXG4gICAgICpcbiAgICAgKiBOb3RlOiB0aGlzIG9wdGltaXphdGlvbiBpcyB1bmF2YWlsYWJsZSB0byBmdW5jdGlvbnMgbm90IGV4cGxpY2l0bHkgbGlzdGVkXG4gICAgICogYWJvdmUuICBGb3IgaW5zdGFuY2UsIGl0IGlzIG5vdCBjdXJyZW50bHkgc3VwcG9ydGVkIGJ5IHJlZHVjZUluZGV4ZWQsXG4gICAgICogcmVkdWNlUmlnaHQsIG9yIHJlZHVjZVJpZ2h0SW5kZXhlZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzZWUgUi5yZWR1Y2UsIFIudHJhbnNkdWNlXG4gICAgICogQHNpZyBhIC0+ICpcbiAgICAgKiBAcGFyYW0geyp9IHggVGhlIGZpbmFsIHZhbHVlIG9mIHRoZSByZWR1Y2UuXG4gICAgICogQHJldHVybiB7Kn0gVGhlIHdyYXBwZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5yZWR1Y2UoXG4gICAgICogICAgICAgIFIucGlwZShSLmFkZCwgUi5pZkVsc2UoUi5sdGUoMTApLCBSLnJlZHVjZWQsIFIuaWRlbnRpdHkpKSxcbiAgICAgKiAgICAgICAgMCxcbiAgICAgKiAgICAgICAgWzEsIDIsIDMsIDQsIDVdKSAvLyAxMFxuICAgICAqL1xuICAgIHZhciByZWR1Y2VkID0gX2N1cnJ5MShfcmVkdWNlZCk7XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBzdWItbGlzdCBvZiBgbGlzdGAgc3RhcnRpbmcgYXQgaW5kZXggYHN0YXJ0YCBhbmQgY29udGFpbmluZ1xuICAgICAqIGBjb3VudGAgZWxlbWVudHMuICBfTm90ZSB0aGF0IHRoaXMgaXMgbm90IGRlc3RydWN0aXZlXzogaXQgcmV0dXJucyBhXG4gICAgICogY29weSBvZiB0aGUgbGlzdCB3aXRoIHRoZSBjaGFuZ2VzLlxuICAgICAqIDxzbWFsbD5ObyBsaXN0cyBoYXZlIGJlZW4gaGFybWVkIGluIHRoZSBhcHBsaWNhdGlvbiBvZiB0aGlzIGZ1bmN0aW9uLjwvc21hbGw+XG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXIgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydCBUaGUgcG9zaXRpb24gdG8gc3RhcnQgcmVtb3ZpbmcgZWxlbWVudHNcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byByZW1vdmVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIHJlbW92ZSBmcm9tXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IEFycmF5IHdpdGggYGNvdW50YCBlbGVtZW50cyBmcm9tIGBzdGFydGAgcmVtb3ZlZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnJlbW92ZSgyLCAzLCBbMSwyLDMsNCw1LDYsNyw4XSk7IC8vPT4gWzEsMiw2LDcsOF1cbiAgICAgKi9cbiAgICB2YXIgcmVtb3ZlID0gX2N1cnJ5MyhmdW5jdGlvbiByZW1vdmUoc3RhcnQsIGNvdW50LCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBfY29uY2F0KF9zbGljZShsaXN0LCAwLCBNYXRoLm1pbihzdGFydCwgbGlzdC5sZW5ndGgpKSwgX3NsaWNlKGxpc3QsIE1hdGgubWluKGxpc3QubGVuZ3RoLCBzdGFydCArIGNvdW50KSkpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSBhIHN1YnN0cmluZyBvciByZWdleCBtYXRjaCBpbiBhIHN0cmluZyB3aXRoIGEgcmVwbGFjZW1lbnQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBzaWcgUmVnRXhwfFN0cmluZyAtPiBTdHJpbmcgLT4gU3RyaW5nIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7UmVnRXhwfFN0cmluZ30gcGF0dGVybiBBIHJlZ3VsYXIgZXhwcmVzc2lvbiBvciBhIHN1YnN0cmluZyB0byBtYXRjaC5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwbGFjZW1lbnQgVGhlIHN0cmluZyB0byByZXBsYWNlIHRoZSBtYXRjaGVzIHdpdGguXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgU3RyaW5nIHRvIGRvIHRoZSBzZWFyY2ggYW5kIHJlcGxhY2VtZW50IGluLlxuICAgICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIHJlc3VsdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnJlcGxhY2UoJ2ZvbycsICdiYXInLCAnZm9vIGZvbyBmb28nKTsgLy89PiAnYmFyIGZvbyBmb28nXG4gICAgICogICAgICBSLnJlcGxhY2UoL2Zvby8sICdiYXInLCAnZm9vIGZvbyBmb28nKTsgLy89PiAnYmFyIGZvbyBmb28nXG4gICAgICpcbiAgICAgKiAgICAgIC8vIFVzZSB0aGUgXCJnXCIgKGdsb2JhbCkgZmxhZyB0byByZXBsYWNlIGFsbCBvY2N1cnJlbmNlczpcbiAgICAgKiAgICAgIFIucmVwbGFjZSgvZm9vL2csICdiYXInLCAnZm9vIGZvbyBmb28nKTsgLy89PiAnYmFyIGJhciBiYXInXG4gICAgICovXG4gICAgdmFyIHJlcGxhY2UgPSBfY3VycnkzKGZ1bmN0aW9uIHJlcGxhY2UocmVnZXgsIHJlcGxhY2VtZW50LCBzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKHJlZ2V4LCByZXBsYWNlbWVudCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3Qgd2l0aCB0aGUgc2FtZSBlbGVtZW50cyBhcyB0aGUgb3JpZ2luYWwgbGlzdCwganVzdFxuICAgICAqIGluIHRoZSByZXZlcnNlIG9yZGVyLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byByZXZlcnNlLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIGNvcHkgb2YgdGhlIGxpc3QgaW4gcmV2ZXJzZSBvcmRlci5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnJldmVyc2UoWzEsIDIsIDNdKTsgIC8vPT4gWzMsIDIsIDFdXG4gICAgICogICAgICBSLnJldmVyc2UoWzEsIDJdKTsgICAgIC8vPT4gWzIsIDFdXG4gICAgICogICAgICBSLnJldmVyc2UoWzFdKTsgICAgICAgIC8vPT4gWzFdXG4gICAgICogICAgICBSLnJldmVyc2UoW10pOyAgICAgICAgIC8vPT4gW11cbiAgICAgKi9cbiAgICB2YXIgcmV2ZXJzZSA9IF9jdXJyeTEoZnVuY3Rpb24gcmV2ZXJzZShsaXN0KSB7XG4gICAgICAgIHJldHVybiBfc2xpY2UobGlzdCkucmV2ZXJzZSgpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogU2NhbiBpcyBzaW1pbGFyIHRvIHJlZHVjZSwgYnV0IHJldHVybnMgYSBsaXN0IG9mIHN1Y2Nlc3NpdmVseSByZWR1Y2VkIHZhbHVlcyBmcm9tIHRoZSBsZWZ0XG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhLGIgLT4gYSkgLT4gYSAtPiBbYl0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uLiBSZWNlaXZlcyB0d28gdmFsdWVzLCB0aGUgYWNjdW11bGF0b3IgYW5kIHRoZVxuICAgICAqICAgICAgICBjdXJyZW50IGVsZW1lbnQgZnJvbSB0aGUgYXJyYXlcbiAgICAgKiBAcGFyYW0geyp9IGFjYyBUaGUgYWNjdW11bGF0b3IgdmFsdWUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbGlzdCBvZiBhbGwgaW50ZXJtZWRpYXRlbHkgcmVkdWNlZCB2YWx1ZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG51bWJlcnMgPSBbMSwgMiwgMywgNF07XG4gICAgICogICAgICB2YXIgZmFjdG9yaWFscyA9IFIuc2NhbihSLm11bHRpcGx5LCAxLCBudW1iZXJzKTsgLy89PiBbMSwgMSwgMiwgNiwgMjRdXG4gICAgICovXG4gICAgdmFyIHNjYW4gPSBfY3VycnkzKGZ1bmN0aW9uIHNjYW4oZm4sIGFjYywgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGgsIHJlc3VsdCA9IFthY2NdO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBhY2MgPSBmbihhY2MsIGxpc3RbaWR4XSk7XG4gICAgICAgICAgICByZXN1bHRbaWR4ICsgMV0gPSBhY2M7XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcmVzdWx0IG9mIFwic2V0dGluZ1wiIHRoZSBwb3J0aW9uIG9mIHRoZSBnaXZlbiBkYXRhIHN0cnVjdHVyZVxuICAgICAqIGZvY3VzZWQgYnkgdGhlIGdpdmVuIGxlbnMgdG8gdGhlIGdpdmVuIHZhbHVlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAdHlwZWRlZiBMZW5zIHMgYSA9IEZ1bmN0b3IgZiA9PiAoYSAtPiBmIGEpIC0+IHMgLT4gZiBzXG4gICAgICogQHNpZyBMZW5zIHMgYSAtPiBhIC0+IHMgLT4gc1xuICAgICAqIEBwYXJhbSB7TGVuc30gbGVuc1xuICAgICAqIEBwYXJhbSB7Kn0gdlxuICAgICAqIEBwYXJhbSB7Kn0geFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLnByb3AsIFIubGVuc0luZGV4LCBSLmxlbnNQcm9wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhMZW5zID0gUi5sZW5zUHJvcCgneCcpO1xuICAgICAqXG4gICAgICogICAgICBSLnNldCh4TGVucywgNCwge3g6IDEsIHk6IDJ9KTsgIC8vPT4ge3g6IDQsIHk6IDJ9XG4gICAgICogICAgICBSLnNldCh4TGVucywgOCwge3g6IDEsIHk6IDJ9KTsgIC8vPT4ge3g6IDgsIHk6IDJ9XG4gICAgICovXG4gICAgdmFyIHNldCA9IF9jdXJyeTMoZnVuY3Rpb24gc2V0KGxlbnMsIHYsIHgpIHtcbiAgICAgICAgcmV0dXJuIG92ZXIobGVucywgYWx3YXlzKHYpLCB4KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBjb3B5IG9mIHRoZSBsaXN0LCBzb3J0ZWQgYWNjb3JkaW5nIHRvIHRoZSBjb21wYXJhdG9yIGZ1bmN0aW9uLCB3aGljaCBzaG91bGQgYWNjZXB0IHR3byB2YWx1ZXMgYXQgYVxuICAgICAqIHRpbWUgYW5kIHJldHVybiBhIG5lZ2F0aXZlIG51bWJlciBpZiB0aGUgZmlyc3QgdmFsdWUgaXMgc21hbGxlciwgYSBwb3NpdGl2ZSBudW1iZXIgaWYgaXQncyBsYXJnZXIsIGFuZCB6ZXJvXG4gICAgICogaWYgdGhleSBhcmUgZXF1YWwuICBQbGVhc2Ugbm90ZSB0aGF0IHRoaXMgaXMgYSAqKmNvcHkqKiBvZiB0aGUgbGlzdC4gIEl0IGRvZXMgbm90IG1vZGlmeSB0aGUgb3JpZ2luYWwuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhLGEgLT4gTnVtYmVyKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY29tcGFyYXRvciBBIHNvcnRpbmcgZnVuY3Rpb24gOjogYSAtPiBiIC0+IEludFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gc29ydFxuICAgICAqIEByZXR1cm4ge0FycmF5fSBhIG5ldyBhcnJheSB3aXRoIGl0cyBlbGVtZW50cyBzb3J0ZWQgYnkgdGhlIGNvbXBhcmF0b3IgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGRpZmYgPSBmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhIC0gYjsgfTtcbiAgICAgKiAgICAgIFIuc29ydChkaWZmLCBbNCwyLDcsNV0pOyAvLz0+IFsyLCA0LCA1LCA3XVxuICAgICAqL1xuICAgIHZhciBzb3J0ID0gX2N1cnJ5MihmdW5jdGlvbiBzb3J0KGNvbXBhcmF0b3IsIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIF9zbGljZShsaXN0KS5zb3J0KGNvbXBhcmF0b3IpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogU29ydHMgdGhlIGxpc3QgYWNjb3JkaW5nIHRvIHRoZSBzdXBwbGllZCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIE9yZCBiID0+IChhIC0+IGIpIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gc29ydC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgbGlzdCBzb3J0ZWQgYnkgdGhlIGtleXMgZ2VuZXJhdGVkIGJ5IGBmbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHNvcnRCeUZpcnN0SXRlbSA9IFIuc29ydEJ5KHByb3AoMCkpO1xuICAgICAqICAgICAgdmFyIHNvcnRCeU5hbWVDYXNlSW5zZW5zaXRpdmUgPSBSLnNvcnRCeShSLmNvbXBvc2UoUi50b0xvd2VyLCBSLnByb3AoJ25hbWUnKSkpO1xuICAgICAqICAgICAgdmFyIHBhaXJzID0gW1stMSwgMV0sIFstMiwgMl0sIFstMywgM11dO1xuICAgICAqICAgICAgc29ydEJ5Rmlyc3RJdGVtKHBhaXJzKTsgLy89PiBbWy0zLCAzXSwgWy0yLCAyXSwgWy0xLCAxXV1cbiAgICAgKiAgICAgIHZhciBhbGljZSA9IHtcbiAgICAgKiAgICAgICAgbmFtZTogJ0FMSUNFJyxcbiAgICAgKiAgICAgICAgYWdlOiAxMDFcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICB2YXIgYm9iID0ge1xuICAgICAqICAgICAgICBuYW1lOiAnQm9iJyxcbiAgICAgKiAgICAgICAgYWdlOiAtMTBcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICB2YXIgY2xhcmEgPSB7XG4gICAgICogICAgICAgIG5hbWU6ICdjbGFyYScsXG4gICAgICogICAgICAgIGFnZTogMzE0LjE1OVxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHZhciBwZW9wbGUgPSBbY2xhcmEsIGJvYiwgYWxpY2VdO1xuICAgICAqICAgICAgc29ydEJ5TmFtZUNhc2VJbnNlbnNpdGl2ZShwZW9wbGUpOyAvLz0+IFthbGljZSwgYm9iLCBjbGFyYV1cbiAgICAgKi9cbiAgICB2YXIgc29ydEJ5ID0gX2N1cnJ5MihmdW5jdGlvbiBzb3J0QnkoZm4sIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIF9zbGljZShsaXN0KS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICB2YXIgYWEgPSBmbihhKTtcbiAgICAgICAgICAgIHZhciBiYiA9IGZuKGIpO1xuICAgICAgICAgICAgcmV0dXJuIGFhIDwgYmIgPyAtMSA6IGFhID4gYmIgPyAxIDogMDtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBTdWJ0cmFjdHMgdHdvIG51bWJlcnMuIEVxdWl2YWxlbnQgdG8gYGEgLSBiYCBidXQgY3VycmllZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gYSBUaGUgZmlyc3QgdmFsdWUuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGIgVGhlIHNlY29uZCB2YWx1ZS5cbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSByZXN1bHQgb2YgYGEgLSBiYC5cbiAgICAgKiBAc2VlIFIuYWRkXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5zdWJ0cmFjdCgxMCwgOCk7IC8vPT4gMlxuICAgICAqXG4gICAgICogICAgICB2YXIgbWludXM1ID0gUi5zdWJ0cmFjdChSLl9fLCA1KTtcbiAgICAgKiAgICAgIG1pbnVzNSgxNyk7IC8vPT4gMTJcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGNvbXBsZW1lbnRhcnlBbmdsZSA9IFIuc3VidHJhY3QoOTApO1xuICAgICAqICAgICAgY29tcGxlbWVudGFyeUFuZ2xlKDMwKTsgLy89PiA2MFxuICAgICAqICAgICAgY29tcGxlbWVudGFyeUFuZ2xlKDcyKTsgLy89PiAxOFxuICAgICAqL1xuICAgIHZhciBzdWJ0cmFjdCA9IF9jdXJyeTIoZnVuY3Rpb24gc3VidHJhY3QoYSwgYikge1xuICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29udGFpbmluZyB0aGUgbGFzdCBgbmAgZWxlbWVudHMgb2YgYSBnaXZlbiBsaXN0LCBwYXNzaW5nIGVhY2ggdmFsdWVcbiAgICAgKiB0byB0aGUgc3VwcGxpZWQgcHJlZGljYXRlIGZ1bmN0aW9uLCBhbmQgdGVybWluYXRpbmcgd2hlbiB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uIHJldHVybnNcbiAgICAgKiBgZmFsc2VgLiBFeGNsdWRlcyB0aGUgZWxlbWVudCB0aGF0IGNhdXNlZCB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uIHRvIGZhaWwuIFRoZSBwcmVkaWNhdGVcbiAgICAgKiBmdW5jdGlvbiBpcyBwYXNzZWQgb25lIGFyZ3VtZW50OiAqKHZhbHVlKSouXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IGFycmF5LlxuICAgICAqIEBzZWUgUi5kcm9wTGFzdFdoaWxlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGlzTm90T25lID0gZnVuY3Rpb24oeCkge1xuICAgICAqICAgICAgICByZXR1cm4gISh4ID09PSAxKTtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIFIudGFrZUxhc3RXaGlsZShpc05vdE9uZSwgWzEsIDIsIDMsIDRdKTsgLy89PiBbMiwgMywgNF1cbiAgICAgKi9cbiAgICB2YXIgdGFrZUxhc3RXaGlsZSA9IF9jdXJyeTIoZnVuY3Rpb24gdGFrZUxhc3RXaGlsZShmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICB3aGlsZSAoaWR4ID49IDAgJiYgZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgaWR4IC09IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF9zbGljZShsaXN0LCBpZHggKyAxLCBJbmZpbml0eSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSdW5zIHRoZSBnaXZlbiBmdW5jdGlvbiB3aXRoIHRoZSBzdXBwbGllZCBvYmplY3QsIHRoZW4gcmV0dXJucyB0aGUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKGEgLT4gKikgLT4gYSAtPiBhXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGNhbGwgd2l0aCBgeGAuIFRoZSByZXR1cm4gdmFsdWUgb2YgYGZuYCB3aWxsIGJlIHRocm93biBhd2F5LlxuICAgICAqIEBwYXJhbSB7Kn0geFxuICAgICAqIEByZXR1cm4geyp9IGB4YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgc2F5WCA9IGZ1bmN0aW9uKHgpIHsgY29uc29sZS5sb2coJ3ggaXMgJyArIHgpOyB9O1xuICAgICAqICAgICAgUi50YXAoc2F5WCwgMTAwKTsgLy89PiAxMDBcbiAgICAgKiAgICAgIC8vLT4gJ3ggaXMgMTAwJ1xuICAgICAqL1xuICAgIHZhciB0YXAgPSBfY3VycnkyKGZ1bmN0aW9uIHRhcChmbiwgeCkge1xuICAgICAgICBmbih4KTtcbiAgICAgICAgcmV0dXJuIHg7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgYSBnaXZlbiBzdHJpbmcgbWF0Y2hlcyBhIGdpdmVuIHJlZ3VsYXIgZXhwcmVzc2lvbi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAc2VlIFIubWF0Y2hcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBSZWdFeHAgLT4gU3RyaW5nIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge1JlZ0V4cH0gcGF0dGVyblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudGVzdCgvXngvLCAneHl6Jyk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi50ZXN0KC9eeS8sICd4eXonKTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciB0ZXN0ID0gX2N1cnJ5MihmdW5jdGlvbiB0ZXN0KHBhdHRlcm4sIHN0cikge1xuICAgICAgICByZXR1cm4gX2Nsb25lUmVnRXhwKHBhdHRlcm4pLnRlc3Qoc3RyKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENhbGxzIGFuIGlucHV0IGZ1bmN0aW9uIGBuYCB0aW1lcywgcmV0dXJuaW5nIGFuIGFycmF5IGNvbnRhaW5pbmcgdGhlIHJlc3VsdHMgb2YgdGhvc2VcbiAgICAgKiBmdW5jdGlvbiBjYWxscy5cbiAgICAgKlxuICAgICAqIGBmbmAgaXMgcGFzc2VkIG9uZSBhcmd1bWVudDogVGhlIGN1cnJlbnQgdmFsdWUgb2YgYG5gLCB3aGljaCBiZWdpbnMgYXQgYDBgIGFuZCBpc1xuICAgICAqIGdyYWR1YWxseSBpbmNyZW1lbnRlZCB0byBgbiAtIDFgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoaSAtPiBhKSAtPiBpIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBpbnZva2UuIFBhc3NlZCBvbmUgYXJndW1lbnQsIHRoZSBjdXJyZW50IHZhbHVlIG9mIGBuYC5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gbiBBIHZhbHVlIGJldHdlZW4gYDBgIGFuZCBgbiAtIDFgLiBJbmNyZW1lbnRzIGFmdGVyIGVhY2ggZnVuY3Rpb24gY2FsbC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgY29udGFpbmluZyB0aGUgcmV0dXJuIHZhbHVlcyBvZiBhbGwgY2FsbHMgdG8gYGZuYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnRpbWVzKFIuaWRlbnRpdHksIDUpOyAvLz0+IFswLCAxLCAyLCAzLCA0XVxuICAgICAqL1xuICAgIHZhciB0aW1lcyA9IF9jdXJyeTIoZnVuY3Rpb24gdGltZXMoZm4sIG4pIHtcbiAgICAgICAgdmFyIGxlbiA9IE51bWJlcihuKTtcbiAgICAgICAgdmFyIGxpc3QgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIGxpc3RbaWR4XSA9IGZuKGlkeCk7XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGFuIG9iamVjdCBpbnRvIGFuIGFycmF5IG9mIGtleSwgdmFsdWUgYXJyYXlzLlxuICAgICAqIE9ubHkgdGhlIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzIGFyZSB1c2VkLlxuICAgICAqIE5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgdGhlIG91dHB1dCBhcnJheSBpcyBub3QgZ3VhcmFudGVlZCB0byBiZVxuICAgICAqIGNvbnNpc3RlbnQgYWNyb3NzIGRpZmZlcmVudCBKUyBwbGF0Zm9ybXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge1N0cmluZzogKn0gLT4gW1tTdHJpbmcsKl1dXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGV4dHJhY3QgZnJvbVxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiBrZXksIHZhbHVlIGFycmF5cyBmcm9tIHRoZSBvYmplY3QncyBvd24gcHJvcGVydGllcy5cbiAgICAgKiBAc2VlIFIuZnJvbVBhaXJzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50b1BhaXJzKHthOiAxLCBiOiAyLCBjOiAzfSk7IC8vPT4gW1snYScsIDFdLCBbJ2InLCAyXSwgWydjJywgM11dXG4gICAgICovXG4gICAgdmFyIHRvUGFpcnMgPSBfY3VycnkxKGZ1bmN0aW9uIHRvUGFpcnMob2JqKSB7XG4gICAgICAgIHZhciBwYWlycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgICAgICAgaWYgKF9oYXMocHJvcCwgb2JqKSkge1xuICAgICAgICAgICAgICAgIHBhaXJzW3BhaXJzLmxlbmd0aF0gPSBbXG4gICAgICAgICAgICAgICAgICAgIHByb3AsXG4gICAgICAgICAgICAgICAgICAgIG9ialtwcm9wXVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhaXJzO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYW4gb2JqZWN0IGludG8gYW4gYXJyYXkgb2Yga2V5LCB2YWx1ZSBhcnJheXMuXG4gICAgICogVGhlIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzIGFuZCBwcm90b3R5cGUgcHJvcGVydGllcyBhcmUgdXNlZC5cbiAgICAgKiBOb3RlIHRoYXQgdGhlIG9yZGVyIG9mIHRoZSBvdXRwdXQgYXJyYXkgaXMgbm90IGd1YXJhbnRlZWQgdG8gYmVcbiAgICAgKiBjb25zaXN0ZW50IGFjcm9zcyBkaWZmZXJlbnQgSlMgcGxhdGZvcm1zLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHtTdHJpbmc6ICp9IC0+IFtbU3RyaW5nLCpdXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBleHRyYWN0IGZyb21cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2Yga2V5LCB2YWx1ZSBhcnJheXMgZnJvbSB0aGUgb2JqZWN0J3Mgb3duXG4gICAgICogICAgICAgICBhbmQgcHJvdG90eXBlIHByb3BlcnRpZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIEYgPSBmdW5jdGlvbigpIHsgdGhpcy54ID0gJ1gnOyB9O1xuICAgICAqICAgICAgRi5wcm90b3R5cGUueSA9ICdZJztcbiAgICAgKiAgICAgIHZhciBmID0gbmV3IEYoKTtcbiAgICAgKiAgICAgIFIudG9QYWlyc0luKGYpOyAvLz0+IFtbJ3gnLCdYJ10sIFsneScsJ1knXV1cbiAgICAgKi9cbiAgICB2YXIgdG9QYWlyc0luID0gX2N1cnJ5MShmdW5jdGlvbiB0b1BhaXJzSW4ob2JqKSB7XG4gICAgICAgIHZhciBwYWlycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgICAgICAgcGFpcnNbcGFpcnMubGVuZ3RoXSA9IFtcbiAgICAgICAgICAgICAgICBwcm9wLFxuICAgICAgICAgICAgICAgIG9ialtwcm9wXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFpcnM7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIChzdHJpcHMpIHdoaXRlc3BhY2UgZnJvbSBib3RoIGVuZHMgb2YgdGhlIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIHRyaW0uXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBUcmltbWVkIHZlcnNpb24gb2YgYHN0cmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50cmltKCcgICB4eXogICcpOyAvLz0+ICd4eXonXG4gICAgICogICAgICBSLm1hcChSLnRyaW0sIFIuc3BsaXQoJywnLCAneCwgeSwgeicpKTsgLy89PiBbJ3gnLCAneScsICd6J11cbiAgICAgKi9cbiAgICB2YXIgdHJpbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHdzID0gJ1xcdFxcblxceDBCXFxmXFxyIFxceEEwXFx1MTY4MFxcdTE4MEVcXHUyMDAwXFx1MjAwMVxcdTIwMDJcXHUyMDAzJyArICdcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBBXFx1MjAyRlxcdTIwNUZcXHUzMDAwXFx1MjAyOCcgKyAnXFx1MjAyOVxcdUZFRkYnO1xuICAgICAgICB2YXIgemVyb1dpZHRoID0gJ1xcdTIwMEInO1xuICAgICAgICB2YXIgaGFzUHJvdG9UcmltID0gdHlwZW9mIFN0cmluZy5wcm90b3R5cGUudHJpbSA9PT0gJ2Z1bmN0aW9uJztcbiAgICAgICAgaWYgKCFoYXNQcm90b1RyaW0gfHwgKHdzLnRyaW0oKSB8fCAhemVyb1dpZHRoLnRyaW0oKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIHRyaW0oc3RyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJlZ2luUnggPSBuZXcgUmVnRXhwKCdeWycgKyB3cyArICddWycgKyB3cyArICddKicpO1xuICAgICAgICAgICAgICAgIHZhciBlbmRSeCA9IG5ldyBSZWdFeHAoJ1snICsgd3MgKyAnXVsnICsgd3MgKyAnXSokJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKGJlZ2luUngsICcnKS5yZXBsYWNlKGVuZFJ4LCAnJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBfY3VycnkxKGZ1bmN0aW9uIHRyaW0oc3RyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0ci50cmltKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0oKTtcblxuICAgIC8qKlxuICAgICAqIEdpdmVzIGEgc2luZ2xlLXdvcmQgc3RyaW5nIGRlc2NyaXB0aW9uIG9mIHRoZSAobmF0aXZlKSB0eXBlIG9mIGEgdmFsdWUsIHJldHVybmluZyBzdWNoXG4gICAgICogYW5zd2VycyBhcyAnT2JqZWN0JywgJ051bWJlcicsICdBcnJheScsIG9yICdOdWxsJy4gIERvZXMgbm90IGF0dGVtcHQgdG8gZGlzdGluZ3Vpc2ggdXNlclxuICAgICAqIE9iamVjdCB0eXBlcyBhbnkgZnVydGhlciwgcmVwb3J0aW5nIHRoZW0gYWxsIGFzICdPYmplY3QnLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBUeXBlXG4gICAgICogQHNpZyAoKiAtPiB7Kn0pIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gICAgICogQHJldHVybiB7U3RyaW5nfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudHlwZSh7fSk7IC8vPT4gXCJPYmplY3RcIlxuICAgICAqICAgICAgUi50eXBlKDEpOyAvLz0+IFwiTnVtYmVyXCJcbiAgICAgKiAgICAgIFIudHlwZShmYWxzZSk7IC8vPT4gXCJCb29sZWFuXCJcbiAgICAgKiAgICAgIFIudHlwZSgncycpOyAvLz0+IFwiU3RyaW5nXCJcbiAgICAgKiAgICAgIFIudHlwZShudWxsKTsgLy89PiBcIk51bGxcIlxuICAgICAqICAgICAgUi50eXBlKFtdKTsgLy89PiBcIkFycmF5XCJcbiAgICAgKiAgICAgIFIudHlwZSgvW0Etel0vKTsgLy89PiBcIlJlZ0V4cFwiXG4gICAgICovXG4gICAgdmFyIHR5cGUgPSBfY3VycnkxKGZ1bmN0aW9uIHR5cGUodmFsKSB7XG4gICAgICAgIHJldHVybiB2YWwgPT09IG51bGwgPyAnTnVsbCcgOiB2YWwgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbCkuc2xpY2UoOCwgLTEpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGFrZXMgYSBmdW5jdGlvbiBgZm5gLCB3aGljaCB0YWtlcyBhIHNpbmdsZSBhcnJheSBhcmd1bWVudCwgYW5kIHJldHVybnNcbiAgICAgKiBhIGZ1bmN0aW9uIHdoaWNoOlxuICAgICAqXG4gICAgICogICAtIHRha2VzIGFueSBudW1iZXIgb2YgcG9zaXRpb25hbCBhcmd1bWVudHM7XG4gICAgICogICAtIHBhc3NlcyB0aGVzZSBhcmd1bWVudHMgdG8gYGZuYCBhcyBhbiBhcnJheTsgYW5kXG4gICAgICogICAtIHJldHVybnMgdGhlIHJlc3VsdC5cbiAgICAgKlxuICAgICAqIEluIG90aGVyIHdvcmRzLCBSLnVuYXBwbHkgZGVyaXZlcyBhIHZhcmlhZGljIGZ1bmN0aW9uIGZyb20gYSBmdW5jdGlvblxuICAgICAqIHdoaWNoIHRha2VzIGFuIGFycmF5LiBSLnVuYXBwbHkgaXMgdGhlIGludmVyc2Ugb2YgUi5hcHBseS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIChbKi4uLl0gLT4gYSkgLT4gKCouLi4gLT4gYSlcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBzZWUgUi5hcHBseVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudW5hcHBseShKU09OLnN0cmluZ2lmeSkoMSwgMiwgMyk7IC8vPT4gJ1sxLDIsM10nXG4gICAgICovXG4gICAgdmFyIHVuYXBwbHkgPSBfY3VycnkxKGZ1bmN0aW9uIHVuYXBwbHkoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmbihfc2xpY2UoYXJndW1lbnRzKSk7XG4gICAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcyBhIGZ1bmN0aW9uIG9mIGFueSBhcml0eSAoaW5jbHVkaW5nIG51bGxhcnkpIGluIGEgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIGV4YWN0bHkgMVxuICAgICAqIHBhcmFtZXRlci4gQW55IGV4dHJhbmVvdXMgcGFyYW1ldGVycyB3aWxsIG5vdCBiZSBwYXNzZWQgdG8gdGhlIHN1cHBsaWVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKCogLT4gYikgLT4gKGEgLT4gYilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcgZnVuY3Rpb24gd3JhcHBpbmcgYGZuYC4gVGhlIG5ldyBmdW5jdGlvbiBpcyBndWFyYW50ZWVkIHRvIGJlIG9mXG4gICAgICogICAgICAgICBhcml0eSAxLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB0YWtlc1R3b0FyZ3MgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgICogICAgICAgIHJldHVybiBbYSwgYl07XG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgdGFrZXNUd29BcmdzLmxlbmd0aDsgLy89PiAyXG4gICAgICogICAgICB0YWtlc1R3b0FyZ3MoMSwgMik7IC8vPT4gWzEsIDJdXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB0YWtlc09uZUFyZyA9IFIudW5hcnkodGFrZXNUd29BcmdzKTtcbiAgICAgKiAgICAgIHRha2VzT25lQXJnLmxlbmd0aDsgLy89PiAxXG4gICAgICogICAgICAvLyBPbmx5IDEgYXJndW1lbnQgaXMgcGFzc2VkIHRvIHRoZSB3cmFwcGVkIGZ1bmN0aW9uXG4gICAgICogICAgICB0YWtlc09uZUFyZygxLCAyKTsgLy89PiBbMSwgdW5kZWZpbmVkXVxuICAgICAqL1xuICAgIHZhciB1bmFyeSA9IF9jdXJyeTEoZnVuY3Rpb24gdW5hcnkoZm4pIHtcbiAgICAgICAgcmV0dXJuIG5BcnkoMSwgZm4pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIG9mIGFyaXR5IGBuYCBmcm9tIGEgKG1hbnVhbGx5KSBjdXJyaWVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgTnVtYmVyIC0+IChhIC0+IGIpIC0+IChhIC0+IGMpXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGxlbmd0aCBUaGUgYXJpdHkgZm9yIHRoZSByZXR1cm5lZCBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gdW5jdXJyeS5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcgZnVuY3Rpb24uXG4gICAgICogQHNlZSBSLmN1cnJ5XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGFkZEZvdXIgPSBmdW5jdGlvbihhKSB7XG4gICAgICogICAgICAgIHJldHVybiBmdW5jdGlvbihiKSB7XG4gICAgICogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGMpIHtcbiAgICAgKiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihkKSB7XG4gICAgICogICAgICAgICAgICAgIHJldHVybiBhICsgYiArIGMgKyBkO1xuICAgICAqICAgICAgICAgICAgfTtcbiAgICAgKiAgICAgICAgICB9O1xuICAgICAqICAgICAgICB9O1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHVuY3VycmllZEFkZEZvdXIgPSBSLnVuY3VycnlOKDQsIGFkZEZvdXIpO1xuICAgICAqICAgICAgY3VycmllZEFkZEZvdXIoMSwgMiwgMywgNCk7IC8vPT4gMTBcbiAgICAgKi9cbiAgICB2YXIgdW5jdXJyeU4gPSBfY3VycnkyKGZ1bmN0aW9uIHVuY3VycnlOKGRlcHRoLCBmbikge1xuICAgICAgICByZXR1cm4gY3VycnlOKGRlcHRoLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudERlcHRoID0gMTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZuO1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgICAgICB2YXIgZW5kSWR4O1xuICAgICAgICAgICAgd2hpbGUgKGN1cnJlbnREZXB0aCA8PSBkZXB0aCAmJiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBlbmRJZHggPSBjdXJyZW50RGVwdGggPT09IGRlcHRoID8gYXJndW1lbnRzLmxlbmd0aCA6IGlkeCArIHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLmFwcGx5KHRoaXMsIF9zbGljZShhcmd1bWVudHMsIGlkeCwgZW5kSWR4KSk7XG4gICAgICAgICAgICAgICAgY3VycmVudERlcHRoICs9IDE7XG4gICAgICAgICAgICAgICAgaWR4ID0gZW5kSWR4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEJ1aWxkcyBhIGxpc3QgZnJvbSBhIHNlZWQgdmFsdWUuIEFjY2VwdHMgYW4gaXRlcmF0b3IgZnVuY3Rpb24sIHdoaWNoIHJldHVybnMgZWl0aGVyIGZhbHNlXG4gICAgICogdG8gc3RvcCBpdGVyYXRpb24gb3IgYW4gYXJyYXkgb2YgbGVuZ3RoIDIgY29udGFpbmluZyB0aGUgdmFsdWUgdG8gYWRkIHRvIHRoZSByZXN1bHRpbmdcbiAgICAgKiBsaXN0IGFuZCB0aGUgc2VlZCB0byBiZSB1c2VkIGluIHRoZSBuZXh0IGNhbGwgdG8gdGhlIGl0ZXJhdG9yIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uIHJlY2VpdmVzIG9uZSBhcmd1bWVudDogKihzZWVkKSouXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IFtiXSkgLT4gKiAtPiBbYl1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24uIHJlY2VpdmVzIG9uZSBhcmd1bWVudCwgYHNlZWRgLCBhbmQgcmV0dXJuc1xuICAgICAqICAgICAgICBlaXRoZXIgZmFsc2UgdG8gcXVpdCBpdGVyYXRpb24gb3IgYW4gYXJyYXkgb2YgbGVuZ3RoIHR3byB0byBwcm9jZWVkLiBUaGUgZWxlbWVudFxuICAgICAqICAgICAgICBhdCBpbmRleCAwIG9mIHRoaXMgYXJyYXkgd2lsbCBiZSBhZGRlZCB0byB0aGUgcmVzdWx0aW5nIGFycmF5LCBhbmQgdGhlIGVsZW1lbnRcbiAgICAgKiAgICAgICAgYXQgaW5kZXggMSB3aWxsIGJlIHBhc3NlZCB0byB0aGUgbmV4dCBjYWxsIHRvIGBmbmAuXG4gICAgICogQHBhcmFtIHsqfSBzZWVkIFRoZSBzZWVkIHZhbHVlLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgZmluYWwgbGlzdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZiA9IGZ1bmN0aW9uKG4pIHsgcmV0dXJuIG4gPiA1MCA/IGZhbHNlIDogWy1uLCBuICsgMTBdIH07XG4gICAgICogICAgICBSLnVuZm9sZChmLCAxMCk7IC8vPT4gWy0xMCwgLTIwLCAtMzAsIC00MCwgLTUwXVxuICAgICAqL1xuICAgIHZhciB1bmZvbGQgPSBfY3VycnkyKGZ1bmN0aW9uIHVuZm9sZChmbiwgc2VlZCkge1xuICAgICAgICB2YXIgcGFpciA9IGZuKHNlZWQpO1xuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHdoaWxlIChwYWlyICYmIHBhaXIubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBwYWlyWzBdO1xuICAgICAgICAgICAgcGFpciA9IGZuKHBhaXJbMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29udGFpbmluZyBvbmx5IG9uZSBjb3B5IG9mIGVhY2ggZWxlbWVudCBpbiB0aGUgb3JpZ2luYWwgbGlzdCwgYmFzZWRcbiAgICAgKiB1cG9uIHRoZSB2YWx1ZSByZXR1cm5lZCBieSBhcHBseWluZyB0aGUgc3VwcGxpZWQgcHJlZGljYXRlIHRvIHR3byBsaXN0IGVsZW1lbnRzLiBQcmVmZXJzXG4gICAgICogdGhlIGZpcnN0IGl0ZW0gaWYgdHdvIGl0ZW1zIGNvbXBhcmUgZXF1YWwgYmFzZWQgb24gdGhlIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEsIGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgQSBwcmVkaWNhdGUgdXNlZCB0byB0ZXN0IHdoZXRoZXIgdHdvIGl0ZW1zIGFyZSBlcXVhbC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3Qgb2YgdW5pcXVlIGl0ZW1zLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBzdHJFcSA9IGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIFN0cmluZyhhKSA9PT0gU3RyaW5nKGIpOyB9O1xuICAgICAqICAgICAgUi51bmlxV2l0aChzdHJFcSkoWzEsICcxJywgMiwgMV0pOyAvLz0+IFsxLCAyXVxuICAgICAqICAgICAgUi51bmlxV2l0aChzdHJFcSkoW3t9LCB7fV0pOyAgICAgICAvLz0+IFt7fV1cbiAgICAgKiAgICAgIFIudW5pcVdpdGgoc3RyRXEpKFsxLCAnMScsIDFdKTsgICAgLy89PiBbMV1cbiAgICAgKiAgICAgIFIudW5pcVdpdGgoc3RyRXEpKFsnMScsIDEsIDFdKTsgICAgLy89PiBbJzEnXVxuICAgICAqL1xuICAgIHZhciB1bmlxV2l0aCA9IF9jdXJyeTIoZnVuY3Rpb24gdW5pcVdpdGgocHJlZCwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXSwgaXRlbTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgaXRlbSA9IGxpc3RbaWR4XTtcbiAgICAgICAgICAgIGlmICghX2NvbnRhaW5zV2l0aChwcmVkLCBpdGVtLCByZXN1bHQpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gaXRlbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGNvcHkgb2YgdGhlIGFycmF5IHdpdGggdGhlIGVsZW1lbnQgYXQgdGhlXG4gICAgICogcHJvdmlkZWQgaW5kZXggcmVwbGFjZWQgd2l0aCB0aGUgZ2l2ZW4gdmFsdWUuXG4gICAgICogQHNlZSBSLmFkanVzdFxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBOdW1iZXIgLT4gYSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlkeCBUaGUgaW5kZXggdG8gdXBkYXRlLlxuICAgICAqIEBwYXJhbSB7Kn0geCBUaGUgdmFsdWUgdG8gZXhpc3QgYXQgdGhlIGdpdmVuIGluZGV4IG9mIHRoZSByZXR1cm5lZCBhcnJheS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fEFyZ3VtZW50c30gbGlzdCBUaGUgc291cmNlIGFycmF5LWxpa2Ugb2JqZWN0IHRvIGJlIHVwZGF0ZWQuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgY29weSBvZiBgbGlzdGAgd2l0aCB0aGUgdmFsdWUgYXQgaW5kZXggYGlkeGAgcmVwbGFjZWQgd2l0aCBgeGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi51cGRhdGUoMSwgMTEsIFswLCAxLCAyXSk7ICAgICAvLz0+IFswLCAxMSwgMl1cbiAgICAgKiAgICAgIFIudXBkYXRlKDEpKDExKShbMCwgMSwgMl0pOyAgICAgLy89PiBbMCwgMTEsIDJdXG4gICAgICovXG4gICAgdmFyIHVwZGF0ZSA9IF9jdXJyeTMoZnVuY3Rpb24gdXBkYXRlKGlkeCwgeCwgbGlzdCkge1xuICAgICAgICByZXR1cm4gYWRqdXN0KGFsd2F5cyh4KSwgaWR4LCBsaXN0KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsaXN0IG9mIGFsbCB0aGUgZW51bWVyYWJsZSBvd24gcHJvcGVydGllcyBvZiB0aGUgc3VwcGxpZWQgb2JqZWN0LlxuICAgICAqIE5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgdGhlIG91dHB1dCBhcnJheSBpcyBub3QgZ3VhcmFudGVlZCBhY3Jvc3NcbiAgICAgKiBkaWZmZXJlbnQgSlMgcGxhdGZvcm1zLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHtrOiB2fSAtPiBbdl1cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gZXh0cmFjdCB2YWx1ZXMgZnJvbVxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBvZiB0aGUgdmFsdWVzIG9mIHRoZSBvYmplY3QncyBvd24gcHJvcGVydGllcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnZhbHVlcyh7YTogMSwgYjogMiwgYzogM30pOyAvLz0+IFsxLCAyLCAzXVxuICAgICAqL1xuICAgIHZhciB2YWx1ZXMgPSBfY3VycnkxKGZ1bmN0aW9uIHZhbHVlcyhvYmopIHtcbiAgICAgICAgdmFyIHByb3BzID0ga2V5cyhvYmopO1xuICAgICAgICB2YXIgbGVuID0gcHJvcHMubGVuZ3RoO1xuICAgICAgICB2YXIgdmFscyA9IFtdO1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgdmFsc1tpZHhdID0gb2JqW3Byb3BzW2lkeF1dO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHM7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBhbGwgdGhlIHByb3BlcnRpZXMsIGluY2x1ZGluZyBwcm90b3R5cGUgcHJvcGVydGllcyxcbiAgICAgKiBvZiB0aGUgc3VwcGxpZWQgb2JqZWN0LlxuICAgICAqIE5vdGUgdGhhdCB0aGUgb3JkZXIgb2YgdGhlIG91dHB1dCBhcnJheSBpcyBub3QgZ3VhcmFudGVlZCB0byBiZVxuICAgICAqIGNvbnNpc3RlbnQgYWNyb3NzIGRpZmZlcmVudCBKUyBwbGF0Zm9ybXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge2s6IHZ9IC0+IFt2XVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBleHRyYWN0IHZhbHVlcyBmcm9tXG4gICAgICogQHJldHVybiB7QXJyYXl9IEFuIGFycmF5IG9mIHRoZSB2YWx1ZXMgb2YgdGhlIG9iamVjdCdzIG93biBhbmQgcHJvdG90eXBlIHByb3BlcnRpZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIEYgPSBmdW5jdGlvbigpIHsgdGhpcy54ID0gJ1gnOyB9O1xuICAgICAqICAgICAgRi5wcm90b3R5cGUueSA9ICdZJztcbiAgICAgKiAgICAgIHZhciBmID0gbmV3IEYoKTtcbiAgICAgKiAgICAgIFIudmFsdWVzSW4oZik7IC8vPT4gWydYJywgJ1knXVxuICAgICAqL1xuICAgIHZhciB2YWx1ZXNJbiA9IF9jdXJyeTEoZnVuY3Rpb24gdmFsdWVzSW4ob2JqKSB7XG4gICAgICAgIHZhciBwcm9wLCB2cyA9IFtdO1xuICAgICAgICBmb3IgKHByb3AgaW4gb2JqKSB7XG4gICAgICAgICAgICB2c1t2cy5sZW5ndGhdID0gb2JqW3Byb3BdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2cztcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBcInZpZXdcIiBvZiB0aGUgZ2l2ZW4gZGF0YSBzdHJ1Y3R1cmUsIGRldGVybWluZWQgYnkgdGhlIGdpdmVuIGxlbnMuXG4gICAgICogVGhlIGxlbnMncyBmb2N1cyBkZXRlcm1pbmVzIHdoaWNoIHBvcnRpb24gb2YgdGhlIGRhdGEgc3RydWN0dXJlIGlzIHZpc2libGUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEB0eXBlZGVmIExlbnMgcyBhID0gRnVuY3RvciBmID0+IChhIC0+IGYgYSkgLT4gcyAtPiBmIHNcbiAgICAgKiBAc2lnIExlbnMgcyBhIC0+IHMgLT4gYVxuICAgICAqIEBwYXJhbSB7TGVuc30gbGVuc1xuICAgICAqIEBwYXJhbSB7Kn0geFxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICogQHNlZSBSLnByb3AsIFIubGVuc0luZGV4LCBSLmxlbnNQcm9wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhMZW5zID0gUi5sZW5zUHJvcCgneCcpO1xuICAgICAqXG4gICAgICogICAgICBSLnZpZXcoeExlbnMsIHt4OiAxLCB5OiAyfSk7ICAvLz0+IDFcbiAgICAgKiAgICAgIFIudmlldyh4TGVucywge3g6IDQsIHk6IDJ9KTsgIC8vPT4gNFxuICAgICAqL1xuICAgIHZhciB2aWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgQ29uc3QgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogeCxcbiAgICAgICAgICAgICAgICBtYXA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gdmlldyhsZW5zLCB4KSB7XG4gICAgICAgICAgICByZXR1cm4gbGVucyhDb25zdCkoeCkudmFsdWU7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIC8qKlxuICAgICAqIFRha2VzIGEgc3BlYyBvYmplY3QgYW5kIGEgdGVzdCBvYmplY3Q7IHJldHVybnMgdHJ1ZSBpZiB0aGUgdGVzdCBzYXRpc2ZpZXNcbiAgICAgKiB0aGUgc3BlYy4gRWFjaCBvZiB0aGUgc3BlYydzIG93biBwcm9wZXJ0aWVzIG11c3QgYmUgYSBwcmVkaWNhdGUgZnVuY3Rpb24uXG4gICAgICogRWFjaCBwcmVkaWNhdGUgaXMgYXBwbGllZCB0byB0aGUgdmFsdWUgb2YgdGhlIGNvcnJlc3BvbmRpbmcgcHJvcGVydHkgb2ZcbiAgICAgKiB0aGUgdGVzdCBvYmplY3QuIGB3aGVyZWAgcmV0dXJucyB0cnVlIGlmIGFsbCB0aGUgcHJlZGljYXRlcyByZXR1cm4gdHJ1ZSxcbiAgICAgKiBmYWxzZSBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBgd2hlcmVgIGlzIHdlbGwgc3VpdGVkIHRvIGRlY2xhcmF0aXZlbHkgZXhwcmVzc2luZyBjb25zdHJhaW50cyBmb3Igb3RoZXJcbiAgICAgKiBmdW5jdGlvbnMgc3VjaCBhcyBgZmlsdGVyYCBhbmQgYGZpbmRgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHtTdHJpbmc6ICgqIC0+IEJvb2xlYW4pfSAtPiB7U3RyaW5nOiAqfSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNwZWNcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gdGVzdE9ialxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gcHJlZCA6OiBPYmplY3QgLT4gQm9vbGVhblxuICAgICAqICAgICAgdmFyIHByZWQgPSBSLndoZXJlKHtcbiAgICAgKiAgICAgICAgYTogUi5lcXVhbHMoJ2ZvbycpLFxuICAgICAqICAgICAgICBiOiBSLmNvbXBsZW1lbnQoUi5lcXVhbHMoJ2JhcicpKSxcbiAgICAgKiAgICAgICAgeDogUi5ndChfLCAxMCksXG4gICAgICogICAgICAgIHk6IFIubHQoXywgMjApXG4gICAgICogICAgICB9KTtcbiAgICAgKlxuICAgICAqICAgICAgcHJlZCh7YTogJ2ZvbycsIGI6ICd4eHgnLCB4OiAxMSwgeTogMTl9KTsgLy89PiB0cnVlXG4gICAgICogICAgICBwcmVkKHthOiAneHh4JywgYjogJ3h4eCcsIHg6IDExLCB5OiAxOX0pOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBwcmVkKHthOiAnZm9vJywgYjogJ2JhcicsIHg6IDExLCB5OiAxOX0pOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBwcmVkKHthOiAnZm9vJywgYjogJ3h4eCcsIHg6IDEwLCB5OiAxOX0pOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBwcmVkKHthOiAnZm9vJywgYjogJ3h4eCcsIHg6IDExLCB5OiAyMH0pOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIHdoZXJlID0gX2N1cnJ5MihmdW5jdGlvbiB3aGVyZShzcGVjLCB0ZXN0T2JqKSB7XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gc3BlYykge1xuICAgICAgICAgICAgaWYgKF9oYXMocHJvcCwgc3BlYykgJiYgIXNwZWNbcHJvcF0odGVzdE9ialtwcm9wXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBXcmFwIGEgZnVuY3Rpb24gaW5zaWRlIGFub3RoZXIgdG8gYWxsb3cgeW91IHRvIG1ha2UgYWRqdXN0bWVudHMgdG8gdGhlIHBhcmFtZXRlcnMsIG9yIGRvXG4gICAgICogb3RoZXIgcHJvY2Vzc2luZyBlaXRoZXIgYmVmb3JlIHRoZSBpbnRlcm5hbCBmdW5jdGlvbiBpcyBjYWxsZWQgb3Igd2l0aCBpdHMgcmVzdWx0cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIChhLi4uIC0+IGIpIC0+ICgoYS4uLiAtPiBiKSAtPiBhLi4uIC0+IGMpIC0+IChhLi4uIC0+IGMpXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIHdyYXAuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gd3JhcHBlciBUaGUgd3JhcHBlciBmdW5jdGlvbi5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gVGhlIHdyYXBwZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGdyZWV0ID0gZnVuY3Rpb24obmFtZSkge3JldHVybiAnSGVsbG8gJyArIG5hbWU7fTtcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHNob3V0ZWRHcmVldCA9IFIud3JhcChncmVldCwgZnVuY3Rpb24oZ3IsIG5hbWUpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGdyKG5hbWUpLnRvVXBwZXJDYXNlKCk7XG4gICAgICogICAgICB9KTtcbiAgICAgKiAgICAgIHNob3V0ZWRHcmVldChcIkthdGh5XCIpOyAvLz0+IFwiSEVMTE8gS0FUSFlcIlxuICAgICAqXG4gICAgICogICAgICB2YXIgc2hvcnRlbmVkR3JlZXQgPSBSLndyYXAoZ3JlZXQsIGZ1bmN0aW9uKGdyLCBuYW1lKSB7XG4gICAgICogICAgICAgIHJldHVybiBncihuYW1lLnN1YnN0cmluZygwLCAzKSk7XG4gICAgICogICAgICB9KTtcbiAgICAgKiAgICAgIHNob3J0ZW5lZEdyZWV0KFwiUm9iZXJ0XCIpOyAvLz0+IFwiSGVsbG8gUm9iXCJcbiAgICAgKi9cbiAgICB2YXIgd3JhcCA9IF9jdXJyeTIoZnVuY3Rpb24gd3JhcChmbiwgd3JhcHBlcikge1xuICAgICAgICByZXR1cm4gY3VycnlOKGZuLmxlbmd0aCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHdyYXBwZXIuYXBwbHkodGhpcywgX2NvbmNhdChbZm5dLCBhcmd1bWVudHMpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGxpc3Qgb3V0IG9mIHRoZSB0d28gc3VwcGxpZWQgYnkgY3JlYXRpbmcgZWFjaCBwb3NzaWJsZVxuICAgICAqIHBhaXIgZnJvbSB0aGUgbGlzdHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBbYl0gLT4gW1thLGJdXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFzIFRoZSBmaXJzdCBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGJzIFRoZSBzZWNvbmQgbGlzdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3QgbWFkZSBieSBjb21iaW5pbmcgZWFjaCBwb3NzaWJsZSBwYWlyIGZyb21cbiAgICAgKiAgICAgICAgIGBhc2AgYW5kIGBic2AgaW50byBwYWlycyAoYFthLCBiXWApLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIueHByb2QoWzEsIDJdLCBbJ2EnLCAnYiddKTsgLy89PiBbWzEsICdhJ10sIFsxLCAnYiddLCBbMiwgJ2EnXSwgWzIsICdiJ11dXG4gICAgICovXG4gICAgLy8gPSB4cHJvZFdpdGgocHJlcGVuZCk7ICh0YWtlcyBhYm91dCAzIHRpbWVzIGFzIGxvbmcuLi4pXG4gICAgdmFyIHhwcm9kID0gX2N1cnJ5MihmdW5jdGlvbiB4cHJvZChhLCBiKSB7XG4gICAgICAgIC8vID0geHByb2RXaXRoKHByZXBlbmQpOyAodGFrZXMgYWJvdXQgMyB0aW1lcyBhcyBsb25nLi4uKVxuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgdmFyIGlsZW4gPSBhLmxlbmd0aDtcbiAgICAgICAgdmFyIGo7XG4gICAgICAgIHZhciBqbGVuID0gYi5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGlsZW4pIHtcbiAgICAgICAgICAgIGogPSAwO1xuICAgICAgICAgICAgd2hpbGUgKGogPCBqbGVuKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gW1xuICAgICAgICAgICAgICAgICAgICBhW2lkeF0sXG4gICAgICAgICAgICAgICAgICAgIGJbal1cbiAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGxpc3Qgb3V0IG9mIHRoZSB0d28gc3VwcGxpZWQgYnkgcGFpcmluZyB1cFxuICAgICAqIGVxdWFsbHktcG9zaXRpb25lZCBpdGVtcyBmcm9tIGJvdGggbGlzdHMuICBUaGUgcmV0dXJuZWQgbGlzdCBpc1xuICAgICAqIHRydW5jYXRlZCB0byB0aGUgbGVuZ3RoIG9mIHRoZSBzaG9ydGVyIG9mIHRoZSB0d28gaW5wdXQgbGlzdHMuXG4gICAgICogTm90ZTogYHppcGAgaXMgZXF1aXZhbGVudCB0byBgemlwV2l0aChmdW5jdGlvbihhLCBiKSB7IHJldHVybiBbYSwgYl0gfSlgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbYV0gLT4gW2JdIC0+IFtbYSxiXV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MSBUaGUgZmlyc3QgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdDIgVGhlIHNlY29uZCBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3QgbWFkZSBieSBwYWlyaW5nIHVwIHNhbWUtaW5kZXhlZCBlbGVtZW50cyBvZiBgbGlzdDFgIGFuZCBgbGlzdDJgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuemlwKFsxLCAyLCAzXSwgWydhJywgJ2InLCAnYyddKTsgLy89PiBbWzEsICdhJ10sIFsyLCAnYiddLCBbMywgJ2MnXV1cbiAgICAgKi9cbiAgICB2YXIgemlwID0gX2N1cnJ5MihmdW5jdGlvbiB6aXAoYSwgYikge1xuICAgICAgICB2YXIgcnYgPSBbXTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1pbihhLmxlbmd0aCwgYi5sZW5ndGgpO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBydltpZHhdID0gW1xuICAgICAgICAgICAgICAgIGFbaWR4XSxcbiAgICAgICAgICAgICAgICBiW2lkeF1cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcnY7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IG9iamVjdCBvdXQgb2YgYSBsaXN0IG9mIGtleXMgYW5kIGEgbGlzdCBvZiB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFtTdHJpbmddIC0+IFsqXSAtPiB7U3RyaW5nOiAqfVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGtleXMgVGhlIGFycmF5IHRoYXQgd2lsbCBiZSBwcm9wZXJ0aWVzIG9uIHRoZSBvdXRwdXQgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBUaGUgbGlzdCBvZiB2YWx1ZXMgb24gdGhlIG91dHB1dCBvYmplY3QuXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBUaGUgb2JqZWN0IG1hZGUgYnkgcGFpcmluZyB1cCBzYW1lLWluZGV4ZWQgZWxlbWVudHMgb2YgYGtleXNgIGFuZCBgdmFsdWVzYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnppcE9iaihbJ2EnLCAnYicsICdjJ10sIFsxLCAyLCAzXSk7IC8vPT4ge2E6IDEsIGI6IDIsIGM6IDN9XG4gICAgICovXG4gICAgdmFyIHppcE9iaiA9IF9jdXJyeTIoZnVuY3Rpb24gemlwT2JqKGtleXMsIHZhbHVlcykge1xuICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0ga2V5cy5sZW5ndGgsIG91dCA9IHt9O1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBvdXRba2V5c1tpZHhdXSA9IHZhbHVlc1tpZHhdO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgbGlzdCBvdXQgb2YgdGhlIHR3byBzdXBwbGllZCBieSBhcHBseWluZyB0aGUgZnVuY3Rpb24gdG9cbiAgICAgKiBlYWNoIGVxdWFsbHktcG9zaXRpb25lZCBwYWlyIGluIHRoZSBsaXN0cy4gVGhlIHJldHVybmVkIGxpc3QgaXNcbiAgICAgKiB0cnVuY2F0ZWQgdG8gdGhlIGxlbmd0aCBvZiB0aGUgc2hvcnRlciBvZiB0aGUgdHdvIGlucHV0IGxpc3RzLlxuICAgICAqXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEsYiAtPiBjKSAtPiBbYV0gLT4gW2JdIC0+IFtjXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB1c2VkIHRvIGNvbWJpbmUgdGhlIHR3byBlbGVtZW50cyBpbnRvIG9uZSB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MSBUaGUgZmlyc3QgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdDIgVGhlIHNlY29uZCBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3QgbWFkZSBieSBjb21iaW5pbmcgc2FtZS1pbmRleGVkIGVsZW1lbnRzIG9mIGBsaXN0MWAgYW5kIGBsaXN0MmBcbiAgICAgKiAgICAgICAgIHVzaW5nIGBmbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGYgPSBmdW5jdGlvbih4LCB5KSB7XG4gICAgICogICAgICAgIC8vIC4uLlxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIFIuemlwV2l0aChmLCBbMSwgMiwgM10sIFsnYScsICdiJywgJ2MnXSk7XG4gICAgICogICAgICAvLz0+IFtmKDEsICdhJyksIGYoMiwgJ2InKSwgZigzLCAnYycpXVxuICAgICAqL1xuICAgIHZhciB6aXBXaXRoID0gX2N1cnJ5MyhmdW5jdGlvbiB6aXBXaXRoKGZuLCBhLCBiKSB7XG4gICAgICAgIHZhciBydiA9IFtdLCBpZHggPSAwLCBsZW4gPSBNYXRoLm1pbihhLmxlbmd0aCwgYi5sZW5ndGgpO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBydltpZHhdID0gZm4oYVtpZHhdLCBiW2lkeF0pO1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJ2O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0aGF0IGFsd2F5cyByZXR1cm5zIGBmYWxzZWAuIEFueSBwYXNzZWQgaW4gcGFyYW1ldGVycyBhcmUgaWdub3JlZC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICogLT4gZmFsc2VcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBmYWxzZVxuICAgICAqIEBzZWUgUi5hbHdheXMsIFIuVFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuRigpOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIEYgPSBhbHdheXMoZmFsc2UpO1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0aGF0IGFsd2F5cyByZXR1cm5zIGB0cnVlYC4gQW55IHBhc3NlZCBpbiBwYXJhbWV0ZXJzIGFyZSBpZ25vcmVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKiAtPiB0cnVlXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgLlxuICAgICAqIEBzZWUgUi5hbHdheXMsIFIuRlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuVCgpOyAvLz0+IHRydWVcbiAgICAgKi9cbiAgICB2YXIgVCA9IGFsd2F5cyh0cnVlKTtcblxuICAgIC8qKlxuICAgICAqIFNpbWlsYXIgdG8gaGFzTWV0aG9kLCB0aGlzIGNoZWNrcyB3aGV0aGVyIGEgZnVuY3Rpb24gaGFzIGEgW21ldGhvZG5hbWVdXG4gICAgICogZnVuY3Rpb24uIElmIGl0IGlzbid0IGFuIGFycmF5IGl0IHdpbGwgZXhlY3V0ZSB0aGF0IGZ1bmN0aW9uIG90aGVyd2lzZSBpdCB3aWxsXG4gICAgICogZGVmYXVsdCB0byB0aGUgcmFtZGEgaW1wbGVtZW50YXRpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIHJhbWRhIGltcGxlbXRhdGlvblxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2RuYW1lIHByb3BlcnR5IHRvIGNoZWNrIGZvciBhIGN1c3RvbSBpbXBsZW1lbnRhdGlvblxuICAgICAqIEByZXR1cm4ge09iamVjdH0gV2hhdGV2ZXIgdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgbWV0aG9kIGlzLlxuICAgICAqL1xuICAgIHZhciBfY2hlY2tGb3JNZXRob2QgPSBmdW5jdGlvbiBfY2hlY2tGb3JNZXRob2QobWV0aG9kbmFtZSwgZm4pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKGxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9iaiA9IGFyZ3VtZW50c1tsZW5ndGggLSAxXTtcbiAgICAgICAgICAgIHJldHVybiBfaXNBcnJheShvYmopIHx8IHR5cGVvZiBvYmpbbWV0aG9kbmFtZV0gIT09ICdmdW5jdGlvbicgPyBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpIDogb2JqW21ldGhvZG5hbWVdLmFwcGx5KG9iaiwgX3NsaWNlKGFyZ3VtZW50cywgMCwgbGVuZ3RoIC0gMSkpO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgYW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBiZSBjb3BpZWRcbiAgICAgKiBAcGFyYW0ge0FycmF5fSByZWZGcm9tIEFycmF5IGNvbnRhaW5pbmcgdGhlIHNvdXJjZSByZWZlcmVuY2VzXG4gICAgICogQHBhcmFtIHtBcnJheX0gcmVmVG8gQXJyYXkgY29udGFpbmluZyB0aGUgY29waWVkIHNvdXJjZSByZWZlcmVuY2VzXG4gICAgICogQHJldHVybiB7Kn0gVGhlIGNvcGllZCB2YWx1ZS5cbiAgICAgKi9cbiAgICB2YXIgX2Nsb25lID0gZnVuY3Rpb24gX2Nsb25lKHZhbHVlLCByZWZGcm9tLCByZWZUbykge1xuICAgICAgICB2YXIgY29weSA9IGZ1bmN0aW9uIGNvcHkoY29waWVkVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBsZW4gPSByZWZGcm9tLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gcmVmRnJvbVtpZHhdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWZUb1tpZHhdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlZkZyb21baWR4ICsgMV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHJlZlRvW2lkeCArIDFdID0gY29waWVkVmFsdWU7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb3BpZWRWYWx1ZVtrZXldID0gX2Nsb25lKHZhbHVlW2tleV0sIHJlZkZyb20sIHJlZlRvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb3BpZWRWYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgc3dpdGNoICh0eXBlKHZhbHVlKSkge1xuICAgICAgICBjYXNlICdPYmplY3QnOlxuICAgICAgICAgICAgcmV0dXJuIGNvcHkoe30pO1xuICAgICAgICBjYXNlICdBcnJheSc6XG4gICAgICAgICAgICByZXR1cm4gY29weShbXSk7XG4gICAgICAgIGNhc2UgJ0RhdGUnOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHZhbHVlKTtcbiAgICAgICAgY2FzZSAnUmVnRXhwJzpcbiAgICAgICAgICAgIHJldHVybiBfY2xvbmVSZWdFeHAodmFsdWUpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBfY3JlYXRlUGFydGlhbEFwcGxpY2F0b3IgPSBmdW5jdGlvbiBfY3JlYXRlUGFydGlhbEFwcGxpY2F0b3IoY29uY2F0KSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gX3NsaWNlKGFyZ3VtZW50cywgMSk7XG4gICAgICAgICAgICByZXR1cm4gX2FyaXR5KE1hdGgubWF4KDAsIGZuLmxlbmd0aCAtIGFyZ3MubGVuZ3RoKSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBjb25jYXQoYXJncywgYXJndW1lbnRzKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgZGlzcGF0Y2hlcyB3aXRoIGRpZmZlcmVudCBzdHJhdGVnaWVzIGJhc2VkIG9uIHRoZVxuICAgICAqIG9iamVjdCBpbiBsaXN0IHBvc2l0aW9uIChsYXN0IGFyZ3VtZW50KS4gSWYgaXQgaXMgYW4gYXJyYXksIGV4ZWN1dGVzIFtmbl0uXG4gICAgICogT3RoZXJ3aXNlLCBpZiBpdCBoYXMgYSAgZnVuY3Rpb24gd2l0aCBbbWV0aG9kbmFtZV0sIGl0IHdpbGwgZXhlY3V0ZSB0aGF0XG4gICAgICogZnVuY3Rpb24gKGZ1bmN0b3IgY2FzZSkuIE90aGVyd2lzZSwgaWYgaXQgaXMgYSB0cmFuc2Zvcm1lciwgdXNlcyB0cmFuc2R1Y2VyXG4gICAgICogW3hmXSB0byByZXR1cm4gYSBuZXcgdHJhbnNmb3JtZXIgKHRyYW5zZHVjZXIgY2FzZSkuIE90aGVyd2lzZSwgaXQgd2lsbFxuICAgICAqIGRlZmF1bHQgdG8gZXhlY3V0aW5nIFtmbl0uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBtZXRob2RuYW1lIHByb3BlcnR5IHRvIGNoZWNrIGZvciBhIGN1c3RvbSBpbXBsZW1lbnRhdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHhmIHRyYW5zZHVjZXIgdG8gaW5pdGlhbGl6ZSBpZiBvYmplY3QgaXMgdHJhbnNmb3JtZXJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBkZWZhdWx0IHJhbWRhIGltcGxlbWVudGF0aW9uXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCBkaXNwYXRjaGVzIG9uIG9iamVjdCBpbiBsaXN0IHBvc2l0aW9uXG4gICAgICovXG4gICAgdmFyIF9kaXNwYXRjaGFibGUgPSBmdW5jdGlvbiBfZGlzcGF0Y2hhYmxlKG1ldGhvZG5hbWUsIHhmLCBmbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICAgICAgICBpZiAobGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzW2xlbmd0aCAtIDFdO1xuICAgICAgICAgICAgaWYgKCFfaXNBcnJheShvYmopKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBfc2xpY2UoYXJndW1lbnRzLCAwLCBsZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9ialttZXRob2RuYW1lXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqW21ldGhvZG5hbWVdLmFwcGx5KG9iaiwgYXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChfaXNUcmFuc2Zvcm1lcihvYmopKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2R1Y2VyID0geGYuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2R1Y2VyKG9iaik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIC8vIFRoZSBhbGdvcml0aG0gdXNlZCB0byBoYW5kbGUgY3ljbGljIHN0cnVjdHVyZXMgaXNcbiAgICAvLyBpbnNwaXJlZCBieSB1bmRlcnNjb3JlJ3MgaXNFcXVhbFxuICAgIC8vIFJlZ0V4cCBlcXVhbGl0eSBhbGdvcml0aG06IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzEwNzc2NjM1XG4gICAgdmFyIF9lcXVhbHMgPSBmdW5jdGlvbiBfZXF1YWxzKGEsIGIsIHN0YWNrQSwgc3RhY2tCKSB7XG4gICAgICAgIHZhciB0eXBlQSA9IHR5cGUoYSk7XG4gICAgICAgIGlmICh0eXBlQSAhPT0gdHlwZShiKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlQSA9PT0gJ0Jvb2xlYW4nIHx8IHR5cGVBID09PSAnTnVtYmVyJyB8fCB0eXBlQSA9PT0gJ1N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYSA9PT0gJ29iamVjdCcgPyB0eXBlb2YgYiA9PT0gJ29iamVjdCcgJiYgaWRlbnRpY2FsKGEudmFsdWVPZigpLCBiLnZhbHVlT2YoKSkgOiBpZGVudGljYWwoYSwgYik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlkZW50aWNhbChhLCBiKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVBID09PSAnUmVnRXhwJykge1xuICAgICAgICAgICAgLy8gUmVnRXhwIGVxdWFsaXR5IGFsZ29yaXRobTogaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTA3NzY2MzVcbiAgICAgICAgICAgIHJldHVybiBhLnNvdXJjZSA9PT0gYi5zb3VyY2UgJiYgYS5nbG9iYWwgPT09IGIuZ2xvYmFsICYmIGEuaWdub3JlQ2FzZSA9PT0gYi5pZ25vcmVDYXNlICYmIGEubXVsdGlsaW5lID09PSBiLm11bHRpbGluZSAmJiBhLnN0aWNreSA9PT0gYi5zdGlja3kgJiYgYS51bmljb2RlID09PSBiLnVuaWNvZGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKE9iamVjdChhKSA9PT0gYSkge1xuICAgICAgICAgICAgaWYgKHR5cGVBID09PSAnRGF0ZScgJiYgYS5nZXRUaW1lKCkgIT09IGIuZ2V0VGltZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGtleXNBID0ga2V5cyhhKTtcbiAgICAgICAgICAgIGlmIChrZXlzQS5sZW5ndGggIT09IGtleXMoYikubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlkeCA9IHN0YWNrQS5sZW5ndGggLSAxO1xuICAgICAgICAgICAgd2hpbGUgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YWNrQVtpZHhdID09PSBhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFja0JbaWR4XSA9PT0gYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4IC09IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdGFja0Fbc3RhY2tBLmxlbmd0aF0gPSBhO1xuICAgICAgICAgICAgc3RhY2tCW3N0YWNrQi5sZW5ndGhdID0gYjtcbiAgICAgICAgICAgIGlkeCA9IGtleXNBLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB3aGlsZSAoaWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0ga2V5c0FbaWR4XTtcbiAgICAgICAgICAgICAgICBpZiAoIV9oYXMoa2V5LCBiKSB8fCAhX2VxdWFscyhiW2tleV0sIGFba2V5XSwgc3RhY2tBLCBzdGFja0IpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4IC09IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdGFja0EucG9wKCk7XG4gICAgICAgICAgICBzdGFja0IucG9wKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFByaXZhdGUgZnVuY3Rpb24gdGhhdCBkZXRlcm1pbmVzIHdoZXRoZXIgb3Igbm90IGEgcHJvdmlkZWQgb2JqZWN0IGhhcyBhIGdpdmVuIG1ldGhvZC5cbiAgICAgKiBEb2VzIG5vdCBpZ25vcmUgbWV0aG9kcyBzdG9yZWQgb24gdGhlIG9iamVjdCdzIHByb3RvdHlwZSBjaGFpbi4gVXNlZCBmb3IgZHluYW1pY2FsbHlcbiAgICAgKiBkaXNwYXRjaGluZyBSYW1kYSBtZXRob2RzIHRvIG5vbi1BcnJheSBvYmplY3RzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWV0aG9kTmFtZSBUaGUgbmFtZSBvZiB0aGUgbWV0aG9kIHRvIGNoZWNrIGZvci5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gdGVzdC5cbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaGFzIGEgZ2l2ZW4gbWV0aG9kLCBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgcGVyc29uID0geyBuYW1lOiAnSm9obicgfTtcbiAgICAgKiAgICAgIHBlcnNvbi5zaG91dCA9IGZ1bmN0aW9uKCkgeyBhbGVydCh0aGlzLm5hbWUpOyB9O1xuICAgICAqXG4gICAgICogICAgICBfaGFzTWV0aG9kKCdzaG91dCcsIHBlcnNvbik7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgX2hhc01ldGhvZCgnZm9vJywgcGVyc29uKTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBfaGFzTWV0aG9kID0gZnVuY3Rpb24gX2hhc01ldGhvZChtZXRob2ROYW1lLCBvYmopIHtcbiAgICAgICAgcmV0dXJuIG9iaiAhPSBudWxsICYmICFfaXNBcnJheShvYmopICYmIHR5cGVvZiBvYmpbbWV0aG9kTmFtZV0gPT09ICdmdW5jdGlvbic7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGBfbWFrZUZsYXRgIGlzIGEgaGVscGVyIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIG9uZS1sZXZlbCBvciBmdWxseSByZWN1cnNpdmUgZnVuY3Rpb25cbiAgICAgKiBiYXNlZCBvbiB0aGUgZmxhZyBwYXNzZWQgaW4uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHZhciBfbWFrZUZsYXQgPSBmdW5jdGlvbiBfbWFrZUZsYXQocmVjdXJzaXZlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBmbGF0dChsaXN0KSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUsIHJlc3VsdCA9IFtdLCBpZHggPSAwLCBqLCBpbGVuID0gbGlzdC5sZW5ndGgsIGpsZW47XG4gICAgICAgICAgICB3aGlsZSAoaWR4IDwgaWxlbikge1xuICAgICAgICAgICAgICAgIGlmIChpc0FycmF5TGlrZShsaXN0W2lkeF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gcmVjdXJzaXZlID8gZmxhdHQobGlzdFtpZHhdKSA6IGxpc3RbaWR4XTtcbiAgICAgICAgICAgICAgICAgICAgaiA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGpsZW4gPSB2YWx1ZS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChqIDwgamxlbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0W3Jlc3VsdC5sZW5ndGhdID0gdmFsdWVbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBqICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRbcmVzdWx0Lmxlbmd0aF0gPSBsaXN0W2lkeF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgdmFyIF9yZWR1Y2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIF9hcnJheVJlZHVjZSh4ZiwgYWNjLCBsaXN0KSB7XG4gICAgICAgICAgICB2YXIgaWR4ID0gMCwgbGVuID0gbGlzdC5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICAgICAgYWNjID0geGZbJ0BAdHJhbnNkdWNlci9zdGVwJ10oYWNjLCBsaXN0W2lkeF0pO1xuICAgICAgICAgICAgICAgIGlmIChhY2MgJiYgYWNjWydAQHRyYW5zZHVjZXIvcmVkdWNlZCddKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjYyA9IGFjY1snQEB0cmFuc2R1Y2VyL3ZhbHVlJ107XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB4ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKGFjYyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gX2l0ZXJhYmxlUmVkdWNlKHhmLCBhY2MsIGl0ZXIpIHtcbiAgICAgICAgICAgIHZhciBzdGVwID0gaXRlci5uZXh0KCk7XG4gICAgICAgICAgICB3aGlsZSAoIXN0ZXAuZG9uZSkge1xuICAgICAgICAgICAgICAgIGFjYyA9IHhmWydAQHRyYW5zZHVjZXIvc3RlcCddKGFjYywgc3RlcC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGFjYyAmJiBhY2NbJ0BAdHJhbnNkdWNlci9yZWR1Y2VkJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjID0gYWNjWydAQHRyYW5zZHVjZXIvdmFsdWUnXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0ZXAgPSBpdGVyLm5leHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB4ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKGFjYyk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gX21ldGhvZFJlZHVjZSh4ZiwgYWNjLCBvYmopIHtcbiAgICAgICAgICAgIHJldHVybiB4ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKG9iai5yZWR1Y2UoYmluZCh4ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSwgeGYpLCBhY2MpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3ltSXRlcmF0b3IgPSB0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyA/IFN5bWJvbC5pdGVyYXRvciA6ICdAQGl0ZXJhdG9yJztcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIF9yZWR1Y2UoZm4sIGFjYywgbGlzdCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGZuID0gX3h3cmFwKGZuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpc0FycmF5TGlrZShsaXN0KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfYXJyYXlSZWR1Y2UoZm4sIGFjYywgbGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIGxpc3QucmVkdWNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9tZXRob2RSZWR1Y2UoZm4sIGFjYywgbGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGlzdFtzeW1JdGVyYXRvcl0gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfaXRlcmFibGVSZWR1Y2UoZm4sIGFjYywgbGlzdFtzeW1JdGVyYXRvcl0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIGxpc3QubmV4dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBfaXRlcmFibGVSZWR1Y2UoZm4sIGFjYywgbGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdyZWR1Y2U6IGxpc3QgbXVzdCBiZSBhcnJheSBvciBpdGVyYWJsZScpO1xuICAgICAgICB9O1xuICAgIH0oKTtcblxuICAgIHZhciBfc3RlcENhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9zdGVwQ2F0QXJyYXkgPSB7XG4gICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL2luaXQnOiBBcnJheSxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvc3RlcCc6IGZ1bmN0aW9uICh4cywgeCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfY29uY2F0KHhzLCBbeF0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvcmVzdWx0JzogX2lkZW50aXR5XG4gICAgICAgIH07XG4gICAgICAgIHZhciBfc3RlcENhdFN0cmluZyA9IHtcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvaW5pdCc6IFN0cmluZyxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvc3RlcCc6IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGEgKyBiO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvcmVzdWx0JzogX2lkZW50aXR5XG4gICAgICAgIH07XG4gICAgICAgIHZhciBfc3RlcENhdE9iamVjdCA9IHtcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvaW5pdCc6IE9iamVjdCxcbiAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvc3RlcCc6IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lcmdlKHJlc3VsdCwgaXNBcnJheUxpa2UoaW5wdXQpID8gY3JlYXRlTWFwRW50cnkoaW5wdXRbMF0sIGlucHV0WzFdKSA6IGlucHV0KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnQEB0cmFuc2R1Y2VyL3Jlc3VsdCc6IF9pZGVudGl0eVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gX3N0ZXBDYXQob2JqKSB7XG4gICAgICAgICAgICBpZiAoX2lzVHJhbnNmb3JtZXIob2JqKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNBcnJheUxpa2Uob2JqKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfc3RlcENhdEFycmF5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmogPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zdGVwQ2F0U3RyaW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zdGVwQ2F0T2JqZWN0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY3JlYXRlIHRyYW5zZm9ybWVyIGZvciAnICsgb2JqKTtcbiAgICAgICAgfTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hhbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhBbGwoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgICAgICB0aGlzLmFsbCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgWEFsbC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhBbGwucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbGwpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIFhBbGwucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5mKGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gX3JlZHVjZWQodGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIGZhbHNlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGFsbChmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYQWxsKGYsIHhmKTtcbiAgICAgICAgfSk7XG4gICAgfSgpO1xuXG4gICAgdmFyIF94YW55ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYQW55KGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICAgICAgdGhpcy5hbnkgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBYQW55LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWEFueS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5hbnkpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXShyZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgICBYQW55LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5mKGlucHV0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW55ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBfcmVkdWNlZCh0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdHJ1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3hhbnkoZiwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWEFueShmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeGRyb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhEcm9wKG4sIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLm4gPSBuO1xuICAgICAgICB9XG4gICAgICAgIFhEcm9wLnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL2luaXQnXSA9IF94ZkJhc2UuaW5pdDtcbiAgICAgICAgWERyb3AucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBfeGZCYXNlLnJlc3VsdDtcbiAgICAgICAgWERyb3AucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm4gPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uIC09IDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgaW5wdXQpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX2N1cnJ5MihmdW5jdGlvbiBfeGRyb3AobiwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWERyb3AobiwgeGYpO1xuICAgICAgICB9KTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX3hkcm9wV2hpbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhEcm9wV2hpbGUoZiwgeGYpIHtcbiAgICAgICAgICAgIHRoaXMueGYgPSB4ZjtcbiAgICAgICAgICAgIHRoaXMuZiA9IGY7XG4gICAgICAgIH1cbiAgICAgICAgWERyb3BXaGlsZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhEcm9wV2hpbGUucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvcmVzdWx0J10gPSBfeGZCYXNlLnJlc3VsdDtcbiAgICAgICAgWERyb3BXaGlsZS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9zdGVwJ10gPSBmdW5jdGlvbiAocmVzdWx0LCBpbnB1dCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmYoaW5wdXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZiA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIGlucHV0KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF9jdXJyeTIoZnVuY3Rpb24gX3hkcm9wV2hpbGUoZiwgeGYpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWERyb3BXaGlsZShmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIHZhciBfeGdyb3VwQnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFhHcm91cEJ5KGYsIHhmKSB7XG4gICAgICAgICAgICB0aGlzLnhmID0geGY7XG4gICAgICAgICAgICB0aGlzLmYgPSBmO1xuICAgICAgICAgICAgdGhpcy5pbnB1dHMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBYR3JvdXBCeS5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gICAgICAgIFhHcm91cEJ5LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgdmFyIGtleTtcbiAgICAgICAgICAgIGZvciAoa2V5IGluIHRoaXMuaW5wdXRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKF9oYXMoa2V5LCB0aGlzLmlucHV0cykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3N0ZXAnXShyZXN1bHQsIHRoaXMuaW5wdXRzW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0WydAQHRyYW5zZHVjZXIvcmVkdWNlZCddKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHRbJ0BAdHJhbnNkdWNlci92YWx1ZSddO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy54ZlsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICAgIFhHcm91cEJ5LnByb3RvdHlwZVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSA9IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5mKGlucHV0KTtcbiAgICAgICAgICAgIHRoaXMuaW5wdXRzW2tleV0gPSB0aGlzLmlucHV0c1trZXldIHx8IFtcbiAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgW11cbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICB0aGlzLmlucHV0c1trZXldWzFdID0gYXBwZW5kKGlucHV0LCB0aGlzLmlucHV0c1trZXldWzFdKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfY3VycnkyKGZ1bmN0aW9uIF94Z3JvdXBCeShmLCB4Zikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBYR3JvdXBCeShmLCB4Zik7XG4gICAgICAgIH0pO1xuICAgIH0oKTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgbGlzdCBpdGVyYXRpb24gZnVuY3Rpb24gZnJvbSBhbiBleGlzdGluZyBvbmUgYnkgYWRkaW5nIHR3byBuZXcgcGFyYW1ldGVyc1xuICAgICAqIHRvIGl0cyBjYWxsYmFjayBmdW5jdGlvbjogdGhlIGN1cnJlbnQgaW5kZXgsIGFuZCB0aGUgZW50aXJlIGxpc3QuXG4gICAgICpcbiAgICAgKiBUaGlzIHdvdWxkIHR1cm4sIGZvciBpbnN0YW5jZSwgUmFtZGEncyBzaW1wbGUgYG1hcGAgZnVuY3Rpb24gaW50byBvbmUgdGhhdCBtb3JlIGNsb3NlbHlcbiAgICAgKiByZXNlbWJsZXMgYEFycmF5LnByb3RvdHlwZS5tYXBgLiAgTm90ZSB0aGF0IHRoaXMgd2lsbCBvbmx5IHdvcmsgZm9yIGZ1bmN0aW9ucyBpbiB3aGljaFxuICAgICAqIHRoZSBpdGVyYXRpb24gY2FsbGJhY2sgZnVuY3Rpb24gaXMgdGhlIGZpcnN0IHBhcmFtZXRlciwgYW5kIHdoZXJlIHRoZSBsaXN0IGlzIHRoZSBsYXN0XG4gICAgICogcGFyYW1ldGVyLiAgKFRoaXMgbGF0dGVyIG1pZ2h0IGJlIHVuaW1wb3J0YW50IGlmIHRoZSBsaXN0IHBhcmFtZXRlciBpcyBub3QgdXNlZC4pXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnICgoYSAuLi4gLT4gYikgLi4uIC0+IFthXSAtPiAqKSAtPiAoYSAuLi4sIEludCwgW2FdIC0+IGIpIC4uLiAtPiBbYV0gLT4gKilcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBBIGxpc3QgaXRlcmF0aW9uIGZ1bmN0aW9uIHRoYXQgZG9lcyBub3QgcGFzcyBpbmRleCBvciBsaXN0IHRvIGl0cyBjYWxsYmFja1xuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBbiBhbHRlcmVkIGxpc3QgaXRlcmF0aW9uIGZ1bmN0aW9uIHRoYXQgcGFzc2VzIChpdGVtLCBpbmRleCwgbGlzdCkgdG8gaXRzIGNhbGxiYWNrXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG1hcEluZGV4ZWQgPSBSLmFkZEluZGV4KFIubWFwKTtcbiAgICAgKiAgICAgIG1hcEluZGV4ZWQoZnVuY3Rpb24odmFsLCBpZHgpIHtyZXR1cm4gaWR4ICsgJy0nICsgdmFsO30sIFsnZicsICdvJywgJ28nLCAnYicsICdhJywgJ3InXSk7XG4gICAgICogICAgICAvLz0+IFsnMC1mJywgJzEtbycsICcyLW8nLCAnMy1iJywgJzQtYScsICc1LXInXVxuICAgICAqL1xuICAgIHZhciBhZGRJbmRleCA9IF9jdXJyeTEoZnVuY3Rpb24gYWRkSW5kZXgoZm4pIHtcbiAgICAgICAgcmV0dXJuIGN1cnJ5Tihmbi5sZW5ndGgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICAgICAgdmFyIG9yaWdGbiA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIHZhciBhcmdzID0gX3NsaWNlKGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBhcmdzWzBdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBvcmlnRm4uYXBwbHkodGhpcywgX2NvbmNhdChhcmd1bWVudHMsIFtcbiAgICAgICAgICAgICAgICAgICAgaWR4LFxuICAgICAgICAgICAgICAgICAgICBsaXN0XG4gICAgICAgICAgICAgICAgXSkpO1xuICAgICAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIGFsbCBlbGVtZW50cyBvZiB0aGUgbGlzdCBtYXRjaCB0aGUgcHJlZGljYXRlLCBgZmFsc2VgIGlmIHRoZXJlIGFyZSBhbnlcbiAgICAgKiB0aGF0IGRvbid0LlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgcHJlZGljYXRlIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiB0aGUgcHJlZGljYXRlIGlzIHNhdGlzZmllZCBieSBldmVyeSBlbGVtZW50LCBgZmFsc2VgXG4gICAgICogICAgICAgICBvdGhlcndpc2UuXG4gICAgICogQHNlZSBSLmFueSwgUi5ub25lXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGxlc3NUaGFuMiA9IFIuZmxpcChSLmx0KSgyKTtcbiAgICAgKiAgICAgIHZhciBsZXNzVGhhbjMgPSBSLmZsaXAoUi5sdCkoMyk7XG4gICAgICogICAgICBSLmFsbChsZXNzVGhhbjIpKFsxLCAyXSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuYWxsKGxlc3NUaGFuMykoWzEsIDJdKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGFsbCA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgnYWxsJywgX3hhbGwsIGZ1bmN0aW9uIGFsbChmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoIWZuKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgZmlyc3QgYXJndW1lbnQgaWYgaXQncyBmYWxzeSBvdGhlcndpc2UgdGhlIHNlY29uZFxuICAgICAqIGFyZ3VtZW50LiBOb3RlIHRoYXQgdGhpcyBpcyBOT1Qgc2hvcnQtY2lyY3VpdGVkLCBtZWFuaW5nIHRoYXQgaWYgZXhwcmVzc2lvbnNcbiAgICAgKiBhcmUgcGFzc2VkIHRoZXkgYXJlIGJvdGggZXZhbHVhdGVkLlxuICAgICAqXG4gICAgICogRGlzcGF0Y2hlcyB0byB0aGUgYGFuZGAgbWV0aG9kIG9mIHRoZSBmaXJzdCBhcmd1bWVudCBpZiBhcHBsaWNhYmxlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMb2dpY1xuICAgICAqIEBzaWcgKiAtPiAqIC0+ICpcbiAgICAgKiBAcGFyYW0geyp9IGEgYW55IHZhbHVlXG4gICAgICogQHBhcmFtIHsqfSBiIGFueSBvdGhlciB2YWx1ZVxuICAgICAqIEByZXR1cm4geyp9IHRoZSBmaXJzdCBhcmd1bWVudCBpZiBmYWxzeSBvdGhlcndpc2UgdGhlIHNlY29uZCBhcmd1bWVudC5cbiAgICAgKiBAc2VlIFIuYm90aFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuYW5kKGZhbHNlLCB0cnVlKTsgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5hbmQoMCwgW10pOyAvLz0+IDBcbiAgICAgKiAgICAgIFIuYW5kKG51bGwsICcnKTsgPT4gbnVsbFxuICAgICAqL1xuICAgIHZhciBhbmQgPSBfY3VycnkyKGZ1bmN0aW9uIGFuZChhLCBiKSB7XG4gICAgICAgIHJldHVybiBfaGFzTWV0aG9kKCdhbmQnLCBhKSA/IGEuYW5kKGIpIDogYSAmJiBiO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgYXQgbGVhc3Qgb25lIG9mIGVsZW1lbnRzIG9mIHRoZSBsaXN0IG1hdGNoIHRoZSBwcmVkaWNhdGUsIGBmYWxzZWBcbiAgICAgKiBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBwcmVkaWNhdGUgaXMgc2F0aXNmaWVkIGJ5IGF0IGxlYXN0IG9uZSBlbGVtZW50LCBgZmFsc2VgXG4gICAgICogICAgICAgICBvdGhlcndpc2UuXG4gICAgICogQHNlZSBSLmFsbCwgUi5ub25lXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGxlc3NUaGFuMCA9IFIuZmxpcChSLmx0KSgwKTtcbiAgICAgKiAgICAgIHZhciBsZXNzVGhhbjIgPSBSLmZsaXAoUi5sdCkoMik7XG4gICAgICogICAgICBSLmFueShsZXNzVGhhbjApKFsxLCAyXSk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuYW55KGxlc3NUaGFuMikoWzEsIDJdKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGFueSA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgnYW55JywgX3hhbnksIGZ1bmN0aW9uIGFueShmbiwgbGlzdCkge1xuICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoZm4obGlzdFtpZHhdKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFdyYXBzIGEgZnVuY3Rpb24gb2YgYW55IGFyaXR5IChpbmNsdWRpbmcgbnVsbGFyeSkgaW4gYSBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgZXhhY3RseSAyXG4gICAgICogcGFyYW1ldGVycy4gQW55IGV4dHJhbmVvdXMgcGFyYW1ldGVycyB3aWxsIG5vdCBiZSBwYXNzZWQgdG8gdGhlIHN1cHBsaWVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKCogLT4gYykgLT4gKGEsIGIgLT4gYylcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcgZnVuY3Rpb24gd3JhcHBpbmcgYGZuYC4gVGhlIG5ldyBmdW5jdGlvbiBpcyBndWFyYW50ZWVkIHRvIGJlIG9mXG4gICAgICogICAgICAgICBhcml0eSAyLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB0YWtlc1RocmVlQXJncyA9IGZ1bmN0aW9uKGEsIGIsIGMpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIFthLCBiLCBjXTtcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICB0YWtlc1RocmVlQXJncy5sZW5ndGg7IC8vPT4gM1xuICAgICAqICAgICAgdGFrZXNUaHJlZUFyZ3MoMSwgMiwgMyk7IC8vPT4gWzEsIDIsIDNdXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB0YWtlc1R3b0FyZ3MgPSBSLmJpbmFyeSh0YWtlc1RocmVlQXJncyk7XG4gICAgICogICAgICB0YWtlc1R3b0FyZ3MubGVuZ3RoOyAvLz0+IDJcbiAgICAgKiAgICAgIC8vIE9ubHkgMiBhcmd1bWVudHMgYXJlIHBhc3NlZCB0byB0aGUgd3JhcHBlZCBmdW5jdGlvblxuICAgICAqICAgICAgdGFrZXNUd29BcmdzKDEsIDIsIDMpOyAvLz0+IFsxLCAyLCB1bmRlZmluZWRdXG4gICAgICovXG4gICAgdmFyIGJpbmFyeSA9IF9jdXJyeTEoZnVuY3Rpb24gYmluYXJ5KGZuKSB7XG4gICAgICAgIHJldHVybiBuQXJ5KDIsIGZuKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBkZWVwIGNvcHkgb2YgdGhlIHZhbHVlIHdoaWNoIG1heSBjb250YWluIChuZXN0ZWQpIGBBcnJheWBzIGFuZFxuICAgICAqIGBPYmplY3RgcywgYE51bWJlcmBzLCBgU3RyaW5nYHMsIGBCb29sZWFuYHMgYW5kIGBEYXRlYHMuIGBGdW5jdGlvbmBzIGFyZVxuICAgICAqIG5vdCBjb3BpZWQsIGJ1dCBhc3NpZ25lZCBieSB0aGVpciByZWZlcmVuY2UuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgeyp9IC0+IHsqfVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIG9iamVjdCBvciBhcnJheSB0byBjbG9uZVxuICAgICAqIEByZXR1cm4geyp9IEEgbmV3IG9iamVjdCBvciBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgb2JqZWN0cyA9IFt7fSwge30sIHt9XTtcbiAgICAgKiAgICAgIHZhciBvYmplY3RzQ2xvbmUgPSBSLmNsb25lKG9iamVjdHMpO1xuICAgICAqICAgICAgb2JqZWN0c1swXSA9PT0gb2JqZWN0c0Nsb25lWzBdOyAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGNsb25lID0gX2N1cnJ5MShmdW5jdGlvbiBjbG9uZSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gX2Nsb25lKHZhbHVlLCBbXSwgW10pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IGNvbnNpc3Rpbmcgb2YgdGhlIGVsZW1lbnRzIG9mIHRoZSBmaXJzdCBsaXN0IGZvbGxvd2VkIGJ5IHRoZSBlbGVtZW50c1xuICAgICAqIG9mIHRoZSBzZWNvbmQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdDEgVGhlIGZpcnN0IGxpc3QgdG8gbWVyZ2UuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdDIgVGhlIHNlY29uZCBzZXQgdG8gbWVyZ2UuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IGFycmF5IGNvbnNpc3Rpbmcgb2YgdGhlIGNvbnRlbnRzIG9mIGBsaXN0MWAgZm9sbG93ZWQgYnkgdGhlXG4gICAgICogICAgICAgICBjb250ZW50cyBvZiBgbGlzdDJgLiBJZiwgaW5zdGVhZCBvZiBhbiBBcnJheSBmb3IgYGxpc3QxYCwgeW91IHBhc3MgYW5cbiAgICAgKiAgICAgICAgIG9iamVjdCB3aXRoIGEgYGNvbmNhdGAgbWV0aG9kIG9uIGl0LCBgY29uY2F0YCB3aWxsIGNhbGwgYGxpc3QxLmNvbmNhdGBcbiAgICAgKiAgICAgICAgIGFuZCBwYXNzIGl0IHRoZSB2YWx1ZSBvZiBgbGlzdDJgLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5jb25jYXQoW10sIFtdKTsgLy89PiBbXVxuICAgICAqICAgICAgUi5jb25jYXQoWzQsIDUsIDZdLCBbMSwgMiwgM10pOyAvLz0+IFs0LCA1LCA2LCAxLCAyLCAzXVxuICAgICAqICAgICAgUi5jb25jYXQoJ0FCQycsICdERUYnKTsgLy8gJ0FCQ0RFRidcbiAgICAgKi9cbiAgICB2YXIgY29uY2F0ID0gX2N1cnJ5MihmdW5jdGlvbiBjb25jYXQoc2V0MSwgc2V0Mikge1xuICAgICAgICBpZiAoX2lzQXJyYXkoc2V0MikpIHtcbiAgICAgICAgICAgIHJldHVybiBfY29uY2F0KHNldDEsIHNldDIpO1xuICAgICAgICB9IGVsc2UgaWYgKF9oYXNNZXRob2QoJ2NvbmNhdCcsIHNldDEpKSB7XG4gICAgICAgICAgICByZXR1cm4gc2V0MS5jb25jYXQoc2V0Mik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdjYW5cXCd0IGNvbmNhdCAnICsgdHlwZW9mIHNldDEpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgY3VycmllZCBlcXVpdmFsZW50IG9mIHRoZSBwcm92aWRlZCBmdW5jdGlvbi4gVGhlIGN1cnJpZWRcbiAgICAgKiBmdW5jdGlvbiBoYXMgdHdvIHVudXN1YWwgY2FwYWJpbGl0aWVzLiBGaXJzdCwgaXRzIGFyZ3VtZW50cyBuZWVkbid0XG4gICAgICogYmUgcHJvdmlkZWQgb25lIGF0IGEgdGltZS4gSWYgYGZgIGlzIGEgdGVybmFyeSBmdW5jdGlvbiBhbmQgYGdgIGlzXG4gICAgICogYFIuY3VycnkoZilgLCB0aGUgZm9sbG93aW5nIGFyZSBlcXVpdmFsZW50OlxuICAgICAqXG4gICAgICogICAtIGBnKDEpKDIpKDMpYFxuICAgICAqICAgLSBgZygxKSgyLCAzKWBcbiAgICAgKiAgIC0gYGcoMSwgMikoMylgXG4gICAgICogICAtIGBnKDEsIDIsIDMpYFxuICAgICAqXG4gICAgICogU2Vjb25kbHksIHRoZSBzcGVjaWFsIHBsYWNlaG9sZGVyIHZhbHVlIGBSLl9fYCBtYXkgYmUgdXNlZCB0byBzcGVjaWZ5XG4gICAgICogXCJnYXBzXCIsIGFsbG93aW5nIHBhcnRpYWwgYXBwbGljYXRpb24gb2YgYW55IGNvbWJpbmF0aW9uIG9mIGFyZ3VtZW50cyxcbiAgICAgKiByZWdhcmRsZXNzIG9mIHRoZWlyIHBvc2l0aW9ucy4gSWYgYGdgIGlzIGFzIGFib3ZlIGFuZCBgX2AgaXMgYFIuX19gLFxuICAgICAqIHRoZSBmb2xsb3dpbmcgYXJlIGVxdWl2YWxlbnQ6XG4gICAgICpcbiAgICAgKiAgIC0gYGcoMSwgMiwgMylgXG4gICAgICogICAtIGBnKF8sIDIsIDMpKDEpYFxuICAgICAqICAgLSBgZyhfLCBfLCAzKSgxKSgyKWBcbiAgICAgKiAgIC0gYGcoXywgXywgMykoMSwgMilgXG4gICAgICogICAtIGBnKF8sIDIpKDEpKDMpYFxuICAgICAqICAgLSBgZyhfLCAyKSgxLCAzKWBcbiAgICAgKiAgIC0gYGcoXywgMikoXywgMykoMSlgXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKiAtPiBhKSAtPiAoKiAtPiBhKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBjdXJyeS5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcsIGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICogQHNlZSBSLmN1cnJ5TlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBhZGRGb3VyTnVtYmVycyA9IGZ1bmN0aW9uKGEsIGIsIGMsIGQpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGEgKyBiICsgYyArIGQ7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICB2YXIgY3VycmllZEFkZEZvdXJOdW1iZXJzID0gUi5jdXJyeShhZGRGb3VyTnVtYmVycyk7XG4gICAgICogICAgICB2YXIgZiA9IGN1cnJpZWRBZGRGb3VyTnVtYmVycygxLCAyKTtcbiAgICAgKiAgICAgIHZhciBnID0gZigzKTtcbiAgICAgKiAgICAgIGcoNCk7IC8vPT4gMTBcbiAgICAgKi9cbiAgICB2YXIgY3VycnkgPSBfY3VycnkxKGZ1bmN0aW9uIGN1cnJ5KGZuKSB7XG4gICAgICAgIHJldHVybiBjdXJyeU4oZm4ubGVuZ3RoLCBmbik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29udGFpbmluZyB0aGUgbGFzdCBgbmAgZWxlbWVudHMgb2YgYSBnaXZlbiBsaXN0LCBwYXNzaW5nIGVhY2ggdmFsdWVcbiAgICAgKiB0byB0aGUgc3VwcGxpZWQgcHJlZGljYXRlIGZ1bmN0aW9uLCBza2lwcGluZyBlbGVtZW50cyB3aGlsZSB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uIHJldHVybnNcbiAgICAgKiBgdHJ1ZWAuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gaXMgcGFzc2VkIG9uZSBhcmd1bWVudDogKih2YWx1ZSkqLlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgYXJyYXkuXG4gICAgICogQHNlZSBSLnRha2VXaGlsZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBsdGVUd28gPSBmdW5jdGlvbih4KSB7XG4gICAgICogICAgICAgIHJldHVybiB4IDw9IDI7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBSLmRyb3BXaGlsZShsdGVUd28sIFsxLCAyLCAzLCA0LCAzLCAyLCAxXSk7IC8vPT4gWzMsIDQsIDMsIDIsIDFdXG4gICAgICovXG4gICAgdmFyIGRyb3BXaGlsZSA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgnZHJvcFdoaWxlJywgX3hkcm9wV2hpbGUsIGZ1bmN0aW9uIGRyb3BXaGlsZShwcmVkLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSAwLCBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbiAmJiBwcmVkKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc2xpY2UobGlzdCwgaWR4KTtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiBpdHMgYXJndW1lbnRzIGFyZSBlcXVpdmFsZW50LCBgZmFsc2VgIG90aGVyd2lzZS5cbiAgICAgKiBEaXNwYXRjaGVzIHRvIGFuIGBlcXVhbHNgIG1ldGhvZCBpZiBwcmVzZW50LiBIYW5kbGVzIGN5Y2xpY2FsIGRhdGFcbiAgICAgKiBzdHJ1Y3R1cmVzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgYSAtPiBiIC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0geyp9IGFcbiAgICAgKiBAcGFyYW0geyp9IGJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZXF1YWxzKDEsIDEpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIuZXF1YWxzKDEsICcxJyk7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuZXF1YWxzKFsxLCAyLCAzXSwgWzEsIDIsIDNdKTsgLy89PiB0cnVlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBhID0ge307IGEudiA9IGE7XG4gICAgICogICAgICB2YXIgYiA9IHt9OyBiLnYgPSBiO1xuICAgICAqICAgICAgUi5lcXVhbHMoYSwgYik7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBlcXVhbHMgPSBfY3VycnkyKGZ1bmN0aW9uIGVxdWFscyhhLCBiKSB7XG4gICAgICAgIHJldHVybiBfaGFzTWV0aG9kKCdlcXVhbHMnLCBhKSA/IGEuZXF1YWxzKGIpIDogX2hhc01ldGhvZCgnZXF1YWxzJywgYikgPyBiLmVxdWFscyhhKSA6IF9lcXVhbHMoYSwgYiwgW10sIFtdKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIG9ubHkgdGhvc2UgaXRlbXMgdGhhdCBtYXRjaCBhIGdpdmVuIHByZWRpY2F0ZSBmdW5jdGlvbi5cbiAgICAgKiBUaGUgcHJlZGljYXRlIGZ1bmN0aW9uIGlzIHBhc3NlZCBvbmUgYXJndW1lbnQ6ICoodmFsdWUpKi5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBgUi5maWx0ZXJgIGRvZXMgbm90IHNraXAgZGVsZXRlZCBvciB1bmFzc2lnbmVkIGluZGljZXMsIHVubGlrZSB0aGUgbmF0aXZlXG4gICAgICogYEFycmF5LnByb3RvdHlwZS5maWx0ZXJgIG1ldGhvZC4gRm9yIG1vcmUgZGV0YWlscyBvbiB0aGlzIGJlaGF2aW9yLCBzZWU6XG4gICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvZmlsdGVyI0Rlc2NyaXB0aW9uXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbmV3IGZpbHRlcmVkIGFycmF5LlxuICAgICAqIEBzZWUgUi5yZWplY3RcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaXNFdmVuID0gZnVuY3Rpb24obikge1xuICAgICAqICAgICAgICByZXR1cm4gbiAlIDIgPT09IDA7XG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgUi5maWx0ZXIoaXNFdmVuLCBbMSwgMiwgMywgNF0pOyAvLz0+IFsyLCA0XVxuICAgICAqL1xuICAgIHZhciBmaWx0ZXIgPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ2ZpbHRlcicsIF94ZmlsdGVyLCBfZmlsdGVyKSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBmaXJzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZSwgb3IgYHVuZGVmaW5lZGAgaWYgbm9cbiAgICAgKiBlbGVtZW50IG1hdGNoZXMuXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gYSB8IHVuZGVmaW5lZFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gdXNlZCB0byBkZXRlcm1pbmUgaWYgdGhlIGVsZW1lbnQgaXMgdGhlXG4gICAgICogICAgICAgIGRlc2lyZWQgb25lLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gVGhlIGVsZW1lbnQgZm91bmQsIG9yIGB1bmRlZmluZWRgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB4cyA9IFt7YTogMX0sIHthOiAyfSwge2E6IDN9XTtcbiAgICAgKiAgICAgIFIuZmluZChSLnByb3BFcSgnYScsIDIpKSh4cyk7IC8vPT4ge2E6IDJ9XG4gICAgICogICAgICBSLmZpbmQoUi5wcm9wRXEoJ2EnLCA0KSkoeHMpOyAvLz0+IHVuZGVmaW5lZFxuICAgICAqL1xuICAgIHZhciBmaW5kID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdmaW5kJywgX3hmaW5kLCBmdW5jdGlvbiBmaW5kKGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB2YXIgbGVuID0gbGlzdC5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChmbihsaXN0W2lkeF0pKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RbaWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGxpc3Qgd2hpY2ggbWF0Y2hlcyB0aGUgcHJlZGljYXRlLCBvciBgLTFgXG4gICAgICogaWYgbm8gZWxlbWVudCBtYXRjaGVzLlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBwcmVkaWNhdGUgZnVuY3Rpb24gdXNlZCB0byBkZXRlcm1pbmUgaWYgdGhlIGVsZW1lbnQgaXMgdGhlXG4gICAgICogZGVzaXJlZCBvbmUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgaW5kZXggb2YgdGhlIGVsZW1lbnQgZm91bmQsIG9yIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhzID0gW3thOiAxfSwge2E6IDJ9LCB7YTogM31dO1xuICAgICAqICAgICAgUi5maW5kSW5kZXgoUi5wcm9wRXEoJ2EnLCAyKSkoeHMpOyAvLz0+IDFcbiAgICAgKiAgICAgIFIuZmluZEluZGV4KFIucHJvcEVxKCdhJywgNCkpKHhzKTsgLy89PiAtMVxuICAgICAqL1xuICAgIHZhciBmaW5kSW5kZXggPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ2ZpbmRJbmRleCcsIF94ZmluZEluZGV4LCBmdW5jdGlvbiBmaW5kSW5kZXgoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGZuKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWR4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgbGlzdCB3aGljaCBtYXRjaGVzIHRoZSBwcmVkaWNhdGUsIG9yIGB1bmRlZmluZWRgIGlmIG5vXG4gICAgICogZWxlbWVudCBtYXRjaGVzLlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IGEgfCB1bmRlZmluZWRcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgcHJlZGljYXRlIGZ1bmN0aW9uIHVzZWQgdG8gZGV0ZXJtaW5lIGlmIHRoZSBlbGVtZW50IGlzIHRoZVxuICAgICAqIGRlc2lyZWQgb25lLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gVGhlIGVsZW1lbnQgZm91bmQsIG9yIGB1bmRlZmluZWRgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB4cyA9IFt7YTogMSwgYjogMH0sIHthOjEsIGI6IDF9XTtcbiAgICAgKiAgICAgIFIuZmluZExhc3QoUi5wcm9wRXEoJ2EnLCAxKSkoeHMpOyAvLz0+IHthOiAxLCBiOiAxfVxuICAgICAqICAgICAgUi5maW5kTGFzdChSLnByb3BFcSgnYScsIDQpKSh4cyk7IC8vPT4gdW5kZWZpbmVkXG4gICAgICovXG4gICAgdmFyIGZpbmRMYXN0ID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdmaW5kTGFzdCcsIF94ZmluZExhc3QsIGZ1bmN0aW9uIGZpbmRMYXN0KGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgIHdoaWxlIChpZHggPj0gMCkge1xuICAgICAgICAgICAgaWYgKGZuKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFtpZHhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4IC09IDE7XG4gICAgICAgIH1cbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IG9mIHRoZSBsaXN0IHdoaWNoIG1hdGNoZXMgdGhlIHByZWRpY2F0ZSwgb3JcbiAgICAgKiBgLTFgIGlmIG5vIGVsZW1lbnQgbWF0Y2hlcy5cbiAgICAgKlxuICAgICAqIEFjdHMgYXMgYSB0cmFuc2R1Y2VyIGlmIGEgdHJhbnNmb3JtZXIgaXMgZ2l2ZW4gaW4gbGlzdCBwb3NpdGlvbi5cbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgcHJlZGljYXRlIGZ1bmN0aW9uIHVzZWQgdG8gZGV0ZXJtaW5lIGlmIHRoZSBlbGVtZW50IGlzIHRoZVxuICAgICAqIGRlc2lyZWQgb25lLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIGluZGV4IG9mIHRoZSBlbGVtZW50IGZvdW5kLCBvciBgLTFgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB4cyA9IFt7YTogMSwgYjogMH0sIHthOjEsIGI6IDF9XTtcbiAgICAgKiAgICAgIFIuZmluZExhc3RJbmRleChSLnByb3BFcSgnYScsIDEpKSh4cyk7IC8vPT4gMVxuICAgICAqICAgICAgUi5maW5kTGFzdEluZGV4KFIucHJvcEVxKCdhJywgNCkpKHhzKTsgLy89PiAtMVxuICAgICAqL1xuICAgIHZhciBmaW5kTGFzdEluZGV4ID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdmaW5kTGFzdEluZGV4JywgX3hmaW5kTGFzdEluZGV4LCBmdW5jdGlvbiBmaW5kTGFzdEluZGV4KGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBpZHggPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgIHdoaWxlIChpZHggPj0gMCkge1xuICAgICAgICAgICAgaWYgKGZuKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWR4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4IC09IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBieSBwdWxsaW5nIGV2ZXJ5IGl0ZW0gb3V0IG9mIGl0IChhbmQgYWxsIGl0cyBzdWItYXJyYXlzKSBhbmQgcHV0dGluZ1xuICAgICAqIHRoZW0gaW4gYSBuZXcgYXJyYXksIGRlcHRoLWZpcnN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbYV0gLT4gW2JdXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBmbGF0dGVuZWQgbGlzdC5cbiAgICAgKiBAc2VlIFIudW5uZXN0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5mbGF0dGVuKFsxLCAyLCBbMywgNF0sIDUsIFs2LCBbNywgOCwgWzksIFsxMCwgMTFdLCAxMl1dXV0pO1xuICAgICAqICAgICAgLy89PiBbMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAxMl1cbiAgICAgKi9cbiAgICB2YXIgZmxhdHRlbiA9IF9jdXJyeTEoX21ha2VGbGF0KHRydWUpKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgZnVuY3Rpb24gbXVjaCBsaWtlIHRoZSBzdXBwbGllZCBvbmUsIGV4Y2VwdCB0aGF0IHRoZSBmaXJzdCB0d28gYXJndW1lbnRzJ1xuICAgICAqIG9yZGVyIGlzIHJldmVyc2VkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKGEgLT4gYiAtPiBjIC0+IC4uLiAtPiB6KSAtPiAoYiAtPiBhIC0+IGMgLT4gLi4uIC0+IHopXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGludm9rZSB3aXRoIGl0cyBmaXJzdCB0d28gcGFyYW1ldGVycyByZXZlcnNlZC5cbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgcmVzdWx0IG9mIGludm9raW5nIGBmbmAgd2l0aCBpdHMgZmlyc3QgdHdvIHBhcmFtZXRlcnMnIG9yZGVyIHJldmVyc2VkLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBtZXJnZVRocmVlID0gZnVuY3Rpb24oYSwgYiwgYykge1xuICAgICAqICAgICAgICByZXR1cm4gKFtdKS5jb25jYXQoYSwgYiwgYyk7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBtZXJnZVRocmVlKDEsIDIsIDMpOyAvLz0+IFsxLCAyLCAzXVxuICAgICAqXG4gICAgICogICAgICBSLmZsaXAobWVyZ2VUaHJlZSkoMSwgMiwgMyk7IC8vPT4gWzIsIDEsIDNdXG4gICAgICovXG4gICAgdmFyIGZsaXAgPSBfY3VycnkxKGZ1bmN0aW9uIGZsaXAoZm4pIHtcbiAgICAgICAgcmV0dXJuIGN1cnJ5KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IF9zbGljZShhcmd1bWVudHMpO1xuICAgICAgICAgICAgYXJnc1swXSA9IGI7XG4gICAgICAgICAgICBhcmdzWzFdID0gYTtcbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlIG92ZXIgYW4gaW5wdXQgYGxpc3RgLCBjYWxsaW5nIGEgcHJvdmlkZWQgZnVuY3Rpb24gYGZuYCBmb3IgZWFjaCBlbGVtZW50IGluIHRoZVxuICAgICAqIGxpc3QuXG4gICAgICpcbiAgICAgKiBgZm5gIHJlY2VpdmVzIG9uZSBhcmd1bWVudDogKih2YWx1ZSkqLlxuICAgICAqXG4gICAgICogTm90ZTogYFIuZm9yRWFjaGAgZG9lcyBub3Qgc2tpcCBkZWxldGVkIG9yIHVuYXNzaWduZWQgaW5kaWNlcyAoc3BhcnNlIGFycmF5cyksIHVubGlrZVxuICAgICAqIHRoZSBuYXRpdmUgYEFycmF5LnByb3RvdHlwZS5mb3JFYWNoYCBtZXRob2QuIEZvciBtb3JlIGRldGFpbHMgb24gdGhpcyBiZWhhdmlvciwgc2VlOlxuICAgICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L2ZvckVhY2gjRGVzY3JpcHRpb25cbiAgICAgKlxuICAgICAqIEFsc28gbm90ZSB0aGF0LCB1bmxpa2UgYEFycmF5LnByb3RvdHlwZS5mb3JFYWNoYCwgUmFtZGEncyBgZm9yRWFjaGAgcmV0dXJucyB0aGUgb3JpZ2luYWxcbiAgICAgKiBhcnJheS4gSW4gc29tZSBsaWJyYXJpZXMgdGhpcyBmdW5jdGlvbiBpcyBuYW1lZCBgZWFjaGAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+ICopIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gaW52b2tlLiBSZWNlaXZlcyBvbmUgYXJndW1lbnQsIGB2YWx1ZWAuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBvcmlnaW5hbCBsaXN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBwcmludFhQbHVzRml2ZSA9IGZ1bmN0aW9uKHgpIHsgY29uc29sZS5sb2coeCArIDUpOyB9O1xuICAgICAqICAgICAgUi5mb3JFYWNoKHByaW50WFBsdXNGaXZlLCBbMSwgMiwgM10pOyAvLz0+IFsxLCAyLCAzXVxuICAgICAqICAgICAgLy8tPiA2XG4gICAgICogICAgICAvLy0+IDdcbiAgICAgKiAgICAgIC8vLT4gOFxuICAgICAqL1xuICAgIHZhciBmb3JFYWNoID0gX2N1cnJ5MihfY2hlY2tGb3JNZXRob2QoJ2ZvckVhY2gnLCBmdW5jdGlvbiBmb3JFYWNoKGZuLCBsaXN0KSB7XG4gICAgICAgIHZhciBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgIGZuKGxpc3RbaWR4XSk7XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGlzdDtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBmdW5jdGlvbiBuYW1lcyBvZiBvYmplY3QncyBvd24gZnVuY3Rpb25zXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgeyp9IC0+IFtTdHJpbmddXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0cyB3aXRoIGZ1bmN0aW9ucyBpbiBpdFxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIGxpc3Qgb2YgdGhlIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzIHRoYXQgbWFwIHRvIGZ1bmN0aW9ucy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmZ1bmN0aW9ucyhSKTsgLy8gcmV0dXJucyBsaXN0IG9mIHJhbWRhJ3Mgb3duIGZ1bmN0aW9uIG5hbWVzXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBGID0gZnVuY3Rpb24oKSB7IHRoaXMueCA9IGZ1bmN0aW9uKCl7fTsgdGhpcy55ID0gMTsgfVxuICAgICAqICAgICAgRi5wcm90b3R5cGUueiA9IGZ1bmN0aW9uKCkge307XG4gICAgICogICAgICBGLnByb3RvdHlwZS5hID0gMTAwO1xuICAgICAqICAgICAgUi5mdW5jdGlvbnMobmV3IEYoKSk7IC8vPT4gW1wieFwiXVxuICAgICAqL1xuICAgIHZhciBmdW5jdGlvbnMgPSBfY3VycnkxKF9mdW5jdGlvbnNXaXRoKGtleXMpKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsaXN0IG9mIGZ1bmN0aW9uIG5hbWVzIG9mIG9iamVjdCdzIG93biBhbmQgcHJvdG90eXBlIGZ1bmN0aW9uc1xuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIHsqfSAtPiBbU3RyaW5nXVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdHMgd2l0aCBmdW5jdGlvbnMgaW4gaXRcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBsaXN0IG9mIHRoZSBvYmplY3QncyBvd24gcHJvcGVydGllcyBhbmQgcHJvdG90eXBlXG4gICAgICogICAgICAgICBwcm9wZXJ0aWVzIHRoYXQgbWFwIHRvIGZ1bmN0aW9ucy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmZ1bmN0aW9uc0luKFIpOyAvLyByZXR1cm5zIGxpc3Qgb2YgcmFtZGEncyBvd24gYW5kIHByb3RvdHlwZSBmdW5jdGlvbiBuYW1lc1xuICAgICAqXG4gICAgICogICAgICB2YXIgRiA9IGZ1bmN0aW9uKCkgeyB0aGlzLnggPSBmdW5jdGlvbigpe307IHRoaXMueSA9IDE7IH1cbiAgICAgKiAgICAgIEYucHJvdG90eXBlLnogPSBmdW5jdGlvbigpIHt9O1xuICAgICAqICAgICAgRi5wcm90b3R5cGUuYSA9IDEwMDtcbiAgICAgKiAgICAgIFIuZnVuY3Rpb25zSW4obmV3IEYoKSk7IC8vPT4gW1wieFwiLCBcInpcIl1cbiAgICAgKi9cbiAgICB2YXIgZnVuY3Rpb25zSW4gPSBfY3VycnkxKF9mdW5jdGlvbnNXaXRoKGtleXNJbikpO1xuXG4gICAgLyoqXG4gICAgICogU3BsaXRzIGEgbGlzdCBpbnRvIHN1Yi1saXN0cyBzdG9yZWQgaW4gYW4gb2JqZWN0LCBiYXNlZCBvbiB0aGUgcmVzdWx0IG9mIGNhbGxpbmcgYSBTdHJpbmctcmV0dXJuaW5nIGZ1bmN0aW9uXG4gICAgICogb24gZWFjaCBlbGVtZW50LCBhbmQgZ3JvdXBpbmcgdGhlIHJlc3VsdHMgYWNjb3JkaW5nIHRvIHZhbHVlcyByZXR1cm5lZC5cbiAgICAgKlxuICAgICAqIEFjdHMgYXMgYSB0cmFuc2R1Y2VyIGlmIGEgdHJhbnNmb3JtZXIgaXMgZ2l2ZW4gaW4gbGlzdCBwb3NpdGlvbi5cbiAgICAgKiBAc2VlIFIudHJhbnNkdWNlXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IFN0cmluZykgLT4gW2FdIC0+IHtTdHJpbmc6IFthXX1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBGdW5jdGlvbiA6OiBhIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGdyb3VwXG4gICAgICogQHJldHVybiB7T2JqZWN0fSBBbiBvYmplY3Qgd2l0aCB0aGUgb3V0cHV0IG9mIGBmbmAgZm9yIGtleXMsIG1hcHBlZCB0byBhcnJheXMgb2YgZWxlbWVudHNcbiAgICAgKiAgICAgICAgIHRoYXQgcHJvZHVjZWQgdGhhdCBrZXkgd2hlbiBwYXNzZWQgdG8gYGZuYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYnlHcmFkZSA9IFIuZ3JvdXBCeShmdW5jdGlvbihzdHVkZW50KSB7XG4gICAgICogICAgICAgIHZhciBzY29yZSA9IHN0dWRlbnQuc2NvcmU7XG4gICAgICogICAgICAgIHJldHVybiBzY29yZSA8IDY1ID8gJ0YnIDpcbiAgICAgKiAgICAgICAgICAgICAgIHNjb3JlIDwgNzAgPyAnRCcgOlxuICAgICAqICAgICAgICAgICAgICAgc2NvcmUgPCA4MCA/ICdDJyA6XG4gICAgICogICAgICAgICAgICAgICBzY29yZSA8IDkwID8gJ0InIDogJ0EnO1xuICAgICAqICAgICAgfSk7XG4gICAgICogICAgICB2YXIgc3R1ZGVudHMgPSBbe25hbWU6ICdBYmJ5Jywgc2NvcmU6IDg0fSxcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICB7bmFtZTogJ0VkZHknLCBzY29yZTogNTh9LFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgIC8vIC4uLlxuICAgICAqICAgICAgICAgICAgICAgICAgICAgIHtuYW1lOiAnSmFjaycsIHNjb3JlOiA2OX1dO1xuICAgICAqICAgICAgYnlHcmFkZShzdHVkZW50cyk7XG4gICAgICogICAgICAvLyB7XG4gICAgICogICAgICAvLyAgICdBJzogW3tuYW1lOiAnRGlhbm5lJywgc2NvcmU6IDk5fV0sXG4gICAgICogICAgICAvLyAgICdCJzogW3tuYW1lOiAnQWJieScsIHNjb3JlOiA4NH1dXG4gICAgICogICAgICAvLyAgIC8vIC4uLixcbiAgICAgKiAgICAgIC8vICAgJ0YnOiBbe25hbWU6ICdFZGR5Jywgc2NvcmU6IDU4fV1cbiAgICAgKiAgICAgIC8vIH1cbiAgICAgKi9cbiAgICB2YXIgZ3JvdXBCeSA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgnZ3JvdXBCeScsIF94Z3JvdXBCeSwgZnVuY3Rpb24gZ3JvdXBCeShmbiwgbGlzdCkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZShmdW5jdGlvbiAoYWNjLCBlbHQpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBmbihlbHQpO1xuICAgICAgICAgICAgYWNjW2tleV0gPSBhcHBlbmQoZWx0LCBhY2Nba2V5XSB8fCAoYWNjW2tleV0gPSBbXSkpO1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwge30sIGxpc3QpO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGdpdmVuIGxpc3Qgb3Igc3RyaW5nLiBJbiBzb21lIGxpYnJhcmllc1xuICAgICAqIHRoaXMgZnVuY3Rpb24gaXMgbmFtZWQgYGZpcnN0YC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzZWUgUi50YWlsLCBSLmluaXQsIFIubGFzdFxuICAgICAqIEBzaWcgW2FdIC0+IGEgfCBVbmRlZmluZWRcbiAgICAgKiBAc2lnIFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuaGVhZChbJ2ZpJywgJ2ZvJywgJ2Z1bSddKTsgLy89PiAnZmknXG4gICAgICogICAgICBSLmhlYWQoW10pOyAvLz0+IHVuZGVmaW5lZFxuICAgICAqXG4gICAgICogICAgICBSLmhlYWQoJ2FiYycpOyAvLz0+ICdhJ1xuICAgICAqICAgICAgUi5oZWFkKCcnKTsgLy89PiAnJ1xuICAgICAqL1xuICAgIHZhciBoZWFkID0gbnRoKDApO1xuXG4gICAgLyoqXG4gICAgICogQ29tYmluZXMgdHdvIGxpc3RzIGludG8gYSBzZXQgKGkuZS4gbm8gZHVwbGljYXRlcykgY29tcG9zZWQgb2YgdGhvc2VcbiAgICAgKiBlbGVtZW50cyBjb21tb24gdG8gYm90aCBsaXN0cy4gIER1cGxpY2F0aW9uIGlzIGRldGVybWluZWQgYWNjb3JkaW5nXG4gICAgICogdG8gdGhlIHZhbHVlIHJldHVybmVkIGJ5IGFwcGx5aW5nIHRoZSBzdXBwbGllZCBwcmVkaWNhdGUgdG8gdHdvIGxpc3RcbiAgICAgKiBlbGVtZW50cy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIChhLGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkIEEgcHJlZGljYXRlIGZ1bmN0aW9uIHRoYXQgZGV0ZXJtaW5lcyB3aGV0aGVyXG4gICAgICogICAgICAgIHRoZSB0d28gc3VwcGxpZWQgZWxlbWVudHMgYXJlIGVxdWFsLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QxIE9uZSBsaXN0IG9mIGl0ZW1zIHRvIGNvbXBhcmVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MiBBIHNlY29uZCBsaXN0IG9mIGl0ZW1zIHRvIGNvbXBhcmVcbiAgICAgKiBAc2VlIFIuaW50ZXJzZWN0aW9uXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IGxpc3QgY29udGFpbmluZyB0aG9zZSBlbGVtZW50cyBjb21tb24gdG8gYm90aCBsaXN0cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYnVmZmFsb1NwcmluZ2ZpZWxkID0gW1xuICAgICAqICAgICAgICB7aWQ6IDgyNCwgbmFtZTogJ1JpY2hpZSBGdXJheSd9LFxuICAgICAqICAgICAgICB7aWQ6IDk1NiwgbmFtZTogJ0Rld2V5IE1hcnRpbid9LFxuICAgICAqICAgICAgICB7aWQ6IDMxMywgbmFtZTogJ0JydWNlIFBhbG1lcid9LFxuICAgICAqICAgICAgICB7aWQ6IDQ1NiwgbmFtZTogJ1N0ZXBoZW4gU3RpbGxzJ30sXG4gICAgICogICAgICAgIHtpZDogMTc3LCBuYW1lOiAnTmVpbCBZb3VuZyd9XG4gICAgICogICAgICBdO1xuICAgICAqICAgICAgdmFyIGNzbnkgPSBbXG4gICAgICogICAgICAgIHtpZDogMjA0LCBuYW1lOiAnRGF2aWQgQ3Jvc2J5J30sXG4gICAgICogICAgICAgIHtpZDogNDU2LCBuYW1lOiAnU3RlcGhlbiBTdGlsbHMnfSxcbiAgICAgKiAgICAgICAge2lkOiA1MzksIG5hbWU6ICdHcmFoYW0gTmFzaCd9LFxuICAgICAqICAgICAgICB7aWQ6IDE3NywgbmFtZTogJ05laWwgWW91bmcnfVxuICAgICAqICAgICAgXTtcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHNhbWVJZCA9IGZ1bmN0aW9uKG8xLCBvMikge3JldHVybiBvMS5pZCA9PT0gbzIuaWQ7fTtcbiAgICAgKlxuICAgICAqICAgICAgUi5pbnRlcnNlY3Rpb25XaXRoKHNhbWVJZCwgYnVmZmFsb1NwcmluZ2ZpZWxkLCBjc255KTtcbiAgICAgKiAgICAgIC8vPT4gW3tpZDogNDU2LCBuYW1lOiAnU3RlcGhlbiBTdGlsbHMnfSwge2lkOiAxNzcsIG5hbWU6ICdOZWlsIFlvdW5nJ31dXG4gICAgICovXG4gICAgdmFyIGludGVyc2VjdGlvbldpdGggPSBfY3VycnkzKGZ1bmN0aW9uIGludGVyc2VjdGlvbldpdGgocHJlZCwgbGlzdDEsIGxpc3QyKSB7XG4gICAgICAgIHZhciByZXN1bHRzID0gW10sIGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChpZHggPCBsaXN0MS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChfY29udGFpbnNXaXRoKHByZWQsIGxpc3QxW2lkeF0sIGxpc3QyKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdHNbcmVzdWx0cy5sZW5ndGhdID0gbGlzdDFbaWR4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmlxV2l0aChwcmVkLCByZXN1bHRzKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgbGlzdCB3aXRoIHRoZSBzZXBhcmF0b3IgaW50ZXJwb3NlZCBiZXR3ZWVuIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBhIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0geyp9IHNlcGFyYXRvciBUaGUgZWxlbWVudCB0byBhZGQgdG8gdGhlIGxpc3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgbGlzdCB0byBiZSBpbnRlcnBvc2VkLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbmV3IGxpc3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pbnRlcnNwZXJzZSgnbicsIFsnYmEnLCAnYScsICdhJ10pOyAvLz0+IFsnYmEnLCAnbicsICdhJywgJ24nLCAnYSddXG4gICAgICovXG4gICAgdmFyIGludGVyc3BlcnNlID0gX2N1cnJ5MihfY2hlY2tGb3JNZXRob2QoJ2ludGVyc3BlcnNlJywgZnVuY3Rpb24gaW50ZXJzcGVyc2Uoc2VwYXJhdG9yLCBsaXN0KSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBsZW5ndGggPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGlkeCA9PT0gbGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGxpc3RbaWR4XSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG91dC5wdXNoKGxpc3RbaWR4XSwgc2VwYXJhdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXQ7XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogVHJhbnNmb3JtcyB0aGUgaXRlbXMgb2YgdGhlIGxpc3Qgd2l0aCB0aGUgdHJhbnNkdWNlciBhbmQgYXBwZW5kcyB0aGUgdHJhbnNmb3JtZWQgaXRlbXMgdG9cbiAgICAgKiB0aGUgYWNjdW11bGF0b3IgdXNpbmcgYW4gYXBwcm9wcmlhdGUgaXRlcmF0b3IgZnVuY3Rpb24gYmFzZWQgb24gdGhlIGFjY3VtdWxhdG9yIHR5cGUuXG4gICAgICpcbiAgICAgKiBUaGUgYWNjdW11bGF0b3IgY2FuIGJlIGFuIGFycmF5LCBzdHJpbmcsIG9iamVjdCBvciBhIHRyYW5zZm9ybWVyLiBJdGVyYXRlZCBpdGVtcyB3aWxsXG4gICAgICogYmUgYXBwZW5kZWQgdG8gYXJyYXlzIGFuZCBjb25jYXRlbmF0ZWQgdG8gc3RyaW5ncy4gT2JqZWN0cyB3aWxsIGJlIG1lcmdlZCBkaXJlY3RseSBvciAyLWl0ZW1cbiAgICAgKiBhcnJheXMgd2lsbCBiZSBtZXJnZWQgYXMga2V5LCB2YWx1ZSBwYWlycy5cbiAgICAgKlxuICAgICAqIFRoZSBhY2N1bXVsYXRvciBjYW4gYWxzbyBiZSBhIHRyYW5zZm9ybWVyIG9iamVjdCB0aGF0IHByb3ZpZGVzIGEgMi1hcml0eSByZWR1Y2luZyBpdGVyYXRvclxuICAgICAqIGZ1bmN0aW9uLCBzdGVwLCAwLWFyaXR5IGluaXRpYWwgdmFsdWUgZnVuY3Rpb24sIGluaXQsIGFuZCAxLWFyaXR5IHJlc3VsdCBleHRyYWN0aW9uIGZ1bmN0aW9uXG4gICAgICogcmVzdWx0LiBUaGUgc3RlcCBmdW5jdGlvbiBpcyB1c2VkIGFzIHRoZSBpdGVyYXRvciBmdW5jdGlvbiBpbiByZWR1Y2UuIFRoZSByZXN1bHQgZnVuY3Rpb24gaXNcbiAgICAgKiB1c2VkIHRvIGNvbnZlcnQgdGhlIGZpbmFsIGFjY3VtdWxhdG9yIGludG8gdGhlIHJldHVybiB0eXBlIGFuZCBpbiBtb3N0IGNhc2VzIGlzIFIuaWRlbnRpdHkuXG4gICAgICogVGhlIGluaXQgZnVuY3Rpb24gaXMgdXNlZCB0byBwcm92aWRlIHRoZSBpbml0aWFsIGFjY3VtdWxhdG9yLlxuICAgICAqXG4gICAgICogVGhlIGl0ZXJhdGlvbiBpcyBwZXJmb3JtZWQgd2l0aCBSLnJlZHVjZSBhZnRlciBpbml0aWFsaXppbmcgdGhlIHRyYW5zZHVjZXIuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGEgLT4gKGIgLT4gYikgLT4gW2NdIC0+IGFcbiAgICAgKiBAcGFyYW0geyp9IGFjYyBUaGUgaW5pdGlhbCBhY2N1bXVsYXRvciB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB4ZiBUaGUgdHJhbnNkdWNlciBmdW5jdGlvbi4gUmVjZWl2ZXMgYSB0cmFuc2Zvcm1lciBhbmQgcmV0dXJucyBhIHRyYW5zZm9ybWVyLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBmaW5hbCwgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG51bWJlcnMgPSBbMSwgMiwgMywgNF07XG4gICAgICogICAgICB2YXIgdHJhbnNkdWNlciA9IFIuY29tcG9zZShSLm1hcChSLmFkZCgxKSksIFIudGFrZSgyKSk7XG4gICAgICpcbiAgICAgKiAgICAgIFIuaW50byhbXSwgdHJhbnNkdWNlciwgbnVtYmVycyk7IC8vPT4gWzIsIDNdXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpbnRvQXJyYXkgPSBSLmludG8oW10pO1xuICAgICAqICAgICAgaW50b0FycmF5KHRyYW5zZHVjZXIsIG51bWJlcnMpOyAvLz0+IFsyLCAzXVxuICAgICAqL1xuICAgIHZhciBpbnRvID0gX2N1cnJ5MyhmdW5jdGlvbiBpbnRvKGFjYywgeGYsIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIF9pc1RyYW5zZm9ybWVyKGFjYykgPyBfcmVkdWNlKHhmKGFjYyksIGFjY1snQEB0cmFuc2R1Y2VyL2luaXQnXSgpLCBsaXN0KSA6IF9yZWR1Y2UoeGYoX3N0ZXBDYXQoYWNjKSksIGFjYywgbGlzdCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBTYW1lIGFzIFIuaW52ZXJ0T2JqLCBob3dldmVyIHRoaXMgYWNjb3VudHMgZm9yIG9iamVjdHNcbiAgICAgKiB3aXRoIGR1cGxpY2F0ZSB2YWx1ZXMgYnkgcHV0dGluZyB0aGUgdmFsdWVzIGludG8gYW5cbiAgICAgKiBhcnJheS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyB7czogeH0gLT4ge3g6IFsgcywgLi4uIF19XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IG9yIGFycmF5IHRvIGludmVydFxuICAgICAqIEByZXR1cm4ge09iamVjdH0gb3V0IEEgbmV3IG9iamVjdCB3aXRoIGtleXNcbiAgICAgKiBpbiBhbiBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgcmFjZVJlc3VsdHNCeUZpcnN0TmFtZSA9IHtcbiAgICAgKiAgICAgICAgZmlyc3Q6ICdhbGljZScsXG4gICAgICogICAgICAgIHNlY29uZDogJ2pha2UnLFxuICAgICAqICAgICAgICB0aGlyZDogJ2FsaWNlJyxcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICBSLmludmVydChyYWNlUmVzdWx0c0J5Rmlyc3ROYW1lKTtcbiAgICAgKiAgICAgIC8vPT4geyAnYWxpY2UnOiBbJ2ZpcnN0JywgJ3RoaXJkJ10sICdqYWtlJzpbJ3NlY29uZCddIH1cbiAgICAgKi9cbiAgICB2YXIgaW52ZXJ0ID0gX2N1cnJ5MShmdW5jdGlvbiBpbnZlcnQob2JqKSB7XG4gICAgICAgIHZhciBwcm9wcyA9IGtleXMob2JqKTtcbiAgICAgICAgdmFyIGxlbiA9IHByb3BzLmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgdmFyIGtleSA9IHByb3BzW2lkeF07XG4gICAgICAgICAgICB2YXIgdmFsID0gb2JqW2tleV07XG4gICAgICAgICAgICB2YXIgbGlzdCA9IF9oYXModmFsLCBvdXQpID8gb3V0W3ZhbF0gOiBvdXRbdmFsXSA9IFtdO1xuICAgICAgICAgICAgbGlzdFtsaXN0Lmxlbmd0aF0gPSBrZXk7XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCB0aGUga2V5cyBvZiB0aGUgZ2l2ZW4gb2JqZWN0XG4gICAgICogYXMgdmFsdWVzLCBhbmQgdGhlIHZhbHVlcyBvZiB0aGUgZ2l2ZW4gb2JqZWN0IGFzIGtleXMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge3M6IHh9IC0+IHt4OiBzfVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCBvciBhcnJheSB0byBpbnZlcnRcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IG91dCBBIG5ldyBvYmplY3RcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgcmFjZVJlc3VsdHMgPSB7XG4gICAgICogICAgICAgIGZpcnN0OiAnYWxpY2UnLFxuICAgICAqICAgICAgICBzZWNvbmQ6ICdqYWtlJ1xuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIFIuaW52ZXJ0T2JqKHJhY2VSZXN1bHRzKTtcbiAgICAgKiAgICAgIC8vPT4geyAnYWxpY2UnOiAnZmlyc3QnLCAnamFrZSc6J3NlY29uZCcgfVxuICAgICAqXG4gICAgICogICAgICAvLyBBbHRlcm5hdGl2ZWx5OlxuICAgICAqICAgICAgdmFyIHJhY2VSZXN1bHRzID0gWydhbGljZScsICdqYWtlJ107XG4gICAgICogICAgICBSLmludmVydE9iaihyYWNlUmVzdWx0cyk7XG4gICAgICogICAgICAvLz0+IHsgJ2FsaWNlJzogJzAnLCAnamFrZSc6JzEnIH1cbiAgICAgKi9cbiAgICB2YXIgaW52ZXJ0T2JqID0gX2N1cnJ5MShmdW5jdGlvbiBpbnZlcnRPYmoob2JqKSB7XG4gICAgICAgIHZhciBwcm9wcyA9IGtleXMob2JqKTtcbiAgICAgICAgdmFyIGxlbiA9IHByb3BzLmxlbmd0aDtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBvdXQgPSB7fTtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGxlbikge1xuICAgICAgICAgICAgdmFyIGtleSA9IHByb3BzW2lkeF07XG4gICAgICAgICAgICBvdXRbb2JqW2tleV1dID0ga2V5O1xuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGxhc3QgZWxlbWVudCBvZiB0aGUgZ2l2ZW4gbGlzdCBvciBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2VlIFIuaW5pdCwgUi5oZWFkLCBSLnRhaWxcbiAgICAgKiBAc2lnIFthXSAtPiBhIHwgVW5kZWZpbmVkXG4gICAgICogQHNpZyBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHsqfSBsaXN0XG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmxhc3QoWydmaScsICdmbycsICdmdW0nXSk7IC8vPT4gJ2Z1bSdcbiAgICAgKiAgICAgIFIubGFzdChbXSk7IC8vPT4gdW5kZWZpbmVkXG4gICAgICpcbiAgICAgKiAgICAgIFIubGFzdCgnYWJjJyk7IC8vPT4gJ2MnXG4gICAgICogICAgICBSLmxhc3QoJycpOyAvLz0+ICcnXG4gICAgICovXG4gICAgdmFyIGxhc3QgPSBudGgoLTEpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcG9zaXRpb24gb2YgdGhlIGxhc3Qgb2NjdXJyZW5jZSBvZiBhbiBpdGVtIGluXG4gICAgICogYW4gYXJyYXksIG9yIC0xIGlmIHRoZSBpdGVtIGlzIG5vdCBpbmNsdWRlZCBpbiB0aGUgYXJyYXkuXG4gICAgICogYFIuZXF1YWxzYCBpcyB1c2VkIHRvIGRldGVybWluZSBlcXVhbGl0eS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgYSAtPiBbYV0gLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQgVGhlIGl0ZW0gdG8gZmluZC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSB4cyBUaGUgYXJyYXkgdG8gc2VhcmNoIGluLlxuICAgICAqIEByZXR1cm4ge051bWJlcn0gdGhlIGluZGV4IG9mIHRoZSB0YXJnZXQsIG9yIC0xIGlmIHRoZSB0YXJnZXQgaXMgbm90IGZvdW5kLlxuICAgICAqIEBzZWUgUi5pbmRleE9mXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5sYXN0SW5kZXhPZigzLCBbLTEsMywzLDAsMSwyLDMsNF0pOyAvLz0+IDZcbiAgICAgKiAgICAgIFIubGFzdEluZGV4T2YoMTAsIFsxLDIsMyw0XSk7IC8vPT4gLTFcbiAgICAgKi9cbiAgICB2YXIgbGFzdEluZGV4T2YgPSBfY3VycnkyKGZ1bmN0aW9uIGxhc3RJbmRleE9mKHRhcmdldCwgeHMpIHtcbiAgICAgICAgaWYgKF9oYXNNZXRob2QoJ2xhc3RJbmRleE9mJywgeHMpKSB7XG4gICAgICAgICAgICByZXR1cm4geHMubGFzdEluZGV4T2YodGFyZ2V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBpZHggPSB4cy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgd2hpbGUgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVxdWFscyh4c1tpZHhdLCB0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlkeCAtPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QsIGNvbnN0cnVjdGVkIGJ5IGFwcGx5aW5nIHRoZSBzdXBwbGllZCBmdW5jdGlvbiB0byBldmVyeSBlbGVtZW50IG9mIHRoZVxuICAgICAqIHN1cHBsaWVkIGxpc3QuXG4gICAgICpcbiAgICAgKiBOb3RlOiBgUi5tYXBgIGRvZXMgbm90IHNraXAgZGVsZXRlZCBvciB1bmFzc2lnbmVkIGluZGljZXMgKHNwYXJzZSBhcnJheXMpLCB1bmxpa2UgdGhlXG4gICAgICogbmF0aXZlIGBBcnJheS5wcm90b3R5cGUubWFwYCBtZXRob2QuIEZvciBtb3JlIGRldGFpbHMgb24gdGhpcyBiZWhhdmlvciwgc2VlOlxuICAgICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L21hcCNEZXNjcmlwdGlvblxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gYikgLT4gW2FdIC0+IFtiXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgb24gZXZlcnkgZWxlbWVudCBvZiB0aGUgaW5wdXQgYGxpc3RgLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gYmUgaXRlcmF0ZWQgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIG5ldyBsaXN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBkb3VibGUgPSBmdW5jdGlvbih4KSB7XG4gICAgICogICAgICAgIHJldHVybiB4ICogMjtcbiAgICAgKiAgICAgIH07XG4gICAgICpcbiAgICAgKiAgICAgIFIubWFwKGRvdWJsZSwgWzEsIDIsIDNdKTsgLy89PiBbMiwgNCwgNl1cbiAgICAgKi9cbiAgICB2YXIgbWFwID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdtYXAnLCBfeG1hcCwgX21hcCkpO1xuXG4gICAgLyoqXG4gICAgICogTWFwLCBidXQgZm9yIG9iamVjdHMuIENyZWF0ZXMgYW4gb2JqZWN0IHdpdGggdGhlIHNhbWUga2V5cyBhcyBgb2JqYCBhbmQgdmFsdWVzXG4gICAgICogZ2VuZXJhdGVkIGJ5IHJ1bm5pbmcgZWFjaCBwcm9wZXJ0eSBvZiBgb2JqYCB0aHJvdWdoIGBmbmAuIGBmbmAgaXMgcGFzc2VkIG9uZSBhcmd1bWVudDpcbiAgICAgKiAqKHZhbHVlKSouXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgKHYgLT4gdikgLT4ge2s6IHZ9IC0+IHtrOiB2fVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIEEgZnVuY3Rpb24gY2FsbGVkIGZvciBlYWNoIHByb3BlcnR5IGluIGBvYmpgLiBJdHMgcmV0dXJuIHZhbHVlIHdpbGxcbiAgICAgKiBiZWNvbWUgYSBuZXcgcHJvcGVydHkgb24gdGhlIHJldHVybiBvYmplY3QuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEEgbmV3IG9iamVjdCB3aXRoIHRoZSBzYW1lIGtleXMgYXMgYG9iamAgYW5kIHZhbHVlcyB0aGF0IGFyZSB0aGUgcmVzdWx0XG4gICAgICogICAgICAgICBvZiBydW5uaW5nIGVhY2ggcHJvcGVydHkgdGhyb3VnaCBgZm5gLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciB2YWx1ZXMgPSB7IHg6IDEsIHk6IDIsIHo6IDMgfTtcbiAgICAgKiAgICAgIHZhciBkb3VibGUgPSBmdW5jdGlvbihudW0pIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIG51bSAqIDI7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBSLm1hcE9iaihkb3VibGUsIHZhbHVlcyk7IC8vPT4geyB4OiAyLCB5OiA0LCB6OiA2IH1cbiAgICAgKi9cbiAgICB2YXIgbWFwT2JqID0gX2N1cnJ5MihmdW5jdGlvbiBtYXBPYmooZm4sIG9iaikge1xuICAgICAgICByZXR1cm4gX3JlZHVjZShmdW5jdGlvbiAoYWNjLCBrZXkpIHtcbiAgICAgICAgICAgIGFjY1trZXldID0gZm4ob2JqW2tleV0pO1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwge30sIGtleXMob2JqKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBMaWtlIGBtYXBPYmpgLCBidXQgYnV0IHBhc3NlcyBhZGRpdGlvbmFsIGFyZ3VtZW50cyB0byB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uLiBUaGVcbiAgICAgKiBwcmVkaWNhdGUgZnVuY3Rpb24gaXMgcGFzc2VkIHRocmVlIGFyZ3VtZW50czogKih2YWx1ZSwga2V5LCBvYmopKi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHNpZyAodiwgaywge2s6IHZ9IC0+IHYpIC0+IHtrOiB2fSAtPiB7azogdn1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBBIGZ1bmN0aW9uIGNhbGxlZCBmb3IgZWFjaCBwcm9wZXJ0eSBpbiBgb2JqYC4gSXRzIHJldHVybiB2YWx1ZSB3aWxsXG4gICAgICogICAgICAgIGJlY29tZSBhIG5ldyBwcm9wZXJ0eSBvbiB0aGUgcmV0dXJuIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggdGhlIHNhbWUga2V5cyBhcyBgb2JqYCBhbmQgdmFsdWVzIHRoYXQgYXJlIHRoZSByZXN1bHRcbiAgICAgKiAgICAgICAgIG9mIHJ1bm5pbmcgZWFjaCBwcm9wZXJ0eSB0aHJvdWdoIGBmbmAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHZhbHVlcyA9IHsgeDogMSwgeTogMiwgejogMyB9O1xuICAgICAqICAgICAgdmFyIHByZXBlbmRLZXlBbmREb3VibGUgPSBmdW5jdGlvbihudW0sIGtleSwgb2JqKSB7XG4gICAgICogICAgICAgIHJldHVybiBrZXkgKyAobnVtICogMik7XG4gICAgICogICAgICB9O1xuICAgICAqXG4gICAgICogICAgICBSLm1hcE9iakluZGV4ZWQocHJlcGVuZEtleUFuZERvdWJsZSwgdmFsdWVzKTsgLy89PiB7IHg6ICd4MicsIHk6ICd5NCcsIHo6ICd6NicgfVxuICAgICAqL1xuICAgIHZhciBtYXBPYmpJbmRleGVkID0gX2N1cnJ5MihmdW5jdGlvbiBtYXBPYmpJbmRleGVkKGZuLCBvYmopIHtcbiAgICAgICAgcmV0dXJuIF9yZWR1Y2UoZnVuY3Rpb24gKGFjYywga2V5KSB7XG4gICAgICAgICAgICBhY2Nba2V5XSA9IGZuKG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCB7fSwga2V5cyhvYmopKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIG5vIGVsZW1lbnRzIG9mIHRoZSBsaXN0IG1hdGNoIHRoZSBwcmVkaWNhdGUsXG4gICAgICogYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIHByZWRpY2F0ZSBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgdGhlIHByZWRpY2F0ZSBpcyBub3Qgc2F0aXNmaWVkIGJ5IGV2ZXJ5IGVsZW1lbnQsIGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqIEBzZWUgUi5hbGwsIFIuYW55XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5ub25lKFIuaXNOYU4sIFsxLCAyLCAzXSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5ub25lKFIuaXNOYU4sIFsxLCAyLCAzLCBOYU5dKTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBub25lID0gX2N1cnJ5MihfY29tcGxlbWVudChfZGlzcGF0Y2hhYmxlKCdhbnknLCBfeGFueSwgYW55KSkpO1xuXG4gICAgLyoqXG4gICAgICogQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGZpcnN0IHRydXRoeSBvZiB0d28gYXJndW1lbnRzIG90aGVyd2lzZSB0aGVcbiAgICAgKiBsYXN0IGFyZ3VtZW50LiBOb3RlIHRoYXQgdGhpcyBpcyBOT1Qgc2hvcnQtY2lyY3VpdGVkLCBtZWFuaW5nIHRoYXQgaWZcbiAgICAgKiBleHByZXNzaW9ucyBhcmUgcGFzc2VkIHRoZXkgYXJlIGJvdGggZXZhbHVhdGVkLlxuICAgICAqXG4gICAgICogRGlzcGF0Y2hlcyB0byB0aGUgYG9yYCBtZXRob2Qgb2YgdGhlIGZpcnN0IGFyZ3VtZW50IGlmIGFwcGxpY2FibGUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExvZ2ljXG4gICAgICogQHNpZyAqIC0+ICogLT4gKlxuICAgICAqIEBwYXJhbSB7Kn0gYSBhbnkgdmFsdWVcbiAgICAgKiBAcGFyYW0geyp9IGIgYW55IG90aGVyIHZhbHVlXG4gICAgICogQHJldHVybiB7Kn0gdGhlIGZpcnN0IHRydXRoeSBhcmd1bWVudCwgb3RoZXJ3aXNlIHRoZSBsYXN0IGFyZ3VtZW50LlxuICAgICAqIEBzZWUgUi5laXRoZXJcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLm9yKGZhbHNlLCB0cnVlKTsgLy89PiB0cnVlXG4gICAgICogICAgICBSLm9yKDAsIFtdKTsgLy89PiBbXVxuICAgICAqICAgICAgUi5vcihudWxsLCAnJyk7ID0+ICcnXG4gICAgICovXG4gICAgdmFyIG9yID0gX2N1cnJ5MihmdW5jdGlvbiBvcihhLCBiKSB7XG4gICAgICAgIHJldHVybiBfaGFzTWV0aG9kKCdvcicsIGEpID8gYS5vcihiKSA6IGEgfHwgYjtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIEFjY2VwdHMgYXMgaXRzIGFyZ3VtZW50cyBhIGZ1bmN0aW9uIGFuZCBhbnkgbnVtYmVyIG9mIHZhbHVlcyBhbmQgcmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQsXG4gICAgICogd2hlbiBpbnZva2VkLCBjYWxscyB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gd2l0aCBhbGwgb2YgdGhlIHZhbHVlcyBwcmVwZW5kZWQgdG8gdGhlXG4gICAgICogb3JpZ2luYWwgZnVuY3Rpb24ncyBhcmd1bWVudHMgbGlzdC4gSW4gc29tZSBsaWJyYXJpZXMgdGhpcyBmdW5jdGlvbiBpcyBuYW1lZCBgYXBwbHlMZWZ0YC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIChhIC0+IGIgLT4gLi4uIC0+IGkgLT4gaiAtPiAuLi4gLT4gbSAtPiBuKSAtPiBhIC0+IGItPiAuLi4gLT4gaSAtPiAoaiAtPiAuLi4gLT4gbSAtPiBuKVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBpbnZva2UuXG4gICAgICogQHBhcmFtIHsuLi4qfSBbYXJnc10gQXJndW1lbnRzIHRvIHByZXBlbmQgdG8gYGZuYCB3aGVuIHRoZSByZXR1cm5lZCBmdW5jdGlvbiBpcyBpbnZva2VkLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbiB3cmFwcGluZyBgZm5gLiBXaGVuIGludm9rZWQsIGl0IHdpbGwgY2FsbCBgZm5gXG4gICAgICogICAgICAgICB3aXRoIGBhcmdzYCBwcmVwZW5kZWQgdG8gYGZuYCdzIGFyZ3VtZW50cyBsaXN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBtdWx0aXBseSA9IGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEgKiBiOyB9O1xuICAgICAqICAgICAgdmFyIGRvdWJsZSA9IFIucGFydGlhbChtdWx0aXBseSwgMik7XG4gICAgICogICAgICBkb3VibGUoMik7IC8vPT4gNFxuICAgICAqXG4gICAgICogICAgICB2YXIgZ3JlZXQgPSBmdW5jdGlvbihzYWx1dGF0aW9uLCB0aXRsZSwgZmlyc3ROYW1lLCBsYXN0TmFtZSkge1xuICAgICAqICAgICAgICByZXR1cm4gc2FsdXRhdGlvbiArICcsICcgKyB0aXRsZSArICcgJyArIGZpcnN0TmFtZSArICcgJyArIGxhc3ROYW1lICsgJyEnO1xuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHZhciBzYXlIZWxsbyA9IFIucGFydGlhbChncmVldCwgJ0hlbGxvJyk7XG4gICAgICogICAgICB2YXIgc2F5SGVsbG9Ub01zID0gUi5wYXJ0aWFsKHNheUhlbGxvLCAnTXMuJyk7XG4gICAgICogICAgICBzYXlIZWxsb1RvTXMoJ0phbmUnLCAnSm9uZXMnKTsgLy89PiAnSGVsbG8sIE1zLiBKYW5lIEpvbmVzISdcbiAgICAgKi9cbiAgICB2YXIgcGFydGlhbCA9IGN1cnJ5KF9jcmVhdGVQYXJ0aWFsQXBwbGljYXRvcihfY29uY2F0KSk7XG5cbiAgICAvKipcbiAgICAgKiBBY2NlcHRzIGFzIGl0cyBhcmd1bWVudHMgYSBmdW5jdGlvbiBhbmQgYW55IG51bWJlciBvZiB2YWx1ZXMgYW5kIHJldHVybnMgYSBmdW5jdGlvbiB0aGF0LFxuICAgICAqIHdoZW4gaW52b2tlZCwgY2FsbHMgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIHdpdGggYWxsIG9mIHRoZSB2YWx1ZXMgYXBwZW5kZWQgdG8gdGhlIG9yaWdpbmFsXG4gICAgICogZnVuY3Rpb24ncyBhcmd1bWVudHMgbGlzdC5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCBgcGFydGlhbFJpZ2h0YCBpcyB0aGUgb3Bwb3NpdGUgb2YgYHBhcnRpYWxgOiBgcGFydGlhbFJpZ2h0YCBmaWxscyBgZm5gJ3MgYXJndW1lbnRzXG4gICAgICogZnJvbSB0aGUgcmlnaHQgdG8gdGhlIGxlZnQuICBJbiBzb21lIGxpYnJhcmllcyB0aGlzIGZ1bmN0aW9uIGlzIG5hbWVkIGBhcHBseVJpZ2h0YC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIChhIC0+IGItPiAuLi4gLT4gaSAtPiBqIC0+IC4uLiAtPiBtIC0+IG4pIC0+IGogLT4gLi4uIC0+IG0gLT4gbiAtPiAoYSAtPiBiLT4gLi4uIC0+IGkpXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGludm9rZS5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmdzXSBBcmd1bWVudHMgdG8gYXBwZW5kIHRvIGBmbmAgd2hlbiB0aGUgcmV0dXJuZWQgZnVuY3Rpb24gaXMgaW52b2tlZC5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gQSBuZXcgZnVuY3Rpb24gd3JhcHBpbmcgYGZuYC4gV2hlbiBpbnZva2VkLCBpdCB3aWxsIGNhbGwgYGZuYCB3aXRoXG4gICAgICogICAgICAgICBgYXJnc2AgYXBwZW5kZWQgdG8gYGZuYCdzIGFyZ3VtZW50cyBsaXN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBncmVldCA9IGZ1bmN0aW9uKHNhbHV0YXRpb24sIHRpdGxlLCBmaXJzdE5hbWUsIGxhc3ROYW1lKSB7XG4gICAgICogICAgICAgIHJldHVybiBzYWx1dGF0aW9uICsgJywgJyArIHRpdGxlICsgJyAnICsgZmlyc3ROYW1lICsgJyAnICsgbGFzdE5hbWUgKyAnISc7XG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgdmFyIGdyZWV0TXNKYW5lSm9uZXMgPSBSLnBhcnRpYWxSaWdodChncmVldCwgJ01zLicsICdKYW5lJywgJ0pvbmVzJyk7XG4gICAgICpcbiAgICAgKiAgICAgIGdyZWV0TXNKYW5lSm9uZXMoJ0hlbGxvJyk7IC8vPT4gJ0hlbGxvLCBNcy4gSmFuZSBKb25lcyEnXG4gICAgICovXG4gICAgdmFyIHBhcnRpYWxSaWdodCA9IGN1cnJ5KF9jcmVhdGVQYXJ0aWFsQXBwbGljYXRvcihmbGlwKF9jb25jYXQpKSk7XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyBhIHByZWRpY2F0ZSBhbmQgYSBsaXN0IGFuZCByZXR1cm5zIHRoZSBwYWlyIG9mIGxpc3RzIG9mXG4gICAgICogZWxlbWVudHMgd2hpY2ggZG8gYW5kIGRvIG5vdCBzYXRpc2Z5IHRoZSBwcmVkaWNhdGUsIHJlc3BlY3RpdmVseS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFtbYV0sW2FdXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgQSBwcmVkaWNhdGUgdG8gZGV0ZXJtaW5lIHdoaWNoIGFycmF5IHRoZSBlbGVtZW50IGJlbG9uZ3MgdG8uXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gcGFydGl0aW9uLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBIG5lc3RlZCBhcnJheSwgY29udGFpbmluZyBmaXJzdCBhbiBhcnJheSBvZiBlbGVtZW50cyB0aGF0IHNhdGlzZmllZCB0aGUgcHJlZGljYXRlLFxuICAgICAqICAgICAgICAgYW5kIHNlY29uZCBhbiBhcnJheSBvZiBlbGVtZW50cyB0aGF0IGRpZCBub3Qgc2F0aXNmeS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnBhcnRpdGlvbihSLmNvbnRhaW5zKCdzJyksIFsnc3NzJywgJ3R0dCcsICdmb28nLCAnYmFycyddKTtcbiAgICAgKiAgICAgIC8vPT4gWyBbICdzc3MnLCAnYmFycycgXSwgIFsgJ3R0dCcsICdmb28nIF0gXVxuICAgICAqL1xuICAgIHZhciBwYXJ0aXRpb24gPSBfY3VycnkyKGZ1bmN0aW9uIHBhcnRpdGlvbihwcmVkLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBfcmVkdWNlKGZ1bmN0aW9uIChhY2MsIGVsdCkge1xuICAgICAgICAgICAgdmFyIHhzID0gYWNjW3ByZWQoZWx0KSA/IDAgOiAxXTtcbiAgICAgICAgICAgIHhzW3hzLmxlbmd0aF0gPSBlbHQ7XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCBbXG4gICAgICAgICAgICBbXSxcbiAgICAgICAgICAgIFtdXG4gICAgICAgIF0sIGxpc3QpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIGEgbmVzdGVkIHBhdGggb24gYW4gb2JqZWN0IGhhcyBhIHNwZWNpZmljIHZhbHVlLFxuICAgICAqIGluIGBSLmVxdWFsc2AgdGVybXMuIE1vc3QgbGlrZWx5IHVzZWQgdG8gZmlsdGVyIGEgbGlzdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgUmVsYXRpb25cbiAgICAgKiBAc2lnIFtTdHJpbmddIC0+ICogLT4ge1N0cmluZzogKn0gLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHBhdGggVGhlIHBhdGggb2YgdGhlIG5lc3RlZCBwcm9wZXJ0eSB0byB1c2VcbiAgICAgKiBAcGFyYW0geyp9IHZhbCBUaGUgdmFsdWUgdG8gY29tcGFyZSB0aGUgbmVzdGVkIHByb3BlcnR5IHdpdGhcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gY2hlY2sgdGhlIG5lc3RlZCBwcm9wZXJ0eSBpblxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiB0aGUgdmFsdWUgZXF1YWxzIHRoZSBuZXN0ZWQgb2JqZWN0IHByb3BlcnR5LFxuICAgICAqICAgICAgICAgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHVzZXIxID0geyBhZGRyZXNzOiB7IHppcENvZGU6IDkwMjEwIH0gfTtcbiAgICAgKiAgICAgIHZhciB1c2VyMiA9IHsgYWRkcmVzczogeyB6aXBDb2RlOiA1NTU1NSB9IH07XG4gICAgICogICAgICB2YXIgdXNlcjMgPSB7IG5hbWU6ICdCb2InIH07XG4gICAgICogICAgICB2YXIgdXNlcnMgPSBbIHVzZXIxLCB1c2VyMiwgdXNlcjMgXTtcbiAgICAgKiAgICAgIHZhciBpc0ZhbW91cyA9IFIucGF0aEVxKFsnYWRkcmVzcycsICd6aXBDb2RlJ10sIDkwMjEwKTtcbiAgICAgKiAgICAgIFIuZmlsdGVyKGlzRmFtb3VzLCB1c2Vycyk7IC8vPT4gWyB1c2VyMSBdXG4gICAgICovXG4gICAgdmFyIHBhdGhFcSA9IF9jdXJyeTMoZnVuY3Rpb24gcGF0aEVxKF9wYXRoLCB2YWwsIG9iaikge1xuICAgICAgICByZXR1cm4gZXF1YWxzKHBhdGgoX3BhdGgsIG9iaiksIHZhbCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgYnkgcGx1Y2tpbmcgdGhlIHNhbWUgbmFtZWQgcHJvcGVydHkgb2ZmIGFsbCBvYmplY3RzIGluIHRoZSBsaXN0IHN1cHBsaWVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBrIC0+IFt7azogdn1dIC0+IFt2XVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfFN0cmluZ30ga2V5IFRoZSBrZXkgbmFtZSB0byBwbHVjayBvZmYgb2YgZWFjaCBvYmplY3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBsaXN0IG9mIHZhbHVlcyBmb3IgdGhlIGdpdmVuIGtleS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnBsdWNrKCdhJykoW3thOiAxfSwge2E6IDJ9XSk7IC8vPT4gWzEsIDJdXG4gICAgICogICAgICBSLnBsdWNrKDApKFtbMSwgMl0sIFszLCA0XV0pOyAgIC8vPT4gWzEsIDNdXG4gICAgICovXG4gICAgdmFyIHBsdWNrID0gX2N1cnJ5MihmdW5jdGlvbiBwbHVjayhwLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBtYXAocHJvcChwKSwgbGlzdCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgc3BlY2lmaWVkIG9iamVjdCBwcm9wZXJ0eSBpcyBlcXVhbCwgaW4gYFIuZXF1YWxzYFxuICAgICAqIHRlcm1zLCB0byB0aGUgZ2l2ZW4gdmFsdWU7IGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgU3RyaW5nIC0+IGEgLT4gT2JqZWN0IC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsXG4gICAgICogQHBhcmFtIHsqfSBvYmpcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBzZWUgUi5lcXVhbHMsIFIucHJvcFNhdGlzZmllc1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBhYmJ5ID0ge25hbWU6ICdBYmJ5JywgYWdlOiA3LCBoYWlyOiAnYmxvbmQnfTtcbiAgICAgKiAgICAgIHZhciBmcmVkID0ge25hbWU6ICdGcmVkJywgYWdlOiAxMiwgaGFpcjogJ2Jyb3duJ307XG4gICAgICogICAgICB2YXIgcnVzdHkgPSB7bmFtZTogJ1J1c3R5JywgYWdlOiAxMCwgaGFpcjogJ2Jyb3duJ307XG4gICAgICogICAgICB2YXIgYWxvaXMgPSB7bmFtZTogJ0Fsb2lzJywgYWdlOiAxNSwgZGlzcG9zaXRpb246ICdzdXJseSd9O1xuICAgICAqICAgICAgdmFyIGtpZHMgPSBbYWJieSwgZnJlZCwgcnVzdHksIGFsb2lzXTtcbiAgICAgKiAgICAgIHZhciBoYXNCcm93bkhhaXIgPSBSLnByb3BFcSgnaGFpcicsICdicm93bicpO1xuICAgICAqICAgICAgUi5maWx0ZXIoaGFzQnJvd25IYWlyLCBraWRzKTsgLy89PiBbZnJlZCwgcnVzdHldXG4gICAgICovXG4gICAgdmFyIHByb3BFcSA9IF9jdXJyeTMoZnVuY3Rpb24gcHJvcEVxKG5hbWUsIHZhbCwgb2JqKSB7XG4gICAgICAgIHJldHVybiBwcm9wU2F0aXNmaWVzKGVxdWFscyh2YWwpLCBuYW1lLCBvYmopO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHNwZWNpZmllZCBvYmplY3QgcHJvcGVydHkgaXMgb2YgdGhlIGdpdmVuIHR5cGU7XG4gICAgICogYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFR5cGVcbiAgICAgKiBAc2lnIFR5cGUgLT4gU3RyaW5nIC0+IE9iamVjdCAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gdHlwZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAgICogQHBhcmFtIHsqfSBvYmpcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBzZWUgUi5pc1xuICAgICAqIEBzZWUgUi5wcm9wU2F0aXNmaWVzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5wcm9wSXMoTnVtYmVyLCAneCcsIHt4OiAxLCB5OiAyfSk7ICAvLz0+IHRydWVcbiAgICAgKiAgICAgIFIucHJvcElzKE51bWJlciwgJ3gnLCB7eDogJ2Zvbyd9KTsgICAgLy89PiBmYWxzZVxuICAgICAqICAgICAgUi5wcm9wSXMoTnVtYmVyLCAneCcsIHt9KTsgICAgICAgICAgICAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIHByb3BJcyA9IF9jdXJyeTMoZnVuY3Rpb24gcHJvcElzKHR5cGUsIG5hbWUsIG9iaikge1xuICAgICAgICByZXR1cm4gcHJvcFNhdGlzZmllcyhpcyh0eXBlKSwgbmFtZSwgb2JqKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzaW5nbGUgaXRlbSBieSBpdGVyYXRpbmcgdGhyb3VnaCB0aGUgbGlzdCwgc3VjY2Vzc2l2ZWx5IGNhbGxpbmcgdGhlIGl0ZXJhdG9yXG4gICAgICogZnVuY3Rpb24gYW5kIHBhc3NpbmcgaXQgYW4gYWNjdW11bGF0b3IgdmFsdWUgYW5kIHRoZSBjdXJyZW50IHZhbHVlIGZyb20gdGhlIGFycmF5LCBhbmRcbiAgICAgKiB0aGVuIHBhc3NpbmcgdGhlIHJlc3VsdCB0byB0aGUgbmV4dCBjYWxsLlxuICAgICAqXG4gICAgICogVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uIHJlY2VpdmVzIHR3byB2YWx1ZXM6ICooYWNjLCB2YWx1ZSkqLiAgSXQgbWF5IHVzZSBgUi5yZWR1Y2VkYCB0b1xuICAgICAqIHNob3J0Y3V0IHRoZSBpdGVyYXRpb24uXG4gICAgICpcbiAgICAgKiBOb3RlOiBgUi5yZWR1Y2VgIGRvZXMgbm90IHNraXAgZGVsZXRlZCBvciB1bmFzc2lnbmVkIGluZGljZXMgKHNwYXJzZSBhcnJheXMpLCB1bmxpa2VcbiAgICAgKiB0aGUgbmF0aXZlIGBBcnJheS5wcm90b3R5cGUucmVkdWNlYCBtZXRob2QuIEZvciBtb3JlIGRldGFpbHMgb24gdGhpcyBiZWhhdmlvciwgc2VlOlxuICAgICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L3JlZHVjZSNEZXNjcmlwdGlvblxuICAgICAqIEBzZWUgUi5yZWR1Y2VkXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhLGIgLT4gYSkgLT4gYSAtPiBbYl0gLT4gYVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBpdGVyYXRvciBmdW5jdGlvbi4gUmVjZWl2ZXMgdHdvIHZhbHVlcywgdGhlIGFjY3VtdWxhdG9yIGFuZCB0aGVcbiAgICAgKiAgICAgICAgY3VycmVudCBlbGVtZW50IGZyb20gdGhlIGFycmF5LlxuICAgICAqIEBwYXJhbSB7Kn0gYWNjIFRoZSBhY2N1bXVsYXRvciB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBsaXN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHsqfSBUaGUgZmluYWwsIGFjY3VtdWxhdGVkIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBudW1iZXJzID0gWzEsIDIsIDNdO1xuICAgICAqICAgICAgdmFyIGFkZCA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgKiAgICAgICAgcmV0dXJuIGEgKyBiO1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgUi5yZWR1Y2UoYWRkLCAxMCwgbnVtYmVycyk7IC8vPT4gMTZcbiAgICAgKi9cbiAgICB2YXIgcmVkdWNlID0gX2N1cnJ5MyhfcmVkdWNlKTtcblxuICAgIC8qKlxuICAgICAqIFNpbWlsYXIgdG8gYGZpbHRlcmAsIGV4Y2VwdCB0aGF0IGl0IGtlZXBzIG9ubHkgdmFsdWVzIGZvciB3aGljaCB0aGUgZ2l2ZW4gcHJlZGljYXRlXG4gICAgICogZnVuY3Rpb24gcmV0dXJucyBmYWxzeS4gVGhlIHByZWRpY2F0ZSBmdW5jdGlvbiBpcyBwYXNzZWQgb25lIGFyZ3VtZW50OiAqKHZhbHVlKSouXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyAoYSAtPiBCb29sZWFuKSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbmV3IGZpbHRlcmVkIGFycmF5LlxuICAgICAqIEBzZWUgUi5maWx0ZXJcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaXNPZGQgPSBmdW5jdGlvbihuKSB7XG4gICAgICogICAgICAgIHJldHVybiBuICUgMiA9PT0gMTtcbiAgICAgKiAgICAgIH07XG4gICAgICogICAgICBSLnJlamVjdChpc09kZCwgWzEsIDIsIDMsIDRdKTsgLy89PiBbMiwgNF1cbiAgICAgKi9cbiAgICB2YXIgcmVqZWN0ID0gX2N1cnJ5MihmdW5jdGlvbiByZWplY3QoZm4sIGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIGZpbHRlcihfY29tcGxlbWVudChmbiksIGxpc3QpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZpeGVkIGxpc3Qgb2Ygc2l6ZSBgbmAgY29udGFpbmluZyBhIHNwZWNpZmllZCBpZGVudGljYWwgdmFsdWUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIGEgLT4gbiAtPiBbYV1cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byByZXBlYXQuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG4gVGhlIGRlc2lyZWQgc2l6ZSBvZiB0aGUgb3V0cHV0IGxpc3QuXG4gICAgICogQHJldHVybiB7QXJyYXl9IEEgbmV3IGFycmF5IGNvbnRhaW5pbmcgYG5gIGB2YWx1ZWBzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIucmVwZWF0KCdoaScsIDUpOyAvLz0+IFsnaGknLCAnaGknLCAnaGknLCAnaGknLCAnaGknXVxuICAgICAqXG4gICAgICogICAgICB2YXIgb2JqID0ge307XG4gICAgICogICAgICB2YXIgcmVwZWF0ZWRPYmpzID0gUi5yZXBlYXQob2JqLCA1KTsgLy89PiBbe30sIHt9LCB7fSwge30sIHt9XVxuICAgICAqICAgICAgcmVwZWF0ZWRPYmpzWzBdID09PSByZXBlYXRlZE9ianNbMV07IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciByZXBlYXQgPSBfY3VycnkyKGZ1bmN0aW9uIHJlcGVhdCh2YWx1ZSwgbikge1xuICAgICAgICByZXR1cm4gdGltZXMoYWx3YXlzKHZhbHVlKSwgbik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gbGlzdCBvciBzdHJpbmcgKG9yIG9iamVjdCB3aXRoIGEgYHNsaWNlYFxuICAgICAqIG1ldGhvZCkgZnJvbSBgZnJvbUluZGV4YCAoaW5jbHVzaXZlKSB0byBgdG9JbmRleGAgKGV4Y2x1c2l2ZSkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBOdW1iZXIgLT4gW2FdIC0+IFthXVxuICAgICAqIEBzaWcgTnVtYmVyIC0+IE51bWJlciAtPiBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGZyb21JbmRleCBUaGUgc3RhcnQgaW5kZXggKGluY2x1c2l2ZSkuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHRvSW5kZXggVGhlIGVuZCBpbmRleCAoZXhjbHVzaXZlKS5cbiAgICAgKiBAcGFyYW0geyp9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuc2xpY2UoMSwgMywgWydhJywgJ2InLCAnYycsICdkJ10pOyAgICAgICAgLy89PiBbJ2InLCAnYyddXG4gICAgICogICAgICBSLnNsaWNlKDEsIEluZmluaXR5LCBbJ2EnLCAnYicsICdjJywgJ2QnXSk7IC8vPT4gWydiJywgJ2MnLCAnZCddXG4gICAgICogICAgICBSLnNsaWNlKDAsIC0xLCBbJ2EnLCAnYicsICdjJywgJ2QnXSk7ICAgICAgIC8vPT4gWydhJywgJ2InLCAnYyddXG4gICAgICogICAgICBSLnNsaWNlKC0zLCAtMSwgWydhJywgJ2InLCAnYycsICdkJ10pOyAgICAgIC8vPT4gWydiJywgJ2MnXVxuICAgICAqICAgICAgUi5zbGljZSgwLCAzLCAncmFtZGEnKTsgICAgICAgICAgICAgICAgICAgICAvLz0+ICdyYW0nXG4gICAgICovXG4gICAgdmFyIHNsaWNlID0gX2N1cnJ5MyhfY2hlY2tGb3JNZXRob2QoJ3NsaWNlJywgZnVuY3Rpb24gc2xpY2UoZnJvbUluZGV4LCB0b0luZGV4LCBsaXN0KSB7XG4gICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChsaXN0LCBmcm9tSW5kZXgsIHRvSW5kZXgpO1xuICAgIH0pKTtcblxuICAgIC8qKlxuICAgICAqIFNwbGl0cyBhIGNvbGxlY3Rpb24gaW50byBzbGljZXMgb2YgdGhlIHNwZWNpZmllZCBsZW5ndGguXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBbYV0gLT4gW1thXV1cbiAgICAgKiBAc2lnIE51bWJlciAtPiBTdHJpbmcgLT4gW1N0cmluZ11cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gblxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnNwbGl0RXZlcnkoMywgWzEsIDIsIDMsIDQsIDUsIDYsIDddKTsgLy89PiBbWzEsIDIsIDNdLCBbNCwgNSwgNl0sIFs3XV1cbiAgICAgKiAgICAgIFIuc3BsaXRFdmVyeSgzLCAnZm9vYmFyYmF6Jyk7IC8vPT4gWydmb28nLCAnYmFyJywgJ2JheiddXG4gICAgICovXG4gICAgdmFyIHNwbGl0RXZlcnkgPSBfY3VycnkyKGZ1bmN0aW9uIHNwbGl0RXZlcnkobiwgbGlzdCkge1xuICAgICAgICBpZiAobiA8PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZpcnN0IGFyZ3VtZW50IHRvIHNwbGl0RXZlcnkgbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXInKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHNsaWNlKGlkeCwgaWR4ICs9IG4sIGxpc3QpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQWRkcyB0b2dldGhlciBhbGwgdGhlIGVsZW1lbnRzIG9mIGEgbGlzdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBzaWcgW051bWJlcl0gLT4gTnVtYmVyXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBBbiBhcnJheSBvZiBudW1iZXJzXG4gICAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgc3VtIG9mIGFsbCB0aGUgbnVtYmVycyBpbiB0aGUgbGlzdC5cbiAgICAgKiBAc2VlIFIucmVkdWNlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5zdW0oWzIsNCw2LDgsMTAwLDFdKTsgLy89PiAxMjFcbiAgICAgKi9cbiAgICB2YXIgc3VtID0gcmVkdWNlKGFkZCwgMCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFsbCBidXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGdpdmVuIGxpc3Qgb3Igc3RyaW5nIChvciBvYmplY3RcbiAgICAgKiB3aXRoIGEgYHRhaWxgIG1ldGhvZCkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2VlIFIuaGVhZCwgUi5pbml0LCBSLmxhc3RcbiAgICAgKiBAc2lnIFthXSAtPiBbYV1cbiAgICAgKiBAc2lnIFN0cmluZyAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0geyp9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudGFpbChbMSwgMiwgM10pOyAgLy89PiBbMiwgM11cbiAgICAgKiAgICAgIFIudGFpbChbMSwgMl0pOyAgICAgLy89PiBbMl1cbiAgICAgKiAgICAgIFIudGFpbChbMV0pOyAgICAgICAgLy89PiBbXVxuICAgICAqICAgICAgUi50YWlsKFtdKTsgICAgICAgICAvLz0+IFtdXG4gICAgICpcbiAgICAgKiAgICAgIFIudGFpbCgnYWJjJyk7ICAvLz0+ICdiYydcbiAgICAgKiAgICAgIFIudGFpbCgnYWInKTsgICAvLz0+ICdiJ1xuICAgICAqICAgICAgUi50YWlsKCdhJyk7ICAgIC8vPT4gJydcbiAgICAgKiAgICAgIFIudGFpbCgnJyk7ICAgICAvLz0+ICcnXG4gICAgICovXG4gICAgdmFyIHRhaWwgPSBfY2hlY2tGb3JNZXRob2QoJ3RhaWwnLCBzbGljZSgxLCBJbmZpbml0eSkpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZmlyc3QgYG5gIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBsaXN0LCBzdHJpbmcsIG9yXG4gICAgICogdHJhbnNkdWNlci90cmFuc2Zvcm1lciAob3Igb2JqZWN0IHdpdGggYSBgdGFrZWAgbWV0aG9kKS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAc2lnIE51bWJlciAtPiBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG5cbiAgICAgKiBAcGFyYW0geyp9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBzZWUgUi5kcm9wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50YWtlKDEsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydmb28nXVxuICAgICAqICAgICAgUi50YWtlKDIsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydmb28nLCAnYmFyJ11cbiAgICAgKiAgICAgIFIudGFrZSgzLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnZm9vJywgJ2JhcicsICdiYXonXVxuICAgICAqICAgICAgUi50YWtlKDQsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydmb28nLCAnYmFyJywgJ2JheiddXG4gICAgICogICAgICBSLnRha2UoMywgJ3JhbWRhJyk7ICAgICAgICAgICAgICAgLy89PiAncmFtJ1xuICAgICAqXG4gICAgICogICAgICB2YXIgcGVyc29ubmVsID0gW1xuICAgICAqICAgICAgICAnRGF2ZSBCcnViZWNrJyxcbiAgICAgKiAgICAgICAgJ1BhdWwgRGVzbW9uZCcsXG4gICAgICogICAgICAgICdFdWdlbmUgV3JpZ2h0JyxcbiAgICAgKiAgICAgICAgJ0pvZSBNb3JlbGxvJyxcbiAgICAgKiAgICAgICAgJ0dlcnJ5IE11bGxpZ2FuJyxcbiAgICAgKiAgICAgICAgJ0JvYiBCYXRlcycsXG4gICAgICogICAgICAgICdKb2UgRG9kZ2UnLFxuICAgICAqICAgICAgICAnUm9uIENyb3R0eSdcbiAgICAgKiAgICAgIF07XG4gICAgICpcbiAgICAgKiAgICAgIHZhciB0YWtlRml2ZSA9IFIudGFrZSg1KTtcbiAgICAgKiAgICAgIHRha2VGaXZlKHBlcnNvbm5lbCk7XG4gICAgICogICAgICAvLz0+IFsnRGF2ZSBCcnViZWNrJywgJ1BhdWwgRGVzbW9uZCcsICdFdWdlbmUgV3JpZ2h0JywgJ0pvZSBNb3JlbGxvJywgJ0dlcnJ5IE11bGxpZ2FuJ11cbiAgICAgKi9cbiAgICB2YXIgdGFrZSA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgndGFrZScsIF94dGFrZSwgZnVuY3Rpb24gdGFrZShuLCB4cykge1xuICAgICAgICByZXR1cm4gc2xpY2UoMCwgbiA8IDAgPyBJbmZpbml0eSA6IG4sIHhzKTtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29udGFpbmluZyB0aGUgZmlyc3QgYG5gIGVsZW1lbnRzIG9mIGEgZ2l2ZW4gbGlzdCwgcGFzc2luZyBlYWNoIHZhbHVlXG4gICAgICogdG8gdGhlIHN1cHBsaWVkIHByZWRpY2F0ZSBmdW5jdGlvbiwgYW5kIHRlcm1pbmF0aW5nIHdoZW4gdGhlIHByZWRpY2F0ZSBmdW5jdGlvbiByZXR1cm5zXG4gICAgICogYGZhbHNlYC4gRXhjbHVkZXMgdGhlIGVsZW1lbnQgdGhhdCBjYXVzZWQgdGhlIHByZWRpY2F0ZSBmdW5jdGlvbiB0byBmYWlsLiBUaGUgcHJlZGljYXRlXG4gICAgICogZnVuY3Rpb24gaXMgcGFzc2VkIG9uZSBhcmd1bWVudDogKih2YWx1ZSkqLlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQSBuZXcgYXJyYXkuXG4gICAgICogQHNlZSBSLmRyb3BXaGlsZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBpc05vdEZvdXIgPSBmdW5jdGlvbih4KSB7XG4gICAgICogICAgICAgIHJldHVybiAhKHggPT09IDQpO1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgUi50YWtlV2hpbGUoaXNOb3RGb3VyLCBbMSwgMiwgMywgNF0pOyAvLz0+IFsxLCAyLCAzXVxuICAgICAqL1xuICAgIHZhciB0YWtlV2hpbGUgPSBfY3VycnkyKF9kaXNwYXRjaGFibGUoJ3Rha2VXaGlsZScsIF94dGFrZVdoaWxlLCBmdW5jdGlvbiB0YWtlV2hpbGUoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuICYmIGZuKGxpc3RbaWR4XSkpIHtcbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc2xpY2UobGlzdCwgMCwgaWR4KTtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhIHRyYW5zZHVjZXIgdXNpbmcgc3VwcGxpZWQgaXRlcmF0b3IgZnVuY3Rpb24uIFJldHVybnMgYSBzaW5nbGUgaXRlbSBieVxuICAgICAqIGl0ZXJhdGluZyB0aHJvdWdoIHRoZSBsaXN0LCBzdWNjZXNzaXZlbHkgY2FsbGluZyB0aGUgdHJhbnNmb3JtZWQgaXRlcmF0b3IgZnVuY3Rpb24gYW5kXG4gICAgICogcGFzc2luZyBpdCBhbiBhY2N1bXVsYXRvciB2YWx1ZSBhbmQgdGhlIGN1cnJlbnQgdmFsdWUgZnJvbSB0aGUgYXJyYXksIGFuZCB0aGVuIHBhc3NpbmdcbiAgICAgKiB0aGUgcmVzdWx0IHRvIHRoZSBuZXh0IGNhbGwuXG4gICAgICpcbiAgICAgKiBUaGUgaXRlcmF0b3IgZnVuY3Rpb24gcmVjZWl2ZXMgdHdvIHZhbHVlczogKihhY2MsIHZhbHVlKSouIEl0IHdpbGwgYmUgd3JhcHBlZCBhcyBhXG4gICAgICogdHJhbnNmb3JtZXIgdG8gaW5pdGlhbGl6ZSB0aGUgdHJhbnNkdWNlci4gQSB0cmFuc2Zvcm1lciBjYW4gYmUgcGFzc2VkIGRpcmVjdGx5IGluIHBsYWNlXG4gICAgICogb2YgYW4gaXRlcmF0b3IgZnVuY3Rpb24uICBJbiBib3RoIGNhc2VzLCBpdGVyYXRpb24gbWF5IGJlIHN0b3BwZWQgZWFybHkgd2l0aCB0aGVcbiAgICAgKiBgUi5yZWR1Y2VkYCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEEgdHJhbnNkdWNlciBpcyBhIGZ1bmN0aW9uIHRoYXQgYWNjZXB0cyBhIHRyYW5zZm9ybWVyIGFuZCByZXR1cm5zIGEgdHJhbnNmb3JtZXIgYW5kIGNhblxuICAgICAqIGJlIGNvbXBvc2VkIGRpcmVjdGx5LlxuICAgICAqXG4gICAgICogQSB0cmFuc2Zvcm1lciBpcyBhbiBhbiBvYmplY3QgdGhhdCBwcm92aWRlcyBhIDItYXJpdHkgcmVkdWNpbmcgaXRlcmF0b3IgZnVuY3Rpb24sIHN0ZXAsXG4gICAgICogMC1hcml0eSBpbml0aWFsIHZhbHVlIGZ1bmN0aW9uLCBpbml0LCBhbmQgMS1hcml0eSByZXN1bHQgZXh0cmFjdGlvbiBmdW5jdGlvbiwgcmVzdWx0LlxuICAgICAqIFRoZSBzdGVwIGZ1bmN0aW9uIGlzIHVzZWQgYXMgdGhlIGl0ZXJhdG9yIGZ1bmN0aW9uIGluIHJlZHVjZS4gVGhlIHJlc3VsdCBmdW5jdGlvbiBpcyB1c2VkXG4gICAgICogdG8gY29udmVydCB0aGUgZmluYWwgYWNjdW11bGF0b3IgaW50byB0aGUgcmV0dXJuIHR5cGUgYW5kIGluIG1vc3QgY2FzZXMgaXMgUi5pZGVudGl0eS5cbiAgICAgKiBUaGUgaW5pdCBmdW5jdGlvbiBjYW4gYmUgdXNlZCB0byBwcm92aWRlIGFuIGluaXRpYWwgYWNjdW11bGF0b3IsIGJ1dCBpcyBpZ25vcmVkIGJ5IHRyYW5zZHVjZS5cbiAgICAgKlxuICAgICAqIFRoZSBpdGVyYXRpb24gaXMgcGVyZm9ybWVkIHdpdGggUi5yZWR1Y2UgYWZ0ZXIgaW5pdGlhbGl6aW5nIHRoZSB0cmFuc2R1Y2VyLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNlZSBSLnJlZHVjZSwgUi5yZWR1Y2VkLCBSLmludG9cbiAgICAgKiBAc2lnIChjIC0+IGMpIC0+IChhLGIgLT4gYSkgLT4gYSAtPiBbYl0gLT4gYVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHhmIFRoZSB0cmFuc2R1Y2VyIGZ1bmN0aW9uLiBSZWNlaXZlcyBhIHRyYW5zZm9ybWVyIGFuZCByZXR1cm5zIGEgdHJhbnNmb3JtZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGl0ZXJhdG9yIGZ1bmN0aW9uLiBSZWNlaXZlcyB0d28gdmFsdWVzLCB0aGUgYWNjdW11bGF0b3IgYW5kIHRoZVxuICAgICAqICAgICAgICBjdXJyZW50IGVsZW1lbnQgZnJvbSB0aGUgYXJyYXkuIFdyYXBwZWQgYXMgdHJhbnNmb3JtZXIsIGlmIG5lY2Vzc2FyeSwgYW5kIHVzZWQgdG9cbiAgICAgKiAgICAgICAgaW5pdGlhbGl6ZSB0aGUgdHJhbnNkdWNlclxuICAgICAqIEBwYXJhbSB7Kn0gYWNjIFRoZSBpbml0aWFsIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGxpc3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm4geyp9IFRoZSBmaW5hbCwgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG51bWJlcnMgPSBbMSwgMiwgMywgNF07XG4gICAgICogICAgICB2YXIgdHJhbnNkdWNlciA9IFIuY29tcG9zZShSLm1hcChSLmFkZCgxKSksIFIudGFrZSgyKSk7XG4gICAgICpcbiAgICAgKiAgICAgIFIudHJhbnNkdWNlKHRyYW5zZHVjZXIsIFIuZmxpcChSLmFwcGVuZCksIFtdLCBudW1iZXJzKTsgLy89PiBbMiwgM11cbiAgICAgKi9cbiAgICB2YXIgdHJhbnNkdWNlID0gY3VycnlOKDQsIGZ1bmN0aW9uIHRyYW5zZHVjZSh4ZiwgZm4sIGFjYywgbGlzdCkge1xuICAgICAgICByZXR1cm4gX3JlZHVjZSh4Zih0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicgPyBfeHdyYXAoZm4pIDogZm4pLCBhY2MsIGxpc3QpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ29tYmluZXMgdHdvIGxpc3RzIGludG8gYSBzZXQgKGkuZS4gbm8gZHVwbGljYXRlcykgY29tcG9zZWQgb2YgdGhlIGVsZW1lbnRzIG9mIGVhY2ggbGlzdC4gIER1cGxpY2F0aW9uIGlzXG4gICAgICogZGV0ZXJtaW5lZCBhY2NvcmRpbmcgdG8gdGhlIHZhbHVlIHJldHVybmVkIGJ5IGFwcGx5aW5nIHRoZSBzdXBwbGllZCBwcmVkaWNhdGUgdG8gdHdvIGxpc3QgZWxlbWVudHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyAoYSxhIC0+IEJvb2xlYW4pIC0+IFthXSAtPiBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZCBBIHByZWRpY2F0ZSB1c2VkIHRvIHRlc3Qgd2hldGhlciB0d28gaXRlbXMgYXJlIGVxdWFsLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QxIFRoZSBmaXJzdCBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QyIFRoZSBzZWNvbmQgbGlzdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGZpcnN0IGFuZCBzZWNvbmQgbGlzdHMgY29uY2F0ZW5hdGVkLCB3aXRoXG4gICAgICogICAgICAgICBkdXBsaWNhdGVzIHJlbW92ZWQuXG4gICAgICogQHNlZSBSLnVuaW9uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgZnVuY3Rpb24gY21wKHgsIHkpIHsgcmV0dXJuIHguYSA9PT0geS5hOyB9XG4gICAgICogICAgICB2YXIgbDEgPSBbe2E6IDF9LCB7YTogMn1dO1xuICAgICAqICAgICAgdmFyIGwyID0gW3thOiAxfSwge2E6IDR9XTtcbiAgICAgKiAgICAgIFIudW5pb25XaXRoKGNtcCwgbDEsIGwyKTsgLy89PiBbe2E6IDF9LCB7YTogMn0sIHthOiA0fV1cbiAgICAgKi9cbiAgICB2YXIgdW5pb25XaXRoID0gX2N1cnJ5MyhmdW5jdGlvbiB1bmlvbldpdGgocHJlZCwgbGlzdDEsIGxpc3QyKSB7XG4gICAgICAgIHJldHVybiB1bmlxV2l0aChwcmVkLCBfY29uY2F0KGxpc3QxLCBsaXN0MikpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IGNvbnRhaW5pbmcgb25seSBvbmUgY29weSBvZiBlYWNoIGVsZW1lbnQgaW4gdGhlIG9yaWdpbmFsIGxpc3QuXG4gICAgICogYFIuZXF1YWxzYCBpcyB1c2VkIHRvIGRldGVybWluZSBlcXVhbGl0eS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgbGlzdCBvZiB1bmlxdWUgaXRlbXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi51bmlxKFsxLCAxLCAyLCAxXSk7IC8vPT4gWzEsIDJdXG4gICAgICogICAgICBSLnVuaXEoWzEsICcxJ10pOyAgICAgLy89PiBbMSwgJzEnXVxuICAgICAqICAgICAgUi51bmlxKFtbNDJdLCBbNDJdXSk7IC8vPT4gW1s0Ml1dXG4gICAgICovXG4gICAgdmFyIHVuaXEgPSB1bmlxV2l0aChlcXVhbHMpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IGJ5IHB1bGxpbmcgZXZlcnkgaXRlbSBhdCB0aGUgZmlyc3QgbGV2ZWwgb2YgbmVzdGluZyBvdXQsIGFuZCBwdXR0aW5nXG4gICAgICogdGhlbSBpbiBhIG5ldyBhcnJheS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgW2FdIC0+IFtiXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgZmxhdHRlbmVkIGxpc3QuXG4gICAgICogQHNlZSBSLmZsYXR0ZW5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnVubmVzdChbMSwgWzJdLCBbWzNdXV0pOyAvLz0+IFsxLCAyLCBbM11dXG4gICAgICogICAgICBSLnVubmVzdChbWzEsIDJdLCBbMywgNF0sIFs1LCA2XV0pOyAvLz0+IFsxLCAyLCAzLCA0LCA1LCA2XVxuICAgICAqL1xuICAgIHZhciB1bm5lc3QgPSBfY3VycnkxKF9tYWtlRmxhdChmYWxzZSkpO1xuXG4gICAgLyoqXG4gICAgICogQWNjZXB0cyBhIGZ1bmN0aW9uIGBmbmAgYW5kIGFueSBudW1iZXIgb2YgdHJhbnNmb3JtZXIgZnVuY3Rpb25zIGFuZCByZXR1cm5zIGEgbmV3XG4gICAgICogZnVuY3Rpb24uIFdoZW4gdGhlIG5ldyBmdW5jdGlvbiBpcyBpbnZva2VkLCBpdCBjYWxscyB0aGUgZnVuY3Rpb24gYGZuYCB3aXRoIHBhcmFtZXRlcnNcbiAgICAgKiBjb25zaXN0aW5nIG9mIHRoZSByZXN1bHQgb2YgY2FsbGluZyBlYWNoIHN1cHBsaWVkIGhhbmRsZXIgb24gc3VjY2Vzc2l2ZSBhcmd1bWVudHMgdG8gdGhlXG4gICAgICogbmV3IGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogSWYgbW9yZSBhcmd1bWVudHMgYXJlIHBhc3NlZCB0byB0aGUgcmV0dXJuZWQgZnVuY3Rpb24gdGhhbiB0cmFuc2Zvcm1lciBmdW5jdGlvbnMsIHRob3NlXG4gICAgICogYXJndW1lbnRzIGFyZSBwYXNzZWQgZGlyZWN0bHkgdG8gYGZuYCBhcyBhZGRpdGlvbmFsIHBhcmFtZXRlcnMuIElmIHlvdSBleHBlY3QgYWRkaXRpb25hbFxuICAgICAqIGFyZ3VtZW50cyB0aGF0IGRvbid0IG5lZWQgdG8gYmUgdHJhbnNmb3JtZWQsIGFsdGhvdWdoIHlvdSBjYW4gaWdub3JlIHRoZW0sIGl0J3MgYmVzdCB0b1xuICAgICAqIHBhc3MgYW4gaWRlbnRpdHkgZnVuY3Rpb24gc28gdGhhdCB0aGUgbmV3IGZ1bmN0aW9uIHJlcG9ydHMgdGhlIGNvcnJlY3QgYXJpdHkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoeDEgLT4geDIgLT4gLi4uIC0+IHopIC0+ICgoYSAtPiB4MSksIChiIC0+IHgyKSwgLi4uKSAtPiAoYSAtPiBiIC0+IC4uLiAtPiB6KVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byB3cmFwLlxuICAgICAqIEBwYXJhbSB7Li4uRnVuY3Rpb259IHRyYW5zZm9ybWVycyBBIHZhcmlhYmxlIG51bWJlciBvZiB0cmFuc2Zvcm1lciBmdW5jdGlvbnNcbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gVGhlIHdyYXBwZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGRvdWJsZSA9IGZ1bmN0aW9uKHkpIHsgcmV0dXJuIHkgKiAyOyB9O1xuICAgICAqICAgICAgdmFyIHNxdWFyZSA9IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHggKiB4OyB9O1xuICAgICAqICAgICAgdmFyIGFkZCA9IGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEgKyBiOyB9O1xuICAgICAqICAgICAgLy8gQWRkcyBhbnkgbnVtYmVyIG9mIGFyZ3VtZW50cyB0b2dldGhlclxuICAgICAqICAgICAgdmFyIGFkZEFsbCA9IGZ1bmN0aW9uKCkge1xuICAgICAqICAgICAgICByZXR1cm4gUi5yZWR1Y2UoYWRkLCAwLCBhcmd1bWVudHMpO1xuICAgICAqICAgICAgfTtcbiAgICAgKlxuICAgICAqICAgICAgLy8gQmFzaWMgZXhhbXBsZVxuICAgICAqICAgICAgdmFyIGFkZERvdWJsZUFuZFNxdWFyZSA9IFIudXNlV2l0aChhZGRBbGwsIGRvdWJsZSwgc3F1YXJlKTtcbiAgICAgKlxuICAgICAqICAgICAgLy/iiYUgYWRkQWxsKGRvdWJsZSgxMCksIHNxdWFyZSg1KSk7XG4gICAgICogICAgICBhZGREb3VibGVBbmRTcXVhcmUoMTAsIDUpOyAvLz0+IDQ1XG4gICAgICpcbiAgICAgKiAgICAgIC8vIEV4YW1wbGUgb2YgcGFzc2luZyBtb3JlIGFyZ3VtZW50cyB0aGFuIHRyYW5zZm9ybWVyc1xuICAgICAqICAgICAgLy/iiYUgYWRkQWxsKGRvdWJsZSgxMCksIHNxdWFyZSg1KSwgMTAwKTtcbiAgICAgKiAgICAgIGFkZERvdWJsZUFuZFNxdWFyZSgxMCwgNSwgMTAwKTsgLy89PiAxNDVcbiAgICAgKlxuICAgICAqICAgICAgLy8gSWYgdGhlcmUgYXJlIGV4dHJhIF9leHBlY3RlZF8gYXJndW1lbnRzIHRoYXQgZG9uJ3QgbmVlZCB0byBiZSB0cmFuc2Zvcm1lZCwgYWx0aG91Z2hcbiAgICAgKiAgICAgIC8vIHlvdSBjYW4gaWdub3JlIHRoZW0sIGl0IG1pZ2h0IGJlIGJlc3QgdG8gcGFzcyBpbiB0aGUgaWRlbnRpdHkgZnVuY3Rpb24gc28gdGhhdCB0aGUgbmV3XG4gICAgICogICAgICAvLyBmdW5jdGlvbiBjb3JyZWN0bHkgcmVwb3J0cyBhcml0eS5cbiAgICAgKiAgICAgIHZhciBhZGREb3VibGVBbmRTcXVhcmVXaXRoRXh0cmFQYXJhbXMgPSBSLnVzZVdpdGgoYWRkQWxsLCBkb3VibGUsIHNxdWFyZSwgUi5pZGVudGl0eSk7XG4gICAgICogICAgICAvLyBhZGREb3VibGVBbmRTcXVhcmVXaXRoRXh0cmFQYXJhbXMubGVuZ3RoIC8vPT4gM1xuICAgICAqICAgICAgLy/iiYUgYWRkQWxsKGRvdWJsZSgxMCksIHNxdWFyZSg1KSwgUi5pZGVudGl0eSgxMDApKTtcbiAgICAgKiAgICAgIGFkZERvdWJsZUFuZFNxdWFyZSgxMCwgNSwgMTAwKTsgLy89PiAxNDVcbiAgICAgKi9cbiAgICAvKiwgdHJhbnNmb3JtZXJzICovXG4gICAgdmFyIHVzZVdpdGggPSBjdXJyeShmdW5jdGlvbiB1c2VXaXRoKGZuKSB7XG4gICAgICAgIHZhciB0cmFuc2Zvcm1lcnMgPSBfc2xpY2UoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgdmFyIHRsZW4gPSB0cmFuc2Zvcm1lcnMubGVuZ3RoO1xuICAgICAgICByZXR1cm4gY3VycnkoX2FyaXR5KHRsZW4sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW10sIGlkeCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoaWR4IDwgdGxlbikge1xuICAgICAgICAgICAgICAgIGFyZ3NbaWR4XSA9IHRyYW5zZm9ybWVyc1tpZHhdKGFyZ3VtZW50c1tpZHhdKTtcbiAgICAgICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmdzLmNvbmNhdChfc2xpY2UoYXJndW1lbnRzLCB0bGVuKSkpO1xuICAgICAgICB9KSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUYWtlcyBhIHNwZWMgb2JqZWN0IGFuZCBhIHRlc3Qgb2JqZWN0OyByZXR1cm5zIHRydWUgaWYgdGhlIHRlc3Qgc2F0aXNmaWVzXG4gICAgICogdGhlIHNwZWMsIGZhbHNlIG90aGVyd2lzZS4gQW4gb2JqZWN0IHNhdGlzZmllcyB0aGUgc3BlYyBpZiwgZm9yIGVhY2ggb2YgdGhlXG4gICAgICogc3BlYydzIG93biBwcm9wZXJ0aWVzLCBhY2Nlc3NpbmcgdGhhdCBwcm9wZXJ0eSBvZiB0aGUgb2JqZWN0IGdpdmVzIHRoZSBzYW1lXG4gICAgICogdmFsdWUgKGluIGBSLmVxdWFsc2AgdGVybXMpIGFzIGFjY2Vzc2luZyB0aGF0IHByb3BlcnR5IG9mIHRoZSBzcGVjLlxuICAgICAqXG4gICAgICogYHdoZXJlRXFgIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgW2B3aGVyZWBdKCN3aGVyZSkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcge1N0cmluZzogKn0gLT4ge1N0cmluZzogKn0gLT4gQm9vbGVhblxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzcGVjXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHRlc3RPYmpcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqIEBzZWUgUi53aGVyZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIC8vIHByZWQgOjogT2JqZWN0IC0+IEJvb2xlYW5cbiAgICAgKiAgICAgIHZhciBwcmVkID0gUi53aGVyZUVxKHthOiAxLCBiOiAyfSk7XG4gICAgICpcbiAgICAgKiAgICAgIHByZWQoe2E6IDF9KTsgICAgICAgICAgICAgIC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIHByZWQoe2E6IDEsIGI6IDJ9KTsgICAgICAgIC8vPT4gdHJ1ZVxuICAgICAqICAgICAgcHJlZCh7YTogMSwgYjogMiwgYzogM30pOyAgLy89PiB0cnVlXG4gICAgICogICAgICBwcmVkKHthOiAxLCBiOiAxfSk7ICAgICAgICAvLz0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIHdoZXJlRXEgPSBfY3VycnkyKGZ1bmN0aW9uIHdoZXJlRXEoc3BlYywgdGVzdE9iaikge1xuICAgICAgICByZXR1cm4gd2hlcmUobWFwT2JqKGVxdWFscywgc3BlYyksIHRlc3RPYmopO1xuICAgIH0pO1xuXG4gICAgdmFyIF9mbGF0Q2F0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcHJlc2VydmluZ1JlZHVjZWQgPSBmdW5jdGlvbiAoeGYpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9pbml0JzogX3hmQmFzZS5pbml0LFxuICAgICAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvcmVzdWx0JzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geGZbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXShyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9zdGVwJzogZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldCA9IHhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgaW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0WydAQHRyYW5zZHVjZXIvcmVkdWNlZCddID8gX2ZvcmNlUmVkdWNlZChyZXQpIDogcmV0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBfeGNhdCh4Zikge1xuICAgICAgICAgICAgdmFyIHJ4ZiA9IHByZXNlcnZpbmdSZWR1Y2VkKHhmKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgJ0BAdHJhbnNkdWNlci9pbml0JzogX3hmQmFzZS5pbml0LFxuICAgICAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvcmVzdWx0JzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnhmWydAQHRyYW5zZHVjZXIvcmVzdWx0J10ocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICdAQHRyYW5zZHVjZXIvc3RlcCc6IGZ1bmN0aW9uIChyZXN1bHQsIGlucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhaXNBcnJheUxpa2UoaW5wdXQpID8gX3JlZHVjZShyeGYsIHJlc3VsdCwgW2lucHV0XSkgOiBfcmVkdWNlKHJ4ZiwgcmVzdWx0LCBpbnB1dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9KCk7XG5cbiAgICB2YXIgX2luZGV4T2YgPSBmdW5jdGlvbiBfaW5kZXhPZihsaXN0LCBpdGVtLCBmcm9tKSB7XG4gICAgICAgIHZhciBpZHggPSBmcm9tO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChlcXVhbHMobGlzdFtpZHhdLCBpdGVtKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHByZWRpY2F0ZSB3cmFwcGVyIHdoaWNoIHdpbGwgY2FsbCBhIHBpY2sgZnVuY3Rpb24gKGFsbC9hbnkpIGZvciBlYWNoIHByZWRpY2F0ZVxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAc2VlIFIuYWxsXG4gICAgICogQHNlZSBSLmFueVxuICAgICAqL1xuICAgIC8vIENhbGwgZnVuY3Rpb24gaW1tZWRpYXRlbHkgaWYgZ2l2ZW4gYXJndW1lbnRzXG4gICAgLy8gUmV0dXJuIGEgZnVuY3Rpb24gd2hpY2ggd2lsbCBjYWxsIHRoZSBwcmVkaWNhdGVzIHdpdGggdGhlIHByb3ZpZGVkIGFyZ3VtZW50c1xuICAgIHZhciBfcHJlZGljYXRlV3JhcCA9IGZ1bmN0aW9uIF9wcmVkaWNhdGVXcmFwKHByZWRQaWNrZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChwcmVkcykge1xuICAgICAgICAgICAgdmFyIHByZWRJdGVyYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlZFBpY2tlcihmdW5jdGlvbiAocHJlZGljYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVkaWNhdGUuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgICAgICAgICAgICAgfSwgcHJlZHMpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID4gMSA/IC8vIENhbGwgZnVuY3Rpb24gaW1tZWRpYXRlbHkgaWYgZ2l2ZW4gYXJndW1lbnRzXG4gICAgICAgICAgICBwcmVkSXRlcmF0b3IuYXBwbHkobnVsbCwgX3NsaWNlKGFyZ3VtZW50cywgMSkpIDogLy8gUmV0dXJuIGEgZnVuY3Rpb24gd2hpY2ggd2lsbCBjYWxsIHRoZSBwcmVkaWNhdGVzIHdpdGggdGhlIHByb3ZpZGVkIGFyZ3VtZW50c1xuICAgICAgICAgICAgX2FyaXR5KE1hdGgubWF4LmFwcGx5KE1hdGgsIHBsdWNrKCdsZW5ndGgnLCBwcmVkcykpLCBwcmVkSXRlcmF0b3IpO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICB2YXIgX3hjaGFpbiA9IF9jdXJyeTIoZnVuY3Rpb24gX3hjaGFpbihmLCB4Zikge1xuICAgICAgICByZXR1cm4gbWFwKGYsIF9mbGF0Q2F0KHhmKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIGxpc3Qgb2YgcHJlZGljYXRlcywgcmV0dXJucyBhIG5ldyBwcmVkaWNhdGUgdGhhdCB3aWxsIGJlIHRydWUgZXhhY3RseSB3aGVuIGFsbCBvZiB0aGVtIGFyZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnIFsoKi4uLiAtPiBCb29sZWFuKV0gLT4gKCouLi4gLT4gQm9vbGVhbilcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IEFuIGFycmF5IG9mIHByZWRpY2F0ZSBmdW5jdGlvbnNcbiAgICAgKiBAcGFyYW0geyp9IG9wdGlvbmFsIEFueSBhcmd1bWVudHMgdG8gcGFzcyBpbnRvIHRoZSBwcmVkaWNhdGVzXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IGEgZnVuY3Rpb24gdGhhdCBhcHBsaWVzIGl0cyBhcmd1bWVudHMgdG8gZWFjaCBvZlxuICAgICAqICAgICAgICAgdGhlIHByZWRpY2F0ZXMsIHJldHVybmluZyBgdHJ1ZWAgaWYgYWxsIGFyZSBzYXRpc2ZpZWQuXG4gICAgICogQHNlZSBSLmFueVBhc3NcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZ3QxMCA9IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHggPiAxMDsgfTtcbiAgICAgKiAgICAgIHZhciBldmVuID0gZnVuY3Rpb24oeCkgeyByZXR1cm4geCAlIDIgPT09IDB9O1xuICAgICAqICAgICAgdmFyIGYgPSBSLmFsbFBhc3MoW2d0MTAsIGV2ZW5dKTtcbiAgICAgKiAgICAgIGYoMTEpOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBmKDEyKTsgLy89PiB0cnVlXG4gICAgICovXG4gICAgdmFyIGFsbFBhc3MgPSBfY3VycnkxKF9wcmVkaWNhdGVXcmFwKGFsbCkpO1xuXG4gICAgLyoqXG4gICAgICogR2l2ZW4gYSBsaXN0IG9mIHByZWRpY2F0ZXMgcmV0dXJucyBhIG5ldyBwcmVkaWNhdGUgdGhhdCB3aWxsIGJlIHRydWUgZXhhY3RseSB3aGVuIGFueSBvbmUgb2YgdGhlbSBpcy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTG9naWNcbiAgICAgKiBAc2lnIFsoKi4uLiAtPiBCb29sZWFuKV0gLT4gKCouLi4gLT4gQm9vbGVhbilcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IEFuIGFycmF5IG9mIHByZWRpY2F0ZSBmdW5jdGlvbnNcbiAgICAgKiBAcGFyYW0geyp9IG9wdGlvbmFsIEFueSBhcmd1bWVudHMgdG8gcGFzcyBpbnRvIHRoZSBwcmVkaWNhdGVzXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgZnVuY3Rpb24gdGhhdCBhcHBsaWVzIGl0cyBhcmd1bWVudHMgdG8gZWFjaCBvZiB0aGUgcHJlZGljYXRlcywgcmV0dXJuaW5nXG4gICAgICogICAgICAgICBgdHJ1ZWAgaWYgYWxsIGFyZSBzYXRpc2ZpZWQuXG4gICAgICogQHNlZSBSLmFsbFBhc3NcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZ3QxMCA9IGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHggPiAxMDsgfTtcbiAgICAgKiAgICAgIHZhciBldmVuID0gZnVuY3Rpb24oeCkgeyByZXR1cm4geCAlIDIgPT09IDB9O1xuICAgICAqICAgICAgdmFyIGYgPSBSLmFueVBhc3MoW2d0MTAsIGV2ZW5dKTtcbiAgICAgKiAgICAgIGYoMTEpOyAvLz0+IHRydWVcbiAgICAgKiAgICAgIGYoOCk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgZig5KTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBhbnlQYXNzID0gX2N1cnJ5MShfcHJlZGljYXRlV3JhcChhbnkpKTtcblxuICAgIC8qKlxuICAgICAqIGFwIGFwcGxpZXMgYSBsaXN0IG9mIGZ1bmN0aW9ucyB0byBhIGxpc3Qgb2YgdmFsdWVzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgW2ZdIC0+IFthXSAtPiBbZiBhXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGZucyBBbiBhcnJheSBvZiBmdW5jdGlvbnNcbiAgICAgKiBAcGFyYW0ge0FycmF5fSB2cyBBbiBhcnJheSBvZiB2YWx1ZXNcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2YgcmVzdWx0cyBvZiBhcHBseWluZyBlYWNoIG9mIGBmbnNgIHRvIGFsbCBvZiBgdnNgIGluIHR1cm4uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5hcChbUi5tdWx0aXBseSgyKSwgUi5hZGQoMyldLCBbMSwyLDNdKTsgLy89PiBbMiwgNCwgNiwgNCwgNSwgNl1cbiAgICAgKi9cbiAgICB2YXIgYXAgPSBfY3VycnkyKGZ1bmN0aW9uIGFwKGZucywgdnMpIHtcbiAgICAgICAgcmV0dXJuIF9oYXNNZXRob2QoJ2FwJywgZm5zKSA/IGZucy5hcCh2cykgOiBfcmVkdWNlKGZ1bmN0aW9uIChhY2MsIGZuKSB7XG4gICAgICAgICAgICByZXR1cm4gX2NvbmNhdChhY2MsIG1hcChmbiwgdnMpKTtcbiAgICAgICAgfSwgW10sIGZucyk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXN1bHQgb2YgY2FsbGluZyBpdHMgZmlyc3QgYXJndW1lbnQgd2l0aCB0aGUgcmVtYWluaW5nXG4gICAgICogYXJndW1lbnRzLiBUaGlzIGlzIG9jY2FzaW9uYWxseSB1c2VmdWwgYXMgYSBjb252ZXJnaW5nIGZ1bmN0aW9uIGZvclxuICAgICAqIGBSLmNvbnZlcmdlYDogdGhlIGxlZnQgYnJhbmNoIGNhbiBwcm9kdWNlIGEgZnVuY3Rpb24gd2hpbGUgdGhlIHJpZ2h0XG4gICAgICogYnJhbmNoIHByb2R1Y2VzIGEgdmFsdWUgdG8gYmUgcGFzc2VkIHRvIHRoYXQgZnVuY3Rpb24gYXMgYW4gYXJndW1lbnQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKi4uLiAtPiBhKSwqLi4uIC0+IGFcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gYXBwbHkgdG8gdGhlIHJlbWFpbmluZyBhcmd1bWVudHMuXG4gICAgICogQHBhcmFtIHsuLi4qfSBhcmdzIEFueSBudW1iZXIgb2YgcG9zaXRpb25hbCBhcmd1bWVudHMuXG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAc2VlIFIuYXBwbHlcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgaW5kZW50TiA9IFIucGlwZShSLnRpbWVzKFIuYWx3YXlzKCcgJykpLFxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgUi5qb2luKCcnKSxcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgIFIucmVwbGFjZSgvXig/ISQpL2dtKSk7XG4gICAgICpcbiAgICAgKiAgICAgIHZhciBmb3JtYXQgPSBSLmNvbnZlcmdlKFIuY2FsbCxcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFIucGlwZShSLnByb3AoJ2luZGVudCcpLCBpbmRlbnROKSxcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFIucHJvcCgndmFsdWUnKSk7XG4gICAgICpcbiAgICAgKiAgICAgIGZvcm1hdCh7aW5kZW50OiAyLCB2YWx1ZTogJ2Zvb1xcbmJhclxcbmJhelxcbid9KTsgLy89PiAnICBmb29cXG4gIGJhclxcbiAgYmF6XFxuJ1xuICAgICAqL1xuICAgIHZhciBjYWxsID0gY3VycnkoZnVuY3Rpb24gY2FsbChmbikge1xuICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgX3NsaWNlKGFyZ3VtZW50cywgMSkpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogYGNoYWluYCBtYXBzIGEgZnVuY3Rpb24gb3ZlciBhIGxpc3QgYW5kIGNvbmNhdGVuYXRlcyB0aGUgcmVzdWx0cy5cbiAgICAgKiBUaGlzIGltcGxlbWVudGF0aW9uIGlzIGNvbXBhdGlibGUgd2l0aCB0aGVcbiAgICAgKiBGYW50YXN5LWxhbmQgQ2hhaW4gc3BlYywgYW5kIHdpbGwgd29yayB3aXRoIHR5cGVzIHRoYXQgaW1wbGVtZW50IHRoYXQgc3BlYy5cbiAgICAgKiBgY2hhaW5gIGlzIGFsc28ga25vd24gYXMgYGZsYXRNYXBgIGluIHNvbWUgbGlicmFyaWVzXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IFtiXSkgLT4gW2FdIC0+IFtiXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdFxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBkdXBsaWNhdGUgPSBmdW5jdGlvbihuKSB7XG4gICAgICogICAgICAgIHJldHVybiBbbiwgbl07XG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgUi5jaGFpbihkdXBsaWNhdGUsIFsxLCAyLCAzXSk7IC8vPT4gWzEsIDEsIDIsIDIsIDMsIDNdXG4gICAgICovXG4gICAgdmFyIGNoYWluID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdjaGFpbicsIF94Y2hhaW4sIGZ1bmN0aW9uIGNoYWluKGZuLCBsaXN0KSB7XG4gICAgICAgIHJldHVybiB1bm5lc3QobWFwKGZuLCBsaXN0KSk7XG4gICAgfSkpO1xuXG4gICAgLyoqXG4gICAgICogVHVybnMgYSBsaXN0IG9mIEZ1bmN0b3JzIGludG8gYSBGdW5jdG9yIG9mIGEgbGlzdCwgYXBwbHlpbmdcbiAgICAgKiBhIG1hcHBpbmcgZnVuY3Rpb24gdG8gdGhlIGVsZW1lbnRzIG9mIHRoZSBsaXN0IGFsb25nIHRoZSB3YXkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2VlIFIuY29tbXV0ZVxuICAgICAqIEBzaWcgRnVuY3RvciBmID0+IChmIGEgLT4gZiBiKSAtPiAoeCAtPiBmIHgpIC0+IFtmIGFdIC0+IGYgW2JdXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIHRyYW5zZm9ybWF0aW9uIGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb2YgQSBmdW5jdGlvbiB0aGF0IHJldHVybnMgdGhlIGRhdGEgdHlwZSB0byByZXR1cm5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IEFuIGFycmF5IG9mIGZ1bmN0b3JzIG9mIHRoZSBzYW1lIHR5cGVcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuY29tbXV0ZU1hcChSLm1hcChSLmFkZCgxMCkpLCBSLm9mLCBbWzFdLCBbMiwgM11dKTsgICAvLz0+IFtbMTEsIDEyXSwgWzExLCAxM11dXG4gICAgICogICAgICBSLmNvbW11dGVNYXAoUi5tYXAoUi5hZGQoMTApKSwgUi5vZiwgW1sxLCAyXSwgWzNdXSk7ICAgLy89PiBbWzExLCAxM10sIFsxMiwgMTNdXVxuICAgICAqICAgICAgUi5jb21tdXRlTWFwKFIubWFwKFIuYWRkKDEwKSksIFIub2YsIFtbMV0sIFsyXSwgWzNdXSk7IC8vPT4gW1sxMSwgMTIsIDEzXV1cbiAgICAgKiAgICAgIFIuY29tbXV0ZU1hcChSLm1hcChSLmFkZCgxMCkpLCBNYXliZS5vZiwgW0p1c3QoMSksIEp1c3QoMiksIEp1c3QoMyldKTsgICAvLz0+IEp1c3QoWzExLCAxMiwgMTNdKVxuICAgICAqICAgICAgUi5jb21tdXRlTWFwKFIubWFwKFIuYWRkKDEwKSksIE1heWJlLm9mLCBbSnVzdCgxKSwgSnVzdCgyKSwgTm90aGluZygpXSk7IC8vPT4gTm90aGluZygpXG4gICAgICovXG4gICAgdmFyIGNvbW11dGVNYXAgPSBfY3VycnkzKGZ1bmN0aW9uIGNvbW11dGVNYXAoZm4sIG9mLCBsaXN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGNvbnNGKGFjYywgZnRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGFwKG1hcChhcHBlbmQsIGZuKGZ0b3IpKSwgYWNjKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX3JlZHVjZShjb25zRiwgb2YoW10pLCBsaXN0KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFdyYXBzIGEgY29uc3RydWN0b3IgZnVuY3Rpb24gaW5zaWRlIGEgY3VycmllZCBmdW5jdGlvbiB0aGF0IGNhbiBiZSBjYWxsZWQgd2l0aCB0aGUgc2FtZVxuICAgICAqIGFyZ3VtZW50cyBhbmQgcmV0dXJucyB0aGUgc2FtZSB0eXBlLiBUaGUgYXJpdHkgb2YgdGhlIGZ1bmN0aW9uIHJldHVybmVkIGlzIHNwZWNpZmllZFxuICAgICAqIHRvIGFsbG93IHVzaW5nIHZhcmlhZGljIGNvbnN0cnVjdG9yIGZ1bmN0aW9ucy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIE51bWJlciAtPiAoKiAtPiB7Kn0pIC0+ICgqIC0+IHsqfSlcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gbiBUaGUgYXJpdHkgb2YgdGhlIGNvbnN0cnVjdG9yIGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IEZuIFRoZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiB0byB3cmFwLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIHdyYXBwZWQsIGN1cnJpZWQgY29uc3RydWN0b3IgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gVmFyaWFkaWMgY29uc3RydWN0b3IgZnVuY3Rpb25cbiAgICAgKiAgICAgIHZhciBXaWRnZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgKiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgICogICAgICAgIC8vIC4uLlxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIFdpZGdldC5wcm90b3R5cGUgPSB7XG4gICAgICogICAgICAgIC8vIC4uLlxuICAgICAqICAgICAgfTtcbiAgICAgKiAgICAgIHZhciBhbGxDb25maWdzID0gW1xuICAgICAqICAgICAgICAvLyAuLi5cbiAgICAgKiAgICAgIF07XG4gICAgICogICAgICBSLm1hcChSLmNvbnN0cnVjdE4oMSwgV2lkZ2V0KSwgYWxsQ29uZmlncyk7IC8vIGEgbGlzdCBvZiBXaWRnZXRzXG4gICAgICovXG4gICAgdmFyIGNvbnN0cnVjdE4gPSBfY3VycnkyKGZ1bmN0aW9uIGNvbnN0cnVjdE4obiwgRm4pIHtcbiAgICAgICAgaWYgKG4gPiAxMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb25zdHJ1Y3RvciB3aXRoIGdyZWF0ZXIgdGhhbiB0ZW4gYXJndW1lbnRzJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG4gPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3VycnkobkFyeShuLCBmdW5jdGlvbiAoJDAsICQxLCAkMiwgJDMsICQ0LCAkNSwgJDYsICQ3LCAkOCwgJDkpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDApO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxKTtcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZuKCQwLCAkMSwgJDIpO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMiwgJDMpO1xuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMiwgJDMsICQ0KTtcbiAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZuKCQwLCAkMSwgJDIsICQzLCAkNCwgJDUpO1xuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMiwgJDMsICQ0LCAkNSwgJDYpO1xuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm4oJDAsICQxLCAkMiwgJDMsICQ0LCAkNSwgJDYsICQ3KTtcbiAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZuKCQwLCAkMSwgJDIsICQzLCAkNCwgJDUsICQ2LCAkNywgJDgpO1xuICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZuKCQwLCAkMSwgJDIsICQzLCAkNCwgJDUsICQ2LCAkNywgJDgsICQ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQWNjZXB0cyBhdCBsZWFzdCB0aHJlZSBmdW5jdGlvbnMgYW5kIHJldHVybnMgYSBuZXcgZnVuY3Rpb24uIFdoZW4gaW52b2tlZCwgdGhpcyBuZXdcbiAgICAgKiBmdW5jdGlvbiB3aWxsIGludm9rZSB0aGUgZmlyc3QgZnVuY3Rpb24sIGBhZnRlcmAsIHBhc3NpbmcgYXMgaXRzIGFyZ3VtZW50cyB0aGVcbiAgICAgKiByZXN1bHRzIG9mIGludm9raW5nIHRoZSBzdWJzZXF1ZW50IGZ1bmN0aW9ucyB3aXRoIHdoYXRldmVyIGFyZ3VtZW50cyBhcmUgcGFzc2VkIHRvXG4gICAgICogdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICh4MSAtPiB4MiAtPiAuLi4gLT4geikgLT4gKChhIC0+IGIgLT4gLi4uIC0+IHgxKSwgKGEgLT4gYiAtPiAuLi4gLT4geDIpLCAuLi4pIC0+IChhIC0+IGIgLT4gLi4uIC0+IHopXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWZ0ZXIgQSBmdW5jdGlvbi4gYGFmdGVyYCB3aWxsIGJlIGludm9rZWQgd2l0aCB0aGUgcmV0dXJuIHZhbHVlcyBvZlxuICAgICAqICAgICAgICBgZm4xYCBhbmQgYGZuMmAgYXMgaXRzIGFyZ3VtZW50cy5cbiAgICAgKiBAcGFyYW0gey4uLkZ1bmN0aW9ufSBmdW5jdGlvbnMgQSB2YXJpYWJsZSBudW1iZXIgb2YgZnVuY3Rpb25zLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgYWRkID0gZnVuY3Rpb24oYSwgYikgeyByZXR1cm4gYSArIGI7IH07XG4gICAgICogICAgICB2YXIgbXVsdGlwbHkgPSBmdW5jdGlvbihhLCBiKSB7IHJldHVybiBhICogYjsgfTtcbiAgICAgKiAgICAgIHZhciBzdWJ0cmFjdCA9IGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEgLSBiOyB9O1xuICAgICAqXG4gICAgICogICAgICAvL+KJhSBtdWx0aXBseSggYWRkKDEsIDIpLCBzdWJ0cmFjdCgxLCAyKSApO1xuICAgICAqICAgICAgUi5jb252ZXJnZShtdWx0aXBseSwgYWRkLCBzdWJ0cmFjdCkoMSwgMik7IC8vPT4gLTNcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGFkZDMgPSBmdW5jdGlvbihhLCBiLCBjKSB7IHJldHVybiBhICsgYiArIGM7IH07XG4gICAgICogICAgICBSLmNvbnZlcmdlKGFkZDMsIG11bHRpcGx5LCBhZGQsIHN1YnRyYWN0KSgxLCAyKTsgLy89PiA0XG4gICAgICovXG4gICAgdmFyIGNvbnZlcmdlID0gY3VycnlOKDMsIGZ1bmN0aW9uIGNvbnZlcmdlKGFmdGVyKSB7XG4gICAgICAgIHZhciBmbnMgPSBfc2xpY2UoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgcmV0dXJuIGN1cnJ5TihNYXRoLm1heC5hcHBseShNYXRoLCBwbHVjaygnbGVuZ3RoJywgZm5zKSksIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIGFmdGVyLmFwcGx5KGNvbnRleHQsIF9tYXAoZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgfSwgZm5zKSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbGwgYnV0IHRoZSBmaXJzdCBgbmAgZWxlbWVudHMgb2YgdGhlIGdpdmVuIGxpc3QsIHN0cmluZywgb3JcbiAgICAgKiB0cmFuc2R1Y2VyL3RyYW5zZm9ybWVyIChvciBvYmplY3Qgd2l0aCBhIGBkcm9wYCBtZXRob2QpLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqIEBzaWcgTnVtYmVyIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAc2lnIE51bWJlciAtPiBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IG5cbiAgICAgKiBAcGFyYW0geyp9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHsqfVxuICAgICAqIEBzZWUgUi50YWtlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5kcm9wKDEsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydiYXInLCAnYmF6J11cbiAgICAgKiAgICAgIFIuZHJvcCgyLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnYmF6J11cbiAgICAgKiAgICAgIFIuZHJvcCgzLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFtdXG4gICAgICogICAgICBSLmRyb3AoNCwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbXVxuICAgICAqICAgICAgUi5kcm9wKDMsICdyYW1kYScpOyAgICAgICAgICAgICAgIC8vPT4gJ2RhJ1xuICAgICAqL1xuICAgIHZhciBkcm9wID0gX2N1cnJ5MihfZGlzcGF0Y2hhYmxlKCdkcm9wJywgX3hkcm9wLCBmdW5jdGlvbiBkcm9wKG4sIHhzKSB7XG4gICAgICAgIHJldHVybiBzbGljZShNYXRoLm1heCgwLCBuKSwgSW5maW5pdHksIHhzKTtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGlzdCBjb250YWluaW5nIGFsbCBidXQgdGhlIGxhc3QgYG5gIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBgbGlzdGAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBbYV0gLT4gW2FdXG4gICAgICogQHNpZyBOdW1iZXIgLT4gU3RyaW5nIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgb2YgYHhzYCB0byBza2lwLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHhzIFRoZSBjb2xsZWN0aW9uIHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqIEBzZWUgUi50YWtlTGFzdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZHJvcExhc3QoMSwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2ZvbycsICdiYXInXVxuICAgICAqICAgICAgUi5kcm9wTGFzdCgyLCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFsnZm9vJ11cbiAgICAgKiAgICAgIFIuZHJvcExhc3QoMywgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbXVxuICAgICAqICAgICAgUi5kcm9wTGFzdCg0LCBbJ2ZvbycsICdiYXInLCAnYmF6J10pOyAvLz0+IFtdXG4gICAgICogICAgICBSLmRyb3BMYXN0KDMsICdyYW1kYScpOyAgICAgICAgICAgICAgIC8vPT4gJ3JhJ1xuICAgICAqL1xuICAgIHZhciBkcm9wTGFzdCA9IF9jdXJyeTIoZnVuY3Rpb24gZHJvcExhc3QobiwgeHMpIHtcbiAgICAgICAgcmV0dXJuIHRha2UobiA8IHhzLmxlbmd0aCA/IHhzLmxlbmd0aCAtIG4gOiAwLCB4cyk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3Qgd2l0aG91dCBhbnkgY29uc2VjdXRpdmVseSByZXBlYXRpbmcgZWxlbWVudHMuIEVxdWFsaXR5IGlzXG4gICAgICogZGV0ZXJtaW5lZCBieSBhcHBseWluZyB0aGUgc3VwcGxpZWQgcHJlZGljYXRlIHR3byBjb25zZWN1dGl2ZSBlbGVtZW50cy5cbiAgICAgKiBUaGUgZmlyc3QgZWxlbWVudCBpbiBhIHNlcmllcyBvZiBlcXVhbCBlbGVtZW50IGlzIHRoZSBvbmUgYmVpbmcgcHJlc2VydmVkLlxuICAgICAqXG4gICAgICogQWN0cyBhcyBhIHRyYW5zZHVjZXIgaWYgYSB0cmFuc2Zvcm1lciBpcyBnaXZlbiBpbiBsaXN0IHBvc2l0aW9uLlxuICAgICAqIEBzZWUgUi50cmFuc2R1Y2VcbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgKGEsIGEgLT4gQm9vbGVhbikgLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWQgQSBwcmVkaWNhdGUgdXNlZCB0byB0ZXN0IHdoZXRoZXIgdHdvIGl0ZW1zIGFyZSBlcXVhbC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IFRoZSBhcnJheSB0byBjb25zaWRlci5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gYGxpc3RgIHdpdGhvdXQgcmVwZWF0aW5nIGVsZW1lbnRzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIGZ1bmN0aW9uIGxlbmd0aEVxKHgsIHkpIHsgcmV0dXJuIE1hdGguYWJzKHgpID09PSBNYXRoLmFicyh5KTsgfTtcbiAgICAgKiAgICAgIHZhciBsID0gWzEsIC0xLCAxLCAzLCA0LCAtNCwgLTQsIC01LCA1LCAzLCAzXTtcbiAgICAgKiAgICAgIFIuZHJvcFJlcGVhdHNXaXRoKGxlbmd0aEVxLCBsKTsgLy89PiBbMSwgMywgNCwgLTUsIDNdXG4gICAgICovXG4gICAgdmFyIGRyb3BSZXBlYXRzV2l0aCA9IF9jdXJyeTIoX2Rpc3BhdGNoYWJsZSgnZHJvcFJlcGVhdHNXaXRoJywgX3hkcm9wUmVwZWF0c1dpdGgsIGZ1bmN0aW9uIGRyb3BSZXBlYXRzV2l0aChwcmVkLCBsaXN0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIGlkeCA9IDE7XG4gICAgICAgIHZhciBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiAhPT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0WzBdID0gbGlzdFswXTtcbiAgICAgICAgICAgIHdoaWxlIChpZHggPCBsZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoIXByZWQobGFzdChyZXN1bHQpLCBsaXN0W2lkeF0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoXSA9IGxpc3RbaWR4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXBvcnRzIHdoZXRoZXIgdHdvIG9iamVjdHMgaGF2ZSB0aGUgc2FtZSB2YWx1ZSwgaW4gYFIuZXF1YWxzYCB0ZXJtcyxcbiAgICAgKiBmb3IgdGhlIHNwZWNpZmllZCBwcm9wZXJ0eS4gVXNlZnVsIGFzIGEgY3VycmllZCBwcmVkaWNhdGUuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBzaWcgayAtPiB7azogdn0gLT4ge2s6IHZ9IC0+IEJvb2xlYW5cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcCBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkgdG8gY29tcGFyZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmoxXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iajJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIG8xID0geyBhOiAxLCBiOiAyLCBjOiAzLCBkOiA0IH07XG4gICAgICogICAgICB2YXIgbzIgPSB7IGE6IDEwLCBiOiAyMCwgYzogMywgZDogNDAgfTtcbiAgICAgKiAgICAgIFIuZXFQcm9wcygnYScsIG8xLCBvMik7IC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuZXFQcm9wcygnYycsIG8xLCBvMik7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBlcVByb3BzID0gX2N1cnJ5MyhmdW5jdGlvbiBlcVByb3BzKHByb3AsIG9iajEsIG9iajIpIHtcbiAgICAgICAgcmV0dXJuIGVxdWFscyhvYmoxW3Byb3BdLCBvYmoyW3Byb3BdKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuIGl0ZW0gaW4gYW4gYXJyYXksXG4gICAgICogb3IgLTEgaWYgdGhlIGl0ZW0gaXMgbm90IGluY2x1ZGVkIGluIHRoZSBhcnJheS4gYFIuZXF1YWxzYCBpcyB1c2VkIHRvXG4gICAgICogZGV0ZXJtaW5lIGVxdWFsaXR5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBhIC0+IFthXSAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCBUaGUgaXRlbSB0byBmaW5kLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHhzIFRoZSBhcnJheSB0byBzZWFyY2ggaW4uXG4gICAgICogQHJldHVybiB7TnVtYmVyfSB0aGUgaW5kZXggb2YgdGhlIHRhcmdldCwgb3IgLTEgaWYgdGhlIHRhcmdldCBpcyBub3QgZm91bmQuXG4gICAgICogQHNlZSBSLmxhc3RJbmRleE9mXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pbmRleE9mKDMsIFsxLDIsMyw0XSk7IC8vPT4gMlxuICAgICAqICAgICAgUi5pbmRleE9mKDEwLCBbMSwyLDMsNF0pOyAvLz0+IC0xXG4gICAgICovXG4gICAgdmFyIGluZGV4T2YgPSBfY3VycnkyKGZ1bmN0aW9uIGluZGV4T2YodGFyZ2V0LCB4cykge1xuICAgICAgICByZXR1cm4gX2hhc01ldGhvZCgnaW5kZXhPZicsIHhzKSA/IHhzLmluZGV4T2YodGFyZ2V0KSA6IF9pbmRleE9mKHhzLCB0YXJnZXQsIDApO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbGwgYnV0IHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGdpdmVuIGxpc3Qgb3Igc3RyaW5nLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNlZSBSLmxhc3QsIFIuaGVhZCwgUi50YWlsXG4gICAgICogQHNpZyBbYV0gLT4gW2FdXG4gICAgICogQHNpZyBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHsqfSBsaXN0XG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmluaXQoWzEsIDIsIDNdKTsgIC8vPT4gWzEsIDJdXG4gICAgICogICAgICBSLmluaXQoWzEsIDJdKTsgICAgIC8vPT4gWzFdXG4gICAgICogICAgICBSLmluaXQoWzFdKTsgICAgICAgIC8vPT4gW11cbiAgICAgKiAgICAgIFIuaW5pdChbXSk7ICAgICAgICAgLy89PiBbXVxuICAgICAqXG4gICAgICogICAgICBSLmluaXQoJ2FiYycpOyAgLy89PiAnYWInXG4gICAgICogICAgICBSLmluaXQoJ2FiJyk7ICAgLy89PiAnYSdcbiAgICAgKiAgICAgIFIuaW5pdCgnYScpOyAgICAvLz0+ICcnXG4gICAgICogICAgICBSLmluaXQoJycpOyAgICAgLy89PiAnJ1xuICAgICAqL1xuICAgIHZhciBpbml0ID0gc2xpY2UoMCwgLTEpO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBgdHJ1ZWAgaWYgYWxsIGVsZW1lbnRzIGFyZSB1bmlxdWUsIGluIGBSLmVxdWFsc2AgdGVybXMsXG4gICAgICogb3RoZXJ3aXNlIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIFthXSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIGFsbCBlbGVtZW50cyBhcmUgdW5pcXVlLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5pc1NldChbJzEnLCAxXSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5pc1NldChbMSwgMV0pOyAgIC8vPT4gZmFsc2VcbiAgICAgKiAgICAgIFIuaXNTZXQoW1s0Ml0sIFs0Ml1dKTsgLy89PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBpc1NldCA9IF9jdXJyeTEoZnVuY3Rpb24gaXNTZXQobGlzdCkge1xuICAgICAgICB2YXIgbGVuID0gbGlzdC5sZW5ndGg7XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoX2luZGV4T2YobGlzdCwgbGlzdFtpZHhdLCBpZHggKyAxKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4ICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbGVucyBmb3IgdGhlIGdpdmVuIGdldHRlciBhbmQgc2V0dGVyIGZ1bmN0aW9ucy4gVGhlIGdldHRlciBcImdldHNcIlxuICAgICAqIHRoZSB2YWx1ZSBvZiB0aGUgZm9jdXM7IHRoZSBzZXR0ZXIgXCJzZXRzXCIgdGhlIHZhbHVlIG9mIHRoZSBmb2N1cy4gVGhlIHNldHRlclxuICAgICAqIHNob3VsZCBub3QgbXV0YXRlIHRoZSBkYXRhIHN0cnVjdHVyZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHR5cGVkZWYgTGVucyBzIGEgPSBGdW5jdG9yIGYgPT4gKGEgLT4gZiBhKSAtPiBzIC0+IGYgc1xuICAgICAqIEBzaWcgKHMgLT4gYSkgLT4gKChhLCBzKSAtPiBzKSAtPiBMZW5zIHMgYVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGdldHRlclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHNldHRlclxuICAgICAqIEByZXR1cm4ge0xlbnN9XG4gICAgICogQHNlZSBSLnZpZXcsIFIuc2V0LCBSLm92ZXIsIFIubGVuc0luZGV4LCBSLmxlbnNQcm9wXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhMZW5zID0gUi5sZW5zKFIucHJvcCgneCcpLCBSLmFzc29jKCd4JykpO1xuICAgICAqXG4gICAgICogICAgICBSLnZpZXcoeExlbnMsIHt4OiAxLCB5OiAyfSk7ICAgICAgICAgICAgLy89PiAxXG4gICAgICogICAgICBSLnNldCh4TGVucywgNCwge3g6IDEsIHk6IDJ9KTsgICAgICAgICAgLy89PiB7eDogNCwgeTogMn1cbiAgICAgKiAgICAgIFIub3Zlcih4TGVucywgUi5uZWdhdGUsIHt4OiAxLCB5OiAyfSk7ICAvLz0+IHt4OiAtMSwgeTogMn1cbiAgICAgKi9cbiAgICB2YXIgbGVucyA9IF9jdXJyeTIoZnVuY3Rpb24gbGVucyhnZXR0ZXIsIHNldHRlcikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgIHJldHVybiBtYXAoZnVuY3Rpb24gKHYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldHRlcih2LCBzKTtcbiAgICAgICAgICAgICAgICB9LCBmKGdldHRlcihzKSkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsZW5zIHdob3NlIGZvY3VzIGlzIHRoZSBzcGVjaWZpZWQgaW5kZXguXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEB0eXBlZGVmIExlbnMgcyBhID0gRnVuY3RvciBmID0+IChhIC0+IGYgYSkgLT4gcyAtPiBmIHNcbiAgICAgKiBAc2lnIE51bWJlciAtPiBMZW5zIHMgYVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuXG4gICAgICogQHJldHVybiB7TGVuc31cbiAgICAgKiBAc2VlIFIudmlldywgUi5zZXQsIFIub3ZlclxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBoZWFkTGVucyA9IFIubGVuc0luZGV4KDApO1xuICAgICAqXG4gICAgICogICAgICBSLnZpZXcoaGVhZExlbnMsIFsnYScsICdiJywgJ2MnXSk7ICAgICAgICAgICAgLy89PiAnYSdcbiAgICAgKiAgICAgIFIuc2V0KGhlYWRMZW5zLCAneCcsIFsnYScsICdiJywgJ2MnXSk7ICAgICAgICAvLz0+IFsneCcsICdiJywgJ2MnXVxuICAgICAqICAgICAgUi5vdmVyKGhlYWRMZW5zLCBSLnRvVXBwZXIsIFsnYScsICdiJywgJ2MnXSk7IC8vPT4gWydBJywgJ2InLCAnYyddXG4gICAgICovXG4gICAgdmFyIGxlbnNJbmRleCA9IF9jdXJyeTEoZnVuY3Rpb24gbGVuc0luZGV4KG4pIHtcbiAgICAgICAgcmV0dXJuIGxlbnMobnRoKG4pLCB1cGRhdGUobikpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxlbnMgd2hvc2UgZm9jdXMgaXMgdGhlIHNwZWNpZmllZCBwcm9wZXJ0eS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHR5cGVkZWYgTGVucyBzIGEgPSBGdW5jdG9yIGYgPT4gKGEgLT4gZiBhKSAtPiBzIC0+IGYgc1xuICAgICAqIEBzaWcgU3RyaW5nIC0+IExlbnMgcyBhXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGtcbiAgICAgKiBAcmV0dXJuIHtMZW5zfVxuICAgICAqIEBzZWUgUi52aWV3LCBSLnNldCwgUi5vdmVyXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHhMZW5zID0gUi5sZW5zUHJvcCgneCcpO1xuICAgICAqXG4gICAgICogICAgICBSLnZpZXcoeExlbnMsIHt4OiAxLCB5OiAyfSk7ICAgICAgICAgICAgLy89PiAxXG4gICAgICogICAgICBSLnNldCh4TGVucywgNCwge3g6IDEsIHk6IDJ9KTsgICAgICAgICAgLy89PiB7eDogNCwgeTogMn1cbiAgICAgKiAgICAgIFIub3Zlcih4TGVucywgUi5uZWdhdGUsIHt4OiAxLCB5OiAyfSk7ICAvLz0+IHt4OiAtMSwgeTogMn1cbiAgICAgKi9cbiAgICB2YXIgbGVuc1Byb3AgPSBfY3VycnkxKGZ1bmN0aW9uIGxlbnNQcm9wKGspIHtcbiAgICAgICAgcmV0dXJuIGxlbnMocHJvcChrKSwgYXNzb2MoaykpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogXCJsaWZ0c1wiIGEgZnVuY3Rpb24gdG8gYmUgdGhlIHNwZWNpZmllZCBhcml0eSwgc28gdGhhdCBpdCBtYXkgXCJtYXAgb3ZlclwiIHRoYXQgbWFueVxuICAgICAqIGxpc3RzIChvciBvdGhlciBGdW5jdG9ycykuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQHNlZSBSLmxpZnRcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnIE51bWJlciAtPiAoKi4uLiAtPiAqKSAtPiAoWypdLi4uIC0+IFsqXSlcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gbGlmdCBpbnRvIGhpZ2hlciBjb250ZXh0XG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IFRoZSBmdW5jdGlvbiBgZm5gIGFwcGxpY2FibGUgdG8gbWFwcGFibGUgb2JqZWN0cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbWFkZDMgPSBSLmxpZnROKDMsIFIuY3VycnlOKDMsIGZ1bmN0aW9uKCkge1xuICAgICAqICAgICAgICByZXR1cm4gUi5yZWR1Y2UoUi5hZGQsIDAsIGFyZ3VtZW50cyk7XG4gICAgICogICAgICB9KSk7XG4gICAgICogICAgICBtYWRkMyhbMSwyLDNdLCBbMSwyLDNdLCBbMV0pOyAvLz0+IFszLCA0LCA1LCA0LCA1LCA2LCA1LCA2LCA3XVxuICAgICAqL1xuICAgIHZhciBsaWZ0TiA9IF9jdXJyeTIoZnVuY3Rpb24gbGlmdE4oYXJpdHksIGZuKSB7XG4gICAgICAgIHZhciBsaWZ0ZWQgPSBjdXJyeU4oYXJpdHksIGZuKTtcbiAgICAgICAgcmV0dXJuIGN1cnJ5Tihhcml0eSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9yZWR1Y2UoYXAsIG1hcChsaWZ0ZWQsIGFyZ3VtZW50c1swXSksIF9zbGljZShhcmd1bWVudHMsIDEpKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBtZWFuIG9mIHRoZSBnaXZlbiBsaXN0IG9mIG51bWJlcnMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIFtOdW1iZXJdIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3RcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tZWFuKFsyLCA3LCA5XSk7IC8vPT4gNlxuICAgICAqICAgICAgUi5tZWFuKFtdKTsgLy89PiBOYU5cbiAgICAgKi9cbiAgICB2YXIgbWVhbiA9IF9jdXJyeTEoZnVuY3Rpb24gbWVhbihsaXN0KSB7XG4gICAgICAgIHJldHVybiBzdW0obGlzdCkgLyBsaXN0Lmxlbmd0aDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIG1lZGlhbiBvZiB0aGUgZ2l2ZW4gbGlzdCBvZiBudW1iZXJzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHNpZyBbTnVtYmVyXSAtPiBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0XG4gICAgICogQHJldHVybiB7TnVtYmVyfVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIubWVkaWFuKFsyLCA5LCA3XSk7IC8vPT4gN1xuICAgICAqICAgICAgUi5tZWRpYW4oWzcsIDIsIDEwLCA5XSk7IC8vPT4gOFxuICAgICAqICAgICAgUi5tZWRpYW4oW10pOyAvLz0+IE5hTlxuICAgICAqL1xuICAgIHZhciBtZWRpYW4gPSBfY3VycnkxKGZ1bmN0aW9uIG1lZGlhbihsaXN0KSB7XG4gICAgICAgIHZhciBsZW4gPSBsaXN0Lmxlbmd0aDtcbiAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIE5hTjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd2lkdGggPSAyIC0gbGVuICUgMjtcbiAgICAgICAgdmFyIGlkeCA9IChsZW4gLSB3aWR0aCkgLyAyO1xuICAgICAgICByZXR1cm4gbWVhbihfc2xpY2UobGlzdCkuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgcmV0dXJuIGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwO1xuICAgICAgICB9KS5zbGljZShpZHgsIGlkeCArIHdpZHRoKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBNZXJnZXMgYSBsaXN0IG9mIG9iamVjdHMgdG9nZXRoZXIgaW50byBvbmUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbe2s6IHZ9XSAtPiB7azogdn1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0IEFuIGFycmF5IG9mIG9iamVjdHNcbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEEgbWVyZ2VkIG9iamVjdC5cbiAgICAgKiBAc2VlIFIucmVkdWNlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi5tZXJnZUFsbChbe2ZvbzoxfSx7YmFyOjJ9LHtiYXo6M31dKTsgLy89PiB7Zm9vOjEsYmFyOjIsYmF6OjN9XG4gICAgICogICAgICBSLm1lcmdlQWxsKFt7Zm9vOjF9LHtmb286Mn0se2JhcjoyfV0pOyAvLz0+IHtmb286MixiYXI6Mn1cbiAgICAgKi9cbiAgICB2YXIgbWVyZ2VBbGwgPSBfY3VycnkxKGZ1bmN0aW9uIG1lcmdlQWxsKGxpc3QpIHtcbiAgICAgICAgcmV0dXJuIHJlZHVjZShtZXJnZSwge30sIGxpc3QpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgbGVmdC10by1yaWdodCBmdW5jdGlvbiBjb21wb3NpdGlvbi4gVGhlIGxlZnRtb3N0IGZ1bmN0aW9uIG1heSBoYXZlXG4gICAgICogYW55IGFyaXR5OyB0aGUgcmVtYWluaW5nIGZ1bmN0aW9ucyBtdXN0IGJlIHVuYXJ5LlxuICAgICAqXG4gICAgICogSW4gc29tZSBsaWJyYXJpZXMgdGhpcyBmdW5jdGlvbiBpcyBuYW1lZCBgc2VxdWVuY2VgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKCgoYSwgYiwgLi4uLCBuKSAtPiBvKSwgKG8gLT4gcCksIC4uLiwgKHggLT4geSksICh5IC0+IHopKSAtPiAoYSAtPiBiIC0+IC4uLiAtPiBuIC0+IHopXG4gICAgICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gZnVuY3Rpb25zXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQHNlZSBSLmNvbXBvc2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgZiA9IFIucGlwZShNYXRoLnBvdywgUi5uZWdhdGUsIFIuaW5jKTtcbiAgICAgKlxuICAgICAqICAgICAgZigzLCA0KTsgLy8gLSgzXjQpICsgMVxuICAgICAqL1xuICAgIHZhciBwaXBlID0gZnVuY3Rpb24gcGlwZSgpIHtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigncGlwZSByZXF1aXJlcyBhdCBsZWFzdCBvbmUgYXJndW1lbnQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3VycnlOKGFyZ3VtZW50c1swXS5sZW5ndGgsIHJlZHVjZShfcGlwZSwgYXJndW1lbnRzWzBdLCB0YWlsKGFyZ3VtZW50cykpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgbGVmdC10by1yaWdodCBjb21wb3NpdGlvbiBvZiBvbmUgb3IgbW9yZSBQcm9taXNlLXJldHVybmluZ1xuICAgICAqIGZ1bmN0aW9ucy4gVGhlIGxlZnRtb3N0IGZ1bmN0aW9uIG1heSBoYXZlIGFueSBhcml0eTsgdGhlIHJlbWFpbmluZ1xuICAgICAqIGZ1bmN0aW9ucyBtdXN0IGJlIHVuYXJ5LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKChhIC0+IFByb21pc2UgYiksIChiIC0+IFByb21pc2UgYyksIC4uLiwgKHkgLT4gUHJvbWlzZSB6KSkgLT4gKGEgLT4gUHJvbWlzZSB6KVxuICAgICAqIEBwYXJhbSB7Li4uRnVuY3Rpb259IGZ1bmN0aW9uc1xuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBzZWUgUi5jb21wb3NlUFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIC8vICBmb2xsb3dlcnNGb3JVc2VyIDo6IFN0cmluZyAtPiBQcm9taXNlIFtVc2VyXVxuICAgICAqICAgICAgdmFyIGZvbGxvd2Vyc0ZvclVzZXIgPSBSLnBpcGVQKGRiLmdldFVzZXJCeUlkLCBkYi5nZXRGb2xsb3dlcnMpO1xuICAgICAqL1xuICAgIHZhciBwaXBlUCA9IGZ1bmN0aW9uIHBpcGVQKCkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdwaXBlUCByZXF1aXJlcyBhdCBsZWFzdCBvbmUgYXJndW1lbnQnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3VycnlOKGFyZ3VtZW50c1swXS5sZW5ndGgsIHJlZHVjZShfcGlwZVAsIGFyZ3VtZW50c1swXSwgdGFpbChhcmd1bWVudHMpKSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE11bHRpcGxpZXMgdG9nZXRoZXIgYWxsIHRoZSBlbGVtZW50cyBvZiBhIGxpc3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAc2lnIFtOdW1iZXJdIC0+IE51bWJlclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgQW4gYXJyYXkgb2YgbnVtYmVyc1xuICAgICAqIEByZXR1cm4ge051bWJlcn0gVGhlIHByb2R1Y3Qgb2YgYWxsIHRoZSBudW1iZXJzIGluIHRoZSBsaXN0LlxuICAgICAqIEBzZWUgUi5yZWR1Y2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnByb2R1Y3QoWzIsNCw2LDgsMTAwLDFdKTsgLy89PiAzODQwMFxuICAgICAqL1xuICAgIHZhciBwcm9kdWN0ID0gcmVkdWNlKG11bHRpcGx5LCAxKTtcblxuICAgIC8qKlxuICAgICAqIFJlYXNvbmFibGUgYW5hbG9nIHRvIFNRTCBgc2VsZWN0YCBzdGF0ZW1lbnQuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgW2tdIC0+IFt7azogdn1dIC0+IFt7azogdn1dXG4gICAgICogQHBhcmFtIHtBcnJheX0gcHJvcHMgVGhlIHByb3BlcnR5IG5hbWVzIHRvIHByb2plY3RcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBvYmpzIFRoZSBvYmplY3RzIHRvIHF1ZXJ5XG4gICAgICogQHJldHVybiB7QXJyYXl9IEFuIGFycmF5IG9mIG9iamVjdHMgd2l0aCBqdXN0IHRoZSBgcHJvcHNgIHByb3BlcnRpZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGFiYnkgPSB7bmFtZTogJ0FiYnknLCBhZ2U6IDcsIGhhaXI6ICdibG9uZCcsIGdyYWRlOiAyfTtcbiAgICAgKiAgICAgIHZhciBmcmVkID0ge25hbWU6ICdGcmVkJywgYWdlOiAxMiwgaGFpcjogJ2Jyb3duJywgZ3JhZGU6IDd9O1xuICAgICAqICAgICAgdmFyIGtpZHMgPSBbYWJieSwgZnJlZF07XG4gICAgICogICAgICBSLnByb2plY3QoWyduYW1lJywgJ2dyYWRlJ10sIGtpZHMpOyAvLz0+IFt7bmFtZTogJ0FiYnknLCBncmFkZTogMn0sIHtuYW1lOiAnRnJlZCcsIGdyYWRlOiA3fV1cbiAgICAgKi9cbiAgICAvLyBwYXNzaW5nIGBpZGVudGl0eWAgZ2l2ZXMgY29ycmVjdCBhcml0eVxuICAgIHZhciBwcm9qZWN0ID0gdXNlV2l0aChfbWFwLCBwaWNrQWxsLCBpZGVudGl0eSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IGxpc3QgY29udGFpbmluZyB0aGUgbGFzdCBgbmAgZWxlbWVudHMgb2YgdGhlIGdpdmVuIGxpc3QuXG4gICAgICogSWYgYG4gPiBsaXN0Lmxlbmd0aGAsIHJldHVybnMgYSBsaXN0IG9mIGBsaXN0Lmxlbmd0aGAgZWxlbWVudHMuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIE51bWJlciAtPiBbYV0gLT4gW2FdXG4gICAgICogQHNpZyBOdW1iZXIgLT4gU3RyaW5nIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBuIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gcmV0dXJuLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHhzIFRoZSBjb2xsZWN0aW9uIHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqIEBzZWUgUi5kcm9wTGFzdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudGFrZUxhc3QoMSwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2JheiddXG4gICAgICogICAgICBSLnRha2VMYXN0KDIsIFsnZm9vJywgJ2JhcicsICdiYXonXSk7IC8vPT4gWydmb3InLCAnYmF6J11cbiAgICAgKiAgICAgIFIudGFrZUxhc3QoMywgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2ZvbycsICdiYXInLCAnYmF6J11cbiAgICAgKiAgICAgIFIudGFrZUxhc3QoNCwgWydmb28nLCAnYmFyJywgJ2JheiddKTsgLy89PiBbJ2ZvbycsICdiYXInLCAnYmF6J11cbiAgICAgKiAgICAgIFIudGFrZUxhc3QoMywgJ3JhbWRhJyk7ICAgICAgICAgICAgICAgLy89PiAnbWRhJ1xuICAgICAqL1xuICAgIHZhciB0YWtlTGFzdCA9IF9jdXJyeTIoZnVuY3Rpb24gdGFrZUxhc3QobiwgeHMpIHtcbiAgICAgICAgcmV0dXJuIGRyb3AobiA+PSAwID8geHMubGVuZ3RoIC0gbiA6IDAsIHhzKTtcbiAgICB9KTtcblxuICAgIHZhciBfY29udGFpbnMgPSBmdW5jdGlvbiBfY29udGFpbnMoYSwgbGlzdCkge1xuICAgICAgICByZXR1cm4gX2luZGV4T2YobGlzdCwgYSwgMCkgPj0gMDtcbiAgICB9O1xuXG4gICAgLy8gIG1hcFBhaXJzIDo6IChPYmplY3QsIFtTdHJpbmddKSAtPiBbU3RyaW5nXVxuICAgIC8vIEZ1bmN0aW9uLCBSZWdFeHAsIHVzZXItZGVmaW5lZCB0eXBlc1xuICAgIHZhciBfdG9TdHJpbmcgPSBmdW5jdGlvbiBfdG9TdHJpbmcoeCwgc2Vlbikge1xuICAgICAgICB2YXIgcmVjdXIgPSBmdW5jdGlvbiByZWN1cih5KSB7XG4gICAgICAgICAgICB2YXIgeHMgPSBzZWVuLmNvbmNhdChbeF0pO1xuICAgICAgICAgICAgcmV0dXJuIF9jb250YWlucyh5LCB4cykgPyAnPENpcmN1bGFyPicgOiBfdG9TdHJpbmcoeSwgeHMpO1xuICAgICAgICB9O1xuICAgICAgICAvLyAgbWFwUGFpcnMgOjogKE9iamVjdCwgW1N0cmluZ10pIC0+IFtTdHJpbmddXG4gICAgICAgIHZhciBtYXBQYWlycyA9IGZ1bmN0aW9uIChvYmosIGtleXMpIHtcbiAgICAgICAgICAgIHJldHVybiBfbWFwKGZ1bmN0aW9uIChrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9xdW90ZShrKSArICc6ICcgKyByZWN1cihvYmpba10pO1xuICAgICAgICAgICAgfSwga2V5cy5zbGljZSgpLnNvcnQoKSk7XG4gICAgICAgIH07XG4gICAgICAgIHN3aXRjaCAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpKSB7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgQXJndW1lbnRzXSc6XG4gICAgICAgICAgICByZXR1cm4gJyhmdW5jdGlvbigpIHsgcmV0dXJuIGFyZ3VtZW50czsgfSgnICsgX21hcChyZWN1ciwgeCkuam9pbignLCAnKSArICcpKSc7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgQXJyYXldJzpcbiAgICAgICAgICAgIHJldHVybiAnWycgKyBfbWFwKHJlY3VyLCB4KS5jb25jYXQobWFwUGFpcnMoeCwgcmVqZWN0KHRlc3QoL15cXGQrJC8pLCBrZXlzKHgpKSkpLmpvaW4oJywgJykgKyAnXSc7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgQm9vbGVhbl0nOlxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiB4ID09PSAnb2JqZWN0JyA/ICduZXcgQm9vbGVhbignICsgcmVjdXIoeC52YWx1ZU9mKCkpICsgJyknIDogeC50b1N0cmluZygpO1xuICAgICAgICBjYXNlICdbb2JqZWN0IERhdGVdJzpcbiAgICAgICAgICAgIHJldHVybiAnbmV3IERhdGUoJyArIF9xdW90ZShfdG9JU09TdHJpbmcoeCkpICsgJyknO1xuICAgICAgICBjYXNlICdbb2JqZWN0IE51bGxdJzpcbiAgICAgICAgICAgIHJldHVybiAnbnVsbCc7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgTnVtYmVyXSc6XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdvYmplY3QnID8gJ25ldyBOdW1iZXIoJyArIHJlY3VyKHgudmFsdWVPZigpKSArICcpJyA6IDEgLyB4ID09PSAtSW5maW5pdHkgPyAnLTAnIDogeC50b1N0cmluZygxMCk7XG4gICAgICAgIGNhc2UgJ1tvYmplY3QgU3RyaW5nXSc6XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdvYmplY3QnID8gJ25ldyBTdHJpbmcoJyArIHJlY3VyKHgudmFsdWVPZigpKSArICcpJyA6IF9xdW90ZSh4KTtcbiAgICAgICAgY2FzZSAnW29iamVjdCBVbmRlZmluZWRdJzpcbiAgICAgICAgICAgIHJldHVybiAndW5kZWZpbmVkJztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgeC5jb25zdHJ1Y3RvciA9PT0gJ2Z1bmN0aW9uJyAmJiB4LmNvbnN0cnVjdG9yLm5hbWUgIT09ICdPYmplY3QnICYmIHR5cGVvZiB4LnRvU3RyaW5nID09PSAnZnVuY3Rpb24nICYmIHgudG9TdHJpbmcoKSAhPT0gJ1tvYmplY3QgT2JqZWN0XScgPyB4LnRvU3RyaW5nKCkgOiAvLyBGdW5jdGlvbiwgUmVnRXhwLCB1c2VyLWRlZmluZWQgdHlwZXNcbiAgICAgICAgICAgICd7JyArIG1hcFBhaXJzKHgsIGtleXMoeCkpLmpvaW4oJywgJykgKyAnfSc7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVHVybnMgYSBsaXN0IG9mIEZ1bmN0b3JzIGludG8gYSBGdW5jdG9yIG9mIGEgbGlzdC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzZWUgUi5jb21tdXRlTWFwXG4gICAgICogQHNpZyBGdW5jdG9yIGYgPT4gKHggLT4gZiB4KSAtPiBbZiBhXSAtPiBmIFthXVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9mIEEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIHRoZSBkYXRhIHR5cGUgdG8gcmV0dXJuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBBbiBhcnJheSBvZiBmdW5jdG9ycyBvZiB0aGUgc2FtZSB0eXBlXG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmNvbW11dGUoUi5vZiwgW1sxXSwgWzIsIDNdXSk7ICAgLy89PiBbWzEsIDJdLCBbMSwgM11dXG4gICAgICogICAgICBSLmNvbW11dGUoUi5vZiwgW1sxLCAyXSwgWzNdXSk7ICAgLy89PiBbWzEsIDNdLCBbMiwgM11dXG4gICAgICogICAgICBSLmNvbW11dGUoUi5vZiwgW1sxXSwgWzJdLCBbM11dKTsgLy89PiBbWzEsIDIsIDNdXVxuICAgICAqICAgICAgUi5jb21tdXRlKE1heWJlLm9mLCBbSnVzdCgxKSwgSnVzdCgyKSwgSnVzdCgzKV0pOyAgIC8vPT4gSnVzdChbMSwgMiwgM10pXG4gICAgICogICAgICBSLmNvbW11dGUoTWF5YmUub2YsIFtKdXN0KDEpLCBKdXN0KDIpLCBOb3RoaW5nKCldKTsgLy89PiBOb3RoaW5nKClcbiAgICAgKi9cbiAgICB2YXIgY29tbXV0ZSA9IGNvbW11dGVNYXAoaWRlbnRpdHkpO1xuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgcmlnaHQtdG8tbGVmdCBmdW5jdGlvbiBjb21wb3NpdGlvbi4gVGhlIHJpZ2h0bW9zdCBmdW5jdGlvbiBtYXkgaGF2ZVxuICAgICAqIGFueSBhcml0eTsgdGhlIHJlbWFpbmluZyBmdW5jdGlvbnMgbXVzdCBiZSB1bmFyeS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICgoeSAtPiB6KSwgKHggLT4geSksIC4uLiwgKG8gLT4gcCksICgoYSwgYiwgLi4uLCBuKSAtPiBvKSkgLT4gKGEgLT4gYiAtPiAuLi4gLT4gbiAtPiB6KVxuICAgICAqIEBwYXJhbSB7Li4uRnVuY3Rpb259IGZ1bmN0aW9uc1xuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBzZWUgUi5waXBlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIGYgPSBSLmNvbXBvc2UoUi5pbmMsIFIubmVnYXRlLCBNYXRoLnBvdyk7XG4gICAgICpcbiAgICAgKiAgICAgIGYoMywgNCk7IC8vIC0oM140KSArIDFcbiAgICAgKi9cbiAgICB2YXIgY29tcG9zZSA9IGZ1bmN0aW9uIGNvbXBvc2UoKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbXBvc2UgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIGFyZ3VtZW50Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBpcGUuYXBwbHkodGhpcywgcmV2ZXJzZShhcmd1bWVudHMpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcmlnaHQtdG8tbGVmdCBLbGVpc2xpIGNvbXBvc2l0aW9uIG9mIHRoZSBwcm92aWRlZCBmdW5jdGlvbnMsXG4gICAgICogZWFjaCBvZiB3aGljaCBtdXN0IHJldHVybiBhIHZhbHVlIG9mIGEgdHlwZSBzdXBwb3J0ZWQgYnkgW2BjaGFpbmBdKCNjaGFpbikuXG4gICAgICpcbiAgICAgKiBgUi5jb21wb3NlSyhoLCBnLCBmKWAgaXMgZXF1aXZhbGVudCB0byBgUi5jb21wb3NlKFIuY2hhaW4oaCksIFIuY2hhaW4oZyksIFIuY2hhaW4oZikpYC5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2VlIFIucGlwZUtcbiAgICAgKiBAc2lnIENoYWluIG0gPT4gKCh5IC0+IG0geiksICh4IC0+IG0geSksIC4uLiwgKGEgLT4gbSBiKSkgLT4gKG0gYSAtPiBtIHopXG4gICAgICogQHBhcmFtIHsuLi5GdW5jdGlvbn1cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn1cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICAvLyAgcGFyc2VKc29uIDo6IFN0cmluZyAtPiBNYXliZSAqXG4gICAgICogICAgICAvLyAgZ2V0IDo6IFN0cmluZyAtPiBPYmplY3QgLT4gTWF5YmUgKlxuICAgICAqXG4gICAgICogICAgICAvLyAgZ2V0U3RhdGVDb2RlIDo6IE1heWJlIFN0cmluZyAtPiBNYXliZSBTdHJpbmdcbiAgICAgKiAgICAgIHZhciBnZXRTdGF0ZUNvZGUgPSBSLmNvbXBvc2VLKFxuICAgICAqICAgICAgICBSLmNvbXBvc2UoTWF5YmUub2YsIFIudG9VcHBlciksXG4gICAgICogICAgICAgIGdldCgnc3RhdGUnKSxcbiAgICAgKiAgICAgICAgZ2V0KCdhZGRyZXNzJyksXG4gICAgICogICAgICAgIGdldCgndXNlcicpLFxuICAgICAqICAgICAgICBwYXJzZUpzb25cbiAgICAgKiAgICAgICk7XG4gICAgICpcbiAgICAgKiAgICAgIGdldFN0YXRlQ29kZShNYXliZS5vZigne1widXNlclwiOntcImFkZHJlc3NcIjp7XCJzdGF0ZVwiOlwibnlcIn19fScpKTtcbiAgICAgKiAgICAgIC8vPT4gSnVzdCgnTlknKVxuICAgICAqICAgICAgZ2V0U3RhdGVDb2RlKE1heWJlLm9mKCdbSW52YWxpZCBKU09OXScpKTtcbiAgICAgKiAgICAgIC8vPT4gTm90aGluZygpXG4gICAgICovXG4gICAgdmFyIGNvbXBvc2VLID0gZnVuY3Rpb24gY29tcG9zZUsoKSB7XG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAwID8gaWRlbnRpdHkgOiBjb21wb3NlLmFwcGx5KHRoaXMsIG1hcChjaGFpbiwgYXJndW1lbnRzKSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIHJpZ2h0LXRvLWxlZnQgY29tcG9zaXRpb24gb2Ygb25lIG9yIG1vcmUgUHJvbWlzZS1yZXR1cm5pbmdcbiAgICAgKiBmdW5jdGlvbnMuIFRoZSByaWdodG1vc3QgZnVuY3Rpb24gbWF5IGhhdmUgYW55IGFyaXR5OyB0aGUgcmVtYWluaW5nXG4gICAgICogZnVuY3Rpb25zIG11c3QgYmUgdW5hcnkuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKHkgLT4gUHJvbWlzZSB6KSwgKHggLT4gUHJvbWlzZSB5KSwgLi4uLCAoYSAtPiBQcm9taXNlIGIpKSAtPiAoYSAtPiBQcm9taXNlIHopXG4gICAgICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gZnVuY3Rpb25zXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259XG4gICAgICogQHNlZSBSLnBpcGVQXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gIGZvbGxvd2Vyc0ZvclVzZXIgOjogU3RyaW5nIC0+IFByb21pc2UgW1VzZXJdXG4gICAgICogICAgICB2YXIgZm9sbG93ZXJzRm9yVXNlciA9IFIuY29tcG9zZVAoZGIuZ2V0Rm9sbG93ZXJzLCBkYi5nZXRVc2VyQnlJZCk7XG4gICAgICovXG4gICAgdmFyIGNvbXBvc2VQID0gZnVuY3Rpb24gY29tcG9zZVAoKSB7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvbXBvc2VQIHJlcXVpcmVzIGF0IGxlYXN0IG9uZSBhcmd1bWVudCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwaXBlUC5hcHBseSh0aGlzLCByZXZlcnNlKGFyZ3VtZW50cykpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcyBhIGNvbnN0cnVjdG9yIGZ1bmN0aW9uIGluc2lkZSBhIGN1cnJpZWQgZnVuY3Rpb24gdGhhdCBjYW4gYmUgY2FsbGVkIHdpdGggdGhlIHNhbWVcbiAgICAgKiBhcmd1bWVudHMgYW5kIHJldHVybnMgdGhlIHNhbWUgdHlwZS5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAc2lnICgqIC0+IHsqfSkgLT4gKCogLT4geyp9KVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IEZuIFRoZSBjb25zdHJ1Y3RvciBmdW5jdGlvbiB0byB3cmFwLlxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBBIHdyYXBwZWQsIGN1cnJpZWQgY29uc3RydWN0b3IgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgLy8gQ29uc3RydWN0b3IgZnVuY3Rpb25cbiAgICAgKiAgICAgIHZhciBXaWRnZXQgPSBmdW5jdGlvbihjb25maWcpIHtcbiAgICAgKiAgICAgICAgLy8gLi4uXG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgV2lkZ2V0LnByb3RvdHlwZSA9IHtcbiAgICAgKiAgICAgICAgLy8gLi4uXG4gICAgICogICAgICB9O1xuICAgICAqICAgICAgdmFyIGFsbENvbmZpZ3MgPSBbXG4gICAgICogICAgICAgIC8vIC4uLlxuICAgICAqICAgICAgXTtcbiAgICAgKiAgICAgIFIubWFwKFIuY29uc3RydWN0KFdpZGdldCksIGFsbENvbmZpZ3MpOyAvLyBhIGxpc3Qgb2YgV2lkZ2V0c1xuICAgICAqL1xuICAgIHZhciBjb25zdHJ1Y3QgPSBfY3VycnkxKGZ1bmN0aW9uIGNvbnN0cnVjdChGbikge1xuICAgICAgICByZXR1cm4gY29uc3RydWN0TihGbi5sZW5ndGgsIEZuKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYHRydWVgIGlmIHRoZSBzcGVjaWZpZWQgdmFsdWUgaXMgZXF1YWwsIGluIGBSLmVxdWFsc2AgdGVybXMsXG4gICAgICogdG8gYXQgbGVhc3Qgb25lIGVsZW1lbnQgb2YgdGhlIGdpdmVuIGxpc3Q7IGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBhIC0+IFthXSAtPiBCb29sZWFuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGEgVGhlIGl0ZW0gdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGxpc3QgVGhlIGFycmF5IHRvIGNvbnNpZGVyLlxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiB0aGUgaXRlbSBpcyBpbiB0aGUgbGlzdCwgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLmNvbnRhaW5zKDMsIFsxLCAyLCAzXSk7IC8vPT4gdHJ1ZVxuICAgICAqICAgICAgUi5jb250YWlucyg0LCBbMSwgMiwgM10pOyAvLz0+IGZhbHNlXG4gICAgICogICAgICBSLmNvbnRhaW5zKFs0Ml0sIFtbNDJdXSk7IC8vPT4gdHJ1ZVxuICAgICAqL1xuICAgIHZhciBjb250YWlucyA9IF9jdXJyeTIoX2NvbnRhaW5zKTtcblxuICAgIC8qKlxuICAgICAqIEZpbmRzIHRoZSBzZXQgKGkuZS4gbm8gZHVwbGljYXRlcykgb2YgYWxsIGVsZW1lbnRzIGluIHRoZSBmaXJzdCBsaXN0IG5vdCBjb250YWluZWQgaW4gdGhlIHNlY29uZCBsaXN0LlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgW2FdIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MSBUaGUgZmlyc3QgbGlzdC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MiBUaGUgc2Vjb25kIGxpc3QuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBlbGVtZW50cyBpbiBgbGlzdDFgIHRoYXQgYXJlIG5vdCBpbiBgbGlzdDJgLlxuICAgICAqIEBzZWUgUi5kaWZmZXJlbmNlV2l0aFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuZGlmZmVyZW5jZShbMSwyLDMsNF0sIFs3LDYsNSw0LDNdKTsgLy89PiBbMSwyXVxuICAgICAqICAgICAgUi5kaWZmZXJlbmNlKFs3LDYsNSw0LDNdLCBbMSwyLDMsNF0pOyAvLz0+IFs3LDYsNV1cbiAgICAgKi9cbiAgICB2YXIgZGlmZmVyZW5jZSA9IF9jdXJyeTIoZnVuY3Rpb24gZGlmZmVyZW5jZShmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIHZhciBvdXQgPSBbXTtcbiAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgIHZhciBmaXJzdExlbiA9IGZpcnN0Lmxlbmd0aDtcbiAgICAgICAgd2hpbGUgKGlkeCA8IGZpcnN0TGVuKSB7XG4gICAgICAgICAgICBpZiAoIV9jb250YWlucyhmaXJzdFtpZHhdLCBzZWNvbmQpICYmICFfY29udGFpbnMoZmlyc3RbaWR4XSwgb3V0KSkge1xuICAgICAgICAgICAgICAgIG91dFtvdXQubGVuZ3RoXSA9IGZpcnN0W2lkeF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZHggKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIG5ldyBsaXN0IHdpdGhvdXQgYW55IGNvbnNlY3V0aXZlbHkgcmVwZWF0aW5nIGVsZW1lbnRzLlxuICAgICAqIGBSLmVxdWFsc2AgaXMgdXNlZCB0byBkZXRlcm1pbmUgZXF1YWxpdHkuXG4gICAgICpcbiAgICAgKiBBY3RzIGFzIGEgdHJhbnNkdWNlciBpZiBhIHRyYW5zZm9ybWVyIGlzIGdpdmVuIGluIGxpc3QgcG9zaXRpb24uXG4gICAgICogQHNlZSBSLnRyYW5zZHVjZVxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBMaXN0XG4gICAgICogQHNpZyBbYV0gLT4gW2FdXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IGBsaXN0YCB3aXRob3V0IHJlcGVhdGluZyBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgIFIuZHJvcFJlcGVhdHMoWzEsIDEsIDEsIDIsIDMsIDQsIDQsIDIsIDJdKTsgLy89PiBbMSwgMiwgMywgNCwgMl1cbiAgICAgKi9cbiAgICB2YXIgZHJvcFJlcGVhdHMgPSBfY3VycnkxKF9kaXNwYXRjaGFibGUoJ2Ryb3BSZXBlYXRzJywgX3hkcm9wUmVwZWF0c1dpdGgoZXF1YWxzKSwgZHJvcFJlcGVhdHNXaXRoKGVxdWFscykpKTtcblxuICAgIC8qKlxuICAgICAqIENvbWJpbmVzIHR3byBsaXN0cyBpbnRvIGEgc2V0IChpLmUuIG5vIGR1cGxpY2F0ZXMpIGNvbXBvc2VkIG9mIHRob3NlIGVsZW1lbnRzIGNvbW1vbiB0byBib3RoIGxpc3RzLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBSZWxhdGlvblxuICAgICAqIEBzaWcgW2FdIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MSBUaGUgZmlyc3QgbGlzdC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBsaXN0MiBUaGUgc2Vjb25kIGxpc3QuXG4gICAgICogQHNlZSBSLmludGVyc2VjdGlvbldpdGhcbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGxpc3Qgb2YgZWxlbWVudHMgZm91bmQgaW4gYm90aCBgbGlzdDFgIGFuZCBgbGlzdDJgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIuaW50ZXJzZWN0aW9uKFsxLDIsMyw0XSwgWzcsNiw1LDQsM10pOyAvLz0+IFs0LCAzXVxuICAgICAqL1xuICAgIHZhciBpbnRlcnNlY3Rpb24gPSBfY3VycnkyKGZ1bmN0aW9uIGludGVyc2VjdGlvbihsaXN0MSwgbGlzdDIpIHtcbiAgICAgICAgcmV0dXJuIHVuaXEoX2ZpbHRlcihmbGlwKF9jb250YWlucykobGlzdDEpLCBsaXN0MikpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogXCJsaWZ0c1wiIGEgZnVuY3Rpb24gb2YgYXJpdHkgPiAxIHNvIHRoYXQgaXQgbWF5IFwibWFwIG92ZXJcIiBhbiBBcnJheSBvclxuICAgICAqIG90aGVyIEZ1bmN0b3IuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQHNlZSBSLmxpZnROXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyAoKi4uLiAtPiAqKSAtPiAoWypdLi4uIC0+IFsqXSlcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gbGlmdCBpbnRvIGhpZ2hlciBjb250ZXh0XG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IFRoZSBmdW5jdGlvbiBgZm5gIGFwcGxpY2FibGUgdG8gbWFwcGFibGUgb2JqZWN0cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICB2YXIgbWFkZDMgPSBSLmxpZnQoUi5jdXJyeShmdW5jdGlvbihhLCBiLCBjKSB7XG4gICAgICogICAgICAgIHJldHVybiBhICsgYiArIGM7XG4gICAgICogICAgICB9KSk7XG4gICAgICogICAgICBtYWRkMyhbMSwyLDNdLCBbMSwyLDNdLCBbMV0pOyAvLz0+IFszLCA0LCA1LCA0LCA1LCA2LCA1LCA2LCA3XVxuICAgICAqXG4gICAgICogICAgICB2YXIgbWFkZDUgPSBSLmxpZnQoUi5jdXJyeShmdW5jdGlvbihhLCBiLCBjLCBkLCBlKSB7XG4gICAgICogICAgICAgIHJldHVybiBhICsgYiArIGMgKyBkICsgZTtcbiAgICAgKiAgICAgIH0pKTtcbiAgICAgKiAgICAgIG1hZGQ1KFsxLDJdLCBbM10sIFs0LCA1XSwgWzZdLCBbNywgOF0pOyAvLz0+IFsyMSwgMjIsIDIyLCAyMywgMjIsIDIzLCAyMywgMjRdXG4gICAgICovXG4gICAgdmFyIGxpZnQgPSBfY3VycnkxKGZ1bmN0aW9uIGxpZnQoZm4pIHtcbiAgICAgICAgcmV0dXJuIGxpZnROKGZuLmxlbmd0aCwgZm4pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHBhcnRpYWwgY29weSBvZiBhbiBvYmplY3Qgb21pdHRpbmcgdGhlIGtleXMgc3BlY2lmaWVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAc2lnIFtTdHJpbmddIC0+IHtTdHJpbmc6ICp9IC0+IHtTdHJpbmc6ICp9XG4gICAgICogQHBhcmFtIHtBcnJheX0gbmFtZXMgYW4gYXJyYXkgb2YgU3RyaW5nIHByb3BlcnR5IG5hbWVzIHRvIG9taXQgZnJvbSB0aGUgbmV3IG9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBjb3B5IGZyb21cbiAgICAgKiBAcmV0dXJuIHtPYmplY3R9IEEgbmV3IG9iamVjdCB3aXRoIHByb3BlcnRpZXMgZnJvbSBgbmFtZXNgIG5vdCBvbiBpdC5cbiAgICAgKiBAc2VlIFIucGlja1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIub21pdChbJ2EnLCAnZCddLCB7YTogMSwgYjogMiwgYzogMywgZDogNH0pOyAvLz0+IHtiOiAyLCBjOiAzfVxuICAgICAqL1xuICAgIHZhciBvbWl0ID0gX2N1cnJ5MihmdW5jdGlvbiBvbWl0KG5hbWVzLCBvYmopIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIG9iaikge1xuICAgICAgICAgICAgaWYgKCFfY29udGFpbnMocHJvcCwgbmFtZXMpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W3Byb3BdID0gb2JqW3Byb3BdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBsZWZ0LXRvLXJpZ2h0IEtsZWlzbGkgY29tcG9zaXRpb24gb2YgdGhlIHByb3ZpZGVkIGZ1bmN0aW9ucyxcbiAgICAgKiBlYWNoIG9mIHdoaWNoIG11c3QgcmV0dXJuIGEgdmFsdWUgb2YgYSB0eXBlIHN1cHBvcnRlZCBieSBbYGNoYWluYF0oI2NoYWluKS5cbiAgICAgKlxuICAgICAqIGBSLnBpcGVLKGYsIGcsIGgpYCBpcyBlcXVpdmFsZW50IHRvIGBSLnBpcGUoUi5jaGFpbihmKSwgUi5jaGFpbihnKSwgUi5jaGFpbihoKSlgLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzZWUgUi5jb21wb3NlS1xuICAgICAqIEBzaWcgQ2hhaW4gbSA9PiAoKGEgLT4gbSBiKSwgKGIgLT4gbSBjKSwgLi4uLCAoeSAtPiBtIHopKSAtPiAobSBhIC0+IG0geilcbiAgICAgKiBAcGFyYW0gey4uLkZ1bmN0aW9ufVxuICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIC8vICBwYXJzZUpzb24gOjogU3RyaW5nIC0+IE1heWJlICpcbiAgICAgKiAgICAgIC8vICBnZXQgOjogU3RyaW5nIC0+IE9iamVjdCAtPiBNYXliZSAqXG4gICAgICpcbiAgICAgKiAgICAgIC8vICBnZXRTdGF0ZUNvZGUgOjogTWF5YmUgU3RyaW5nIC0+IE1heWJlIFN0cmluZ1xuICAgICAqICAgICAgdmFyIGdldFN0YXRlQ29kZSA9IFIucGlwZUsoXG4gICAgICogICAgICAgIHBhcnNlSnNvbixcbiAgICAgKiAgICAgICAgZ2V0KCd1c2VyJyksXG4gICAgICogICAgICAgIGdldCgnYWRkcmVzcycpLFxuICAgICAqICAgICAgICBnZXQoJ3N0YXRlJyksXG4gICAgICogICAgICAgIFIuY29tcG9zZShNYXliZS5vZiwgUi50b1VwcGVyKVxuICAgICAqICAgICAgKTtcbiAgICAgKlxuICAgICAqICAgICAgZ2V0U3RhdGVDb2RlKE1heWJlLm9mKCd7XCJ1c2VyXCI6e1wiYWRkcmVzc1wiOntcInN0YXRlXCI6XCJueVwifX19JykpO1xuICAgICAqICAgICAgLy89PiBKdXN0KCdOWScpXG4gICAgICogICAgICBnZXRTdGF0ZUNvZGUoTWF5YmUub2YoJ1tJbnZhbGlkIEpTT05dJykpO1xuICAgICAqICAgICAgLy89PiBOb3RoaW5nKClcbiAgICAgKi9cbiAgICB2YXIgcGlwZUsgPSBmdW5jdGlvbiBwaXBlSygpIHtcbiAgICAgICAgcmV0dXJuIGNvbXBvc2VLLmFwcGx5KHRoaXMsIHJldmVyc2UoYXJndW1lbnRzKSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gdmFsdWUuIGBldmFsYCdpbmcgdGhlIG91dHB1dFxuICAgICAqIHNob3VsZCByZXN1bHQgaW4gYSB2YWx1ZSBlcXVpdmFsZW50IHRvIHRoZSBpbnB1dCB2YWx1ZS4gTWFueSBvZiB0aGUgYnVpbHQtaW5cbiAgICAgKiBgdG9TdHJpbmdgIG1ldGhvZHMgZG8gbm90IHNhdGlzZnkgdGhpcyByZXF1aXJlbWVudC5cbiAgICAgKlxuICAgICAqIElmIHRoZSBnaXZlbiB2YWx1ZSBpcyBhbiBgW29iamVjdCBPYmplY3RdYCB3aXRoIGEgYHRvU3RyaW5nYCBtZXRob2Qgb3RoZXJcbiAgICAgKiB0aGFuIGBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nYCwgdGhpcyBtZXRob2QgaXMgaW52b2tlZCB3aXRoIG5vIGFyZ3VtZW50c1xuICAgICAqIHRvIHByb2R1Y2UgdGhlIHJldHVybiB2YWx1ZS4gVGhpcyBtZWFucyB1c2VyLWRlZmluZWQgY29uc3RydWN0b3IgZnVuY3Rpb25zXG4gICAgICogY2FuIHByb3ZpZGUgYSBzdWl0YWJsZSBgdG9TdHJpbmdgIG1ldGhvZC4gRm9yIGV4YW1wbGU6XG4gICAgICpcbiAgICAgKiAgICAgZnVuY3Rpb24gUG9pbnQoeCwgeSkge1xuICAgICAqICAgICAgIHRoaXMueCA9IHg7XG4gICAgICogICAgICAgdGhpcy55ID0geTtcbiAgICAgKiAgICAgfVxuICAgICAqXG4gICAgICogICAgIFBvaW50LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgICAqICAgICAgIHJldHVybiAnbmV3IFBvaW50KCcgKyB0aGlzLnggKyAnLCAnICsgdGhpcy55ICsgJyknO1xuICAgICAqICAgICB9O1xuICAgICAqXG4gICAgICogICAgIFIudG9TdHJpbmcobmV3IFBvaW50KDEsIDIpKTsgLy89PiAnbmV3IFBvaW50KDEsIDIpJ1xuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAc2lnICogLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWxcbiAgICAgKiBAcmV0dXJuIHtTdHJpbmd9XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50b1N0cmluZyg0Mik7IC8vPT4gJzQyJ1xuICAgICAqICAgICAgUi50b1N0cmluZygnYWJjJyk7IC8vPT4gJ1wiYWJjXCInXG4gICAgICogICAgICBSLnRvU3RyaW5nKFsxLCAyLCAzXSk7IC8vPT4gJ1sxLCAyLCAzXSdcbiAgICAgKiAgICAgIFIudG9TdHJpbmcoe2ZvbzogMSwgYmFyOiAyLCBiYXo6IDN9KTsgLy89PiAne1wiYmFyXCI6IDIsIFwiYmF6XCI6IDMsIFwiZm9vXCI6IDF9J1xuICAgICAqICAgICAgUi50b1N0cmluZyhuZXcgRGF0ZSgnMjAwMS0wMi0wM1QwNDowNTowNlonKSk7IC8vPT4gJ25ldyBEYXRlKFwiMjAwMS0wMi0wM1QwNDowNTowNi4wMDBaXCIpJ1xuICAgICAqL1xuICAgIHZhciB0b1N0cmluZyA9IF9jdXJyeTEoZnVuY3Rpb24gdG9TdHJpbmcodmFsKSB7XG4gICAgICAgIHJldHVybiBfdG9TdHJpbmcodmFsLCBbXSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDb21iaW5lcyB0d28gbGlzdHMgaW50byBhIHNldCAoaS5lLiBubyBkdXBsaWNhdGVzKSBjb21wb3NlZCBvZiB0aGVcbiAgICAgKiBlbGVtZW50cyBvZiBlYWNoIGxpc3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFJlbGF0aW9uXG4gICAgICogQHNpZyBbYV0gLT4gW2FdIC0+IFthXVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFzIFRoZSBmaXJzdCBsaXN0LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGJzIFRoZSBzZWNvbmQgbGlzdC5cbiAgICAgKiBAcmV0dXJuIHtBcnJheX0gVGhlIGZpcnN0IGFuZCBzZWNvbmQgbGlzdHMgY29uY2F0ZW5hdGVkLCB3aXRoXG4gICAgICogICAgICAgICBkdXBsaWNhdGVzIHJlbW92ZWQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi51bmlvbihbMSwgMiwgM10sIFsyLCAzLCA0XSk7IC8vPT4gWzEsIDIsIDMsIDRdXG4gICAgICovXG4gICAgdmFyIHVuaW9uID0gX2N1cnJ5Mihjb21wb3NlKHVuaXEsIF9jb25jYXQpKTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgbGlzdCBjb250YWluaW5nIG9ubHkgb25lIGNvcHkgb2YgZWFjaCBlbGVtZW50IGluIHRoZVxuICAgICAqIG9yaWdpbmFsIGxpc3QsIGJhc2VkIHVwb24gdGhlIHZhbHVlIHJldHVybmVkIGJ5IGFwcGx5aW5nIHRoZSBzdXBwbGllZFxuICAgICAqIGZ1bmN0aW9uIHRvIGVhY2ggbGlzdCBlbGVtZW50LiBQcmVmZXJzIHRoZSBmaXJzdCBpdGVtIGlmIHRoZSBzdXBwbGllZFxuICAgICAqIGZ1bmN0aW9uIHByb2R1Y2VzIHRoZSBzYW1lIHZhbHVlIG9uIHR3byBpdGVtcy4gYFIuZXF1YWxzYCBpcyB1c2VkIGZvclxuICAgICAqIGNvbXBhcmlzb24uXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IExpc3RcbiAgICAgKiBAc2lnIChhIC0+IGIpIC0+IFthXSAtPiBbYV1cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBBIGZ1bmN0aW9uIHVzZWQgdG8gcHJvZHVjZSBhIHZhbHVlIHRvIHVzZSBkdXJpbmcgY29tcGFyaXNvbnMuXG4gICAgICogQHBhcmFtIHtBcnJheX0gbGlzdCBUaGUgYXJyYXkgdG8gY29uc2lkZXIuXG4gICAgICogQHJldHVybiB7QXJyYXl9IFRoZSBsaXN0IG9mIHVuaXF1ZSBpdGVtcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogICAgICBSLnVuaXFCeShNYXRoLmFicywgWy0xLCAtNSwgMiwgMTAsIDEsIDJdKTsgLy89PiBbLTEsIC01LCAyLCAxMF1cbiAgICAgKi9cbiAgICB2YXIgdW5pcUJ5ID0gX2N1cnJ5MihmdW5jdGlvbiB1bmlxQnkoZm4sIGxpc3QpIHtcbiAgICAgICAgdmFyIGlkeCA9IDAsIGFwcGxpZWQgPSBbXSwgcmVzdWx0ID0gW10sIGFwcGxpZWRJdGVtLCBpdGVtO1xuICAgICAgICB3aGlsZSAoaWR4IDwgbGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGl0ZW0gPSBsaXN0W2lkeF07XG4gICAgICAgICAgICBhcHBsaWVkSXRlbSA9IGZuKGl0ZW0pO1xuICAgICAgICAgICAgaWYgKCFfY29udGFpbnMoYXBwbGllZEl0ZW0sIGFwcGxpZWQpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgYXBwbGllZC5wdXNoKGFwcGxpZWRJdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlkeCArPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUdXJucyBhIG5hbWVkIG1ldGhvZCB3aXRoIGEgc3BlY2lmaWVkIGFyaXR5IGludG8gYSBmdW5jdGlvblxuICAgICAqIHRoYXQgY2FuIGJlIGNhbGxlZCBkaXJlY3RseSBzdXBwbGllZCB3aXRoIGFyZ3VtZW50cyBhbmQgYSB0YXJnZXQgb2JqZWN0LlxuICAgICAqXG4gICAgICogVGhlIHJldHVybmVkIGZ1bmN0aW9uIGlzIGN1cnJpZWQgYW5kIGFjY2VwdHMgYGFyaXR5ICsgMWAgcGFyYW1ldGVycyB3aGVyZVxuICAgICAqIHRoZSBmaW5hbCBwYXJhbWV0ZXIgaXMgdGhlIHRhcmdldCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHNpZyBOdW1iZXIgLT4gU3RyaW5nIC0+IChhIC0+IGIgLT4gLi4uIC0+IG4gLT4gT2JqZWN0IC0+ICopXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGFyaXR5IE51bWJlciBvZiBhcmd1bWVudHMgdGhlIHJldHVybmVkIGZ1bmN0aW9uIHNob3VsZCB0YWtlXG4gICAgICogICAgICAgIGJlZm9yZSB0aGUgdGFyZ2V0IG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBtZXRob2QgTmFtZSBvZiB0aGUgbWV0aG9kIHRvIGNhbGwuXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IEEgbmV3IGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgdmFyIHNsaWNlRnJvbSA9IFIuaW52b2tlcigxLCAnc2xpY2UnKTtcbiAgICAgKiAgICAgIHNsaWNlRnJvbSg2LCAnYWJjZGVmZ2hpamtsbScpOyAvLz0+ICdnaGlqa2xtJ1xuICAgICAqICAgICAgdmFyIHNsaWNlRnJvbTYgPSBSLmludm9rZXIoMiwgJ3NsaWNlJykoNik7XG4gICAgICogICAgICBzbGljZUZyb202KDgsICdhYmNkZWZnaGlqa2xtJyk7IC8vPT4gJ2doJ1xuICAgICAqL1xuICAgIHZhciBpbnZva2VyID0gX2N1cnJ5MihmdW5jdGlvbiBpbnZva2VyKGFyaXR5LCBtZXRob2QpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJ5Tihhcml0eSArIDEsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBhcmd1bWVudHNbYXJpdHldO1xuICAgICAgICAgICAgaWYgKHRhcmdldCAhPSBudWxsICYmIGlzKEZ1bmN0aW9uLCB0YXJnZXRbbWV0aG9kXSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0W21ldGhvZF0uYXBwbHkodGFyZ2V0LCBfc2xpY2UoYXJndW1lbnRzLCAwLCBhcml0eSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcih0b1N0cmluZyh0YXJnZXQpICsgJyBkb2VzIG5vdCBoYXZlIGEgbWV0aG9kIG5hbWVkIFwiJyArIG1ldGhvZCArICdcIicpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBzdHJpbmcgbWFkZSBieSBpbnNlcnRpbmcgdGhlIGBzZXBhcmF0b3JgIGJldHdlZW4gZWFjaFxuICAgICAqIGVsZW1lbnQgYW5kIGNvbmNhdGVuYXRpbmcgYWxsIHRoZSBlbGVtZW50cyBpbnRvIGEgc2luZ2xlIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgTGlzdFxuICAgICAqIEBzaWcgU3RyaW5nIC0+IFthXSAtPiBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge051bWJlcnxTdHJpbmd9IHNlcGFyYXRvciBUaGUgc3RyaW5nIHVzZWQgdG8gc2VwYXJhdGUgdGhlIGVsZW1lbnRzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHhzIFRoZSBlbGVtZW50cyB0byBqb2luIGludG8gYSBzdHJpbmcuXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBzdHIgVGhlIHN0cmluZyBtYWRlIGJ5IGNvbmNhdGVuYXRpbmcgYHhzYCB3aXRoIGBzZXBhcmF0b3JgLlxuICAgICAqIEBzZWUgUi5zcGxpdFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBzcGFjZXIgPSBSLmpvaW4oJyAnKTtcbiAgICAgKiAgICAgIHNwYWNlcihbJ2EnLCAyLCAzLjRdKTsgICAvLz0+ICdhIDIgMy40J1xuICAgICAqICAgICAgUi5qb2luKCd8JywgWzEsIDIsIDNdKTsgICAgLy89PiAnMXwyfDMnXG4gICAgICovXG4gICAgdmFyIGpvaW4gPSBpbnZva2VyKDEsICdqb2luJyk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGZ1bmN0aW9uIHRoYXQsIHdoZW4gaW52b2tlZCwgY2FjaGVzIHRoZSByZXN1bHQgb2YgY2FsbGluZyBgZm5gIGZvciBhIGdpdmVuXG4gICAgICogYXJndW1lbnQgc2V0IGFuZCByZXR1cm5zIHRoZSByZXN1bHQuIFN1YnNlcXVlbnQgY2FsbHMgdG8gdGhlIG1lbW9pemVkIGBmbmAgd2l0aCB0aGUgc2FtZVxuICAgICAqIGFyZ3VtZW50IHNldCB3aWxsIG5vdCByZXN1bHQgaW4gYW4gYWRkaXRpb25hbCBjYWxsIHRvIGBmbmA7IGluc3RlYWQsIHRoZSBjYWNoZWQgcmVzdWx0XG4gICAgICogZm9yIHRoYXQgc2V0IG9mIGFyZ3VtZW50cyB3aWxsIGJlIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBzaWcgKCouLi4gLT4gYSkgLT4gKCouLi4gLT4gYSlcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gbWVtb2l6ZS5cbiAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbn0gTWVtb2l6ZWQgdmVyc2lvbiBvZiBgZm5gLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICogICAgICB2YXIgZmFjdG9yaWFsID0gUi5tZW1vaXplKGZ1bmN0aW9uKG4pIHtcbiAgICAgKiAgICAgICAgY291bnQgKz0gMTtcbiAgICAgKiAgICAgICAgcmV0dXJuIFIucHJvZHVjdChSLnJhbmdlKDEsIG4gKyAxKSk7XG4gICAgICogICAgICB9KTtcbiAgICAgKiAgICAgIGZhY3RvcmlhbCg1KTsgLy89PiAxMjBcbiAgICAgKiAgICAgIGZhY3RvcmlhbCg1KTsgLy89PiAxMjBcbiAgICAgKiAgICAgIGZhY3RvcmlhbCg1KTsgLy89PiAxMjBcbiAgICAgKiAgICAgIGNvdW50OyAvLz0+IDFcbiAgICAgKi9cbiAgICB2YXIgbWVtb2l6ZSA9IF9jdXJyeTEoZnVuY3Rpb24gbWVtb2l6ZShmbikge1xuICAgICAgICB2YXIgY2FjaGUgPSB7fTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSB0b1N0cmluZyhhcmd1bWVudHMpO1xuICAgICAgICAgICAgaWYgKCFfaGFzKGtleSwgY2FjaGUpKSB7XG4gICAgICAgICAgICAgICAgY2FjaGVba2V5XSA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVba2V5XTtcbiAgICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFNwbGl0cyBhIHN0cmluZyBpbnRvIGFuIGFycmF5IG9mIHN0cmluZ3MgYmFzZWQgb24gdGhlIGdpdmVuXG4gICAgICogc2VwYXJhdG9yLlxuICAgICAqXG4gICAgICogQGZ1bmNcbiAgICAgKiBAbWVtYmVyT2YgUlxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAc2lnIFN0cmluZyAtPiBTdHJpbmcgLT4gW1N0cmluZ11cbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VwIFRoZSBzZXBhcmF0b3Igc3RyaW5nLlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byBzZXBhcmF0ZSBpbnRvIGFuIGFycmF5LlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBUaGUgYXJyYXkgb2Ygc3RyaW5ncyBmcm9tIGBzdHJgIHNlcGFyYXRlZCBieSBgc3RyYC5cbiAgICAgKiBAc2VlIFIuam9pblxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIHZhciBwYXRoQ29tcG9uZW50cyA9IFIuc3BsaXQoJy8nKTtcbiAgICAgKiAgICAgIFIudGFpbChwYXRoQ29tcG9uZW50cygnL3Vzci9sb2NhbC9iaW4vbm9kZScpKTsgLy89PiBbJ3VzcicsICdsb2NhbCcsICdiaW4nLCAnbm9kZSddXG4gICAgICpcbiAgICAgKiAgICAgIFIuc3BsaXQoJy4nLCAnYS5iLmMueHl6LmQnKTsgLy89PiBbJ2EnLCAnYicsICdjJywgJ3h5eicsICdkJ11cbiAgICAgKi9cbiAgICB2YXIgc3BsaXQgPSBpbnZva2VyKDEsICdzcGxpdCcpO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGxvd2VyIGNhc2UgdmVyc2lvbiBvZiBhIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBmdW5jXG4gICAgICogQG1lbWJlck9mIFJcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHNpZyBTdHJpbmcgLT4gU3RyaW5nXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIGxvd2VyIGNhc2UuXG4gICAgICogQHJldHVybiB7U3RyaW5nfSBUaGUgbG93ZXIgY2FzZSB2ZXJzaW9uIG9mIGBzdHJgLlxuICAgICAqIEBzZWUgUi50b1VwcGVyXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqICAgICAgUi50b0xvd2VyKCdYWVonKTsgLy89PiAneHl6J1xuICAgICAqL1xuICAgIHZhciB0b0xvd2VyID0gaW52b2tlcigwLCAndG9Mb3dlckNhc2UnKTtcblxuICAgIC8qKlxuICAgICAqIFRoZSB1cHBlciBjYXNlIHZlcnNpb24gb2YgYSBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAZnVuY1xuICAgICAqIEBtZW1iZXJPZiBSXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBzaWcgU3RyaW5nIC0+IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byB1cHBlciBjYXNlLlxuICAgICAqIEByZXR1cm4ge1N0cmluZ30gVGhlIHVwcGVyIGNhc2UgdmVyc2lvbiBvZiBgc3RyYC5cbiAgICAgKiBAc2VlIFIudG9Mb3dlclxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAgICAgIFIudG9VcHBlcignYWJjJyk7IC8vPT4gJ0FCQydcbiAgICAgKi9cbiAgICB2YXIgdG9VcHBlciA9IGludm9rZXIoMCwgJ3RvVXBwZXJDYXNlJyk7XG5cbiAgICB2YXIgUiA9IHtcbiAgICAgICAgRjogRixcbiAgICAgICAgVDogVCxcbiAgICAgICAgX186IF9fLFxuICAgICAgICBhZGQ6IGFkZCxcbiAgICAgICAgYWRkSW5kZXg6IGFkZEluZGV4LFxuICAgICAgICBhZGp1c3Q6IGFkanVzdCxcbiAgICAgICAgYWxsOiBhbGwsXG4gICAgICAgIGFsbFBhc3M6IGFsbFBhc3MsXG4gICAgICAgIGFsd2F5czogYWx3YXlzLFxuICAgICAgICBhbmQ6IGFuZCxcbiAgICAgICAgYW55OiBhbnksXG4gICAgICAgIGFueVBhc3M6IGFueVBhc3MsXG4gICAgICAgIGFwOiBhcCxcbiAgICAgICAgYXBlcnR1cmU6IGFwZXJ0dXJlLFxuICAgICAgICBhcHBlbmQ6IGFwcGVuZCxcbiAgICAgICAgYXBwbHk6IGFwcGx5LFxuICAgICAgICBhc3NvYzogYXNzb2MsXG4gICAgICAgIGFzc29jUGF0aDogYXNzb2NQYXRoLFxuICAgICAgICBiaW5hcnk6IGJpbmFyeSxcbiAgICAgICAgYmluZDogYmluZCxcbiAgICAgICAgYm90aDogYm90aCxcbiAgICAgICAgY2FsbDogY2FsbCxcbiAgICAgICAgY2hhaW46IGNoYWluLFxuICAgICAgICBjbG9uZTogY2xvbmUsXG4gICAgICAgIGNvbW11dGU6IGNvbW11dGUsXG4gICAgICAgIGNvbW11dGVNYXA6IGNvbW11dGVNYXAsXG4gICAgICAgIGNvbXBhcmF0b3I6IGNvbXBhcmF0b3IsXG4gICAgICAgIGNvbXBsZW1lbnQ6IGNvbXBsZW1lbnQsXG4gICAgICAgIGNvbXBvc2U6IGNvbXBvc2UsXG4gICAgICAgIGNvbXBvc2VLOiBjb21wb3NlSyxcbiAgICAgICAgY29tcG9zZVA6IGNvbXBvc2VQLFxuICAgICAgICBjb25jYXQ6IGNvbmNhdCxcbiAgICAgICAgY29uZDogY29uZCxcbiAgICAgICAgY29uc3RydWN0OiBjb25zdHJ1Y3QsXG4gICAgICAgIGNvbnN0cnVjdE46IGNvbnN0cnVjdE4sXG4gICAgICAgIGNvbnRhaW5zOiBjb250YWlucyxcbiAgICAgICAgY29udGFpbnNXaXRoOiBjb250YWluc1dpdGgsXG4gICAgICAgIGNvbnZlcmdlOiBjb252ZXJnZSxcbiAgICAgICAgY291bnRCeTogY291bnRCeSxcbiAgICAgICAgY3JlYXRlTWFwRW50cnk6IGNyZWF0ZU1hcEVudHJ5LFxuICAgICAgICBjdXJyeTogY3VycnksXG4gICAgICAgIGN1cnJ5TjogY3VycnlOLFxuICAgICAgICBkZWM6IGRlYyxcbiAgICAgICAgZGVmYXVsdFRvOiBkZWZhdWx0VG8sXG4gICAgICAgIGRpZmZlcmVuY2U6IGRpZmZlcmVuY2UsXG4gICAgICAgIGRpZmZlcmVuY2VXaXRoOiBkaWZmZXJlbmNlV2l0aCxcbiAgICAgICAgZGlzc29jOiBkaXNzb2MsXG4gICAgICAgIGRpc3NvY1BhdGg6IGRpc3NvY1BhdGgsXG4gICAgICAgIGRpdmlkZTogZGl2aWRlLFxuICAgICAgICBkcm9wOiBkcm9wLFxuICAgICAgICBkcm9wTGFzdDogZHJvcExhc3QsXG4gICAgICAgIGRyb3BMYXN0V2hpbGU6IGRyb3BMYXN0V2hpbGUsXG4gICAgICAgIGRyb3BSZXBlYXRzOiBkcm9wUmVwZWF0cyxcbiAgICAgICAgZHJvcFJlcGVhdHNXaXRoOiBkcm9wUmVwZWF0c1dpdGgsXG4gICAgICAgIGRyb3BXaGlsZTogZHJvcFdoaWxlLFxuICAgICAgICBlaXRoZXI6IGVpdGhlcixcbiAgICAgICAgZW1wdHk6IGVtcHR5LFxuICAgICAgICBlcVByb3BzOiBlcVByb3BzLFxuICAgICAgICBlcXVhbHM6IGVxdWFscyxcbiAgICAgICAgZXZvbHZlOiBldm9sdmUsXG4gICAgICAgIGZpbHRlcjogZmlsdGVyLFxuICAgICAgICBmaW5kOiBmaW5kLFxuICAgICAgICBmaW5kSW5kZXg6IGZpbmRJbmRleCxcbiAgICAgICAgZmluZExhc3Q6IGZpbmRMYXN0LFxuICAgICAgICBmaW5kTGFzdEluZGV4OiBmaW5kTGFzdEluZGV4LFxuICAgICAgICBmbGF0dGVuOiBmbGF0dGVuLFxuICAgICAgICBmbGlwOiBmbGlwLFxuICAgICAgICBmb3JFYWNoOiBmb3JFYWNoLFxuICAgICAgICBmcm9tUGFpcnM6IGZyb21QYWlycyxcbiAgICAgICAgZnVuY3Rpb25zOiBmdW5jdGlvbnMsXG4gICAgICAgIGZ1bmN0aW9uc0luOiBmdW5jdGlvbnNJbixcbiAgICAgICAgZ3JvdXBCeTogZ3JvdXBCeSxcbiAgICAgICAgZ3Q6IGd0LFxuICAgICAgICBndGU6IGd0ZSxcbiAgICAgICAgaGFzOiBoYXMsXG4gICAgICAgIGhhc0luOiBoYXNJbixcbiAgICAgICAgaGVhZDogaGVhZCxcbiAgICAgICAgaWRlbnRpY2FsOiBpZGVudGljYWwsXG4gICAgICAgIGlkZW50aXR5OiBpZGVudGl0eSxcbiAgICAgICAgaWZFbHNlOiBpZkVsc2UsXG4gICAgICAgIGluYzogaW5jLFxuICAgICAgICBpbmRleE9mOiBpbmRleE9mLFxuICAgICAgICBpbml0OiBpbml0LFxuICAgICAgICBpbnNlcnQ6IGluc2VydCxcbiAgICAgICAgaW5zZXJ0QWxsOiBpbnNlcnRBbGwsXG4gICAgICAgIGludGVyc2VjdGlvbjogaW50ZXJzZWN0aW9uLFxuICAgICAgICBpbnRlcnNlY3Rpb25XaXRoOiBpbnRlcnNlY3Rpb25XaXRoLFxuICAgICAgICBpbnRlcnNwZXJzZTogaW50ZXJzcGVyc2UsXG4gICAgICAgIGludG86IGludG8sXG4gICAgICAgIGludmVydDogaW52ZXJ0LFxuICAgICAgICBpbnZlcnRPYmo6IGludmVydE9iaixcbiAgICAgICAgaW52b2tlcjogaW52b2tlcixcbiAgICAgICAgaXM6IGlzLFxuICAgICAgICBpc0FycmF5TGlrZTogaXNBcnJheUxpa2UsXG4gICAgICAgIGlzRW1wdHk6IGlzRW1wdHksXG4gICAgICAgIGlzTmlsOiBpc05pbCxcbiAgICAgICAgaXNTZXQ6IGlzU2V0LFxuICAgICAgICBqb2luOiBqb2luLFxuICAgICAgICBrZXlzOiBrZXlzLFxuICAgICAgICBrZXlzSW46IGtleXNJbixcbiAgICAgICAgbGFzdDogbGFzdCxcbiAgICAgICAgbGFzdEluZGV4T2Y6IGxhc3RJbmRleE9mLFxuICAgICAgICBsZW5ndGg6IGxlbmd0aCxcbiAgICAgICAgbGVuczogbGVucyxcbiAgICAgICAgbGVuc0luZGV4OiBsZW5zSW5kZXgsXG4gICAgICAgIGxlbnNQcm9wOiBsZW5zUHJvcCxcbiAgICAgICAgbGlmdDogbGlmdCxcbiAgICAgICAgbGlmdE46IGxpZnROLFxuICAgICAgICBsdDogbHQsXG4gICAgICAgIGx0ZTogbHRlLFxuICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgbWFwQWNjdW06IG1hcEFjY3VtLFxuICAgICAgICBtYXBBY2N1bVJpZ2h0OiBtYXBBY2N1bVJpZ2h0LFxuICAgICAgICBtYXBPYmo6IG1hcE9iaixcbiAgICAgICAgbWFwT2JqSW5kZXhlZDogbWFwT2JqSW5kZXhlZCxcbiAgICAgICAgbWF0Y2g6IG1hdGNoLFxuICAgICAgICBtYXRoTW9kOiBtYXRoTW9kLFxuICAgICAgICBtYXg6IG1heCxcbiAgICAgICAgbWF4Qnk6IG1heEJ5LFxuICAgICAgICBtZWFuOiBtZWFuLFxuICAgICAgICBtZWRpYW46IG1lZGlhbixcbiAgICAgICAgbWVtb2l6ZTogbWVtb2l6ZSxcbiAgICAgICAgbWVyZ2U6IG1lcmdlLFxuICAgICAgICBtZXJnZUFsbDogbWVyZ2VBbGwsXG4gICAgICAgIG1pbjogbWluLFxuICAgICAgICBtaW5CeTogbWluQnksXG4gICAgICAgIG1vZHVsbzogbW9kdWxvLFxuICAgICAgICBtdWx0aXBseTogbXVsdGlwbHksXG4gICAgICAgIG5Bcnk6IG5BcnksXG4gICAgICAgIG5lZ2F0ZTogbmVnYXRlLFxuICAgICAgICBub25lOiBub25lLFxuICAgICAgICBub3Q6IG5vdCxcbiAgICAgICAgbnRoOiBudGgsXG4gICAgICAgIG50aEFyZzogbnRoQXJnLFxuICAgICAgICBudGhDaGFyOiBudGhDaGFyLFxuICAgICAgICBudGhDaGFyQ29kZTogbnRoQ2hhckNvZGUsXG4gICAgICAgIG9mOiBvZixcbiAgICAgICAgb21pdDogb21pdCxcbiAgICAgICAgb25jZTogb25jZSxcbiAgICAgICAgb3I6IG9yLFxuICAgICAgICBvdmVyOiBvdmVyLFxuICAgICAgICBwYXJ0aWFsOiBwYXJ0aWFsLFxuICAgICAgICBwYXJ0aWFsUmlnaHQ6IHBhcnRpYWxSaWdodCxcbiAgICAgICAgcGFydGl0aW9uOiBwYXJ0aXRpb24sXG4gICAgICAgIHBhdGg6IHBhdGgsXG4gICAgICAgIHBhdGhFcTogcGF0aEVxLFxuICAgICAgICBwaWNrOiBwaWNrLFxuICAgICAgICBwaWNrQWxsOiBwaWNrQWxsLFxuICAgICAgICBwaWNrQnk6IHBpY2tCeSxcbiAgICAgICAgcGlwZTogcGlwZSxcbiAgICAgICAgcGlwZUs6IHBpcGVLLFxuICAgICAgICBwaXBlUDogcGlwZVAsXG4gICAgICAgIHBsdWNrOiBwbHVjayxcbiAgICAgICAgcHJlcGVuZDogcHJlcGVuZCxcbiAgICAgICAgcHJvZHVjdDogcHJvZHVjdCxcbiAgICAgICAgcHJvamVjdDogcHJvamVjdCxcbiAgICAgICAgcHJvcDogcHJvcCxcbiAgICAgICAgcHJvcEVxOiBwcm9wRXEsXG4gICAgICAgIHByb3BJczogcHJvcElzLFxuICAgICAgICBwcm9wT3I6IHByb3BPcixcbiAgICAgICAgcHJvcFNhdGlzZmllczogcHJvcFNhdGlzZmllcyxcbiAgICAgICAgcHJvcHM6IHByb3BzLFxuICAgICAgICByYW5nZTogcmFuZ2UsXG4gICAgICAgIHJlZHVjZTogcmVkdWNlLFxuICAgICAgICByZWR1Y2VSaWdodDogcmVkdWNlUmlnaHQsXG4gICAgICAgIHJlZHVjZWQ6IHJlZHVjZWQsXG4gICAgICAgIHJlamVjdDogcmVqZWN0LFxuICAgICAgICByZW1vdmU6IHJlbW92ZSxcbiAgICAgICAgcmVwZWF0OiByZXBlYXQsXG4gICAgICAgIHJlcGxhY2U6IHJlcGxhY2UsXG4gICAgICAgIHJldmVyc2U6IHJldmVyc2UsXG4gICAgICAgIHNjYW46IHNjYW4sXG4gICAgICAgIHNldDogc2V0LFxuICAgICAgICBzbGljZTogc2xpY2UsXG4gICAgICAgIHNvcnQ6IHNvcnQsXG4gICAgICAgIHNvcnRCeTogc29ydEJ5LFxuICAgICAgICBzcGxpdDogc3BsaXQsXG4gICAgICAgIHNwbGl0RXZlcnk6IHNwbGl0RXZlcnksXG4gICAgICAgIHN1YnRyYWN0OiBzdWJ0cmFjdCxcbiAgICAgICAgc3VtOiBzdW0sXG4gICAgICAgIHRhaWw6IHRhaWwsXG4gICAgICAgIHRha2U6IHRha2UsXG4gICAgICAgIHRha2VMYXN0OiB0YWtlTGFzdCxcbiAgICAgICAgdGFrZUxhc3RXaGlsZTogdGFrZUxhc3RXaGlsZSxcbiAgICAgICAgdGFrZVdoaWxlOiB0YWtlV2hpbGUsXG4gICAgICAgIHRhcDogdGFwLFxuICAgICAgICB0ZXN0OiB0ZXN0LFxuICAgICAgICB0aW1lczogdGltZXMsXG4gICAgICAgIHRvTG93ZXI6IHRvTG93ZXIsXG4gICAgICAgIHRvUGFpcnM6IHRvUGFpcnMsXG4gICAgICAgIHRvUGFpcnNJbjogdG9QYWlyc0luLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHRvVXBwZXI6IHRvVXBwZXIsXG4gICAgICAgIHRyYW5zZHVjZTogdHJhbnNkdWNlLFxuICAgICAgICB0cmltOiB0cmltLFxuICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICB1bmFwcGx5OiB1bmFwcGx5LFxuICAgICAgICB1bmFyeTogdW5hcnksXG4gICAgICAgIHVuY3VycnlOOiB1bmN1cnJ5TixcbiAgICAgICAgdW5mb2xkOiB1bmZvbGQsXG4gICAgICAgIHVuaW9uOiB1bmlvbixcbiAgICAgICAgdW5pb25XaXRoOiB1bmlvbldpdGgsXG4gICAgICAgIHVuaXE6IHVuaXEsXG4gICAgICAgIHVuaXFCeTogdW5pcUJ5LFxuICAgICAgICB1bmlxV2l0aDogdW5pcVdpdGgsXG4gICAgICAgIHVubmVzdDogdW5uZXN0LFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdXNlV2l0aDogdXNlV2l0aCxcbiAgICAgICAgdmFsdWVzOiB2YWx1ZXMsXG4gICAgICAgIHZhbHVlc0luOiB2YWx1ZXNJbixcbiAgICAgICAgdmlldzogdmlldyxcbiAgICAgICAgd2hlcmU6IHdoZXJlLFxuICAgICAgICB3aGVyZUVxOiB3aGVyZUVxLFxuICAgICAgICB3cmFwOiB3cmFwLFxuICAgICAgICB4cHJvZDogeHByb2QsXG4gICAgICAgIHppcDogemlwLFxuICAgICAgICB6aXBPYmo6IHppcE9iaixcbiAgICAgICAgemlwV2l0aDogemlwV2l0aFxuICAgIH07XG5cbiAgLyogVEVTVF9FTlRSWV9QT0lOVCAqL1xuXG4gIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IFI7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKGZ1bmN0aW9uKCkgeyByZXR1cm4gUjsgfSk7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5SID0gUjtcbiAgfVxuXG59LmNhbGwodGhpcykpO1xuIiwidmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIENvbmZpZyA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIENvbmZpZygpIHtcbiAgICAgICAgfVxuICAgICAgICBDb25maWcuYm9yZGVyV2lkdGggPSA0O1xuICAgICAgICBDb25maWcuYm9yZGVySGVpZ2h0ID0gNDtcbiAgICAgICAgQ29uZmlnLnRpbGVTaXplID0gMzA7XG4gICAgICAgIENvbmZpZy5vZmZzZXRYID0gNDA7XG4gICAgICAgIENvbmZpZy5vZmZzZXRZID0gLTIgKiAoQ29uZmlnLnRpbGVTaXplIC0gMSk7XG4gICAgICAgIENvbmZpZy5ib2FyZFdpZHRoID0gMTA7XG4gICAgICAgIENvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgPSBDb25maWcub2Zmc2V0WCArIENvbmZpZy5ib3JkZXJXaWR0aCAqIDIgKyBDb25maWcuYm9hcmRXaWR0aCAqIENvbmZpZy50aWxlU2l6ZTtcbiAgICAgICAgQ29uZmlnLmJvYXJkSGVpZ2h0ID0gMjI7XG4gICAgICAgIENvbmZpZy5ib2FyZEhlaWdodEluUGl4ZWxzID0gQ29uZmlnLm9mZnNldFkgKyBDb25maWcuYm9yZGVyV2lkdGggKiAyICsgQ29uZmlnLmJvYXJkSGVpZ2h0ICogQ29uZmlnLnRpbGVTaXplO1xuICAgICAgICBDb25maWcubW92ZVRpbWVyUmF0ZSA9IDAuMTtcbiAgICAgICAgQ29uZmlnLmFuaW1hdGlvblRpbWUgPSAzMDA7XG4gICAgICAgIHJldHVybiBDb25maWc7XG4gICAgfSkoKTtcbiAgICBUZXRyaXMuQ29uZmlnID0gQ29uZmlnO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgKGZ1bmN0aW9uIChCbG9ja1N0YXR1cykge1xuICAgICAgICBCbG9ja1N0YXR1c1tCbG9ja1N0YXR1c1tcIkVtcHR5XCJdID0gMF0gPSBcIkVtcHR5XCI7XG4gICAgICAgIEJsb2NrU3RhdHVzW0Jsb2NrU3RhdHVzW1wiVGFrZW5cIl0gPSAxXSA9IFwiVGFrZW5cIjtcbiAgICB9KShUZXRyaXMuQmxvY2tTdGF0dXMgfHwgKFRldHJpcy5CbG9ja1N0YXR1cyA9IHt9KSk7XG4gICAgdmFyIEJsb2NrU3RhdHVzID0gVGV0cmlzLkJsb2NrU3RhdHVzO1xuICAgIChmdW5jdGlvbiAoRGlyZWN0aW9uKSB7XG4gICAgICAgIERpcmVjdGlvbltEaXJlY3Rpb25bXCJMZWZ0XCJdID0gLTFdID0gXCJMZWZ0XCI7XG4gICAgICAgIERpcmVjdGlvbltEaXJlY3Rpb25bXCJSaWdodFwiXSA9IDFdID0gXCJSaWdodFwiO1xuICAgICAgICBEaXJlY3Rpb25bRGlyZWN0aW9uW1wiVXBcIl0gPSAyXSA9IFwiVXBcIjtcbiAgICAgICAgRGlyZWN0aW9uW0RpcmVjdGlvbltcIkRvd25cIl0gPSA0XSA9IFwiRG93blwiO1xuICAgIH0pKFRldHJpcy5EaXJlY3Rpb24gfHwgKFRldHJpcy5EaXJlY3Rpb24gPSB7fSkpO1xuICAgIHZhciBEaXJlY3Rpb24gPSBUZXRyaXMuRGlyZWN0aW9uO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDQtMjAuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9saWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9jb25maWcudHNcIiAvPlxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgIF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlO1xuICAgIGQucHJvdG90eXBlID0gbmV3IF9fKCk7XG59O1xudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIE1lbnVTdGF0ZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhNZW51U3RhdGUsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIE1lbnVTdGF0ZSgpIHtcbiAgICAgICAgICAgIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIE1lbnVTdGF0ZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZS5pbnB1dC5tb3VzZS5pc0Rvd24gfHwgdGhpcy5zdGFydEtleS5pc0Rvd24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuc3RhdGVzLnN3aXRjaFN0YXRlKCdtYWluJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE1lbnVTdGF0ZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jcmVhdGUuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiVGV0cmlzIGNsb25lXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMjAwLCBcIiMwMDBcIiwgMzApKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiRGVmYXVsdCBjb250cm9scyBmb3IgdGhlIGdhbWUgYXJlOlwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDI1MCwgXCIjMDAwXCIsIDIwKSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIk1vdmUgLSBhcnJvdyBrZXlzXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMjgwLCBcIiMwMDBcIiwgMTYpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiUm90YXRlIGNvdW50ZXJjbG9ja3dpc2UgLSB6XCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMzAwLCBcIiMwMDBcIiwgMTYpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiUm90YXRlIGNsb2Nrd2lzZSAtIHhcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAzMjAsIFwiIzAwMFwiLCAxNikpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJSb3RhdGUgYm90aCB3YXlzIC0gdXAgYXJyb3dcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAzNDAsIFwiIzAwMFwiLCAxNikpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJTb2Z0IGRyb3AgLSBkb3duIGtleVwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDM2MCwgXCIjMDAwXCIsIDE2KSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIkhhcmQgZHJvcCAtIHNwYWNlXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMzgwLCBcIiMwMDBcIiwgMTYpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiSG9sZCAtIHNoaWZ0XCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgNDAwLCBcIiMwMDBcIiwgMTYpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiT24gbW9iaWxlIHlvdSBjYW4gcGxheVwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDQ0MCwgXCIjMDAwXCIsIDIwKSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIndpdGggb24gc2NyZWVuIGJ1dHRvbnNcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCA0NjAsIFwiIzAwMFwiLCAyMCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJvciBieSBkcmFnZ2luZyBvbiBzY3JlZW5cIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCA0ODAsIFwiIzAwMFwiLCAyMCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJDbGljayBvbiBzY3JlZW4gdG8gcGxheVwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDUxMCwgXCIjMDAwXCIsIDI1KSk7XG4gICAgICAgICAgICB0aGlzLmdldEFsbENoaWxkcmVuKCkuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRyZW4pIHsgcmV0dXJuIGNoaWxkcmVuLnRleHRBbGlnbiA9ICdjZW50ZXInOyB9KTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KEtpd2kuSW5wdXQuS2V5Y29kZXMuU1BBQ0VCQVIpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTWVudVN0YXRlO1xuICAgIH0pKEtpd2kuU3RhdGUpO1xuICAgIFRldHJpcy5NZW51U3RhdGUgPSBNZW51U3RhdGU7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgUG9zaXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBQb3NpdGlvbih4LCB5KSB7XG4gICAgICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgfVxuICAgICAgICBQb3NpdGlvbi5wcm90b3R5cGUuaXNMb3dlciA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMueSA+IHBvc2l0aW9uLnk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBQb3NpdGlvbjtcbiAgICB9KSgpO1xuICAgIFRldHJpcy5Qb3NpdGlvbiA9IFBvc2l0aW9uO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2xpYi9raXdpLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2NvbmZpZy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwicG9zaXRpb24udHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIEJsb2NrID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQmxvY2soeCwgeSwgc3RhdGUsIHRleHR1cmUpIHtcbiAgICAgICAgICAgIHRoaXMuc2l6ZSA9IFRldHJpcy5Db25maWcudGlsZVNpemU7XG4gICAgICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgICAgIGlmICh0ZXh0dXJlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zcHJpdGUgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5TcHJpdGUoc3RhdGUsIHRleHR1cmUsIFRldHJpcy5Db25maWcub2Zmc2V0WCArIFRldHJpcy5Db25maWcuYm9yZGVyV2lkdGggKyB4ICogKHRoaXMuc2l6ZSAtIDEpLCBUZXRyaXMuQ29uZmlnLm9mZnNldFkgKyBUZXRyaXMuQ29uZmlnLmJvcmRlcldpZHRoICsgeSAqICh0aGlzLnNpemUgLSAxKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgQmxvY2sucHJvdG90eXBlLmZhbGwgPSBmdW5jdGlvbiAoYW1vdW50T2ZUaWxlcykge1xuICAgICAgICAgICAgaWYgKGFtb3VudE9mVGlsZXMgPT09IHZvaWQgMCkgeyBhbW91bnRPZlRpbGVzID0gMTsgfVxuICAgICAgICAgICAgdGhpcy55ICs9IGFtb3VudE9mVGlsZXM7XG4gICAgICAgICAgICBpZiAodGhpcy5zcHJpdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwcml0ZS50cmFuc2Zvcm0ueSArPSBhbW91bnRPZlRpbGVzICogKHRoaXMuc2l6ZSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBCbG9jay5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgICAgICAgICB0aGlzLnggKz0gc2lkZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNwcml0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLnRyYW5zZm9ybS54ICs9IHNpZGUgKiAodGhpcy5zaXplIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEJsb2NrLnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgdmFyIHhEaWZmID0gcG9zaXRpb24ueCAtIHRoaXMueDtcbiAgICAgICAgICAgIHZhciB5RGlmZiA9IHBvc2l0aW9uLnkgLSB0aGlzLnk7XG4gICAgICAgICAgICB0aGlzLnggPSBwb3NpdGlvbi54O1xuICAgICAgICAgICAgdGhpcy55ID0gcG9zaXRpb24ueTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNwcml0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLnRyYW5zZm9ybS54ICs9IHhEaWZmICogKHRoaXMuc2l6ZSAtIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLnRyYW5zZm9ybS55ICs9IHlEaWZmICogKHRoaXMuc2l6ZSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBCbG9jay5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRldHJpcy5Qb3NpdGlvbih0aGlzLngsIHRoaXMueSk7XG4gICAgICAgIH07XG4gICAgICAgIEJsb2NrLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKGFuaW1hdGUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAoYW5pbWF0ZSA9PT0gdm9pZCAwKSB7IGFuaW1hdGUgPSBmYWxzZTsgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc3ByaXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHR3ZWVuID0gdGhpcy5zcHJpdGUuc3RhdGUuZ2FtZS50d2VlbnMuY3JlYXRlKHRoaXMuc3ByaXRlKTtcbiAgICAgICAgICAgICAgICAgICAgdHdlZW4udG8oeyBhbHBoYTogMCB9LCBUZXRyaXMuQ29uZmlnLmFuaW1hdGlvblRpbWUsIEtpd2kuQW5pbWF0aW9ucy5Ud2VlbnMuRWFzaW5nLkJvdW5jZS5JbiwgdHJ1ZSkub25Db21wbGV0ZShmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5zcHJpdGUuZGVzdHJveSgpOyB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3ByaXRlLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBCbG9jaztcbiAgICB9KSgpO1xuICAgIFRldHJpcy5CbG9jayA9IEJsb2NrO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9saWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9ibG9jay50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaGFwZShzdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vc3RhdHVzIGZvciByb3RhdGlvblxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRUZXN0ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRQb3NpdGlvbnMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrcyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVPYmplY3QgPSBuZXcgS2l3aS5Hcm91cChzdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2FkZCBibG9jayBpbnRvIHRoZSBzaGFwZVxuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLmFkZEJsb2NrID0gZnVuY3Rpb24gKGJsb2NrQ29sb3IsIHgsIHksIGNlbnRlcikge1xuICAgICAgICAgICAgICAgIGlmIChjZW50ZXIgPT09IHZvaWQgMCkgeyBjZW50ZXIgPSBmYWxzZTsgfVxuICAgICAgICAgICAgICAgIHZhciBibG9jayA9IG5ldyBUZXRyaXMuQmxvY2soeCwgeSwgdGhpcy5zdGF0ZSwgdGhpcy5zdGF0ZS50ZXh0dXJlc1snYmxvY2stJyArIGJsb2NrQ29sb3JdKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5wdXNoKGJsb2NrKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWVPYmplY3QuYWRkQ2hpbGQoYmxvY2suc3ByaXRlKTtcbiAgICAgICAgICAgICAgICBpZiAoY2VudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyID0gYmxvY2s7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5nZXRHYW1lT2JqZWN0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5nYW1lT2JqZWN0OyB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLmdldEJsb2NrcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuYmxvY2tzOyB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRCbG9ja3MoKS5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykgeyByZXR1cm4gYmxvY2suZGVzdHJveSgpOyB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvL2dldCBibG9ja3MgcG9zaXRpb25cbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5nZXRQb3NpdGlvbnMgPSBmdW5jdGlvbiAoYmxvY2tzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrcyA9PT0gdm9pZCAwKSB7IGJsb2NrcyA9IHRoaXMuYmxvY2tzOyB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJsb2Nrcy5tYXAoZnVuY3Rpb24gKGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBibG9jay5nZXRQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5mYWxsID0gZnVuY3Rpb24gKGFtb3VudE9mVGlsZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmIChhbW91bnRPZlRpbGVzID09PSB2b2lkIDApIHsgYW1vdW50T2ZUaWxlcyA9IDE7IH1cbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYmxvY2sgPT0gX3RoaXMuY2VudGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBibG9jay5mYWxsKGFtb3VudE9mVGlsZXMpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyLmZhbGwoYW1vdW50T2ZUaWxlcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLnNldEJ5UG9pbnRlclBvc2l0aW9uID0gZnVuY3Rpb24gKGRpc3RhbmNlRnJvbUNlbnRlcikge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2NrID09IF90aGlzLmNlbnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYmxvY2suc2V0UG9zaXRpb24obmV3IFRldHJpcy5Qb3NpdGlvbihibG9jay54ICsgZGlzdGFuY2VGcm9tQ2VudGVyLCBibG9jay55KSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jZW50ZXIuc2V0UG9zaXRpb24obmV3IFRldHJpcy5Qb3NpdGlvbih0aGlzLmNlbnRlci54ICsgZGlzdGFuY2VGcm9tQ2VudGVyLCB0aGlzLmNlbnRlci55KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgU2hhcGUucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbiAoc2lkZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJsb2NrID09IF90aGlzLmNlbnRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYmxvY2subW92ZShzaWRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmNlbnRlci5tb3ZlKHNpZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlLnByb3RvdHlwZS5nZXRSb3RhdGlvbnMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBTaGFwZS5yb3RhdGlvbnM7IH07XG4gICAgICAgICAgICBTaGFwZS5wcm90b3R5cGUuZ2V0TmV4dFJvdGF0aW9uID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBuZXh0UG9zaXRpb25zID0gW107XG4gICAgICAgICAgICAgICAgLy9pZiB3ZSBjaGVja2VkIGFsbCBwb3NzaWJpbGl0aWVzLCByZXR1cm4gbm90aGluZ1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRUZXN0ID09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGVzdCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0UG9zaXRpb25zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcm90YXRpb25zID0gdGhpcy5nZXRSb3RhdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB2YXIgY2VudGVyWCA9IHRoaXMuY2VudGVyLng7XG4gICAgICAgICAgICAgICAgdmFyIGNlbnRlclkgPSB0aGlzLmNlbnRlci55O1xuICAgICAgICAgICAgICAgIHZhciB4TWFyZ2luID0gZGlyZWN0aW9uICogcm90YXRpb25zW3RoaXMuY3VycmVudFJvdGF0aW9uXVt0aGlzLmN1cnJlbnRUZXN0XVswXTtcbiAgICAgICAgICAgICAgICB2YXIgeU1hcmdpbiA9IGRpcmVjdGlvbiAqIHJvdGF0aW9uc1t0aGlzLmN1cnJlbnRSb3RhdGlvbl1bdGhpcy5jdXJyZW50VGVzdF1bMV07XG4gICAgICAgICAgICAgICAgLy9zZXQgY2VudGVyIHBvc2l0aW9ucywgc28gd2UgZG9uJ3QgbG9zZSBpdCBkdXJpbmcgcm90YXRpb25cbiAgICAgICAgICAgICAgICB2YXIgbmV4dENlbnRlciA9IG5ldyBUZXRyaXMuUG9zaXRpb24oY2VudGVyWCArIHhNYXJnaW4sIGNlbnRlclkgKyB5TWFyZ2luKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeERpZmYgPSBkaXJlY3Rpb24gKiAoYmxvY2sueCAtIGNlbnRlclgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgeURpZmYgPSBkaXJlY3Rpb24gKiAoYmxvY2sueSAtIGNlbnRlclkpO1xuICAgICAgICAgICAgICAgICAgICBuZXh0UG9zaXRpb25zLnB1c2gobmV3IFRldHJpcy5Qb3NpdGlvbihuZXh0Q2VudGVyLnggLSB5RGlmZiwgbmV4dENlbnRlci55ICsgeERpZmYpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRDZW50ZXIgPSBuZXh0Q2VudGVyO1xuICAgICAgICAgICAgICAgIHRoaXMubmV4dFBvc2l0aW9ucyA9IG5leHRQb3NpdGlvbnM7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4gICAgICAgICAgICAgICAgLy9pbmNyZWF0ZSB0ZXN0IGFtb3VudFxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRlc3QrKztcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV4dFBvc2l0aW9ucztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBTaGFwZS5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgLy9pZiB3ZSB3YW50IHRvIHJhdGF0ZSB3aXRob3V0IGNoZWNraW5nXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLm5leHRDZW50ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXROZXh0Um90YXRpb24oMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY2VudGVyLnNldFBvc2l0aW9uKG5ldyBUZXRyaXMuUG9zaXRpb24odGhpcy5uZXh0Q2VudGVyLngsIHRoaXMubmV4dENlbnRlci55KSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2ssIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vaWYgYyBibG9jayBpcyBpbiBjZW50ZXIgcG9zaXRpb24sIGl0IGlzIGFscmVhZHkgc2V0XG4gICAgICAgICAgICAgICAgICAgIGlmIChibG9jayA9PSBfdGhpcy5jZW50ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLnNldFBvc2l0aW9uKG5ldyBUZXRyaXMuUG9zaXRpb24oX3RoaXMubmV4dFBvc2l0aW9uc1tpbmRleF0ueCwgX3RoaXMubmV4dFBvc2l0aW9uc1tpbmRleF0ueSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRlc3QgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uICs9IHRoaXMuZGlyZWN0aW9uO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRSb3RhdGlvbiA9PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFJvdGF0aW9uID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdGF0aW9uID0gMztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy9yb3RhdGlvbnMgZm9yIEogTCBUIFogUyBQaWVjZXNcbiAgICAgICAgICAgIFNoYXBlLnJvdGF0aW9ucyA9IFtcbiAgICAgICAgICAgICAgICBbWzAsIDBdLCBbLTEsIDBdLCBbLTEsICsxXSwgWzAsIC0yXSwgWy0xLCAtMl1dLFxuICAgICAgICAgICAgICAgIFtbMCwgMF0sIFsrMSwgMF0sIFsrMSwgLTFdLCBbMCwgKzJdLCBbKzEsICsyXV0sXG4gICAgICAgICAgICAgICAgW1swLCAwXSwgWysxLCAwXSwgWysxLCArMV0sIFswLCAtMl0sIFsrMSwgLTJdXSxcbiAgICAgICAgICAgICAgICBbWzAsIDBdLCBbLTEsIDBdLCBbLTEsIC0xXSwgWzAsICsyXSwgWy0xLCArMl1dLFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHJldHVybiBTaGFwZTtcbiAgICAgICAgfSkoKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlID0gU2hhcGU7XG4gICAgfSkoU2hhcGVzID0gVGV0cmlzLlNoYXBlcyB8fCAoVGV0cmlzLlNoYXBlcyA9IHt9KSk7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNS0yMS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2xpYi9raXdpLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInNoYXBlLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBTaGFwZXM7XG4gICAgKGZ1bmN0aW9uIChTaGFwZXMpIHtcbiAgICAgICAgdmFyIFNoYXBlU3RhY2sgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZnVuY3Rpb24gU2hhcGVTdGFjayhzdGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vc2hhcGUgbmFtZXNcbiAgICAgICAgICAgICAgICB0aGlzLnNoYXBlcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgJ0knLFxuICAgICAgICAgICAgICAgICAgICAnSicsXG4gICAgICAgICAgICAgICAgICAgICdMJyxcbiAgICAgICAgICAgICAgICAgICAgJ08nLFxuICAgICAgICAgICAgICAgICAgICAnUycsXG4gICAgICAgICAgICAgICAgICAgICdUJyxcbiAgICAgICAgICAgICAgICAgICAgJ1onXG4gICAgICAgICAgICAgICAgXTtcbiAgICAgICAgICAgICAgICAvL3NoYXBlcyBhcnJheSB3YWl0aW5nIHRvIHNwYXduXG4gICAgICAgICAgICAgICAgdGhpcy5zaGFwZVN0YWNrID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAYXV0aG9yIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNjI3NDMzOS9ob3ctY2FuLWktc2h1ZmZsZS1hbi1hcnJheS1pbi1qYXZhc2NyaXB0XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIFNoYXBlU3RhY2suc2h1ZmZsZSA9IGZ1bmN0aW9uIChhcnJheSkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gYXJyYXkubGVuZ3RoLCB0ZW1wLCBpbmRleDtcbiAgICAgICAgICAgICAgICAvLyBXaGlsZSB0aGVyZSBhcmUgZWxlbWVudHMgaW4gdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgd2hpbGUgKGNvdW50ZXIgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFBpY2sgYSByYW5kb20gaW5kZXhcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb3VudGVyKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gRGVjcmVhc2UgY291bnRlciBieSAxXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ZXItLTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQW5kIHN3YXAgdGhlIGxhc3QgZWxlbWVudCB3aXRoIGl0XG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSBhcnJheVtjb3VudGVyXTtcbiAgICAgICAgICAgICAgICAgICAgYXJyYXlbY291bnRlcl0gPSBhcnJheVtpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGFycmF5W2luZGV4XSA9IHRlbXA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBTaGFwZVN0YWNrLnByb3RvdHlwZS5nZXROZXh0U2hhcGUgPSBmdW5jdGlvbiAocG9wKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvcCA9PT0gdm9pZCAwKSB7IHBvcCA9IGZhbHNlOyB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hhcGVTdGFjay5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wQXJyYXkgPSB0aGlzLnNoYXBlcy5zbGljZSgwKTtcbiAgICAgICAgICAgICAgICAgICAgdGVtcEFycmF5LmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQsIGluZGV4KSB7IHJldHVybiB0ZW1wQXJyYXlbaW5kZXhdID0gJ1NoYXBlJyArIGVsZW1lbnQ7IH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNoYXBlU3RhY2sgPSB0aGlzLnNoYXBlU3RhY2suY29uY2F0KFNoYXBlU3RhY2suc2h1ZmZsZSh0ZW1wQXJyYXkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvcCA/IHRoaXMuc2hhcGVTdGFjay5zaGlmdCgpIDogdGhpcy5zaGFwZVN0YWNrWzBdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlU3RhY2sucHJvdG90eXBlLmNyZWF0ZU5ld1NoYXBlID0gZnVuY3Rpb24gKGFkZFRvR2FtZSwgc2hhcGVOYW1lLCB4LCB5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGFkZFRvR2FtZSA9PT0gdm9pZCAwKSB7IGFkZFRvR2FtZSA9IGZhbHNlOyB9XG4gICAgICAgICAgICAgICAgaWYgKHNoYXBlTmFtZSA9PT0gdm9pZCAwKSB7IHNoYXBlTmFtZSA9ICcnOyB9XG4gICAgICAgICAgICAgICAgaWYgKHggPT09IHZvaWQgMCkgeyB4ID0gNDsgfVxuICAgICAgICAgICAgICAgIGlmICh5ID09PSB2b2lkIDApIHsgeSA9IDE7IH1cbiAgICAgICAgICAgICAgICBpZiAoc2hhcGVOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNoYXBlTmFtZSA9IHRoaXMuZ2V0TmV4dFNoYXBlKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2hhcGUgPSBuZXcgU2hhcGVzW3NoYXBlTmFtZV0odGhpcy5zdGF0ZSwgeCwgeSk7XG4gICAgICAgICAgICAgICAgaWYgKGFkZFRvR2FtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmFkZENoaWxkKHNoYXBlLmdldEdhbWVPYmplY3QoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBzaGFwZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVTdGFjaztcbiAgICAgICAgfSkoKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlU3RhY2sgPSBTaGFwZVN0YWNrO1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9saWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJibG9jay50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgR2hvc3QgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBHaG9zdChzdGF0ZSwgcG9zaXRpb25zLCBsb3dlckJ5KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgICAgIHRoaXMuZ2FtZU9iamVjdCA9IG5ldyBLaXdpLkdyb3VwKHN0YXRlKTtcbiAgICAgICAgICAgIHBvc2l0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBibG9jayA9IG5ldyBUZXRyaXMuQmxvY2socG9zaXRpb24ueCwgcG9zaXRpb24ueSArIGxvd2VyQnksIF90aGlzLnN0YXRlLCBfdGhpcy5zdGF0ZS50ZXh0dXJlc1snYmxvY2stZ2hvc3QnXSk7XG4gICAgICAgICAgICAgICAgX3RoaXMuYmxvY2tzLnB1c2goYmxvY2spO1xuICAgICAgICAgICAgICAgIF90aGlzLmdhbWVPYmplY3QuYWRkQ2hpbGQoYmxvY2suc3ByaXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIEdob3N0LnByb3RvdHlwZS5nZXRHYW1lT2JqZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2FtZU9iamVjdDtcbiAgICAgICAgfTtcbiAgICAgICAgR2hvc3QucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9ucywgbG93ZXJCeSkge1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2ssIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgYmxvY2suc2V0UG9zaXRpb24obmV3IFRldHJpcy5Qb3NpdGlvbihwb3NpdGlvbnNbaW5kZXhdLngsIHBvc2l0aW9uc1tpbmRleF0ueSArIGxvd2VyQnkpKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gR2hvc3Q7XG4gICAgfSkoKTtcbiAgICBUZXRyaXMuR2hvc3QgPSBHaG9zdDtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9saWIvcmFtZGEuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic2hhcGVzL3NoYXBlLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJwb3NpdGlvbi50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vZW51bXMudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2NvbmZpZy50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgUiA9IHJlcXVpcmUoJ3JhbWRhJyk7XG4gICAgdmFyIEJvYXJkID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQm9hcmQoc3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodDtcbiAgICAgICAgICAgIHRoaXMud2lkdGggPSBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGg7XG4gICAgICAgICAgICAvL2Jsb2NrcyBhcnJheSB0byBrZWVwIHRyYWNrIG9mIGJsb2NrcyBpbnNpZGUgZ2FtZVxuICAgICAgICAgICAgdGhpcy5ibG9ja3MgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaGlnaGVzdFBvc2l0aW9ucyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja3NbaV0gPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy53aWR0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWdoZXN0UG9zaXRpb25zW2ldID0gbmV3IFRldHJpcy5Qb3NpdGlvbihpLCB0aGlzLmhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy9jaGVjayBpZiBnaXZlbiBwb3NpdGlvbnMgYXJlIGVtcHR5XG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5lbXB0eVBvc2l0aW9ucyA9IGZ1bmN0aW9uIChwb3NpdGlvbnMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gcG9zaXRpb25zLmZpbHRlcihmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcG9zaXRpb24ueCA8IDBcbiAgICAgICAgICAgICAgICAgICAgfHwgcG9zaXRpb24ueCA+IF90aGlzLndpZHRoIC0gMVxuICAgICAgICAgICAgICAgICAgICB8fCBwb3NpdGlvbi55ID4gX3RoaXMuaGVpZ2h0IC0gMVxuICAgICAgICAgICAgICAgICAgICB8fCBwb3NpdGlvbi55IDwgMFxuICAgICAgICAgICAgICAgICAgICB8fCBfdGhpcy5ibG9ja3NbcG9zaXRpb24ueV1bcG9zaXRpb24ueF0gIT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH0pLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgfTtcbiAgICAgICAgLy9jaGVjayBibG9ja3MgbmV4dCB0byBnaXZlbiBvbmVzIGFyZSBlbXB0eVxuICAgICAgICBCb2FyZC5wcm90b3R5cGUuZW1wdHlEaXJlY3Rpb24gPSBmdW5jdGlvbiAoYmxvY2tzLCBkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gYmxvY2tzLmZpbHRlcihmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKGRpcmVjdGlvbiA9PT0gVGV0cmlzLkRpcmVjdGlvbi5Eb3duICYmIChibG9jay55ID09PSBfdGhpcy5oZWlnaHQgLSAxIHx8IF90aGlzLmJsb2Nrc1tibG9jay55ICsgMV1bYmxvY2sueF0gIT09IHVuZGVmaW5lZCkpXG4gICAgICAgICAgICAgICAgICAgIHx8IChkaXJlY3Rpb24gPT09IFRldHJpcy5EaXJlY3Rpb24uTGVmdCAmJiAoYmxvY2sueCA9PT0gMCB8fCBfdGhpcy5ibG9ja3NbYmxvY2sueV1bYmxvY2sueCAtIDFdICE9PSB1bmRlZmluZWQpKVxuICAgICAgICAgICAgICAgICAgICB8fCAoZGlyZWN0aW9uID09PSBUZXRyaXMuRGlyZWN0aW9uLlJpZ2h0ICYmIChibG9jay54ID09PSBfdGhpcy53aWR0aCAtIDEgfHwgX3RoaXMuYmxvY2tzW2Jsb2NrLnldW2Jsb2NrLnggKyAxXSAhPT0gdW5kZWZpbmVkKSk7XG4gICAgICAgICAgICB9KS5sZW5ndGggPT09IDA7XG4gICAgICAgIH07XG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5yZWZyZXNoSGlnaGVzdFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmhpZ2hlc3RQb3NpdGlvbnNbcG9zaXRpb24ueF0gPVxuICAgICAgICAgICAgICAgIHRoaXMuaGlnaGVzdFBvc2l0aW9uc1twb3NpdGlvbi54XS5pc0xvd2VyKHBvc2l0aW9uKSA/IHBvc2l0aW9uIDogdGhpcy5oaWdoZXN0UG9zaXRpb25zW3Bvc2l0aW9uLnhdO1xuICAgICAgICB9O1xuICAgICAgICBCb2FyZC5wcm90b3R5cGUucmVmcmVzaEhpZ2hlc3RQb3NpdGlvbnMgPSBmdW5jdGlvbiAocG9zaXRpb25zKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHBvc2l0aW9ucyA9PT0gdm9pZCAwKSB7IHBvc2l0aW9ucyA9IFtdOyB9XG4gICAgICAgICAgICB0aGlzLmhpZ2hlc3RQb3NpdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaGlnaGVzdFBvc2l0aW9uLCBjb2x1bW4pIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5oaWdoZXN0UG9zaXRpb25zW2NvbHVtbl0ueSA9IF90aGlzLmhlaWdodDtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IHBvc2l0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKHBvc2l0aW9uKSB7IHJldHVybiBwb3NpdGlvbi54ID09IGNvbHVtbjsgfSkubWFwKGZ1bmN0aW9uIChwb3NpdGlvbikgeyByZXR1cm4gcG9zaXRpb24ueTsgfSlbMF07XG4gICAgICAgICAgICAgICAgZnJvbSA9IGZyb20gPyBmcm9tIDogMDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gZnJvbTsgaSA8IF90aGlzLmhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5ibG9ja3NbaV1bY29sdW1uXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaGlnaGVzdFBvc2l0aW9uc1tjb2x1bW5dLnkgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy9zZXQgc3RhdHVzIGZvciBibG9ja3NcbiAgICAgICAgQm9hcmQucHJvdG90eXBlLnNldEJsb2NrcyA9IGZ1bmN0aW9uIChibG9ja3MsIHN0YXR1cykge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IHZvaWQgMCkgeyBzdGF0dXMgPSBUZXRyaXMuQmxvY2tTdGF0dXMuVGFrZW47IH1cbiAgICAgICAgICAgIGJsb2Nrcy5mb3JFYWNoKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgIF90aGlzLmJsb2Nrc1tibG9jay55XVtibG9jay54XSA9IHN0YXR1cyA9PT0gVGV0cmlzLkJsb2NrU3RhdHVzLlRha2VuID8gYmxvY2sgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gVGV0cmlzLkJsb2NrU3RhdHVzLlRha2VuKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hIaWdoZXN0UG9zaXRpb24oYmxvY2suZ2V0UG9zaXRpb24oKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgLy9jaGVjayBmb3Igcm93cyB0byBjbGVhciBhbmQgcmV0dXJuIGFtb3VudCBvZiBjbGVhcmVkIHJvd3NcbiAgICAgICAgQm9hcmQucHJvdG90eXBlLmNoZWNrUm93cyA9IGZ1bmN0aW9uIChibG9ja3MpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgcm93c1RvQ2xlYXIgPSB0aGlzLmdldFJvd3NUb0NsZWFyKGJsb2Nrcyk7XG4gICAgICAgICAgICBpZiAocm93c1RvQ2xlYXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJSb3dzKHJvd3NUb0NsZWFyKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLmdhbWUudGltZS5jbG9jay5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9hZnRlciBjbGVhcmluZyB0aGUgcm93cywgbWFrZSBvdGhlciBibG9ja3MgZmFsbCBkb3duXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZhbGxCbG9ja3Mocm93c1RvQ2xlYXIpO1xuICAgICAgICAgICAgICAgICAgICAvL3JlZnJlc2ggaGlnaGVzdCBwb3NpdGlvbnMgYmVjYXVzZSBzb21lIHJvd3MgY2FuIGdldCBlbXB0eSBvciBzb21lIGdhcHMgY2FuIGhhcHBlblxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZWZyZXNoSGlnaGVzdFBvc2l0aW9ucygpO1xuICAgICAgICAgICAgICAgIH0sIFRldHJpcy5Db25maWcuYW5pbWF0aW9uVGltZSwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcm93c1RvQ2xlYXIubGVuZ3RoO1xuICAgICAgICB9O1xuICAgICAgICAvL2ZpbmQgZnVsbCByb3dzXG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5nZXRSb3dzVG9DbGVhciA9IGZ1bmN0aW9uIChibG9ja3MpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAvL25vIGR1cGxpY2F0ZXNcbiAgICAgICAgICAgIHZhciByb3dzVG9DbGVhciA9IFIudW5pcShibG9ja3NcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChibG9jaykge1xuICAgICAgICAgICAgICAgIC8vb25seSBpZiBmdWxsIHJvdyAoYWxsIGJsb2NrcyBzZXQgYW5kIG5vbmUgb2YgdGhlbSBhcmUgdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHJldHVybiAoX3RoaXMuYmxvY2tzW2Jsb2NrLnldLmxlbmd0aCA9PT0gX3RoaXMud2lkdGggJiYgIVIuY29udGFpbnModW5kZWZpbmVkLCBfdGhpcy5ibG9ja3NbYmxvY2sueV0pKTtcbiAgICAgICAgICAgICAgICAvL29ubHkgcmV0dXJuIHJvd3NcbiAgICAgICAgICAgIH0pLm1hcChmdW5jdGlvbiAoYmxvY2spIHsgcmV0dXJuIGJsb2NrLnk7IH0pKTtcbiAgICAgICAgICAgIC8vcmV2ZXJzZSBzb3J0XG4gICAgICAgICAgICByZXR1cm4gUi5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGIgLSBhO1xuICAgICAgICAgICAgfSwgcm93c1RvQ2xlYXIpO1xuICAgICAgICB9O1xuICAgICAgICBCb2FyZC5wcm90b3R5cGUuY2xlYXJSb3dzID0gZnVuY3Rpb24gKHJvd051bWJlcnMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByb3dOdW1iZXJzLmZvckVhY2goZnVuY3Rpb24gKHJvd051bWJlcikge1xuICAgICAgICAgICAgICAgIC8vZGVzdHJveSBhbGwgYmxvY2tzIGluIHJvd1xuICAgICAgICAgICAgICAgIF90aGlzLmJsb2Nrc1tyb3dOdW1iZXJdLmZvckVhY2goZnVuY3Rpb24gKGJsb2NrKSB7IHJldHVybiBibG9jay5kZXN0cm95KHRydWUpOyB9KTtcbiAgICAgICAgICAgICAgICAvL3NldCBhbGwgcm93IGVtcHR5XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0QmxvY2tzKF90aGlzLmJsb2Nrc1tyb3dOdW1iZXJdLCBUZXRyaXMuQmxvY2tTdGF0dXMuRW1wdHkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIEJvYXJkLnByb3RvdHlwZS5mYWxsQmxvY2tzID0gZnVuY3Rpb24gKHJvd3NUb0ZhbGwpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByb3dzVG9GYWxsLmZvckVhY2goZnVuY3Rpb24gKGZyb21Sb3csIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgdmFyIGxvd2VyQnkgPSBpbmRleCArIDE7XG4gICAgICAgICAgICAgICAgLy90aWxsIHdoYXQgcm93IHRvIGNsZWFyXG4gICAgICAgICAgICAgICAgdmFyIHRvUm93ID0gcm93c1RvRmFsbFtsb3dlckJ5XSA/IHJvd3NUb0ZhbGxbbG93ZXJCeV0gOiAwO1xuICAgICAgICAgICAgICAgIC8vZmxhdHRlbiBhcnJheXMgaW50byBvbmUgdHlwZXNjcmlwdCBjb21waWxhdG9yIGlzIHNjcmV3aW5nIGluIHRoaXMgcGxhY2UuLlxuICAgICAgICAgICAgICAgIHZhciBibG9ja3NUb0ZhbGwgPSBSLmZsYXR0ZW4oXG4gICAgICAgICAgICAgICAgLy9jaGVjayBmcm9tIGJvdHRvbSB0byB0b3BcbiAgICAgICAgICAgICAgICBSLnJldmVyc2UoXG4gICAgICAgICAgICAgICAgLy9nZXQgYWxsIHJvd3MgYmV0d2VlbiBoaWdoZXN0IGFuZCBsb3dlc3RcbiAgICAgICAgICAgICAgICBfdGhpcy5ibG9ja3MuZmlsdGVyKGZ1bmN0aW9uIChibG9ja3MsIHJvdykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcm93IDw9IGZyb21Sb3cgJiYgcm93ID49IHRvUm93O1xuICAgICAgICAgICAgICAgIH0pKSkuZmlsdGVyKGZ1bmN0aW9uIChibG9jaykgeyByZXR1cm4gYmxvY2sgIT09IHVuZGVmaW5lZDsgfSk7XG4gICAgICAgICAgICAgICAgLy9maXJzdCBnZXQgYWxsIHJvd3Mgd2hpY2ggbmVlZCB0byBiZSBjaGVja2VkLCByZXZlcnNlIHRoZW0gKHNvIHdlIHdvdWxkbnQgb3ZlcndyaXRlIGJsb2NrcyBpbiBib2FyZCksIHRoZW4gZ2V0IGFsbCBibG9ja3MgaW4gdGhlbSBhbmQgZG8gbWFrZSB0aGVtIGdvIGRvd25cbiAgICAgICAgICAgICAgICBibG9ja3NUb0ZhbGwuZm9yRWFjaChmdW5jdGlvbiAoYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0QmxvY2tzKFtibG9ja10sIFRldHJpcy5CbG9ja1N0YXR1cy5FbXB0eSk7XG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLnNldFBvc2l0aW9uKG5ldyBUZXRyaXMuUG9zaXRpb24oYmxvY2sueCwgYmxvY2sueSArIGxvd2VyQnkpKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0QmxvY2tzKFtibG9ja10sIFRldHJpcy5CbG9ja1N0YXR1cy5UYWtlbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy9yZXR1cm4gbnVtYmVyIG9mIHJvd3MgdG8gZmFsbFxuICAgICAgICBCb2FyZC5wcm90b3R5cGUuZmluZERpc3RhbmNlVG9GYWxsID0gZnVuY3Rpb24gKHBvc2l0aW9ucykge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEhpZ2hlc3RQb3NpdGlvbnMocG9zaXRpb25zKTtcbiAgICAgICAgICAgIHJldHVybiBwb3NpdGlvbnMucmVkdWNlKGZ1bmN0aW9uIChyb3dzVG9GYWxsLCBwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IE1hdGguc3FydChNYXRoLnBvdyhfdGhpcy5oaWdoZXN0UG9zaXRpb25zW3Bvc2l0aW9uLnhdLnkgLSBwb3NpdGlvbi55LCAyKSkgLSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiBkaXN0YW5jZSA8IHJvd3NUb0ZhbGwgPyBkaXN0YW5jZSA6IHJvd3NUb0ZhbGw7XG4gICAgICAgICAgICB9LCB0aGlzLmhlaWdodCk7XG4gICAgICAgIH07XG4gICAgICAgIC8vZmluZCBob3cgbXVjaCBjZW50ZXIgcG9zaXRpb24gY2FuIG1vdmUgKHVzZWQgd2l0aCBwb2ludGVyIHRvIGNoZWNrIGZvciB3YWxscylcbiAgICAgICAgQm9hcmQucHJvdG90eXBlLmZpbmRWYWxpZFBvc2l0aW9uID0gZnVuY3Rpb24gKGRpc3RhbmNlRnJvbUNlbnRlciwgcG9zaXRpb25zKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKGRpc3RhbmNlRnJvbUNlbnRlciA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBvc2l0aW9ucy5yZWR1Y2UoZnVuY3Rpb24gKHByZXZpb3VzRWxlbWVudCwgY3VycmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3UG9zaXRpb24gPSBjdXJyZW50RWxlbWVudC54ICsgZGlzdGFuY2VGcm9tQ2VudGVyO1xuICAgICAgICAgICAgICAgIHZhciBuZXdEaXN0YW5jZUZyb21DZW50ZXIgPSBkaXN0YW5jZUZyb21DZW50ZXI7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1Bvc2l0aW9uIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdEaXN0YW5jZUZyb21DZW50ZXIgPSBkaXN0YW5jZUZyb21DZW50ZXIgLSBuZXdQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5ld1Bvc2l0aW9uID4gX3RoaXMud2lkdGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0Rpc3RhbmNlRnJvbUNlbnRlciA9IGRpc3RhbmNlRnJvbUNlbnRlciAtIChuZXdQb3NpdGlvbiAtIChfdGhpcy53aWR0aCAtIDEpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguYWJzKG5ld0Rpc3RhbmNlRnJvbUNlbnRlcikgPCBNYXRoLmFicyhwcmV2aW91c0VsZW1lbnQpID8gbmV3RGlzdGFuY2VGcm9tQ2VudGVyIDogcHJldmlvdXNFbGVtZW50O1xuICAgICAgICAgICAgfSwgZGlzdGFuY2VGcm9tQ2VudGVyKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEJvYXJkO1xuICAgIH0pKCk7XG4gICAgVGV0cmlzLkJvYXJkID0gQm9hcmQ7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNy0wNS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImxpYi9raXdpLmQudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIFNjb3JpbmdNYW5hZ2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gU2NvcmluZ01hbmFnZXIobGV2ZWwpIHtcbiAgICAgICAgICAgIGlmIChsZXZlbCA9PT0gdm9pZCAwKSB7IGxldmVsID0gMTsgfVxuICAgICAgICAgICAgdGhpcy5zY29yZSA9IDA7XG4gICAgICAgICAgICB0aGlzLmxldmVsID0gMTtcbiAgICAgICAgICAgIHRoaXMucm93c0NsZWFyZWQgPSAwO1xuICAgICAgICAgICAgdGhpcy5sZXZlbCA9IGxldmVsO1xuICAgICAgICB9XG4gICAgICAgIFNjb3JpbmdNYW5hZ2VyLnByb3RvdHlwZS5jaGVja0xldmVsID0gZnVuY3Rpb24gKHJvd3NDbGVhcmVkKSB7XG4gICAgICAgICAgICB0aGlzLnJvd3NDbGVhcmVkICs9IHJvd3NDbGVhcmVkO1xuICAgICAgICAgICAgaWYgKHRoaXMucm93c0NsZWFyZWQgPiB0aGlzLmxldmVsICogMTApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxldmVsKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFNjb3JpbmdNYW5hZ2VyLnByb3RvdHlwZS5nZXRJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzY29yZTogdGhpcy5zY29yZSxcbiAgICAgICAgICAgICAgICBsZXZlbDogdGhpcy5sZXZlbCxcbiAgICAgICAgICAgICAgICBsaW5lczogdGhpcy5yb3dzQ2xlYXJlZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgU2NvcmluZ01hbmFnZXIucHJvdG90eXBlLmdldEZhbGxpbmdEZWxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBsZXZlbCA9IHRoaXMubGV2ZWwgPCAxMCA/IHRoaXMubGV2ZWwgOiAxMDtcbiAgICAgICAgICAgIHJldHVybiAoMTEgLSBsZXZlbCkgKiAwLjA1O1xuICAgICAgICB9O1xuICAgICAgICBTY29yaW5nTWFuYWdlci5wcm90b3R5cGUuYWRkUm93c0NsZWFyZWQgPSBmdW5jdGlvbiAocm93c0NsZWFyZWQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocm93c0NsZWFyZWQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NvcmUgKz0gNDAgKiB0aGlzLmxldmVsO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2NvcmUgKz0gMTAwICogdGhpcy5sZXZlbDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlICs9IDMwMCAqIHRoaXMubGV2ZWw7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY29yZSArPSAxMjAwICogdGhpcy5sZXZlbDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jaGVja0xldmVsKHJvd3NDbGVhcmVkKTtcbiAgICAgICAgfTtcbiAgICAgICAgU2NvcmluZ01hbmFnZXIucHJvdG90eXBlLmFkZFNvZnREcm9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5zY29yZSsrO1xuICAgICAgICB9O1xuICAgICAgICBTY29yaW5nTWFuYWdlci5wcm90b3R5cGUuYWRkSGFyZERyb3AgPSBmdW5jdGlvbiAoYW1vdW50T2ZSb3dzKSB7XG4gICAgICAgICAgICB0aGlzLnNjb3JlICs9IDIgKiBhbW91bnRPZlJvd3M7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBTY29yaW5nTWFuYWdlcjtcbiAgICB9KSgpO1xuICAgIFRldHJpcy5TY29yaW5nTWFuYWdlciA9IFNjb3JpbmdNYW5hZ2VyO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDctMDUuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJnYW1lLW9iamVjdHMvc2hhcGVzL3NoYXBlLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJsaWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJjb25maWcudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInNjb3JpbmctbWFuYWdlci50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgSHVkID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSHVkKHN0YXRlLCBzY29yaW5nTWFuYWdlciwgbGV2ZWwsIHNjb3JlLCBsaW5lcykge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICAgICAgdGhpcy5sZXZlbE9iamVjdCA9IGxldmVsO1xuICAgICAgICAgICAgdGhpcy5zY29yZU9iamVjdCA9IHNjb3JlO1xuICAgICAgICAgICAgdGhpcy5saW5lc09iamVjdCA9IGxpbmVzO1xuICAgICAgICAgICAgdGhpcy5zY29yaW5nTWFuYWdlciA9IHNjb3JpbmdNYW5hZ2VyO1xuICAgICAgICB9XG4gICAgICAgIEh1ZC5wcm90b3R5cGUudXBkYXRlU2NvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IHRoaXMuc2NvcmluZ01hbmFnZXIuZ2V0SW5mbygpO1xuICAgICAgICAgICAgdGhpcy5zY29yZU9iamVjdC50ZXh0ID0gaW5mby5zY29yZS50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5sZXZlbE9iamVjdC50ZXh0ID0gaW5mby5sZXZlbC50b1N0cmluZygpO1xuICAgICAgICAgICAgdGhpcy5saW5lc09iamVjdC50ZXh0ID0gaW5mby5saW5lcy50b1N0cmluZygpO1xuICAgICAgICB9O1xuICAgICAgICBIdWQuc2V0VXBTcHJpdGUgPSBmdW5jdGlvbiAoc2hhcGUsIHNoYXBlTmFtZSwgbWFyZ2luWCwgbWFyZ2luWSkge1xuICAgICAgICAgICAgdmFyIGdhbWVPYmplY3QgPSBzaGFwZS5nZXRHYW1lT2JqZWN0KCk7XG4gICAgICAgICAgICBpZiAoc2hhcGVOYW1lID09ICdTaGFwZUknKSB7XG4gICAgICAgICAgICAgICAgc2hhcGUucm90YXRlKCkucm90YXRlKCk7XG4gICAgICAgICAgICAgICAgbWFyZ2luWCAtPSAyMDtcbiAgICAgICAgICAgICAgICBtYXJnaW5ZIC09IDE1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNoYXBlTmFtZSA9PSAnU2hhcGVPJykge1xuICAgICAgICAgICAgICAgIG1hcmdpblggLT0gMTA7XG4gICAgICAgICAgICAgICAgbWFyZ2luWSArPSA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2FtZU9iamVjdC55ID0gbWFyZ2luWTtcbiAgICAgICAgICAgIGdhbWVPYmplY3QueCA9IG1hcmdpblg7XG4gICAgICAgICAgICBnYW1lT2JqZWN0LnNjYWxlID0gMC43O1xuICAgICAgICAgICAgZ2FtZU9iamVjdC5nZXRBbGxDaGlsZHJlbigpLmZvckVhY2goZnVuY3Rpb24gKHNwcml0ZSkge1xuICAgICAgICAgICAgICAgIHNwcml0ZS5hbHBoYSA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIHR3ZWVuID0gc3ByaXRlLnN0YXRlLmdhbWUudHdlZW5zLmNyZWF0ZShzcHJpdGUpO1xuICAgICAgICAgICAgICAgIHR3ZWVuLnRvKHsgYWxwaGE6IDEgfSwgVGV0cmlzLkNvbmZpZy5hbmltYXRpb25UaW1lLCBLaXdpLkFuaW1hdGlvbnMuVHdlZW5zLkVhc2luZy5TaW51c29pZGFsLkluLCB0cnVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGdhbWVPYmplY3Q7XG4gICAgICAgIH07XG4gICAgICAgIEh1ZC5wcm90b3R5cGUuc2V0TmV4dFNoYXBlID0gZnVuY3Rpb24gKHNoYXBlTmFtZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubmV4dFNoYXBlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0U2hhcGUuZ2V0R2FtZU9iamVjdCgpLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmV4dFNoYXBlID0gbmV3IFRldHJpcy5TaGFwZXNbc2hhcGVOYW1lXSh0aGlzLnN0YXRlLCAwLCAwKTtcbiAgICAgICAgICAgIGlmIChzaGFwZU5hbWUgPT0gJ1NoYXBlSScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRTaGFwZS5yb3RhdGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRTaGFwZS5yb3RhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3RhdGUuYWRkQ2hpbGQoSHVkLnNldFVwU3ByaXRlKHRoaXMubmV4dFNoYXBlLCBzaGFwZU5hbWUsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC0gNiwgMjg1KSk7XG4gICAgICAgIH07XG4gICAgICAgIEh1ZC5wcm90b3R5cGUuc2V0SGVsZFNoYXBlID0gZnVuY3Rpb24gKHNoYXBlTmFtZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaGVsZFNoYXBlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWxkU2hhcGUuZ2V0R2FtZU9iamVjdCgpLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaGVsZFNoYXBlID0gbmV3IFRldHJpcy5TaGFwZXNbc2hhcGVOYW1lXSh0aGlzLnN0YXRlLCAwLCAwKTtcbiAgICAgICAgICAgIGlmIChzaGFwZU5hbWUgPT0gJ1NoYXBlSScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhlbGRTaGFwZS5yb3RhdGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhlbGRTaGFwZS5yb3RhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3RhdGUuYWRkQ2hpbGQoSHVkLnNldFVwU3ByaXRlKHRoaXMuaGVsZFNoYXBlLCBzaGFwZU5hbWUsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC0gNiwgNDM1KSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBIdWQ7XG4gICAgfSkoKTtcbiAgICBUZXRyaXMuSHVkID0gSHVkO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDQtMjAuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9saWIva2l3aS5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9nYW1lLW9iamVjdHMvc2hhcGVzL3NoYXBlLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9nYW1lLW9iamVjdHMvc2hhcGVzL3NoYXBlLXN0YWNrLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9nYW1lLW9iamVjdHMvZ2hvc3QudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2dhbWUtb2JqZWN0cy9ib2FyZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vZW51bXMudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2NvbmZpZy50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vaHVkLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9zY29yaW5nLW1hbmFnZXIudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIE1haW5TdGF0ZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhNYWluU3RhdGUsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIE1haW5TdGF0ZSgpIHtcbiAgICAgICAgICAgIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgdGhpcy5ob2xkS2V5SXNEb3duID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmNhbkhvbGQgPSB0cnVlO1xuICAgICAgICAgICAgLy9Nb3ZpbmcgdG8gbGVmdCBhbmQgcmlnaHRcbiAgICAgICAgICAgIHRoaXMubW92ZUtleUlzRG93biA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVLZXlJc0Rvd24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucm90YXRpb25EaXJlY3Rpb24gPSAwO1xuICAgICAgICAgICAgLy9kcm9wcGluZ1xuICAgICAgICAgICAgdGhpcy5kcm9wcGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zU3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgLy9ibG9jayBjb2xvcnMgZm9yIHNwcml0ZSBsb2FkaW5nXG4gICAgICAgICAgICB0aGlzLmJsb2NrcyA9IFtcbiAgICAgICAgICAgICAgICAnYmx1ZScsXG4gICAgICAgICAgICAgICAgJ2N5YW4nLFxuICAgICAgICAgICAgICAgICdncmVlbicsXG4gICAgICAgICAgICAgICAgJ29yYW5nZScsXG4gICAgICAgICAgICAgICAgJ3B1cnBsZScsXG4gICAgICAgICAgICAgICAgJ3JlZCcsXG4gICAgICAgICAgICAgICAgJ3llbGxvdydcbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgTWFpblN0YXRlLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucHJlbG9hZC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5hZGRJbWFnZSgnYm9hcmQnLCAnYXNzZXRzL2ltZy9ib2FyZC5wbmcnKTtcbiAgICAgICAgICAgIHRoaXMuYWRkSW1hZ2UoJ2JvcmRlcnMnLCAnYXNzZXRzL2ltZy9ib3JkZXJzLnBuZycpO1xuICAgICAgICAgICAgdGhpcy5hZGRJbWFnZSgnaHVkQm9yZGVycycsICdhc3NldHMvaW1nL2h1ZC1ib3JkZXJzLnBuZycpO1xuICAgICAgICAgICAgdGhpcy5ibG9ja3MuZm9yRWFjaChmdW5jdGlvbiAoY29sb3IpIHsgcmV0dXJuIF90aGlzLmFkZEltYWdlKCdibG9jay0nICsgY29sb3IsICdhc3NldHMvaW1nL2Jsb2NrLScgKyBjb2xvciArICcucG5nJyk7IH0pO1xuICAgICAgICAgICAgdGhpcy5hZGRJbWFnZSgnYmxvY2stZ2hvc3QnLCAnYXNzZXRzL2ltZy9ibG9jay1naG9zdC5wbmcnKTtcbiAgICAgICAgICAgIHRoaXMuYWRkU3ByaXRlU2hlZXQoJ2NvbnRyb2xBcnJvdycsICdhc3NldHMvaW1nL2NvbnRyb2wtYXJyb3cucG5nJywgNTEsIDczKTtcbiAgICAgICAgICAgIHRoaXMuYWRkU3ByaXRlU2hlZXQoJ2NvbnRyb2xCdXR0b24nLCAnYXNzZXRzL2ltZy9jb250cm9sLWJ1dHRvbi5wbmcnLCAxMDAsIDEwMCk7XG4gICAgICAgIH07XG4gICAgICAgIE1haW5TdGF0ZS5wcm90b3R5cGUubW92ZUNvbnRyb2xzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRTcHJpdGUuaW5wdXQud2l0aGluQm91bmRzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvaW50ZXJQb3NpdGlvbiA9IE1hdGgudHJ1bmMoKHRoaXMuZ2FtZS5pbnB1dC54IC0gVGV0cmlzLkNvbmZpZy5vZmZzZXRYIC0gVGV0cmlzLkNvbmZpZy5ib3JkZXJXaWR0aCkgLyAoVGV0cmlzLkNvbmZpZy50aWxlU2l6ZSAtIDEpKTtcbiAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2VGcm9tQ2VudGVyID0gTWF0aC50cnVuYyhwb2ludGVyUG9zaXRpb24gLSB0aGlzLmN1cnJlbnRTaGFwZS5jZW50ZXIueCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFNoYXBlLm5hbWUgPT0gJ1NoYXBlSScgfHwgdGhpcy5jdXJyZW50U2hhcGUubmFtZSA9PSAnU2hhcGVPJykge1xuICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZUZyb21DZW50ZXIgPSBNYXRoLnJvdW5kKHBvaW50ZXJQb3NpdGlvbiAtIHRoaXMuY3VycmVudFNoYXBlLmNlbnRlci54KSAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vc2hhcGVJIGRvZXNudCBsaWtlIHJvdGF0aW9uIHRvb1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTaGFwZS5uYW1lID09ICdTaGFwZUknICYmIHRoaXMuY3VycmVudFNoYXBlLmN1cnJlbnRSb3RhdGlvbiA9PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlRnJvbUNlbnRlcisrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL3NvbWV0aGluZyBzY3Jld3MgdXAgd2l0aCByb3RhdGlvbiAzLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRTaGFwZS5jdXJyZW50Um90YXRpb24gPT0gMyAmJiBwb2ludGVyUG9zaXRpb24gPT0gOSkge1xuICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZUZyb21DZW50ZXIrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrZWRDZW50ZXJQb3NpdGlvbiA9IHRoaXMuYm9hcmQuZmluZFZhbGlkUG9zaXRpb24oZGlzdGFuY2VGcm9tQ2VudGVyLCB0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U2hhcGUuc2V0QnlQb2ludGVyUG9zaXRpb24oY2hlY2tlZENlbnRlclBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdob3N0LnNldFBvc2l0aW9uKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpLCB0aGlzLmJvYXJkLmZpbmREaXN0YW5jZVRvRmFsbCh0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBsZWZ0ID0gdGhpcy5sZWZ0S2V5LmlzRG93biB8fCB0aGlzLmxlZnRLZXlTY3JlZW4uaXNEb3duO1xuICAgICAgICAgICAgdmFyIHJpZ2h0ID0gdGhpcy5yaWdodEtleS5pc0Rvd24gfHwgdGhpcy5yaWdodEtleVNjcmVlbi5pc0Rvd247XG4gICAgICAgICAgICB2YXIgZGlyZWN0aW9uID0gcmlnaHQgPyBUZXRyaXMuRGlyZWN0aW9uLlJpZ2h0IDogVGV0cmlzLkRpcmVjdGlvbi5MZWZ0O1xuICAgICAgICAgICAgaWYgKChsZWZ0IHx8IHJpZ2h0KSAmJiAhdGhpcy5tb3ZlS2V5SXNEb3duICYmIHRoaXMuYm9hcmQuZW1wdHlEaXJlY3Rpb24odGhpcy5jdXJyZW50U2hhcGUuZ2V0QmxvY2tzKCksIGRpcmVjdGlvbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVLZXlJc0Rvd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNoYXBlLm1vdmUoZGlyZWN0aW9uKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdob3N0LnNldFBvc2l0aW9uKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpLCB0aGlzLmJvYXJkLmZpbmREaXN0YW5jZVRvRmFsbCh0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSkpO1xuICAgICAgICAgICAgICAgIHRoaXMubW92ZVRpbWVyLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE1haW5TdGF0ZS5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgdmFyIHBvc2l0aW9ucyA9IHRoaXMuY3VycmVudFNoYXBlLmdldE5leHRSb3RhdGlvbihkaXJlY3Rpb24pO1xuICAgICAgICAgICAgdmFyIHJvdGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHdoaWxlIChwb3NpdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmJvYXJkLmVtcHR5UG9zaXRpb25zKHBvc2l0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgcm90YXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNoYXBlLnJvdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdob3N0LnNldFBvc2l0aW9uKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpLCB0aGlzLmJvYXJkLmZpbmREaXN0YW5jZVRvRmFsbCh0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvdGF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHBvc2l0aW9ucyA9IHRoaXMuY3VycmVudFNoYXBlLmdldE5leHRSb3RhdGlvbihkaXJlY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJvdGF0ZWQ7XG4gICAgICAgIH07XG4gICAgICAgIE1haW5TdGF0ZS5wcm90b3R5cGUuYWZ0ZXJTaGFwZUxhbmRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1N0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8vY3JlYXRlIGVtcHR5IHNoYXBlXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZU5ld1NoYXBlKCk7XG4gICAgICAgICAgICAvL2lmIHdlIGNhbiBjcmVhdGUgc2hhcGUgYWRkIGl0IGludG8gdGhlIGdhbWVcbiAgICAgICAgICAgIGlmICh0aGlzLmJvYXJkLmVtcHR5UG9zaXRpb25zKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpKSkge1xuICAgICAgICAgICAgICAgIC8vYWxsb3cgdG8gaG9sZCBzaGFwZSBhZ2FpblxuICAgICAgICAgICAgICAgIHRoaXMuY2FuSG9sZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLmN1cnJlbnRTaGFwZS5nZXRHYW1lT2JqZWN0KCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuaHVkLnNldE5leHRTaGFwZSh0aGlzLnNoYXBlU3RhY2suZ2V0TmV4dFNoYXBlKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2hvc3Quc2V0UG9zaXRpb24odGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCksIHRoaXMuYm9hcmQuZmluZERpc3RhbmNlVG9GYWxsKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nYW1lLnN0YXRlcy5zd2l0Y2hTdGF0ZSgnZ2FtZU92ZXInLCBudWxsLCBudWxsLCB0aGlzLnNjb3JpbmdNYW5hZ2VyLmdldEluZm8oKSk7XG4gICAgICAgIH07XG4gICAgICAgIC8vZHJvcCBkb3duIGV2ZW50XG4gICAgICAgIE1haW5TdGF0ZS5wcm90b3R5cGUuZmFsbERvd24gPSBmdW5jdGlvbiAoYW1vdW50T2ZUaWxlcywgZm9yY2VDaGVjaykge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGlmIChhbW91bnRPZlRpbGVzID09PSB2b2lkIDApIHsgYW1vdW50T2ZUaWxlcyA9IDE7IH1cbiAgICAgICAgICAgIGlmIChmb3JjZUNoZWNrID09PSB2b2lkIDApIHsgZm9yY2VDaGVjayA9IGZhbHNlOyB9XG4gICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb25zU3RhcnRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vdHJ5IHRvIGZhbGwgZG93blxuICAgICAgICAgICAgLy9hbW91bnQgb2YgVGlsZXMgc3BlY2lmaWVkIG11c3QgYmUgZW1wdHksIGJlY2F1c2UgaGVyZSBJIGRvbid0IGNoZWNrIHRpbGVzIGJlbG93XG4gICAgICAgICAgICBpZiAodGhpcy5ib2FyZC5lbXB0eURpcmVjdGlvbih0aGlzLmN1cnJlbnRTaGFwZS5nZXRCbG9ja3MoKSwgVGV0cmlzLkRpcmVjdGlvbi5Eb3duKSkge1xuICAgICAgICAgICAgICAgIC8vaWYgc29mdCBkcm9wIGlzIGJlaW5nIGRvbmUsIGFkZCBzY29yZVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZhbGxUaW1lci5kZWxheSA9PT0gMC4wMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JpbmdNYW5hZ2VyLmFkZFNvZnREcm9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNoYXBlLmZhbGwoYW1vdW50T2ZUaWxlcyk7XG4gICAgICAgICAgICAgICAgaWYgKCFmb3JjZUNoZWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2lmIHNoYXBlIGNhbid0IGZhbGwgZG93biwgc2V0IGJsb2NrcyBpbnRvIGJvYXJkIGFuZCBjcmVhdGUgbmV3IHNoYXBlIHVubGVzcyBpdCBpcyBnZ1xuICAgICAgICAgICAgLy9zZXQgYmxvY2tzIGFzIHVzZWQsIHNpbmNlIHdlIGFyZSBjcmVhdGluZyBuZXcgc2hhcGVcbiAgICAgICAgICAgIHRoaXMuYm9hcmQuc2V0QmxvY2tzKHRoaXMuY3VycmVudFNoYXBlLmdldEJsb2NrcygpLCBUZXRyaXMuQmxvY2tTdGF0dXMuVGFrZW4pO1xuICAgICAgICAgICAgLy8vL3RyeSB0byBjbGVhciB0aGUgcm93cyBpbiB3aGljaCBibG9ja3MgZXhpc3RcbiAgICAgICAgICAgIHZhciByb3dzQ2xlYXJlZCA9IHRoaXMuYm9hcmQuY2hlY2tSb3dzKHRoaXMuY3VycmVudFNoYXBlLmdldEJsb2NrcygpKTtcbiAgICAgICAgICAgIHRoaXMuc2NvcmluZ01hbmFnZXIuYWRkUm93c0NsZWFyZWQocm93c0NsZWFyZWQpO1xuICAgICAgICAgICAgaWYgKHJvd3NDbGVhcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zU3RhcnRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLnRpbWUuY2xvY2suc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFmdGVyU2hhcGVMYW5kZWQoKTtcbiAgICAgICAgICAgICAgICB9LCBUZXRyaXMuQ29uZmlnLmFuaW1hdGlvblRpbWUsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZnRlclNoYXBlTGFuZGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE1haW5TdGF0ZS5wcm90b3R5cGUucm90YXRpb25Db250cm9scyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vcm90YXRpb24gY29udHJvbHNcbiAgICAgICAgICAgIGlmICh0aGlzLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2VLZXkuaXNEb3duIHx8IHRoaXMucm90YXRlQ291bnRlckNsb2Nrd2lzZVNjcmVlbi5pc0Rvd24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvdGF0aW9uRGlyZWN0aW9uID0gVGV0cmlzLkRpcmVjdGlvbi5MZWZ0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5yb3RhdGVDbG9ja3dpc2VLZXkuaXNEb3duIHx8IHRoaXMucm90YXRlQ2xvY2t3aXNlU2NyZWVuLmlzRG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMucm90YXRpb25EaXJlY3Rpb24gPSBUZXRyaXMuRGlyZWN0aW9uLlJpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5yb3RhdGVCb3RoS2V5LmlzRG93biB8fCB0aGlzLnJvdGF0ZUJvdGhTY3JlZW4uaXNEb3duIHx8IHRoaXMuYm9hcmRTcHJpdGUuaW5wdXQuaXNEb3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9IFRldHJpcy5EaXJlY3Rpb24uVXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5yb3RhdGlvbkRpcmVjdGlvbiAhPT0gMCAmJiAhdGhpcy5yb3RhdGVLZXlJc0Rvd24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJvdGF0ZUtleUlzRG93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy90cnkgdG8gcm90YXRlIGJvdGggdG8gcmlnaHQgYW5kIGxlZnRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9PSBUZXRyaXMuRGlyZWN0aW9uLlVwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yb3RhdGUoVGV0cmlzLkRpcmVjdGlvbi5SaWdodCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm90YXRlKFRldHJpcy5EaXJlY3Rpb24uTGVmdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm90YXRlKHRoaXMucm90YXRpb25EaXJlY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vcmVzZXQgcm90YXRpb24gY29udHJvbHNcbiAgICAgICAgICAgIGlmICgodGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9PSBUZXRyaXMuRGlyZWN0aW9uLlJpZ2h0ICYmICh0aGlzLnJvdGF0ZUNsb2Nrd2lzZUtleS5pc1VwICYmIHRoaXMucm90YXRlQ2xvY2t3aXNlU2NyZWVuLmlzVXApKVxuICAgICAgICAgICAgICAgIHx8ICh0aGlzLnJvdGF0aW9uRGlyZWN0aW9uID09IFRldHJpcy5EaXJlY3Rpb24uTGVmdCAmJiAodGhpcy5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlS2V5LmlzVXAgJiYgdGhpcy5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlU2NyZWVuLmlzVXApKVxuICAgICAgICAgICAgICAgIHx8ICh0aGlzLnJvdGF0aW9uRGlyZWN0aW9uID09IFRldHJpcy5EaXJlY3Rpb24uVXAgJiYgKHRoaXMucm90YXRlQm90aEtleS5pc1VwICYmIHRoaXMucm90YXRlQm90aFNjcmVlbi5pc1VwICYmIHRoaXMuYm9hcmRTcHJpdGUuaW5wdXQuaXNVcCkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGVLZXlJc0Rvd24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnJvdGF0aW9uRGlyZWN0aW9uID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWFpblN0YXRlLnByb3RvdHlwZS5kcm9wRG93bkNvbnRyb2xzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCh0aGlzLmhhcmREcm9wS2V5LmlzRG93biB8fCB0aGlzLmhhcmREcm9wU2NyZWVuLmlzRG93bikgJiYgIXRoaXMuZHJvcHBpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyb3BwaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgYW1vdW50T2ZSb3dzID0gdGhpcy5ib2FyZC5maW5kRGlzdGFuY2VUb0ZhbGwodGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCkpO1xuICAgICAgICAgICAgICAgIHRoaXMuZmFsbERvd24oYW1vdW50T2ZSb3dzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjb3JpbmdNYW5hZ2VyLmFkZEhhcmREcm9wKGFtb3VudE9mUm93cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5oYXJkRHJvcEtleS5pc1VwICYmIHRoaXMuaGFyZERyb3BTY3JlZW4uaXNVcCAmJiB0aGlzLmRyb3BwaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kcm9wcGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLmZhbGxUaW1lckNvbnRyb2xzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5mYWxsVGltZXIuZGVsYXkgPSB0aGlzLnNjb3JpbmdNYW5hZ2VyLmdldEZhbGxpbmdEZWxheSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc29mdERyb3BLZXkuaXNEb3duIHx8IHRoaXMuc29mdERyb3BTY3JlZW4uaXNEb3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mYWxsVGltZXIuZGVsYXkgPSAwLjAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLmhvbGRDb250cm9scyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICgodGhpcy5ob2xkS2V5LmlzRG93biB8fCB0aGlzLmhvbGRTcHJpdGUuaW5wdXQuaXNEb3duKSAmJiAhdGhpcy5ob2xkS2V5SXNEb3duICYmIHRoaXMuY2FuSG9sZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaG9sZEtleUlzRG93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIGhlbGRTaGFwZU5hbWUgPSB0aGlzLmhlbGRTaGFwZSA/IHRoaXMuaGVsZFNoYXBlIDogJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWxkU2hhcGUgPSB0aGlzLmN1cnJlbnRTaGFwZS5uYW1lO1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFNoYXBlLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZU5ld1NoYXBlKHRydWUsIGhlbGRTaGFwZU5hbWUpO1xuICAgICAgICAgICAgICAgIGlmICghaGVsZFNoYXBlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmh1ZC5zZXROZXh0U2hhcGUodGhpcy5zaGFwZVN0YWNrLmdldE5leHRTaGFwZSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5odWQuc2V0SGVsZFNoYXBlKHRoaXMuaGVsZFNoYXBlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdob3N0LnNldFBvc2l0aW9uKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpLCB0aGlzLmJvYXJkLmZpbmREaXN0YW5jZVRvRmFsbCh0aGlzLmN1cnJlbnRTaGFwZS5nZXRQb3NpdGlvbnMoKSkpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2FuSG9sZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaG9sZEtleS5pc1VwICYmIHRoaXMuaG9sZFNwcml0ZS5pbnB1dC5pc1VwICYmIHRoaXMuaG9sZEtleUlzRG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMuaG9sZEtleUlzRG93biA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUudXBkYXRlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpZiAodGhpcy5hbmltYXRpb25zU3RhcnRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubW92ZUNvbnRyb2xzKCk7XG4gICAgICAgICAgICB0aGlzLnJvdGF0aW9uQ29udHJvbHMoKTtcbiAgICAgICAgICAgIHRoaXMuZHJvcERvd25Db250cm9scygpO1xuICAgICAgICAgICAgdGhpcy5mYWxsVGltZXJDb250cm9scygpO1xuICAgICAgICAgICAgdGhpcy5ob2xkQ29udHJvbHMoKTtcbiAgICAgICAgICAgIC8va2VlcCBmYWxsaW5nIGRvd25cbiAgICAgICAgICAgIHRoaXMuZmFsbFRpbWVyLnN0YXJ0KCk7XG4gICAgICAgICAgICB0aGlzLmh1ZC51cGRhdGVTY29yZSgpO1xuICAgICAgICB9O1xuICAgICAgICBNYWluU3RhdGUucHJvdG90eXBlLmNyZWF0ZU5ld1NoYXBlID0gZnVuY3Rpb24gKGFkZFRvR2FtZSwgc2hhcGVOYW1lLCB4LCB5LCBkZWJ1Zykge1xuICAgICAgICAgICAgaWYgKGFkZFRvR2FtZSA9PT0gdm9pZCAwKSB7IGFkZFRvR2FtZSA9IGZhbHNlOyB9XG4gICAgICAgICAgICBpZiAoc2hhcGVOYW1lID09PSB2b2lkIDApIHsgc2hhcGVOYW1lID0gJyc7IH1cbiAgICAgICAgICAgIGlmICh4ID09PSB2b2lkIDApIHsgeCA9IDQ7IH1cbiAgICAgICAgICAgIGlmICh5ID09PSB2b2lkIDApIHsgeSA9IDE7IH1cbiAgICAgICAgICAgIGlmIChkZWJ1ZyA9PT0gdm9pZCAwKSB7IGRlYnVnID0gZmFsc2U7IH1cbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNoYXBlID0gdGhpcy5zaGFwZVN0YWNrLmNyZWF0ZU5ld1NoYXBlKGFkZFRvR2FtZSwgc2hhcGVOYW1lLCB4LCB5KTtcbiAgICAgICAgICAgIC8vYWx3YXlzIHJlZnJlc2ggYm9hcmQsIGJlY2F1c2Ugc29tZXRpbWVzIGJ1ZyBjYW4gb2NjdXIuIE1vc3QgbGlrZWx5IGJlY2F1c2Ugb2Ygc2V0VGltZW91dHMuIEkgZG9uJ3QgbGlrZSAnZW0uIDooXG4gICAgICAgICAgICB0aGlzLmJvYXJkLnJlZnJlc2hIaWdoZXN0UG9zaXRpb25zKCk7XG4gICAgICAgICAgICBpZiAoZGVidWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJvYXJkLnNldEJsb2Nrcyh0aGlzLmN1cnJlbnRTaGFwZS5nZXRCbG9ja3MoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE1haW5TdGF0ZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuY3JlYXRlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICAvL2NvbnRyb2xzXG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUJvdGhTY3JlZW4gPSBuZXcgS2l3aS5QbHVnaW5zLkdhbWVPYmplY3RzLlRvdWNoQnV0dG9uKHRoaXMsIHRoaXMudGV4dHVyZXNbJ2NvbnRyb2xBcnJvdyddLCA5NSwgVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodEluUGl4ZWxzIC0gMzApO1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVCb3RoU2NyZWVuLnJvdFBvaW50WCA9IHRoaXMucm90YXRlQm90aFNjcmVlbi53aWR0aCAqIDAuNTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQm90aFNjcmVlbi5yb3RQb2ludFkgPSB0aGlzLnJvdGF0ZUJvdGhTY3JlZW4uaGVpZ2h0ICogMC41O1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVCb3RoU2NyZWVuLnJvdGF0aW9uID0gTWF0aC5QSSAvIDI7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKHRoaXMucm90YXRlQm90aFNjcmVlbik7XG4gICAgICAgICAgICB0aGlzLmxlZnRLZXlTY3JlZW4gPSBuZXcgS2l3aS5QbHVnaW5zLkdhbWVPYmplY3RzLlRvdWNoQnV0dG9uKHRoaXMsIHRoaXMudGV4dHVyZXNbJ2NvbnRyb2xBcnJvdyddLCAzMCwgVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodEluUGl4ZWxzICsgMzUpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLmxlZnRLZXlTY3JlZW4pO1xuICAgICAgICAgICAgdGhpcy5yaWdodEtleVNjcmVlbiA9IG5ldyBLaXdpLlBsdWdpbnMuR2FtZU9iamVjdHMuVG91Y2hCdXR0b24odGhpcywgdGhpcy50ZXh0dXJlc1snY29udHJvbEFycm93J10sIDE2MCwgVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodEluUGl4ZWxzICsgMzUpO1xuICAgICAgICAgICAgdGhpcy5yaWdodEtleVNjcmVlbi5yb3RQb2ludFggPSB0aGlzLnJpZ2h0S2V5U2NyZWVuLndpZHRoICogMC41O1xuICAgICAgICAgICAgdGhpcy5yaWdodEtleVNjcmVlbi5yb3RQb2ludFkgPSB0aGlzLnJpZ2h0S2V5U2NyZWVuLmhlaWdodCAqIDAuNTtcbiAgICAgICAgICAgIHRoaXMucmlnaHRLZXlTY3JlZW4ucm90YXRpb24gPSBNYXRoLlBJO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLnJpZ2h0S2V5U2NyZWVuKTtcbiAgICAgICAgICAgIHRoaXMuc29mdERyb3BTY3JlZW4gPSBuZXcgS2l3aS5QbHVnaW5zLkdhbWVPYmplY3RzLlRvdWNoQnV0dG9uKHRoaXMsIHRoaXMudGV4dHVyZXNbJ2NvbnRyb2xBcnJvdyddLCA5NSwgVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodEluUGl4ZWxzICsgMTAwKTtcbiAgICAgICAgICAgIHRoaXMuc29mdERyb3BTY3JlZW4ucm90UG9pbnRYID0gdGhpcy5zb2Z0RHJvcFNjcmVlbi53aWR0aCAqIDAuNTtcbiAgICAgICAgICAgIHRoaXMuc29mdERyb3BTY3JlZW4ucm90UG9pbnRZID0gdGhpcy5zb2Z0RHJvcFNjcmVlbi5oZWlnaHQgKiAwLjU7XG4gICAgICAgICAgICB0aGlzLnNvZnREcm9wU2NyZWVuLnJvdGF0aW9uID0gLU1hdGguUEkgLyAyO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLnNvZnREcm9wU2NyZWVuKTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQ2xvY2t3aXNlU2NyZWVuID0gbmV3IEtpd2kuUGx1Z2lucy5HYW1lT2JqZWN0cy5Ub3VjaEJ1dHRvbih0aGlzLCB0aGlzLnRleHR1cmVzWydjb250cm9sQnV0dG9uJ10sIDIxMCwgVGV0cmlzLkNvbmZpZy5ib2FyZEhlaWdodEluUGl4ZWxzIC0gMzApO1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVDbG9ja3dpc2VTY3JlZW4uc2NhbGVYID0gMC42O1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVDbG9ja3dpc2VTY3JlZW4uc2NhbGVZID0gMC42O1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLnJvdGF0ZUNsb2Nrd2lzZVNjcmVlbik7XG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2VTY3JlZW4gPSBuZXcgS2l3aS5QbHVnaW5zLkdhbWVPYmplY3RzLlRvdWNoQnV0dG9uKHRoaXMsIHRoaXMudGV4dHVyZXNbJ2NvbnRyb2xCdXR0b24nXSwgMjgwLCBUZXRyaXMuQ29uZmlnLmJvYXJkSGVpZ2h0SW5QaXhlbHMgLSAzMCk7XG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2VTY3JlZW4uc2NhbGVYID0gMC42O1xuICAgICAgICAgICAgdGhpcy5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlU2NyZWVuLnNjYWxlWSA9IDAuNjtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlU2NyZWVuKTtcbiAgICAgICAgICAgIHRoaXMuaGFyZERyb3BTY3JlZW4gPSBuZXcgS2l3aS5QbHVnaW5zLkdhbWVPYmplY3RzLlRvdWNoQnV0dG9uKHRoaXMsIHRoaXMudGV4dHVyZXNbJ2NvbnRyb2xCdXR0b24nXSwgMzMwLCA0NjApO1xuICAgICAgICAgICAgdGhpcy5oYXJkRHJvcFNjcmVlbi5zY2FsZVggPSAwLjY7XG4gICAgICAgICAgICB0aGlzLmhhcmREcm9wU2NyZWVuLnNjYWxlWSA9IDAuNjtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5oYXJkRHJvcFNjcmVlbik7XG4gICAgICAgICAgICB0aGlzLmxlZnRLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KEtpd2kuSW5wdXQuS2V5Y29kZXMuTEVGVCk7XG4gICAgICAgICAgICB0aGlzLnJpZ2h0S2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShLaXdpLklucHV0LktleWNvZGVzLlJJR0hUKTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQm90aEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoS2l3aS5JbnB1dC5LZXljb2Rlcy5VUCk7XG4gICAgICAgICAgICB0aGlzLnJvdGF0ZUNsb2Nrd2lzZUtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoS2l3aS5JbnB1dC5LZXljb2Rlcy5aKTtcbiAgICAgICAgICAgIHRoaXMucm90YXRlQ291bnRlckNsb2Nrd2lzZUtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoS2l3aS5JbnB1dC5LZXljb2Rlcy5YKTtcbiAgICAgICAgICAgIHRoaXMuc29mdERyb3BLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KEtpd2kuSW5wdXQuS2V5Y29kZXMuRE9XTik7XG4gICAgICAgICAgICB0aGlzLmhhcmREcm9wS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShLaXdpLklucHV0LktleWNvZGVzLlNQQUNFQkFSKTtcbiAgICAgICAgICAgIHRoaXMuaG9sZEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoS2l3aS5JbnB1dC5LZXljb2Rlcy5TSElGVCk7XG4gICAgICAgICAgICAvL2JvYXJkIHNwcml0ZXNcbiAgICAgICAgICAgIC8vIEFkZCBzY29yZSB0ZXh0IHRvIHRoZSBzdGF0ZVxuICAgICAgICAgICAgdmFyIHNjb3JlVGV4dCA9IG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIlNjb3JlXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzLCAwLCBcIiMwMDBcIiwgMjQpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChzY29yZVRleHQpO1xuICAgICAgICAgICAgdmFyIHNjb3JlID0gbmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiMFwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscywgMjUsIFwiIzAwMFwiLCAyNCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKHNjb3JlKTtcbiAgICAgICAgICAgIHZhciBsZXZlbFRleHQgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJMZXZlbFwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscywgNjAsIFwiIzAwMFwiLCAyNCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKGxldmVsVGV4dCk7XG4gICAgICAgICAgICB2YXIgbGV2ZWwgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCIwXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzLCA4NSwgXCIjMDAwXCIsIDI0KTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobGV2ZWwpO1xuICAgICAgICAgICAgdmFyIGxpbmVzVGV4dCA9IG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIkxpbmVzXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzLCAxMTAsIFwiIzAwMFwiLCAyNCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKGxpbmVzVGV4dCk7XG4gICAgICAgICAgICB2YXIgbGluZXMgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCIwXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzLCAxMzUsIFwiIzAwMFwiLCAyNCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKGxpbmVzKTtcbiAgICAgICAgICAgIHRoaXMuYm9hcmRTcHJpdGUgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5TcHJpdGUodGhpcywgdGhpcy50ZXh0dXJlcy5ib2FyZCwgVGV0cmlzLkNvbmZpZy5vZmZzZXRYICsgVGV0cmlzLkNvbmZpZy5ib3JkZXJXaWR0aCwgVGV0cmlzLkNvbmZpZy5ib3JkZXJIZWlnaHQpO1xuICAgICAgICAgICAgdGhpcy5ib2FyZFNwcml0ZS5pbnB1dC5lbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5ib2FyZFNwcml0ZSk7XG4gICAgICAgICAgICB2YXIgYm9yZGVycyA9IG5ldyBLaXdpLkdhbWVPYmplY3RzLlN0YXRpY0ltYWdlKHRoaXMsIHRoaXMudGV4dHVyZXMuYm9yZGVycywgVGV0cmlzLkNvbmZpZy5vZmZzZXRYLCAwKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQoYm9yZGVycyk7XG4gICAgICAgICAgICB2YXIgbmV4dFNoYXBlVGV4dCA9IG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIk5leHRcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMsIDE3MCwgXCIjMDAwXCIsIDI0KTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV4dFNoYXBlVGV4dCk7XG4gICAgICAgICAgICB2YXIgbmV4dFNoYXBlQm9yZGVycyA9IG5ldyBLaXdpLkdhbWVPYmplY3RzLlN0YXRpY0ltYWdlKHRoaXMsIHRoaXMudGV4dHVyZXMuaHVkQm9yZGVycywgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgKyAyMCwgMjM1KTtcbiAgICAgICAgICAgIG5leHRTaGFwZUJvcmRlcnMuc2NhbGVYID0gMi41O1xuICAgICAgICAgICAgbmV4dFNoYXBlQm9yZGVycy5zY2FsZVkgPSAzLjU7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5leHRTaGFwZUJvcmRlcnMpO1xuICAgICAgICAgICAgdmFyIGhlbGRTaGFwZVRleHQgPSBuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJIb2xkXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzLCAzMjAsIFwiIzAwMFwiLCAyNCk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKGhlbGRTaGFwZVRleHQpO1xuICAgICAgICAgICAgdGhpcy5ob2xkU3ByaXRlID0gbmV3IEtpd2kuR2FtZU9iamVjdHMuU3ByaXRlKHRoaXMsIHRoaXMudGV4dHVyZXMuaHVkQm9yZGVycywgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgKyAyMCwgMzg1KTtcbiAgICAgICAgICAgIHRoaXMuaG9sZFNwcml0ZS5zY2FsZVggPSAyLjU7XG4gICAgICAgICAgICB0aGlzLmhvbGRTcHJpdGUuc2NhbGVZID0gMy41O1xuICAgICAgICAgICAgdGhpcy5ob2xkU3ByaXRlLmlucHV0LmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLmhvbGRTcHJpdGUpO1xuICAgICAgICAgICAgLy9tb3ZlIHRpbWVyIGZvciBsaW1pdGluZyBtb3ZlIGFtb3VudFxuICAgICAgICAgICAgdGhpcy5tb3ZlVGltZXIgPSB0aGlzLmdhbWUudGltZS5jbG9jay5jcmVhdGVUaW1lcignbW92ZScsIFRldHJpcy5Db25maWcubW92ZVRpbWVyUmF0ZSwgMCk7XG4gICAgICAgICAgICB0aGlzLm1vdmVUaW1lci5jcmVhdGVUaW1lckV2ZW50KEtpd2kuVGltZS5UaW1lckV2ZW50LlRJTUVSX1NUT1AsIGZ1bmN0aW9uICgpIHsgX3RoaXMubW92ZUtleUlzRG93biA9IGZhbHNlOyB9LCB0aGlzKTtcbiAgICAgICAgICAgIC8vYWRkIGRyb3AgdGltZXJcbiAgICAgICAgICAgIHRoaXMuZmFsbFRpbWVyID0gdGhpcy5nYW1lLnRpbWUuY2xvY2suY3JlYXRlVGltZXIoJ2ZhbGwnLCAwLjUsIDApO1xuICAgICAgICAgICAgdGhpcy5mYWxsVGltZXIuY3JlYXRlVGltZXJFdmVudChLaXdpLlRpbWUuVGltZXJFdmVudC5USU1FUl9TVE9QLCB0aGlzLmZhbGxEb3duLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYm9hcmQgPSBuZXcgVGV0cmlzLkJvYXJkKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5zaGFwZVN0YWNrID0gbmV3IFRldHJpcy5TaGFwZXMuU2hhcGVTdGFjayh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuc2NvcmluZ01hbmFnZXIgPSBuZXcgVGV0cmlzLlNjb3JpbmdNYW5hZ2VyKDEpO1xuICAgICAgICAgICAgdGhpcy5odWQgPSBuZXcgVGV0cmlzLkh1ZCh0aGlzLCB0aGlzLnNjb3JpbmdNYW5hZ2VyLCBsZXZlbCwgc2NvcmUsIGxpbmVzKTtcbiAgICAgICAgICAgIC8vZHJvcCB0aGUgZmlyc3Qgc2hhcGVcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTmV3U2hhcGUodHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmh1ZC5zZXROZXh0U2hhcGUodGhpcy5zaGFwZVN0YWNrLmdldE5leHRTaGFwZSgpKTtcbiAgICAgICAgICAgIC8vc2V0IGl0cyBnaG9zdFxuICAgICAgICAgICAgdGhpcy5naG9zdCA9IG5ldyBUZXRyaXMuR2hvc3QodGhpcywgdGhpcy5jdXJyZW50U2hhcGUuZ2V0UG9zaXRpb25zKCksIHRoaXMuYm9hcmQuZmluZERpc3RhbmNlVG9GYWxsKHRoaXMuY3VycmVudFNoYXBlLmdldFBvc2l0aW9ucygpKSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkQmVmb3JlKHRoaXMuZ2hvc3QuZ2V0R2FtZU9iamVjdCgpLCBib3JkZXJzKTtcbiAgICAgICAgICAgIHRoaXMuZmFsbFRpbWVyLnN0YXJ0KCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBNYWluU3RhdGU7XG4gICAgfSkoS2l3aS5TdGF0ZSk7XG4gICAgVGV0cmlzLk1haW5TdGF0ZSA9IE1haW5TdGF0ZTtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA0LTIwLlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vbGliL2tpd2kuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vY29uZmlnLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBHYW1lT3ZlclN0YXRlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKEdhbWVPdmVyU3RhdGUsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIEdhbWVPdmVyU3RhdGUoKSB7XG4gICAgICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBHYW1lT3ZlclN0YXRlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nYW1lLmlucHV0Lm1vdXNlLmlzRG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZXMuc3dpdGNoU3RhdGUoJ21haW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgR2FtZU92ZXJTdGF0ZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKHNjb3JlLCBsZXZlbCwgbGluZXMpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuY3JlYXRlLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIkdhbWUgT3ZlciFcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAxMDAsIFwiIzAwMFwiLCAzMCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgXCJTY29yZVwiLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDE1MCwgXCIjMDAwXCIsIDI0KSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBzY29yZS50b1N0cmluZygpLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDE3NSwgXCIjMDAwXCIsIDI0KSk7XG4gICAgICAgICAgICB0aGlzLmFkZENoaWxkKG5ldyBLaXdpLkdhbWVPYmplY3RzLlRleHRGaWVsZCh0aGlzLCBcIkxpbmVzXCIsIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMjAwLCBcIiMwMDBcIiwgMjQpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIGxpbmVzLnRvU3RyaW5nKCksIFRldHJpcy5Db25maWcuYm9hcmRXaWR0aEluUGl4ZWxzIC8gMiwgMjI1LCBcIiMwMDBcIiwgMjQpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2hpbGQobmV3IEtpd2kuR2FtZU9iamVjdHMuVGV4dEZpZWxkKHRoaXMsIFwiTGV2ZWxcIiwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAyNTAsIFwiIzAwMFwiLCAyNCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgbGV2ZWwudG9TdHJpbmcoKSwgVGV0cmlzLkNvbmZpZy5ib2FyZFdpZHRoSW5QaXhlbHMgLyAyLCAyNzUsIFwiIzAwMFwiLCAyNCkpO1xuICAgICAgICAgICAgdGhpcy5hZGRDaGlsZChuZXcgS2l3aS5HYW1lT2JqZWN0cy5UZXh0RmllbGQodGhpcywgJ1BsYXkgYWdhaW4nLCBUZXRyaXMuQ29uZmlnLmJvYXJkV2lkdGhJblBpeGVscyAvIDIsIDM1MCwgXCIjMDAwXCIsIDI0KSk7XG4gICAgICAgICAgICB0aGlzLmdldEFsbENoaWxkcmVuKCkuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRyZW4pIHsgcmV0dXJuIGNoaWxkcmVuLnRleHRBbGlnbiA9ICdjZW50ZXInOyB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEdhbWVPdmVyU3RhdGU7XG4gICAgfSkoS2l3aS5TdGF0ZSk7XG4gICAgVGV0cmlzLkdhbWVPdmVyU3RhdGUgPSBHYW1lT3ZlclN0YXRlO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImxpYi9raXdpLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInN0YXRlcy9tZW51LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzdGF0ZXMvbWFpbi50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic3RhdGVzL2dhbWUtb3Zlci50c1wiIC8+XG4vKipcbiogVGhlIGNvcmUgVGVtcGxhdGVHYW1lIGdhbWUgZmlsZS5cbipcbiogVGhpcyBmaWxlIGlzIG9ubHkgdXNlZCB0byBpbml0YWxpc2UgKHN0YXJ0LXVwKSB0aGUgbWFpbiBLaXdpIEdhbWVcbiogYW5kIGFkZCBhbGwgb2YgdGhlIHJlbGV2YW50IHN0YXRlcyB0byB0aGF0IEdhbWUuXG4qXG4qL1xuLy9Jbml0aWFsaXNlIHRoZSBLaXdpIEdhbWUuXG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgZ2FtZU9wdGlvbnMgPSB7XG4gICAgICAgIHJlbmRlcmVyOiBLaXdpLlJFTkRFUkVSX0NBTlZBUyxcbiAgICAgICAgd2lkdGg6IDQzMCxcbiAgICAgICAgaGVpZ2h0OiA4MDAsXG4gICAgICAgIHBsdWdpbnM6IFsnVG91Y2hCdXR0b24nXVxuICAgIH07XG4gICAgdmFyIGdhbWUgPSBuZXcgS2l3aS5HYW1lKCdjb250ZW50JywgJ1RldHJpcycsIG51bGwsIGdhbWVPcHRpb25zKTtcbiAgICB2YXIgbWVudVN0YXRlID0gbmV3IFRldHJpcy5NZW51U3RhdGUoJ21lbnUnKTtcbiAgICB2YXIgbWFpblN0YXRlID0gbmV3IFRldHJpcy5NYWluU3RhdGUoJ21haW4nKTtcbiAgICB2YXIgZ2FtZU92ZXJTdGF0ZSA9IG5ldyBUZXRyaXMuR2FtZU92ZXJTdGF0ZSgnZ2FtZU92ZXInKTtcbiAgICBnYW1lLnN0YXRlcy5hZGRTdGF0ZShtZW51U3RhdGUpO1xuICAgIGdhbWUuc3RhdGVzLmFkZFN0YXRlKG1haW5TdGF0ZSk7XG4gICAgZ2FtZS5zdGF0ZXMuYWRkU3RhdGUoZ2FtZU92ZXJTdGF0ZSk7XG4gICAgZ2FtZS5zdGF0ZXMuc3dpdGNoU3RhdGUoJ21lbnUnKTtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA1LTIxLlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic2hhcGUudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIFNoYXBlcztcbiAgICAoZnVuY3Rpb24gKFNoYXBlcykge1xuICAgICAgICB2YXIgU2hhcGVEb3QgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNoYXBlRG90LCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gU2hhcGVEb3Qoc3RhdGUsIHgsIHkpIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja0NvbG9yID0gJ3JlZCc7XG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gJ1NoYXBlRG90JztcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVEb3Q7XG4gICAgICAgIH0pKFNoYXBlcy5TaGFwZSk7XG4gICAgICAgIFNoYXBlcy5TaGFwZURvdCA9IFNoYXBlRG90O1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzaGFwZS50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZUkgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNoYXBlSSwgX3N1cGVyKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFNoYXBlSShzdGF0ZSwgeCwgeSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrQ29sb3IgPSAnY3lhbic7XG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gJ1NoYXBlSSc7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggLSAxLCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggKyAxLCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDIsIHkpO1xuICAgICAgICAgICAgICAgIC8vaW52aXNpYmxlIGNlbnRlclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2VudGVyKHggKyAwLjUsIHkgKyAwLjUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9yZXR1cm4gc3BlY2lmaWMgcm90YXRpb25zIGZvciB0aGlzIHNoYXBlXG4gICAgICAgICAgICBTaGFwZUkucHJvdG90eXBlLmdldFJvdGF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gU2hhcGVJLnJvdGF0aW9ucztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBTaGFwZUkucHJvdG90eXBlLmFkZENlbnRlciA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jZW50ZXIgPSBuZXcgVGV0cmlzLkJsb2NrKHgsIHksIHRoaXMuc3RhdGUsIG51bGwpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlSS5yb3RhdGlvbnMgPSBbXG4gICAgICAgICAgICAgICAgW1swLCAwXSwgWy0yLCAwXSwgWysxLCAwXSwgWy0yLCAtMV0sIFsrMSwgKzJdXSxcbiAgICAgICAgICAgICAgICBbWzAsIDBdLCBbLTEsIDBdLCBbKzIsIDBdLCBbLTEsICsyXSwgWysyLCAtMV1dLFxuICAgICAgICAgICAgICAgIFtbMCwgMF0sIFsrMiwgMF0sIFstMSwgMF0sIFsrMiwgKzFdLCBbLTEsIC0yXV0sXG4gICAgICAgICAgICAgICAgW1swLCAwXSwgWysxLCAwXSwgWy0yLCAwXSwgWysxLCAtMl0sIFstMiwgKzFdXSxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVJO1xuICAgICAgICB9KShTaGFwZXMuU2hhcGUpO1xuICAgICAgICBTaGFwZXMuU2hhcGVJID0gU2hhcGVJO1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzaGFwZS50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZUogPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNoYXBlSiwgX3N1cGVyKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFNoYXBlSihzdGF0ZSwgeCwgeSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrQ29sb3IgPSAnYmx1ZSc7XG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gJ1NoYXBlSic7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggLSAxLCB5IC0gMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggLSAxLCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggKyAxLCB5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTaGFwZUo7XG4gICAgICAgIH0pKFNoYXBlcy5TaGFwZSk7XG4gICAgICAgIFNoYXBlcy5TaGFwZUogPSBTaGFwZUo7XG4gICAgfSkoU2hhcGVzID0gVGV0cmlzLlNoYXBlcyB8fCAoVGV0cmlzLlNoYXBlcyA9IHt9KSk7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4vKipcbiAqIENyZWF0ZWQgYnkgR3l0aXMgb24gMjAxNS0wNS0yMS5cbiAqL1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInNoYXBlLnRzXCIgLz5cbnZhciBUZXRyaXM7XG4oZnVuY3Rpb24gKFRldHJpcykge1xuICAgIHZhciBTaGFwZXM7XG4gICAgKGZ1bmN0aW9uIChTaGFwZXMpIHtcbiAgICAgICAgdmFyIFNoYXBlTCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgICAgICBfX2V4dGVuZHMoU2hhcGVMLCBfc3VwZXIpO1xuICAgICAgICAgICAgZnVuY3Rpb24gU2hhcGVMKHN0YXRlLCB4LCB5KSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgc3RhdGUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYmxvY2tDb2xvciA9ICdvcmFuZ2UnO1xuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9ICdTaGFwZUwnO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4IC0gMSwgeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHgsIHksIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4ICsgMSwgeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggKyAxLCB5IC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gU2hhcGVMO1xuICAgICAgICB9KShTaGFwZXMuU2hhcGUpO1xuICAgICAgICBTaGFwZXMuU2hhcGVMID0gU2hhcGVMO1xuICAgIH0pKFNoYXBlcyA9IFRldHJpcy5TaGFwZXMgfHwgKFRldHJpcy5TaGFwZXMgPSB7fSkpO1xufSkoVGV0cmlzIHx8IChUZXRyaXMgPSB7fSkpO1xuLyoqXG4gKiBDcmVhdGVkIGJ5IEd5dGlzIG9uIDIwMTUtMDUtMjEuXG4gKi9cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJzaGFwZS50c1wiIC8+XG52YXIgVGV0cmlzO1xuKGZ1bmN0aW9uIChUZXRyaXMpIHtcbiAgICB2YXIgU2hhcGVzO1xuICAgIChmdW5jdGlvbiAoU2hhcGVzKSB7XG4gICAgICAgIHZhciBTaGFwZU8gPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICAgICAgX19leHRlbmRzKFNoYXBlTywgX3N1cGVyKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIFNoYXBlTyhzdGF0ZSwgeCwgeSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrQ29sb3IgPSAneWVsbG93JztcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSAnU2hhcGVPJztcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSAtIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDEsIHkgLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDEsIHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2VudGVyKHggLSAwLjUsIHkgLSAwLjUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9ObyBuZWVkIHRvIGRvIGFueXRoaW5nXG4gICAgICAgICAgICBTaGFwZU8ucHJvdG90eXBlLnJvdGF0ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH07XG4gICAgICAgICAgICAvL05vIG5lZWQgdG8gZG8gYW55dGhpbmdcbiAgICAgICAgICAgIFNoYXBlTy5wcm90b3R5cGUuZ2V0TmV4dFJvdGF0aW9uID0gZnVuY3Rpb24gKGRpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09IHZvaWQgMCkgeyBkaXJlY3Rpb24gPSAwOyB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFNoYXBlTy5wcm90b3R5cGUuYWRkQ2VudGVyID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNlbnRlciA9IG5ldyBUZXRyaXMuQmxvY2soeCwgeSwgdGhpcy5zdGF0ZSwgbnVsbCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIFNoYXBlTztcbiAgICAgICAgfSkoU2hhcGVzLlNoYXBlKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlTyA9IFNoYXBlTztcbiAgICB9KShTaGFwZXMgPSBUZXRyaXMuU2hhcGVzIHx8IChUZXRyaXMuU2hhcGVzID0ge30pKTtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA1LTIxLlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic2hhcGUudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIFNoYXBlcztcbiAgICAoZnVuY3Rpb24gKFNoYXBlcykge1xuICAgICAgICB2YXIgU2hhcGVTID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgICAgIF9fZXh0ZW5kcyhTaGFwZVMsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaGFwZVMoc3RhdGUsIHgsIHkpIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja0NvbG9yID0gJ2dyZWVuJztcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSAnU2hhcGVTJztcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCAtIDEsIHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4LCB5LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSAtIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQmxvY2sodGhpcy5ibG9ja0NvbG9yLCB4ICsgMSwgeSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFNoYXBlUztcbiAgICAgICAgfSkoU2hhcGVzLlNoYXBlKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlUyA9IFNoYXBlUztcbiAgICB9KShTaGFwZXMgPSBUZXRyaXMuU2hhcGVzIHx8IChUZXRyaXMuU2hhcGVzID0ge30pKTtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA1LTIxLlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic2hhcGUudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIFNoYXBlcztcbiAgICAoZnVuY3Rpb24gKFNoYXBlcykge1xuICAgICAgICB2YXIgU2hhcGVUID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgICAgIF9fZXh0ZW5kcyhTaGFwZVQsIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaGFwZVQoc3RhdGUsIHgsIHkpIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja0NvbG9yID0gJ3B1cnBsZSc7XG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gJ1NoYXBlVCc7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggLSAxLCB5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHgsIHkgLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCArIDEsIHkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFNoYXBlVDtcbiAgICAgICAgfSkoU2hhcGVzLlNoYXBlKTtcbiAgICAgICAgU2hhcGVzLlNoYXBlVCA9IFNoYXBlVDtcbiAgICB9KShTaGFwZXMgPSBUZXRyaXMuU2hhcGVzIHx8IChUZXRyaXMuU2hhcGVzID0ge30pKTtcbn0pKFRldHJpcyB8fCAoVGV0cmlzID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBHeXRpcyBvbiAyMDE1LTA1LTIxLlxuICovXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwic2hhcGUudHNcIiAvPlxudmFyIFRldHJpcztcbihmdW5jdGlvbiAoVGV0cmlzKSB7XG4gICAgdmFyIFNoYXBlcztcbiAgICAoZnVuY3Rpb24gKFNoYXBlcykge1xuICAgICAgICB2YXIgU2hhcGVaID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgICAgIF9fZXh0ZW5kcyhTaGFwZVosIF9zdXBlcik7XG4gICAgICAgICAgICBmdW5jdGlvbiBTaGFwZVooc3RhdGUsIHgsIHkpIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBzdGF0ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5ibG9ja0NvbG9yID0gJ3JlZCc7XG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gJ1NoYXBlWic7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggLSAxLCB5IC0gMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHgsIHkgLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJsb2NrKHRoaXMuYmxvY2tDb2xvciwgeCwgeSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCbG9jayh0aGlzLmJsb2NrQ29sb3IsIHggKyAxLCB5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBTaGFwZVo7XG4gICAgICAgIH0pKFNoYXBlcy5TaGFwZSk7XG4gICAgICAgIFNoYXBlcy5TaGFwZVogPSBTaGFwZVo7XG4gICAgfSkoU2hhcGVzID0gVGV0cmlzLlNoYXBlcyB8fCAoVGV0cmlzLlNoYXBlcyA9IHt9KSk7XG59KShUZXRyaXMgfHwgKFRldHJpcyA9IHt9KSk7XG4iXX0=
